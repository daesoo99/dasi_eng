
> dasi-english-web@1.0.0 lint
> eslint src --ext ts,tsx --report-unused-disable-directives --max-warnings 0 --format=json

[{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\App.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\adapters\\AudioContextAdapter.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\adapters\\BrowserAPIAdapter.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\adapters\\SpeechRecognitionAdapter.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\adapters\\SpeechSynthesisAdapter.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\AudioRecorder.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\AudioTest.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\AudioTestSimple.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\AudioV2Test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\AuthModal.tsx","messages":[{"ruleId":"no-undef","severity":1,"message":"'useMemo' is not defined.","line":127,"column":22,"nodeType":"Identifier","messageId":"undef","endLine":127,"endColumn":29},{"ruleId":"no-undef","severity":1,"message":"'useMemo' is not defined.","line":131,"column":28,"nodeType":"Identifier","messageId":"undef","endLine":131,"endColumn":35},{"ruleId":"no-undef","severity":1,"message":"'useMemo' is not defined.","line":136,"column":28,"nodeType":"Identifier","messageId":"undef","endLine":136,"endColumn":35}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useCallback, memo } from 'react';\r\nimport { getAuthService } from '../lib/firebase';\r\nimport { createUserWithEmailAndPassword, signInWithEmailAndPassword, updateProfile, signInWithPopup, GoogleAuthProvider } from 'firebase/auth';\r\nimport { auth } from '../lib/firebase';\r\n\r\ninterface AuthModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onAuthSuccess: (user: any) => void;\r\n}\r\n\r\ntype AuthMode = 'login' | 'signup';\r\n\r\nexport const AuthModal: React.FC<AuthModalProps> = memo(({ isOpen, onClose, onAuthSuccess }) => {\r\n  const [authMode, setAuthMode] = useState<AuthMode>('login');\r\n  const [email, setEmail] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const [displayName, setDisplayName] = useState('');\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  // Auth ì—ëŸ¬ ë©”ì‹œì§€ ì²˜ë¦¬ í•¨ìˆ˜\r\n  const getAuthErrorMessage = useCallback((error: any): string => {\r\n    switch (error.code) {\r\n      case 'auth/user-not-found':\r\n        return 'ë“±ë¡ë˜ì§€ ì•Šì€ ì´ë©”ì¼ì…ë‹ˆë‹¤.';\r\n      case 'auth/wrong-password':\r\n        return 'ì˜ëª»ëœ ë¹„ë°€ë²ˆí˜¸ì…ë‹ˆë‹¤.';\r\n      case 'auth/email-already-in-use':\r\n        return 'ì´ë¯¸ ì‚¬ìš© ì¤‘ì¸ ì´ë©”ì¼ì…ë‹ˆë‹¤.';\r\n      case 'auth/weak-password':\r\n        return 'ë¹„ë°€ë²ˆí˜¸ëŠ” 6ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.';\r\n      case 'auth/invalid-email':\r\n        return 'ì˜¬ë°”ë¥´ì§€ ì•Šì€ ì´ë©”ì¼ í˜•ì‹ì…ë‹ˆë‹¤.';\r\n      case 'auth/popup-closed-by-user':\r\n        return 'ë¡œê·¸ì¸ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.';\r\n      default:\r\n        return error.message || 'ë¡œê·¸ì¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';\r\n    }\r\n  }, []);\r\n\r\n  const handleEmailAuth = useCallback(async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setIsLoading(true);\r\n    setError(null);\r\n\r\n    console.log(`[DEBUG] ğŸ“§ ì´ë©”ì¼ ${authMode} ì‹œë„:`, { email, hasPassword: !!password });\r\n\r\n    try {\r\n      let userCredential;\r\n      \r\n      if (authMode === 'signup') {\r\n        userCredential = await createUserWithEmailAndPassword(auth, email, password);\r\n        \r\n        // íšŒì›ê°€ì… ì‹œ displayName ì„¤ì •\r\n        if (displayName && userCredential.user) {\r\n          await updateProfile(userCredential.user, {\r\n            displayName: displayName\r\n          });\r\n          console.log('[DEBUG] âœ… í”„ë¡œí•„ ì—…ë°ì´íŠ¸ ì™„ë£Œ:', displayName);\r\n        }\r\n      } else {\r\n        userCredential = await signInWithEmailAndPassword(auth, email, password);\r\n      }\r\n\r\n      console.log('[DEBUG] âœ… ì´ë©”ì¼ ì¸ì¦ ì„±ê³µ:', userCredential.user.uid);\r\n      onAuthSuccess(userCredential.user);\r\n      onClose();\r\n    } catch (error: any) {\r\n      console.error('[DEBUG] âŒ ì´ë©”ì¼ ì¸ì¦ ì‹¤íŒ¨:', error);\r\n      setError(getAuthErrorMessage(error));\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, [authMode, email, password, displayName, onAuthSuccess, onClose, getAuthErrorMessage]);\r\n\r\n  const handleGoogleAuth = useCallback(async () => {\r\n    setIsLoading(true);\r\n    setError(null);\r\n    \r\n    console.log('[DEBUG] ğŸ” êµ¬ê¸€ ë¡œê·¸ì¸ ì‹œë„');\r\n\r\n    try {\r\n      const provider = new GoogleAuthProvider();\r\n      const userCredential = await signInWithPopup(auth, provider);\r\n      \r\n      console.log('[DEBUG] âœ… êµ¬ê¸€ ë¡œê·¸ì¸ ì„±ê³µ:', userCredential.user.uid);\r\n      onAuthSuccess(userCredential.user);\r\n      onClose();\r\n    } catch (error: any) {\r\n      console.error('[DEBUG] âŒ êµ¬ê¸€ ë¡œê·¸ì¸ ì‹¤íŒ¨:', error);\r\n      setError(getAuthErrorMessage(error));\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, [onAuthSuccess, onClose, getAuthErrorMessage]);\r\n\r\n  const handleAnonymousAuth = useCallback(async () => {\r\n    setIsLoading(true);\r\n    setError(null);\r\n    \r\n    console.log('[DEBUG] ğŸ‘¤ ìµëª… ë¡œê·¸ì¸ ì‹œë„');\r\n\r\n    try {\r\n      // ğŸ¯ ëª¨ë“ˆí™”: Firebase ì˜ì¡´ì„±ì„ ë™ì ìœ¼ë¡œ ë¡œë“œ \r\n      const auth = await getAuthService();\r\n      const { signInAnonymously } = await import('firebase/auth');\r\n      \r\n      const userCredential = await signInAnonymously(auth);\r\n      \r\n      console.log('[DEBUG] âœ… ìµëª… ë¡œê·¸ì¸ ì„±ê³µ:', userCredential.user.uid);\r\n      onAuthSuccess(userCredential.user);\r\n      onClose();\r\n    } catch (error: any) {\r\n      console.error('[DEBUG] âŒ ìµëª… ë¡œê·¸ì¸ ì‹¤íŒ¨:', error);\r\n      setError(getAuthErrorMessage(error));\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, [onAuthSuccess, onClose, getAuthErrorMessage]);\r\n\r\n  const handleModeToggle = useCallback(() => {\r\n    setAuthMode(authMode === 'login' ? 'signup' : 'login');\r\n    setError(null);\r\n  }, [authMode]);\r\n\r\n  const modalTitle = useMemo(() => {\r\n    return authMode === 'login' ? 'ë¡œê·¸ì¸' : 'íšŒì›ê°€ì…';\r\n  }, [authMode]);\r\n\r\n  const submitButtonText = useMemo(() => {\r\n    if (isLoading) return 'ì²˜ë¦¬ ì¤‘...';\r\n    return authMode === 'login' ? 'ë¡œê·¸ì¸' : 'íšŒì›ê°€ì…';\r\n  }, [isLoading, authMode]);\r\n\r\n  const toggleButtonText = useMemo(() => {\r\n    return authMode === 'login' ? 'ê³„ì •ì´ ì—†ìœ¼ì‹ ê°€ìš”? íšŒì›ê°€ì…' : 'ì´ë¯¸ ê³„ì •ì´ ìˆìœ¼ì‹ ê°€ìš”? ë¡œê·¸ì¸';\r\n  }, [authMode]);\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg p-8 max-w-md w-full mx-4 transition-colors duration-300\">\r\n        <div className=\"flex justify-between items-center mb-6\">\r\n          <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white\">\r\n            {modalTitle}\r\n          </h2>\r\n          <button\r\n            onClick={onClose}\r\n            className=\"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 transition-colors duration-200\"\r\n            aria-label=\"ë‹«ê¸°\"\r\n          >\r\n            âœ•\r\n          </button>\r\n        </div>\r\n\r\n        {error && (\r\n          <div className=\"mb-4 p-3 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-600 text-red-700 dark:text-red-200 rounded\">\r\n            {error}\r\n          </div>\r\n        )}\r\n\r\n        {/* ì´ë©”ì¼/ë¹„ë°€ë²ˆí˜¸ ë¡œê·¸ì¸ */}\r\n        <form onSubmit={handleEmailAuth} className=\"space-y-4\">\r\n          {authMode === 'signup' && (\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                ë‹‰ë„¤ì„ (ì„ íƒì‚¬í•­)\r\n              </label>\r\n              <input\r\n                type=\"text\"\r\n                value={displayName}\r\n                onChange={(e) => setDisplayName(e.target.value)}\r\n                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 bg-white dark:bg-gray-700 text-gray-900 dark:text-white transition-colors duration-200\"\r\n                placeholder=\"í‘œì‹œë  ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”\"\r\n              />\r\n            </div>\r\n          )}\r\n          \r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n              ì´ë©”ì¼\r\n            </label>\r\n            <input\r\n              type=\"email\"\r\n              required\r\n              value={email}\r\n              onChange={(e) => setEmail(e.target.value)}\r\n              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 bg-white dark:bg-gray-700 text-gray-900 dark:text-white transition-colors duration-200\"\r\n              placeholder=\"ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”\"\r\n            />\r\n          </div>\r\n          \r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n              ë¹„ë°€ë²ˆí˜¸\r\n            </label>\r\n            <input\r\n              type=\"password\"\r\n              required\r\n              minLength={6}\r\n              value={password}\r\n              onChange={(e) => setPassword(e.target.value)}\r\n              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 bg-white dark:bg-gray-700 text-gray-900 dark:text-white transition-colors duration-200\"\r\n              placeholder=\"ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”\"\r\n            />\r\n          </div>\r\n          \r\n          <button\r\n            type=\"submit\"\r\n            disabled={isLoading}\r\n            className=\"w-full bg-blue-500 dark:bg-blue-600 hover:bg-blue-600 dark:hover:bg-blue-700 disabled:bg-gray-300 dark:disabled:bg-gray-600 text-white font-bold py-2 px-4 rounded-md transition-colors duration-200\"\r\n          >\r\n            {submitButtonText}\r\n          </button>\r\n        </form>\r\n\r\n        {/* êµ¬ë¶„ì„  */}\r\n        <div className=\"my-6 flex items-center\">\r\n          <div className=\"flex-grow border-t border-gray-300 dark:border-gray-600\"></div>\r\n          <span className=\"mx-4 text-gray-500 dark:text-gray-400 text-sm\">ë˜ëŠ”</span>\r\n          <div className=\"flex-grow border-t border-gray-300 dark:border-gray-600\"></div>\r\n        </div>\r\n\r\n        {/* ì†Œì…œ ë¡œê·¸ì¸ */}\r\n        <div className=\"space-y-3\">\r\n          <button\r\n            onClick={handleGoogleAuth}\r\n            disabled={isLoading}\r\n            className=\"w-full bg-red-500 dark:bg-red-600 hover:bg-red-600 dark:hover:bg-red-700 disabled:bg-gray-300 dark:disabled:bg-gray-600 text-white font-bold py-2 px-4 rounded-md transition-colors duration-200 flex items-center justify-center space-x-2\"\r\n          >\r\n            <span>ğŸ”</span>\r\n            <span>êµ¬ê¸€ ë¡œê·¸ì¸</span>\r\n          </button>\r\n          \r\n          <button\r\n            onClick={handleAnonymousAuth}\r\n            disabled={isLoading}\r\n            className=\"w-full bg-gray-500 dark:bg-gray-600 hover:bg-gray-600 dark:hover:bg-gray-700 disabled:bg-gray-300 dark:disabled:bg-gray-700 text-white font-bold py-2 px-4 rounded-md transition-colors duration-200 flex items-center justify-center space-x-2\"\r\n          >\r\n            <span>ğŸ‘¤</span>\r\n            <span>ì²´í—˜í•˜ê¸° (ìµëª…)</span>\r\n          </button>\r\n        </div>\r\n\r\n        {/* ëª¨ë“œ ì „í™˜ */}\r\n        <div className=\"mt-6 text-center\">\r\n          <button\r\n            onClick={handleModeToggle}\r\n            className=\"text-blue-500 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 text-sm transition-colors duration-200\"\r\n          >\r\n            {toggleButtonText}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n});\r\n\r\nexport default AuthModal;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\AutoSpeakingFlow.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'flowState' and 'startAutomaticFlow'. Either include them or remove the dependency array.","line":83,"column":6,"nodeType":"ArrayExpression","endLine":83,"endColumn":29,"suggestions":[{"desc":"Update the dependencies array to be: [currentCard, flowState, isActive, startAutomaticFlow]","fix":{"range":[2514,2537],"text":"[currentCard, flowState, isActive, startAutomaticFlow]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'speech.confidence'. Either include it or remove the dependency array.","line":174,"column":6,"nodeType":"ArrayExpression","endLine":174,"endColumn":76,"suggestions":[{"desc":"Update the dependencies array to be: [speech.transcript, flowState, countdown, autoTimeout, onSpeechResult, speech.confidence]","fix":{"range":[4850,4920],"text":"[speech.transcript, flowState, countdown, autoTimeout, onSpeechResult, speech.confidence]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect, useState } from 'react';\r\nimport { useSpeech } from '@/hooks/useSpeech';\r\nimport { useCountdown } from '@/hooks/useCountdown';\r\n\r\ninterface AutoSpeakingFlowProps {\r\n  currentCard: any;\r\n  onSpeechResult: (transcript: string, confidence: number) => void;\r\n  onTimeout?: () => void;\r\n  isActive: boolean;\r\n}\r\n\r\nexport const AutoSpeakingFlow: React.FC<AutoSpeakingFlowProps> = ({\r\n  currentCard,\r\n  onSpeechResult,\r\n  onTimeout,\r\n  isActive\r\n}) => {\r\n  const [flowState, setFlowState] = useState<'idle' | 'tts' | 'beep' | 'recording' | 'processing'>('idle');\r\n  const [autoTimeout, setAutoTimeout] = useState<NodeJS.Timeout | null>(null);\r\n  const [isPaused, setIsPaused] = useState<boolean>(false);\r\n  \r\n  const countdown = useCountdown(() => {\r\n    console.log('[AutoSpeakingFlow] Timer completed, handling timeout');\r\n    handleTimeoutComplete();\r\n  });\r\n  \r\n  // ì‹œê°„ ì´ˆê³¼ ì²˜ë¦¬ í•¨ìˆ˜\r\n  const handleTimeoutComplete = async () => {\r\n    try {\r\n      // í˜„ì¬ ë…¹ìŒ ì¤‘ì§€\r\n      if (speech.isRecording) {\r\n        speech.stopRecording();\r\n      }\r\n      \r\n      // ìƒíƒœë¥¼ processingìœ¼ë¡œ ë³€ê²½\r\n      setFlowState('processing');\r\n      setIsPaused(false);\r\n      \r\n      // ì •ë‹µ TTS ì¬ìƒ (1.5ì´ˆ í›„)\r\n      if (currentCard?.target_en) {\r\n        setTimeout(async () => {\r\n          try {\r\n            console.log('[AutoSpeakingFlow] Playing answer TTS:', currentCard.target_en);\r\n            await speech.speak(currentCard.target_en, { lang: 'en-US' });\r\n            \r\n            // TTS ì™„ë£Œ í›„ ì½œë°± í˜¸ì¶œ\r\n            setTimeout(() => {\r\n              console.log('[AutoSpeakingFlow] Timeout processing complete');\r\n              setFlowState('idle');\r\n              onTimeout?.();\r\n            }, 1000);\r\n          } catch (error) {\r\n            console.error('[AutoSpeakingFlow] Error playing answer TTS:', error);\r\n            setFlowState('idle');\r\n            onTimeout?.();\r\n          }\r\n        }, 1500);\r\n      } else {\r\n        // ì •ë‹µì´ ì—†ìœ¼ë©´ ë°”ë¡œ ë‹¤ìŒìœ¼ë¡œ\r\n        setTimeout(() => {\r\n          setFlowState('idle');\r\n          onTimeout?.();\r\n        }, 1500);\r\n      }\r\n    } catch (error) {\r\n      console.error('[AutoSpeakingFlow] Error in timeout handling:', error);\r\n      setFlowState('idle');\r\n      onTimeout?.();\r\n    }\r\n  };\r\n\r\n  const speech = useSpeech({\r\n    apiBaseUrl: import.meta.env.VITE_API_BASE_URL,\r\n    preferCloudSTT: false,\r\n    language: 'en-US',\r\n  });\r\n\r\n  // ì¹´ë“œ ë³€ê²½ ì‹œ ìë™ í”Œë¡œìš° ì‹œì‘\r\n  useEffect(() => {\r\n    if (currentCard && isActive && flowState === 'idle') {\r\n      startAutomaticFlow();\r\n    }\r\n  }, [currentCard, isActive]);\r\n\r\n  // ì»´í¬ë„ŒíŠ¸ ì–¸ë§ˆìš´íŠ¸ ì‹œ ì •ë¦¬\r\n  useEffect(() => {\r\n    return () => {\r\n      countdown.stop();\r\n      if (autoTimeout) clearTimeout(autoTimeout);\r\n      speech.stopAll();\r\n    };\r\n  }, [countdown, autoTimeout, speech]);\r\n\r\n  const startAutomaticFlow = async () => {\r\n    if (!currentCard) return;\r\n    \r\n    console.log('ğŸ¤ ìë™ Speaking í”Œë¡œìš° ì‹œì‘');\r\n    setFlowState('tts');\r\n    \r\n    // 1. í•œêµ­ì–´ TTS ì¬ìƒ\r\n    if (speech.isTTSAvailable) {\r\n      await speech.speak(currentCard.front_ko, 'ko-KR');\r\n      \r\n      // TTS ì™„ë£Œ í›„ 1ì´ˆ ëŒ€ê¸°\r\n      setTimeout(() => {\r\n        playBeepAndStartRecording();\r\n      }, 1000);\r\n    } else {\r\n      // TTSê°€ ì—†ìœ¼ë©´ ë°”ë¡œ ë…¹ìŒ ì‹œì‘\r\n      setTimeout(() => {\r\n        playBeepAndStartRecording();\r\n      }, 2000);\r\n    }\r\n  };\r\n\r\n  const playBeepAndStartRecording = () => {\r\n    console.log('ğŸ”” ë¹„í”„ìŒ ì¬ìƒ ë° ë…¹ìŒ ì‹œì‘');\r\n    setFlowState('beep');\r\n    \r\n    // ë¹„í”„ìŒ ì¬ìƒ\r\n    playBeep();\r\n    \r\n    // ë¹„í”„ìŒ í›„ 500ms ëŒ€ê¸° í›„ ë…¹ìŒ ì‹œì‘\r\n    setTimeout(() => {\r\n      if (!isPaused) {\r\n        setFlowState('recording');\r\n        speech.startRecording();\r\n        \r\n        // 10ì´ˆ ì¹´ìš´íŠ¸ë‹¤ìš´ ì‹œì‘\r\n        countdown.start(10);\r\n      }\r\n    }, 500);\r\n  };\r\n\r\n  const playBeep = () => {\r\n    // Web Audio APIë¡œ ë¹„í”„ìŒ ìƒì„±\r\n    try {\r\n      const audioContext = new (window.AudioContext || (window as any).webkitAudioContext)();\r\n      const oscillator = audioContext.createOscillator();\r\n      const gainNode = audioContext.createGain();\r\n      \r\n      oscillator.connect(gainNode);\r\n      gainNode.connect(audioContext.destination);\r\n      \r\n      oscillator.frequency.setValueAtTime(800, audioContext.currentTime);\r\n      oscillator.type = 'sine';\r\n      gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);\r\n      \r\n      oscillator.start();\r\n      oscillator.stop(audioContext.currentTime + 0.2);\r\n    } catch (error) {\r\n      console.error('ë¹„í”„ìŒ ì¬ìƒ ì‹¤íŒ¨:', error);\r\n    }\r\n  };\r\n\r\n  // ìŒì„± ì¸ì‹ ê²°ê³¼ ì²˜ë¦¬\r\n  useEffect(() => {\r\n    if (speech.transcript && flowState === 'recording') {\r\n      setFlowState('processing');\r\n      \r\n      // íƒ€ì´ë¨¸ ì •ë¦¬\r\n      countdown.stop();\r\n      if (autoTimeout) {\r\n        clearTimeout(autoTimeout);\r\n        setAutoTimeout(null);\r\n      }\r\n      \r\n      // ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ë¡œ ê²°ê³¼ ì „ë‹¬\r\n      onSpeechResult(speech.transcript, speech.confidence);\r\n      \r\n      // ìƒíƒœ ì´ˆê¸°í™”\r\n      setFlowState('idle');\r\n    }\r\n  }, [speech.transcript, flowState, countdown, autoTimeout, onSpeechResult]);\r\n\r\n  const getStatusMessage = () => {\r\n    switch (flowState) {\r\n      case 'tts':\r\n        return 'ğŸ”Š ë¬¸ì œë¥¼ ë“¤ë ¤ë“œë¦¬ê³  ìˆìŠµë‹ˆë‹¤...';\r\n      case 'beep':\r\n        return 'ğŸ”” ê³§ ë…¹ìŒì´ ì‹œì‘ë©ë‹ˆë‹¤...';\r\n      case 'recording':\r\n        const remainingSeconds = Math.ceil(countdown.remaining);\r\n        return countdown.isPaused ? `â¸ï¸ ì¼ì‹œì •ì§€ë¨ (ë‚¨ì€ ì‹œê°„: ${remainingSeconds}ì´ˆ)` : `ğŸ¤ ë§ì”€í•´ ì£¼ì„¸ìš”... (ë‚¨ì€ ì‹œê°„: ${remainingSeconds}ì´ˆ)`;\r\n      case 'processing':\r\n        return 'ğŸ¤– ë‹µë³€ì„ ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤...';\r\n      default:\r\n        return '';\r\n    }\r\n  };\r\n\r\n  const getProgressWidth = () => {\r\n    if (flowState === 'recording') {\r\n      const elapsed = 10 - countdown.remaining;\r\n      return `${Math.min((elapsed / 10) * 100, 100)}%`;\r\n    }\r\n    return '0%';\r\n  };\r\n\r\n  // ì¼ì‹œì •ì§€/ì¬ê°œ ì œì–´\r\n  const handlePauseResume = () => {\r\n    console.log(`[AutoSpeakingFlow] ${countdown.isPaused || isPaused ? 'Resume' : 'Pause'} requested, flowState: ${flowState}`);\r\n    \r\n    if (countdown.isPaused || isPaused) {\r\n      // ì¬ê°œ\r\n      if (flowState === 'tts' && speech.isTTSPaused()) {\r\n        console.log('[AutoSpeakingFlow] Resuming TTS');\r\n        speech.resumeTTS();\r\n      } else if (flowState === 'recording') {\r\n        console.log('[AutoSpeakingFlow] Resuming countdown');\r\n        countdown.resume();\r\n      }\r\n      setIsPaused(false);\r\n    } else {\r\n      // ì¼ì‹œì •ì§€\r\n      if (flowState === 'tts' && speech.isTTSSpeaking()) {\r\n        console.log('[AutoSpeakingFlow] Pausing TTS');\r\n        speech.pauseTTS();\r\n      } else if (flowState === 'recording') {\r\n        console.log('[AutoSpeakingFlow] Pausing countdown');\r\n        countdown.pause();\r\n      } else if (flowState === 'beep') {\r\n        console.log('[AutoSpeakingFlow] Stopping beep');\r\n        speech.stopBeep();\r\n      }\r\n      setIsPaused(true);\r\n    }\r\n  };\r\n\r\n  // ì™„ì „ ì¤‘ì§€\r\n  const handleStop = () => {\r\n    setFlowState('idle');\r\n    setIsPaused(false);\r\n    countdown.stop();\r\n    speech.stopAll();\r\n    if (autoTimeout) {\r\n      clearTimeout(autoTimeout);\r\n      setAutoTimeout(null);\r\n    }\r\n  };\r\n\r\n  if (!isActive || flowState === 'idle') {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-6 mb-6\">\r\n      <div className=\"text-center\">\r\n        <div className=\"text-lg font-semibold text-blue-800 mb-4\">\r\n          {getStatusMessage()}\r\n        </div>\r\n        \r\n        {flowState === 'recording' && (\r\n          <>\r\n            {/* ì§„í–‰ ë°” */}\r\n            <div className=\"w-full bg-blue-200 rounded-full h-2 mb-4\">\r\n              <div \r\n                className=\"bg-blue-600 h-2 rounded-full transition-all duration-100\"\r\n                style={{ width: getProgressWidth() }}\r\n              />\r\n            </div>\r\n            \r\n            {/* ë…¹ìŒ í‘œì‹œê¸° */}\r\n            <div className=\"flex items-center justify-center space-x-3\">\r\n              <div className={`w-3 h-3 rounded-full ${countdown.isPaused ? 'bg-yellow-500' : 'bg-red-500 animate-pulse'}`}></div>\r\n              <span className=\"text-sm text-blue-700\">\r\n                {countdown.isPaused ? 'ì¼ì‹œì •ì§€ë¨' : 'ìŒì„±ì„ ì¸ì‹í•˜ê³  ìˆìŠµë‹ˆë‹¤...'} (ë‚¨ì€ ì‹œê°„: {Math.ceil(countdown.remaining)}ì´ˆ)\r\n              </span>\r\n            </div>\r\n            \r\n            {/* ì œì–´ ë²„íŠ¼ */}\r\n            <div className=\"flex justify-center space-x-3 mt-4\">\r\n              <button\r\n                onClick={handlePauseResume}\r\n                className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium\"\r\n              >\r\n                {countdown.isPaused ? 'â–¶ï¸ ì¬ê°œ' : 'â¸ï¸ ì¼ì‹œì •ì§€'}\r\n              </button>\r\n              <button\r\n                onClick={handleStop}\r\n                className=\"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm font-medium\"\r\n              >\r\n                â¹ï¸ ì¤‘ì§€\r\n              </button>\r\n            </div>\r\n          </>\r\n        )}\r\n        \r\n        {flowState === 'tts' && (\r\n          <>\r\n            <div className=\"flex items-center justify-center space-x-3\">\r\n              <div className={`w-3 h-3 rounded-full ${speech.isTTSPaused() ? 'bg-yellow-500' : 'bg-green-500 animate-pulse'}`}></div>\r\n              <span className=\"text-sm text-blue-700\">\r\n                {speech.isTTSPaused() ? 'ìŒì„± ì¬ìƒ ì¼ì‹œì •ì§€ë¨' : 'í•œêµ­ì–´ ë¬¸ì œë¥¼ ì¬ìƒ ì¤‘...'}\r\n              </span>\r\n            </div>\r\n            \r\n            {/* TTS ì œì–´ ë²„íŠ¼ */}\r\n            <div className=\"flex justify-center space-x-3 mt-4\">\r\n              <button\r\n                onClick={handlePauseResume}\r\n                className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium\"\r\n              >\r\n                {speech.isTTSPaused() ? 'â–¶ï¸ ì¬ê°œ' : 'â¸ï¸ ì¼ì‹œì •ì§€'}\r\n              </button>\r\n              <button\r\n                onClick={handleStop}\r\n                className=\"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm font-medium\"\r\n              >\r\n                â¹ï¸ ì¤‘ì§€\r\n              </button>\r\n            </div>\r\n          </>\r\n        )}\r\n        \r\n        {flowState === 'beep' && (\r\n          <>\r\n            <div className=\"flex items-center justify-center space-x-3\">\r\n              <div className=\"w-3 h-3 bg-yellow-500 rounded-full animate-pulse\"></div>\r\n              <span className=\"text-sm text-blue-700\">ì‹ í˜¸ìŒ í›„ ë§ì”€í•´ ì£¼ì„¸ìš”</span>\r\n            </div>\r\n            \r\n            {/* ë¹„í”„ìŒ ì¤‘ì§€ ë²„íŠ¼ */}\r\n            <div className=\"flex justify-center space-x-3 mt-4\">\r\n              <button\r\n                onClick={handleStop}\r\n                className=\"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm font-medium\"\r\n              >\r\n                â¹ï¸ ì¤‘ì§€\r\n              </button>\r\n            </div>\r\n          </>\r\n        )}\r\n        \r\n        {flowState === 'processing' && (\r\n          <div className=\"flex items-center justify-center space-x-3\">\r\n            <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600\"></div>\r\n            <span className=\"text-sm text-blue-700\">ë‹µë³€ ë¶„ì„ ì¤‘...</span>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\AutoSpeakingFlowV2.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\ControlPanel.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\CurriculumLint.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\CurriculumSmokeTest.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\CustomFeedbackPanel.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\ErrorBoundary.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":160,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":160,"endColumn":34}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { Component, ReactNode, ErrorInfo } from 'react';\n\ninterface ErrorBoundaryState {\n  hasError: boolean;\n  error?: Error;\n  errorInfo?: ErrorInfo;\n  retryCount: number;\n  isRetrying: boolean;\n}\n\ninterface ErrorBoundaryProps {\n  children: ReactNode;\n  fallback?: ReactNode;\n  onError?: (error: Error, errorInfo: ErrorInfo) => void;\n  maxRetries?: number;\n  resetOnPropsChange?: boolean;\n  resetKeys?: Array<string | number>;\n  level?: 'page' | 'section' | 'component';\n}\n\n/**\n * ErrorBoundary component to catch and handle React component errors\n * Prevents the entire application from crashing when a component error occurs\n */\nexport class ErrorBoundary extends Component<ErrorBoundaryProps, ErrorBoundaryState> {\n  constructor(props: ErrorBoundaryProps) {\n    super(props);\n    this.state = { \n      hasError: false, \n      retryCount: 0,\n      isRetrying: false \n    };\n  }\n\n  /**\n   * Static method to update state when an error is caught\n   * @param error - The error that was thrown\n   * @returns Updated state object\n   */\n  static getDerivedStateFromError(error: Error): ErrorBoundaryState {\n    // Update state so the next render will show the fallback UI\n    return { hasError: true, error };\n  }\n\n  /**\n   * Component lifecycle method called when an error is caught\n   * @param error - The error that was thrown\n   * @param errorInfo - Additional information about the error\n   */\n  componentDidCatch(error: Error, errorInfo: ErrorInfo) {\n    // Enhanced logging for learning flow debugging\n    console.error('[DEBUG] âŒ ErrorBoundary ì—ëŸ¬ í¬ì°©:', {\n      error: {\n        name: error.name,\n        message: error.message,\n        stack: error.stack\n      },\n      errorInfo: {\n        componentStack: errorInfo.componentStack\n      },\n      level: this.props.level || 'component',\n      timestamp: new Date().toISOString(),\n      url: window.location.href,\n      userAgent: navigator.userAgent\n    });\n    \n    // Update state with error details\n    this.setState({\n      error,\n      errorInfo\n    });\n\n    // Call optional error handler\n    if (this.props.onError) {\n      this.props.onError(error, errorInfo);\n    }\n  }\n\n  /**\n   * Reset the error boundary state\n   */\n  resetError = () => {\n    this.setState({ hasError: false, error: undefined, errorInfo: undefined });\n  };\n\n  render() {\n    if (this.state.hasError) {\n      // Custom fallback UI\n      if (this.props.fallback) {\n        return this.props.fallback;\n      }\n\n      // Default fallback UI\n      return (\n        <div className=\"error-boundary-container p-6 bg-red-50 border border-red-200 rounded-lg m-4\">\n          <div className=\"text-center\">\n            <div className=\"text-red-600 mb-4\">\n              <svg className=\"w-16 h-16 mx-auto mb-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z\" />\n              </svg>\n            </div>\n            \n            <h2 className=\"text-xl font-bold text-red-800 mb-2\">\n              ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤\n            </h2>\n            \n            <p className=\"text-red-600 mb-4\">\n              ì´ êµ¬ì„± ìš”ì†Œì—ì„œ ì˜ˆìƒì¹˜ ëª»í•œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\n            </p>\n\n            <button\n              onClick={this.resetError}\n              className=\"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors mb-4\"\n            >\n              ë‹¤ì‹œ ì‹œë„\n            </button>\n\n            {/* Show error details in development */}\n            {process.env.NODE_ENV === 'development' && this.state.error && (\n              <details className=\"text-left bg-red-100 p-4 rounded border mt-4\">\n                <summary className=\"cursor-pointer font-medium text-red-800 mb-2\">\n                  ì˜¤ë¥˜ ì„¸ë¶€ì •ë³´ (ê°œë°œ ëª¨ë“œ)\n                </summary>\n                <div className=\"text-sm text-red-700 space-y-2\">\n                  <div>\n                    <strong>Error:</strong> {this.state.error.message}\n                  </div>\n                  <div>\n                    <strong>Stack:</strong>\n                    <pre className=\"whitespace-pre-wrap text-xs mt-1 bg-red-50 p-2 rounded\">\n                      {this.state.error.stack}\n                    </pre>\n                  </div>\n                  {this.state.errorInfo && (\n                    <div>\n                      <strong>Component Stack:</strong>\n                      <pre className=\"whitespace-pre-wrap text-xs mt-1 bg-red-50 p-2 rounded\">\n                        {this.state.errorInfo.componentStack}\n                      </pre>\n                    </div>\n                  )}\n                </div>\n              </details>\n            )}\n          </div>\n        </div>\n      );\n    }\n\n    return this.props.children;\n  }\n}\n\n/**\n * Higher-order component wrapper for functional components\n * @param Component - The component to wrap with error boundary\n * @param errorBoundaryProps - Props to pass to the ErrorBoundary\n * @returns Wrapped component with error boundary\n */\nexport function withErrorBoundary<P extends object>(\n  Component: React.ComponentType<P>,\n  errorBoundaryProps?: Omit<ErrorBoundaryProps, 'children'>\n) {\n  const WrappedComponent = (props: P) => (\n    <ErrorBoundary {...errorBoundaryProps}>\n      <Component {...props} />\n    </ErrorBoundary>\n  );\n\n  WrappedComponent.displayName = `withErrorBoundary(${Component.displayName || Component.name})`;\n  \n  return WrappedComponent;\n}\n\nexport default ErrorBoundary;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\ExplanationModeSession.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'proceedToNext'. Either include it or remove the dependency array.","line":71,"column":6,"nodeType":"ArrayExpression","endLine":71,"endColumn":102,"suggestions":[{"desc":"Update the dependencies array to be: [session, isAnswering, currentQuestionIndex, userAnswer, settings.showDetailedFeedback, proceedToNext]","fix":{"range":[2168,2264],"text":"[session, isAnswering, currentQuestionIndex, userAnswer, settings.showDetailedFeedback, proceedToNext]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'completeSession'. Either include it or remove the dependency array.","line":86,"column":6,"nodeType":"ArrayExpression","endLine":86,"endColumn":37,"suggestions":[{"desc":"Update the dependencies array to be: [session, currentQuestionIndex, completeSession]","fix":{"range":[2646,2677],"text":"[session, currentQuestionIndex, completeSession]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, memo, useCallback } from 'react';\r\nimport { speedDifficultyService, type SpeedSession, type ExplanationModeSettings } from '@/services/speedDifficultyModes';\r\n\r\ninterface ExplanationModeSessionProps {\r\n  userId: string;\r\n  settings: ExplanationModeSettings;\r\n  questionCount: number;\r\n  onComplete: (results: any) => void;\r\n  onExit: () => void;\r\n}\r\n\r\nexport const ExplanationModeSession: React.FC<ExplanationModeSessionProps> = memo(({\r\n  userId,\r\n  settings,\r\n  questionCount,\r\n  onComplete,\r\n  onExit\r\n}) => {\r\n  const [session, setSession] = useState<SpeedSession | null>(null);\r\n  const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);\r\n  const [userAnswer, setUserAnswer] = useState('');\r\n  const [results, setResults] = useState<any[]>([]);\r\n  const [showExplanation, setShowExplanation] = useState(false);\r\n  const [currentResult, setCurrentResult] = useState<any>(null);\r\n  const [isAnswering, setIsAnswering] = useState(true);\r\n\r\n  // ì„¸ì…˜ ì´ˆê¸°í™”\r\n  useEffect(() => {\r\n    const initSession = async () => {\r\n      try {\r\n        const newSession = await speedDifficultyService.createExplanationSession(userId, settings, questionCount);\r\n        setSession(newSession);\r\n      } catch (error) {\r\n        console.error('í•´ì„¤ ëª¨ë“œ ì„¸ì…˜ ì´ˆê¸°í™” ì‹¤íŒ¨:', error);\r\n      }\r\n    };\r\n\r\n    initSession();\r\n  }, [userId, settings, questionCount]);\r\n\r\n  // ë‹µë³€ ì œì¶œ\r\n  const handleSubmit = useCallback(async () => {\r\n    if (!session || !isAnswering) return;\r\n\r\n    setIsAnswering(false);\r\n    \r\n    try {\r\n      const currentQuestion = session.questions[currentQuestionIndex];\r\n      const responseTime = 5000; // í•´ì„¤ ëª¨ë“œëŠ” ì‹œê°„ ì œí•œ ì—†ìŒ\r\n      \r\n      const result = await speedDifficultyService.processAnswer(\r\n        session.sessionId,\r\n        currentQuestion.questionId,\r\n        userAnswer,\r\n        responseTime\r\n      );\r\n\r\n      setCurrentResult(result);\r\n      setResults(prev => [...prev, result]);\r\n      \r\n      // í•´ì„¤ í‘œì‹œ\r\n      if (settings.showDetailedFeedback) {\r\n        setShowExplanation(true);\r\n      } else {\r\n        proceedToNext();\r\n      }\r\n\r\n    } catch (error) {\r\n      console.error('ë‹µë³€ ì²˜ë¦¬ ì‹¤íŒ¨:', error);\r\n    }\r\n  }, [session, isAnswering, currentQuestionIndex, userAnswer, results, settings.showDetailedFeedback]);\r\n\r\n  // ë‹¤ìŒ ë¬¸ì œë¡œ ì§„í–‰\r\n  const proceedToNext = useCallback(() => {\r\n    if (!session) return;\r\n\r\n    if (currentQuestionIndex < session.questions.length - 1) {\r\n      setCurrentQuestionIndex(prev => prev + 1);\r\n      setUserAnswer('');\r\n      setShowExplanation(false);\r\n      setCurrentResult(null);\r\n      setIsAnswering(true);\r\n    } else {\r\n      completeSession();\r\n    }\r\n  }, [session, currentQuestionIndex]);\r\n\r\n  // ì„¸ì…˜ ì™„ë£Œ\r\n  const completeSession = useCallback(async () => {\r\n    if (!session) return;\r\n\r\n    try {\r\n      const finalResults = await speedDifficultyService.completeSession(session.sessionId);\r\n      onComplete(finalResults);\r\n    } catch (error) {\r\n      console.error('ì„¸ì…˜ ì™„ë£Œ ì‹¤íŒ¨:', error);\r\n    }\r\n  }, [session, onComplete]);\r\n\r\n  if (!session) {\r\n    return (\r\n      <div className=\"flex items-center justify-center min-h-screen\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-500 mx-auto mb-4\"></div>\r\n          <div className=\"text-gray-600\">í•´ì„¤ ëª¨ë“œë¥¼ ì¤€ë¹„í•˜ê³  ìˆìŠµë‹ˆë‹¤...</div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const currentQuestion = session.questions[currentQuestionIndex];\r\n  const progress = ((currentQuestionIndex + 1) / session.questions.length) * 100;\r\n\r\n  return (\r\n    <div className=\"max-w-4xl mx-auto p-6\">\r\n      {/* í—¤ë” */}\r\n      <div className=\"bg-white rounded-lg shadow-lg p-6 mb-6\">\r\n        <div className=\"flex items-center justify-between mb-4\">\r\n          <div>\r\n            <h1 className=\"text-2xl font-bold text-gray-900\">ğŸ“š í•´ì„¤ ëª¨ë“œ</h1>\r\n            <p className=\"text-gray-600\">\r\n              ë¬¸ì œ {currentQuestionIndex + 1} / {session.questions.length}\r\n            </p>\r\n          </div>\r\n          \r\n          <div className=\"text-center\">\r\n            <div className=\"text-sm text-gray-600\">ì§„í–‰ë¥ </div>\r\n            <div className=\"text-xl font-bold text-purple-600\">{Math.round(progress)}%</div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* ì§„í–‰ë¥  ë°” */}\r\n        <div className=\"w-full bg-gray-200 rounded-full h-2\">\r\n          <div \r\n            className=\"bg-purple-600 h-2 rounded-full transition-all duration-300\"\r\n            style={{ width: `${progress}%` }}\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      {!showExplanation ? (\r\n        /* ë¬¸ì œ í™”ë©´ */\r\n        <div className=\"bg-white rounded-lg shadow-lg p-8 mb-6\">\r\n          <div className=\"mb-6\">\r\n            <div className=\"flex items-center gap-2 mb-4\">\r\n              <span className=\"bg-purple-100 text-purple-800 text-xs font-medium px-2.5 py-0.5 rounded\">\r\n                Level {currentQuestion.level}\r\n              </span>\r\n              <span className={`text-xs font-medium px-2.5 py-0.5 rounded ${\r\n                currentQuestion.difficulty === 'easy' ? 'bg-green-100 text-green-800' :\r\n                currentQuestion.difficulty === 'medium' ? 'bg-yellow-100 text-yellow-800' :\r\n                'bg-red-100 text-red-800'\r\n              }`}>\r\n                {currentQuestion.difficulty}\r\n              </span>\r\n              {currentQuestion.tags.map(tag => (\r\n                <span key={tag} className=\"bg-gray-100 text-gray-700 text-xs px-2 py-1 rounded\">\r\n                  {tag}\r\n                </span>\r\n              ))}\r\n            </div>\r\n            \r\n            <h2 className=\"text-2xl font-semibold text-gray-900 mb-4\">\r\n              {currentQuestion.content}\r\n            </h2>\r\n            \r\n            <div className=\"text-sm text-gray-600 mb-4\">\r\n              ğŸ’¡ <strong>í•´ì„¤ ëª¨ë“œ:</strong> ì‹œê°„ ì œí•œì´ ì—†ìœ¼ë‹ˆ ì¶©ë¶„íˆ ìƒê°í•´ë³´ì„¸ìš”. \r\n              ë‹µë³€ í›„ ìƒì„¸í•œ ì„¤ëª…ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\r\n            </div>\r\n          </div>\r\n\r\n          {/* ë‹µë³€ ì…ë ¥ */}\r\n          <div className=\"space-y-4\">\r\n            <input\r\n              type=\"text\"\r\n              value={userAnswer}\r\n              onChange={(e) => setUserAnswer(e.target.value)}\r\n              onKeyPress={(e) => e.key === 'Enter' && isAnswering && userAnswer.trim() && handleSubmit()}\r\n              className=\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-lg\"\r\n              placeholder=\"ë‹µì„ ì…ë ¥í•˜ì„¸ìš”...\"\r\n              disabled={!isAnswering}\r\n              autoFocus\r\n            />\r\n            \r\n            <button\r\n              onClick={handleSubmit}\r\n              disabled={!isAnswering || !userAnswer.trim()}\r\n              className=\"w-full bg-purple-600 hover:bg-purple-700 disabled:bg-gray-400 text-white font-bold py-3 px-6 rounded-lg transition-colors text-lg\"\r\n            >\r\n              {isAnswering ? 'ë‹µë³€ ì œì¶œ ë° í•´ì„¤ ë³´ê¸°' : 'ì²˜ë¦¬ ì¤‘...'}\r\n            </button>\r\n          </div>\r\n        </div>\r\n      ) : (\r\n        /* í•´ì„¤ í™”ë©´ */\r\n        <div className=\"space-y-6\">\r\n          {/* ë‹µë³€ ê²°ê³¼ */}\r\n          <div className=\"bg-white rounded-lg shadow-lg p-6\">\r\n            <div className=\"flex items-center justify-between mb-4\">\r\n              <h3 className=\"text-xl font-semibold text-gray-900\">ğŸ“ ë‹µë³€ ê²°ê³¼</h3>\r\n              <div className={`px-3 py-1 rounded-full text-sm font-medium ${\r\n                currentResult?.isCorrect \r\n                  ? 'bg-green-100 text-green-800' \r\n                  : 'bg-red-100 text-red-800'\r\n              }`}>\r\n                {currentResult?.isCorrect ? 'âœ… ì •ë‹µ' : 'âŒ ì˜¤ë‹µ'}\r\n              </div>\r\n            </div>\r\n            \r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div>\r\n                <div className=\"text-sm text-gray-600 mb-1\">ë‚´ ë‹µë³€</div>\r\n                <div className=\"text-lg font-medium text-gray-900 bg-gray-50 p-3 rounded\">\r\n                  {currentResult?.userAnswer || '(ë‹µë³€ ì—†ìŒ)'}\r\n                </div>\r\n              </div>\r\n              <div>\r\n                <div className=\"text-sm text-gray-600 mb-1\">ì •ë‹µ</div>\r\n                <div className=\"text-lg font-medium text-green-700 bg-green-50 p-3 rounded\">\r\n                  {currentResult?.correctAnswer}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* ìƒì„¸ í•´ì„¤ */}\r\n          {settings.showDetailedFeedback && currentResult?.explanation && (\r\n            <div className=\"bg-white rounded-lg shadow-lg p-6\">\r\n              <h3 className=\"text-xl font-semibold text-gray-900 mb-4\">ğŸ¯ ìƒì„¸ í•´ì„¤</h3>\r\n              <div className=\"prose max-w-none\">\r\n                <div \r\n                  className=\"text-gray-700 leading-relaxed whitespace-pre-line\"\r\n                  dangerouslySetInnerHTML={{ \r\n                    __html: currentResult.explanation.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>')\r\n                      .replace(/`(.*?)`/g, '<code class=\"bg-gray-100 px-1 py-0.5 rounded text-sm\">$1</code>')\r\n                  }}\r\n                />\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* ë¬¸ë²• ë…¸íŠ¸ (ì„¤ì •ì— ë”°ë¼) */}\r\n          {settings.includeGrammarNotes && (\r\n            <div className=\"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-6\">\r\n              <h3 className=\"text-lg font-semibold text-blue-900 mb-3\">ğŸ“– ë¬¸ë²• ë…¸íŠ¸</h3>\r\n              <div className=\"space-y-3 text-blue-800\">\r\n                <div>\r\n                  <strong>í•µì‹¬ ë¬¸ë²•:</strong> {currentQuestion.tags.includes('grammar') ? 'ì¡°ê±´ë¬¸ (Conditional)' : 'ë¹„ì¦ˆë‹ˆìŠ¤ í‘œí˜„'}\r\n                </div>\r\n                <div>\r\n                  <strong>ë‚œì´ë„:</strong> {currentQuestion.difficulty} ìˆ˜ì¤€\r\n                </div>\r\n                <div>\r\n                  <strong>í•™ìŠµ íŒ:</strong> ì´ ìœ í˜•ì˜ ë¬¸ì œëŠ” ë°˜ë³µ í•™ìŠµì„ í†µí•´ íŒ¨í„´ì„ ìµíˆëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤.\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* ì˜ˆë¬¸ (ì„¤ì •ì— ë”°ë¼) */}\r\n          {settings.includeExamples && (\r\n            <div className=\"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-lg p-6\">\r\n              <h3 className=\"text-lg font-semibold text-green-900 mb-3\">ğŸ“š ì¶”ê°€ ì˜ˆë¬¸</h3>\r\n              <div className=\"space-y-2\">\r\n                <div className=\"text-green-800\">\r\n                  â€¢ If I had more time, I would learn Spanish.\r\n                </div>\r\n                <div className=\"text-green-800\">\r\n                  â€¢ If she had called earlier, we could have met.\r\n                </div>\r\n                <div className=\"text-green-800\">\r\n                  â€¢ If they had studied harder, they would have passed.\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* ë‹¤ìŒ ë²„íŠ¼ */}\r\n          <div className=\"flex justify-center\">\r\n            <button\r\n              onClick={proceedToNext}\r\n              className=\"bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-8 rounded-lg transition-colors text-lg\"\r\n            >\r\n              {currentQuestionIndex < session.questions.length - 1 ? 'ë‹¤ìŒ ë¬¸ì œë¡œ â†’' : 'í•´ì„¤ ëª¨ë“œ ì™„ë£Œí•˜ê¸°'}\r\n            </button>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* í•˜ë‹¨ ì»¨íŠ¸ë¡¤ */}\r\n      <div className=\"flex justify-between mt-6\">\r\n        <button\r\n          onClick={onExit}\r\n          className=\"bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded transition-colors\"\r\n        >\r\n          ë‚˜ê°€ê¸°\r\n        </button>\r\n        \r\n        {!showExplanation && (\r\n          <div className=\"text-sm text-gray-600 flex items-center\">\r\n            <span>Enter í‚¤ë¡œ ë‹µë³€ ì œì¶œ</span>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n});\r\n\r\nExplanationModeSession.displayName = 'ExplanationModeSession';","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\FeedbackPanel.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\LoadingOverlay.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\LoadingSkeleton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\MetricsDashboard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\MigrationDashboard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\MixedLevelSession.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\PatternTrainingFlowFinal.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The 'getCountdownTime' function makes the dependencies of useCallback Hook (at line 358) change on every render. Move it inside the useCallback callback. Alternatively, wrap the definition of 'getCountdownTime' in its own useCallback() Hook.","line":67,"column":9,"nodeType":"VariableDeclarator","endLine":73,"endColumn":4},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has missing dependencies: 'handleResult' and 'handleTimeout'. Either include them or remove the dependency array.","line":273,"column":6,"nodeType":"ArrayExpression","endLine":273,"endColumn":38,"suggestions":[{"desc":"Update the dependencies array to be: [flowState.isRecording, handleResult, handleTimeout, onError]","fix":{"range":[8750,8782],"text":"[flowState.isRecording, handleResult, handleTimeout, onError]"}}]}],"suppressedMessages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'startFlow'. Either include it or remove the dependency array.","line":369,"column":6,"nodeType":"ArrayExpression","endLine":369,"endColumn":53,"suggestions":[{"desc":"Update the dependencies array to be: [autoStartKey, autoStart, koreanText, disabled, startFlow]","fix":{"range":[11897,11944],"text":"[autoStartKey, autoStart, koreanText, disabled, startFlow]"}}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { useLocalStorage, STORAGE_KEYS } from '@/hooks/useLocalStorage';\nimport { getCountdownDuration, type SpeakingStage } from '@/utils/speakingStageUtils';\n\n// ğŸ”’ ëª¨ë“ˆ ìŠ¤ì½”í”„ ê°€ë“œ: StrictMode ì¬ë§ˆìš´íŠ¸ê¹Œì§€ ì°¨ë‹¨\nconst __autoStartGuards = new Set<string>();\nconst makeKey = (stage: number, ko: string, en: string) =>\n  `${stage}::${ko}::${en}`;\n\ninterface PatternTrainingFlowFinalProps {\n  koreanText: string;\n  expectedEnglish: string;\n  onResult: (userAnswer: string, isCorrect: boolean, confidence: number, responseTime: number) => void;\n  onError?: (error: string) => void;\n  stage: number;\n  disabled?: boolean;\n  autoStart?: boolean;\n  className?: string;\n  mistakeId?: string;\n  showCorrectAnswer?: boolean;\n}\n\ntype FlowPhase = 'idle' | 'tts' | 'countdown' | 'recognition' | 'completed';\n\nexport const PatternTrainingFlowFinal: React.FC<PatternTrainingFlowFinalProps> = ({\n  koreanText,\n  expectedEnglish,\n  onResult,\n  onError,\n  stage,\n  disabled = false,\n  autoStart = false,\n  className = '',\n  mistakeId: _mistakeId,\n  showCorrectAnswer = true\n}) => {\n  // Single state object to prevent re-render issues\n  const [flowState, setFlowState] = useState({\n    phase: 'idle' as FlowPhase,\n    countdownTimer: 0,\n    recognitionTimer: 0,\n    speechResult: '',\n    showAnswer: false,\n    isRecording: false,\n    ttsInitialized: false,\n    recognitionStartTime: 0,\n    hasStarted: false // Prevent duplicate starts\n  });\n  \n  // Voice settings\n  const { value: voiceSettings } = useLocalStorage(STORAGE_KEYS.VOICE_SETTINGS);\n  \n  // Auto-start í‚¤ ìƒì„±\n  const autoStartKey = makeKey(stage, koreanText || '', expectedEnglish || '');\n  \n  // Single ref for all cleanup\n  const flowRef = useRef({\n    recognition: null as any,\n    countdownInterval: null as NodeJS.Timeout | null,\n    recordingTimeout: null as NodeJS.Timeout | null,\n    timerInterval: null as NodeJS.Timeout | null,\n    hasReceivedResult: false,\n    isCleaningUp: false\n  });\n\n  // Get stage-based timing using utility function\n  const getCountdownTime = () => {\n    // ì •ê·œ ë‹¨ê³„ëŠ” ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ ì‚¬ìš©, ê¸°íƒ€ëŠ” ê¸°ë³¸ê°’ 2ì´ˆ\n    if (stage >= 1 && stage <= 3) {\n      return getCountdownDuration(stage as SpeakingStage);\n    }\n    return 2; // ê¸°ë³¸ê°’: 2ì´ˆ\n  };\n\n  // Force cleanup all timers and recognition\n  const forceCleanup = useCallback(() => {\n    if (flowRef.current.isCleaningUp) return;\n    flowRef.current.isCleaningUp = true;\n    \n    try {\n      // Clear all intervals and timeouts\n      if (flowRef.current.countdownInterval) {\n        clearInterval(flowRef.current.countdownInterval);\n        flowRef.current.countdownInterval = null;\n      }\n      if (flowRef.current.recordingTimeout) {\n        clearTimeout(flowRef.current.recordingTimeout);\n        flowRef.current.recordingTimeout = null;\n      }\n      if (flowRef.current.timerInterval) {\n        clearInterval(flowRef.current.timerInterval);\n        flowRef.current.timerInterval = null;\n      }\n      \n      // Stop speech recognition\n      if (flowRef.current.recognition && flowState.isRecording) {\n        flowRef.current.recognition.stop();\n      }\n      \n      // ğŸ”§ í”ŒëŸ¬ê·¸ì¸ì„ í†µí•œ TTS ì¤‘ì§€\n      try {\n        const ServiceContainer = (await import('@/container/ServiceContainer')).default;\n        const container = ServiceContainer.getInstanceSync();\n        const speechService = container.getSpeechProcessingService();\n        speechService.stopAllSpeech();\n      } catch (error) {\n        console.warn('Plugin TTS stop failed:', error);\n      }\n      \n      setFlowState(prev => ({ ...prev, isRecording: false }));\n    } catch (error) {\n      console.warn('Cleanup error:', error);\n    } finally {\n      flowRef.current.isCleaningUp = false;\n    }\n  }, [flowState.isRecording]);\n\n  // ğŸ”§ í”ŒëŸ¬ê·¸ì¸ ì‹œìŠ¤í…œì„ í†µí•œ TTS í•¨ìˆ˜\n  const speakText = useCallback(async (text: string, lang: 'ko' | 'en' = 'ko'): Promise<void> => {\n    try {\n      // Check voice settings\n      if (lang === 'ko' && !voiceSettings.koreanEnabled) {\n        return;\n      }\n      if (lang === 'en' && !voiceSettings.englishEnabled) {\n        return;\n      }\n\n      // ServiceContainerë¥¼ í†µí•´ speechService ì‚¬ìš©\n      const ServiceContainer = (await import('@/container/ServiceContainer')).default;\n      const container = ServiceContainer.getInstanceSync();\n      const speechService = container.getSpeechProcessingService();\n\n      // ê¸°ì¡´ TTS ì¤‘ì§€\n      speechService.stopAllSpeech();\n\n      // í”ŒëŸ¬ê·¸ì¸ì„ í†µí•´ TTS ì‹¤í–‰\n      await speechService.speakAnswer(text, {\n        language: lang === 'ko' ? 'ko-KR' : 'en-US',\n        rate: voiceSettings.speed,\n        volume: 1.0,\n        pitch: 1.0\n      });\n\n    } catch (error) {\n      console.error('[PatternTrainingFlowFinal] Speech service error:', error);\n\n      // ğŸ”§ í”ŒëŸ¬ê·¸ì¸ fallback: AdvancedSpeechPlugin ì‹œë„\n      try {\n        const ServiceContainer = (await import('@/container/ServiceContainer')).default;\n        const container = ServiceContainer.getInstanceSync();\n        const advancedPlugin = container.getAdvancedSpeechPlugin();\n\n        if (advancedPlugin) {\n          // ê¸°ì¡´ TTS ì¤‘ì§€\n          advancedPlugin.stopAll();\n\n          await advancedPlugin.speakText(text, {\n            language: lang === 'ko' ? 'ko-KR' : 'en-US',\n            rate: voiceSettings.speed,\n            volume: 1.0,\n            pitch: 1.0\n          });\n        } else {\n          console.warn('[PatternTrainingFlowFinal] No speech plugins available');\n        }\n      } catch (pluginError) {\n        console.error('[PatternTrainingFlowFinal] All speech plugins failed:', pluginError);\n      }\n    }\n  }, [voiceSettings]);\n\n  // Play beep sound\n  const playBeep = useCallback(() => {\n    try {\n      const AudioContext = window.AudioContext || (window as any).webkitAudioContext;\n      if (!AudioContext) return;\n      \n      const audioCtx = new AudioContext();\n      const oscillator = audioCtx.createOscillator();\n      const gainNode = audioCtx.createGain();\n      \n      oscillator.connect(gainNode);\n      gainNode.connect(audioCtx.destination);\n      \n      oscillator.frequency.setValueAtTime(800, audioCtx.currentTime);\n      gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);\n      gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.2);\n      \n      oscillator.start(audioCtx.currentTime);\n      oscillator.stop(audioCtx.currentTime + 0.2);\n    } catch (error) {\n      console.warn('Beep error:', error);\n    }\n  }, []);\n\n  // Start speech recognition\n  const startSpeechRecognition = useCallback(() => {\n    if (flowState.isRecording || flowRef.current.hasReceivedResult) {\n      console.log('ìŒì„±ì¸ì‹ ì¤‘ë³µ ì‹¤í–‰ ë°©ì§€');\n      return;\n    }\n\n    console.log('ğŸ¤ ìŒì„±ì¸ì‹ ì‹œì‘');\n    setFlowState(prev => ({ ...prev, phase: 'recognition', isRecording: true, recognitionStartTime: Date.now() }));\n\n    if (!('webkitSpeechRecognition' in window)) {\n      onError?.('ìŒì„± ì¸ì‹ì„ ì§€ì›í•˜ì§€ ì•ŠëŠ” ë¸Œë¼ìš°ì €ì…ë‹ˆë‹¤.');\n      return;\n    }\n\n    const SpeechRecognition = (window as any).webkitSpeechRecognition;\n    const recognition = new SpeechRecognition();\n    \n    recognition.continuous = false;\n    recognition.interimResults = false;\n    recognition.lang = 'en-US';\n    recognition.maxAlternatives = 1;\n\n    flowRef.current.recognition = recognition;\n    flowRef.current.hasReceivedResult = false;\n\n    // Timer for recognition progress\n    flowRef.current.timerInterval = setInterval(() => {\n      setFlowState(prev => ({ ...prev, recognitionTimer: prev.recognitionTimer + 0.1 }));\n    }, 100);\n\n    // 6-second timeout\n    flowRef.current.recordingTimeout = setTimeout(() => {\n      if (!flowRef.current.hasReceivedResult) {\n        console.log('6ì´ˆ íƒ€ì„ì•„ì›ƒ');\n        flowRef.current.hasReceivedResult = true;\n        recognition.stop();\n        handleTimeout();\n      }\n    }, 6000);\n\n    recognition.onresult = (event: any) => {\n      if (flowRef.current.hasReceivedResult) return;\n      flowRef.current.hasReceivedResult = true;\n      \n      const result = event.results[0][0].transcript.trim();\n      const confidence = event.results[0][0].confidence || 0.9;\n      \n      console.log(`ìŒì„±ì¸ì‹ ê²°ê³¼: \"${result}\"`);\n      recognition.stop();\n      handleResult(result, confidence);\n    };\n\n    recognition.onerror = (event: any) => {\n      if (flowRef.current.hasReceivedResult) return;\n      console.error('ìŒì„±ì¸ì‹ ì˜¤ë¥˜:', event.error);\n      \n      if (event.error === 'no-speech' || event.error === 'aborted') {\n        flowRef.current.hasReceivedResult = true;\n        handleTimeout();\n      }\n    };\n\n    recognition.onend = () => {\n      if (!flowRef.current.hasReceivedResult) {\n        flowRef.current.hasReceivedResult = true;\n        handleTimeout();\n      }\n    };\n\n    try {\n      recognition.start();\n    } catch (error) {\n      console.error('ìŒì„±ì¸ì‹ ì‹œì‘ ì‹¤íŒ¨:', error);\n      handleTimeout();\n    }\n  }, [flowState.isRecording, onError]);\n\n  // Handle recognition result\n  const handleResult = useCallback((userAnswer: string, confidence: number) => {\n    forceCleanup();\n    \n    const isCorrect = userAnswer.toLowerCase().trim() === expectedEnglish.toLowerCase().trim();\n    const responseTime = flowState.recognitionStartTime ? Date.now() - flowState.recognitionStartTime : 0;\n    \n    setFlowState(prev => ({\n      ...prev,\n      phase: 'completed',\n      speechResult: `ì¸ì‹ëœ ë‹µë³€: \"${userAnswer}\"`,\n      showAnswer: !isCorrect && showCorrectAnswer,\n      isRecording: false\n    }));\n\n    // Speak correct answer if wrong\n    if (!isCorrect && showCorrectAnswer) {\n      setTimeout(() => {\n        speakText(expectedEnglish, 'en');\n      }, 500);\n    }\n\n    onResult(userAnswer, isCorrect, confidence, responseTime);\n  }, [expectedEnglish, flowState.recognitionStartTime, showCorrectAnswer, speakText, onResult, forceCleanup]);\n\n  // Handle timeout\n  const handleTimeout = useCallback(() => {\n    forceCleanup();\n    \n    setFlowState(prev => ({\n      ...prev,\n      phase: 'completed',\n      speechResult: 'ìŒì„±ì„ ì¸ì‹í•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.',\n      isRecording: false\n    }));\n\n    onResult('', false, 0, 0);\n  }, [onResult, forceCleanup]);\n\n  // Main flow\n  const startFlow = useCallback(async () => {\n    if (flowState.hasStarted || disabled || !koreanText) return;\n    \n    console.log('ğŸš€ Flow ì‹œì‘:', koreanText);\n    setFlowState(prev => ({ \n      ...prev, \n      hasStarted: true,\n      phase: 'tts',\n      speechResult: '',\n      showAnswer: false,\n      countdownTimer: 0,\n      recognitionTimer: 0\n    }));\n\n    try {\n      // Step 1: Korean TTS\n      await speakText(koreanText, 'ko');\n      \n      // Step 2: Countdown\n      setFlowState(prev => ({ ...prev, phase: 'countdown' }));\n      const countdownTime = getCountdownTime();\n      setFlowState(prev => ({ ...prev, countdownTimer: countdownTime }));\n      \n      flowRef.current.countdownInterval = setInterval(() => {\n        setFlowState(prev => {\n          const remaining = prev.countdownTimer - 1;\n          if (remaining <= 0) {\n            if (flowRef.current.countdownInterval) {\n              clearInterval(flowRef.current.countdownInterval);\n              flowRef.current.countdownInterval = null;\n            }\n            // Play beep and start recognition\n            playBeep();\n            setTimeout(() => startSpeechRecognition(), 200);\n          }\n          return { ...prev, countdownTimer: Math.max(0, remaining) };\n        });\n      }, 1000);\n      \n    } catch (error) {\n      console.error('Flow ì˜¤ë¥˜:', error);\n      onError?.(error instanceof Error ? error.message : 'Flow ì‹¤í–‰ ì‹¤íŒ¨');\n    }\n  }, [flowState.hasStarted, disabled, koreanText, speakText, getCountdownTime, playBeep, startSpeechRecognition, onError]);\n\n  // Auto-start effect (StrictMode ì™„ì „ ì°¨ë‹¨)\n  useEffect(() => {\n    if (!autoStart || !koreanText || disabled) return;\n    if (__autoStartGuards.has(autoStartKey)) return;\n    __autoStartGuards.add(autoStartKey);\n\n    const t = setTimeout(() => { startFlow(); }, 300);\n    return () => clearTimeout(t);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [autoStartKey, autoStart, koreanText, disabled]);\n\n  // Cleanup on unmount\n  useEffect(() => {\n    return () => {\n      forceCleanup();\n    };\n  }, [forceCleanup]);\n\n  return (\n    <div className={`text-center ${className}`}>\n      {/* Korean text display */}\n      <div className=\"mb-8\">\n        <div className=\"text-3xl font-bold text-gray-800 mb-4 min-h-[60px] flex items-center justify-center\">\n          {koreanText || 'ë¬¸ì œë¥¼ ê¸°ë‹¤ë¦¬ëŠ” ì¤‘...'}\n        </div>\n        \n        {/* Show correct answer when wrong */}\n        {flowState.showAnswer && (\n          <div className=\"text-2xl font-semibold text-green-600 mb-4 animate-pulse\">\n            ì •ë‹µ: {expectedEnglish}\n          </div>\n        )}\n      </div>\n\n      {/* Status display */}\n      {flowState.phase !== 'idle' && (\n        <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-6 mb-6\">\n          <div className=\"text-lg font-semibold text-blue-800 mb-4\">\n            {flowState.phase === 'tts' && 'ğŸ”Š ë¬¸ì œë¥¼ ë“¤ë ¤ë“œë¦¬ê³  ìˆìŠµë‹ˆë‹¤...'}\n            {flowState.phase === 'countdown' && `â³ ${flowState.countdownTimer}ì´ˆ í›„ ìŒì„± ì¸ì‹ ì‹œì‘...`}\n            {flowState.phase === 'recognition' && `ğŸ¤ ë§ì”€í•´ ì£¼ì„¸ìš”... (${flowState.recognitionTimer.toFixed(1)}ì´ˆ / 6ì´ˆ)`}\n            {flowState.phase === 'completed' && 'âœ… ì™„ë£Œ!'}\n          </div>\n          \n          {/* Progress bar */}\n          {flowState.phase === 'recognition' && (\n            <div className=\"w-full bg-blue-200 rounded-full h-2 mb-4\">\n              <div \n                className=\"bg-blue-600 h-2 rounded-full transition-all duration-100\"\n                style={{ width: `${Math.min((flowState.recognitionTimer / 6) * 100, 100)}%` }}\n              />\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* Speech result */}\n      {flowState.speechResult && (\n        <div className=\"mb-4 p-4 bg-gray-50 border border-gray-200 rounded-lg\">\n          <div className=\"text-sm text-gray-600 mb-1\">ìŒì„± ì¸ì‹ ê²°ê³¼:</div>\n          <div className=\"font-medium text-gray-800\">\"{flowState.speechResult}\"</div>\n        </div>\n      )}\n\n      {/* Manual start button */}\n      {flowState.phase === 'idle' && !autoStart && (\n        <button\n          onClick={startFlow}\n          disabled={disabled || !koreanText}\n          className=\"px-8 py-4 bg-blue-600 text-white font-bold rounded-lg hover:bg-blue-700 disabled:bg-gray-400 transition-colors text-lg\"\n        >\n          ğŸ¤ ì‹œì‘í•˜ê¸°\n        </button>\n      )}\n    </div>\n  );\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\PatternTrainingFlowSimple.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The 'getCountdownTime' function makes the dependencies of useCallback Hook (at line 461) change on every render. To fix this, wrap the definition of 'getCountdownTime' in its own useCallback() Hook.","line":54,"column":9,"nodeType":"VariableDeclarator","endLine":60,"endColumn":4,"suggestions":[{"desc":"Wrap the definition of 'getCountdownTime' in its own useCallback() Hook.","fix":{"range":[1985,2173],"text":"useCallback(() => {\n    // ALL modeë‚˜ ê¸°íƒ€ ë‹¨ê³„ëŠ” 2ì´ˆ, ì •ê·œ ë‹¨ê³„ëŠ” ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ ì‚¬ìš©\n    if (stage >= 1 && stage <= 3) {\n      return getCountdownDuration(stage as SpeakingStage);\n    }\n    return 2; // ALL mode: 2ì´ˆ\n  })"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has missing dependencies: 'currentPhase', 'evaluateAndSubmitAnswer', 'handleRecognitionTimeout', and 'stopSpeechRecognition'. Either include them or remove the dependency array.","line":339,"column":6,"nodeType":"ArrayExpression","endLine":339,"endColumn":48,"suggestions":[{"desc":"Update the dependencies array to be: [currentPhase, isRecording, forceStopAllTimers, onError, handleRecognitionTimeout, stopSpeechRecognition, evaluateAndSubmitAnswer]","fix":{"range":[10518,10560],"text":"[currentPhase, isRecording, forceStopAllTimers, onError, handleRecognitionTimeout, stopSpeechRecognition, evaluateAndSubmitAnswer]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has an unnecessary dependency: 'voiceSettings.englishEnabled'. Either exclude it or remove the dependency array.","line":399,"column":6,"nodeType":"ArrayExpression","endLine":399,"endColumn":115,"suggestions":[{"desc":"Update the dependencies array to be: [expectedEnglish, onResult, recognitionStartTime, showCorrectAnswer, speakText]","fix":{"range":[12441,12550],"text":"[expectedEnglish, onResult, recognitionStartTime, showCorrectAnswer, speakText]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'autoStart', 'currentPhase', 'disabled', and 'startFlow'. Either include them or remove the dependency array.","line":506,"column":6,"nodeType":"ArrayExpression","endLine":506,"endColumn":18,"suggestions":[{"desc":"Update the dependencies array to be: [autoStart, currentPhase, disabled, koreanText, startFlow]","fix":{"range":[16124,16136],"text":"[autoStart, currentPhase, disabled, koreanText, startFlow]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { useLocalStorage, STORAGE_KEYS } from '@/hooks/useLocalStorage';\nimport { getCountdownDuration, type SpeakingStage } from '@/utils/speakingStageUtils';\n\ninterface PatternTrainingFlowSimpleProps {\n  koreanText: string;\n  expectedEnglish: string;\n  onResult: (userAnswer: string, isCorrect: boolean, confidence: number, responseTime: number) => void;\n  onError?: (error: string) => void;\n  stage: number;\n  disabled?: boolean;\n  autoStart?: boolean;\n  className?: string;\n  mistakeId?: string;\n  showCorrectAnswer?: boolean;\n}\n\ntype FlowPhase = 'idle' | 'tts' | 'countdown' | 'recognition' | 'completed';\n\nexport const PatternTrainingFlowSimple: React.FC<PatternTrainingFlowSimpleProps> = ({\n  koreanText,\n  expectedEnglish,\n  onResult,\n  onError,\n  stage,\n  disabled = false,\n  autoStart = false,\n  className = '',\n  mistakeId,\n  showCorrectAnswer = true\n}) => {\n  // State management\n  const [currentPhase, setCurrentPhase] = useState<FlowPhase>('idle');\n  const [countdownTimer, setCountdownTimer] = useState<number>(0);\n  const [recognitionTimer, setRecognitionTimer] = useState<number>(0);\n  const [speechResult, setSpeechResult] = useState<string>('');\n  const [showAnswer, setShowAnswer] = useState<boolean>(false);\n  const [isRecording, setIsRecording] = useState<boolean>(false);\n  const [ttsInitialized, setTtsInitialized] = useState<boolean>(false);\n  \n  // Timing\n  const [recognitionStartTime, setRecognitionStartTime] = useState<number>(0);\n  \n  // Voice settings\n  const { value: voiceSettings } = useLocalStorage(STORAGE_KEYS.VOICE_SETTINGS);\n  \n  // Refs for cleanup\n  const recognitionRef = useRef<any>(null);\n  const countdownIntervalRef = useRef<NodeJS.Timeout | null>(null);\n  const recordingTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n  const timerIntervalRef = useRef<NodeJS.Timeout | null>(null);\n\n  // Get stage-based timing using utility function\n  const getCountdownTime = () => {\n    // ALL modeë‚˜ ê¸°íƒ€ ë‹¨ê³„ëŠ” 2ì´ˆ, ì •ê·œ ë‹¨ê³„ëŠ” ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ ì‚¬ìš©\n    if (stage >= 1 && stage <= 3) {\n      return getCountdownDuration(stage as SpeakingStage);\n    }\n    return 2; // ALL mode: 2ì´ˆ\n  };\n\n  /**\n   * ğŸ”§ í”ŒëŸ¬ê·¸ì¸ì„ í†µí•œ TTS ì´ˆê¸°í™”\n   */\n  const initializeTTS = useCallback(async () => {\n    if (ttsInitialized) {\n      return Promise.resolve();\n    }\n\n    try {\n      console.log('ğŸ”§ í”ŒëŸ¬ê·¸ì¸ TTS ì´ˆê¸°í™” ì‹œì‘...');\n\n      // ServiceContainerë¥¼ í†µí•´ speechService ì‚¬ìš©\n      const ServiceContainer = (await import('@/container/ServiceContainer')).default;\n      const container = ServiceContainer.getInstanceSync();\n      container.getSpeechProcessingService(); // ì´ˆê¸°í™”ë§Œ ìˆ˜í–‰\n\n      // í”ŒëŸ¬ê·¸ì¸ì„ í†µí•œ ì´ˆê¸°í™” (ì‹¤ì œ ìŒì„± ì—†ì´ ì¤€ë¹„ë§Œ)\n      console.log('ğŸ”§ í”ŒëŸ¬ê·¸ì¸ TTS ì´ˆê¸°í™” ì™„ë£Œ');\n      setTtsInitialized(true);\n      return Promise.resolve();\n    } catch (error) {\n      console.warn('ğŸ”§ í”ŒëŸ¬ê·¸ì¸ TTS ì´ˆê¸°í™” ì˜¤ë¥˜:', error);\n      setTtsInitialized(true);\n      return Promise.resolve();\n    }\n  }, [ttsInitialized]);\n\n  /**\n   * ğŸ”§ í”ŒëŸ¬ê·¸ì¸ ì‹œìŠ¤í…œì„ í†µí•œ Text-to-Speech í•¨ìˆ˜\n   */\n  const speakText = useCallback(async (text: string, lang: 'ko' | 'en' = 'ko'): Promise<void> => {\n    try {\n      // Initialize TTS if not already done\n      if (!ttsInitialized) {\n        await initializeTTS();\n      }\n\n      // Check if voice is enabled for this language\n      if (lang === 'ko' && !voiceSettings.koreanEnabled) {\n        return;\n      }\n      if (lang === 'en' && !voiceSettings.englishEnabled) {\n        return;\n      }\n\n      // ServiceContainerë¥¼ í†µí•´ speechService ì‚¬ìš©\n      const ServiceContainer = (await import('@/container/ServiceContainer')).default;\n      const container = ServiceContainer.getInstanceSync();\n      const speechService = container.getSpeechProcessingService();\n\n      // ê¸°ì¡´ TTS ì¤‘ì§€\n      speechService.stopAllSpeech();\n\n      // í”ŒëŸ¬ê·¸ì¸ì„ í†µí•´ TTS ì‹¤í–‰\n      await speechService.speakAnswer(text, {\n        language: lang === 'ko' ? 'ko-KR' : 'en-US',\n        rate: voiceSettings.speed,\n        volume: 1.0,\n        pitch: 1.0\n      });\n\n      console.log(`ğŸ”§ ${lang.toUpperCase()} TTS ì™„ë£Œ (í”ŒëŸ¬ê·¸ì¸)`);\n\n    } catch (error) {\n      console.error(`ğŸ”§ [PatternTrainingFlowSimple] Speech service error:`, error);\n\n      // ğŸ”§ í”ŒëŸ¬ê·¸ì¸ fallback: AdvancedSpeechPlugin ì‹œë„\n      try {\n        const ServiceContainer = (await import('@/container/ServiceContainer')).default;\n        const container = ServiceContainer.getInstanceSync();\n        const advancedPlugin = container.getAdvancedSpeechPlugin();\n\n        if (advancedPlugin) {\n          // ê¸°ì¡´ TTS ì¤‘ì§€\n          advancedPlugin.stopAll();\n\n          await advancedPlugin.speakText(text, {\n            language: lang === 'ko' ? 'ko-KR' : 'en-US',\n            rate: voiceSettings.speed,\n            volume: 1.0,\n            pitch: 1.0\n          });\n\n          console.log(`ğŸ”§ ${lang.toUpperCase()} TTS ì™„ë£Œ (ê³ ê¸‰ í”ŒëŸ¬ê·¸ì¸)`);\n        } else {\n          console.warn(`ğŸ”§ [PatternTrainingFlowSimple] No speech plugins available`);\n        }\n      } catch (pluginError) {\n        console.error(`ğŸ”§ [PatternTrainingFlowSimple] All speech plugins failed:`, pluginError);\n      }\n    }\n  }, [voiceSettings, ttsInitialized, initializeTTS]);\n\n  /**\n   * Force stop all timers and activities\n   */\n  const forceStopAllTimers = useCallback(() => {\n    try {\n      // Clear countdown interval\n      if (countdownIntervalRef.current) {\n        clearInterval(countdownIntervalRef.current);\n        countdownIntervalRef.current = null;\n      }\n      \n      // Clear recording timeout\n      if (recordingTimeoutRef.current) {\n        clearTimeout(recordingTimeoutRef.current);\n        recordingTimeoutRef.current = null;\n      }\n\n      // Clear timer interval\n      if (timerIntervalRef.current) {\n        clearInterval(timerIntervalRef.current);\n        timerIntervalRef.current = null;\n      }\n      \n      // Stop speech recognition safely\n      if (recognitionRef.current && isRecording) {\n        try {\n          recognitionRef.current.stop();\n        } catch (error) {\n          console.warn('Error stopping speech recognition:', error);\n        }\n      }\n      \n      // ğŸ”§ í”ŒëŸ¬ê·¸ì¸ì„ í†µí•œ TTS ì¤‘ì§€ (ë™ê¸°ì ìœ¼ë¡œ ì²˜ë¦¬)\n      try {\n        import('@/container/ServiceContainer').then((module) => {\n          const container = module.default.getInstanceSync();\n          const speechService = container.getSpeechProcessingService();\n          speechService.stopAllSpeech();\n        }).catch((error) => {\n          console.warn('ğŸ”§ Error stopping TTS (plugin):', error);\n        });\n      } catch (error) {\n        console.warn('ğŸ”§ Error importing ServiceContainer:', error);\n      }\n      \n      setIsRecording(false);\n    } catch (error) {\n      console.error('Error in forceStopAllTimers:', error);\n      setIsRecording(false);\n    }\n  }, [isRecording]);\n\n  /**\n   * Start speech recognition\n   */\n  const startSpeechRecognition = useCallback(() => {\n    if (currentPhase === 'recognition' || isRecording) {\n      console.log('ìŒì„±ì¸ì‹ì´ ì´ë¯¸ ì§„í–‰ ì¤‘ - ì¤‘ë³µ ì‹¤í–‰ ë°©ì§€');\n      return;\n    }\n    \n    setCurrentPhase('recognition');\n    console.log('ìŒì„±ì¸ì‹ ì‹œì‘ - 6ì´ˆ ì œí•œì‹œê°„');\n    \n    forceStopAllTimers();\n    \n    if (!('webkitSpeechRecognition' in window || 'SpeechRecognition' in window)) {\n      const errorMsg = 'ìŒì„± ì¸ì‹ì„ ì§€ì›í•˜ì§€ ì•ŠëŠ” ë¸Œë¼ìš°ì €ì…ë‹ˆë‹¤.';\n      setSpeechResult(errorMsg);\n      onError?.(errorMsg);\n      return;\n    }\n\n    const SpeechRecognition = (window as any).webkitSpeechRecognition || (window as any).SpeechRecognition;\n    const recognition = new SpeechRecognition();\n    \n    recognition.continuous = false;\n    recognition.interimResults = false;\n    recognition.lang = 'en-US';\n    recognition.maxAlternatives = 3;\n\n    recognitionRef.current = recognition;\n    setIsRecording(true);\n    setSpeechResult('ìŒì„±ì„ ì¸ì‹í•˜ê³  ìˆìŠµë‹ˆë‹¤...');\n\n    let hasReceivedResult = false;\n    let recognitionStopped = false;\n\n    recognition.onstart = () => {\n      if (recognitionStopped) return;\n      console.log('ìŒì„±ì¸ì‹ ì‹¤ì œ ì‹œì‘');\n      setRecognitionTimer(0);\n      setRecognitionStartTime(Date.now());\n      \n      // Start timer\n      const interval = setInterval(() => {\n        setRecognitionTimer(prev => prev + 0.1);\n      }, 100);\n      timerIntervalRef.current = interval;\n      \n      // 6ì´ˆ íƒ€ì„ì•„ì›ƒ ì„¤ì •\n      recordingTimeoutRef.current = setTimeout(() => {\n        if (!hasReceivedResult && !recognitionStopped) {\n          console.log('6ì´ˆ íƒ€ì„ì•„ì›ƒ - ê°•ì œ ì¤‘ì§€');\n          recognitionStopped = true;\n          recognition.stop();\n          handleRecognitionTimeout();\n        }\n      }, 6000);\n    };\n\n    recognition.onresult = (event: any) => {\n      if (hasReceivedResult || recognitionStopped) {\n        console.log('ì¤‘ë³µ ë‹µë³€ ì‹œë„ ì°¨ë‹¨');\n        return;\n      }\n      \n      hasReceivedResult = true;\n      recognitionStopped = true;\n      \n      const result = event.results[0][0].transcript.trim();\n      const confidence = event.results[0][0].confidence || 0.9;\n      \n      console.log(`ìŒì„±ì¸ì‹ ê²°ê³¼: \"${result}\" (ì‹ ë¢°ë„: ${confidence})`);\n      \n      // ì¦‰ì‹œ ì¸ì‹ ì¤‘ì§€\n      recognition.stop();\n      stopSpeechRecognition();\n      \n      // ê²°ê³¼ í‰ê°€ ë° ì „ë‹¬\n      evaluateAndSubmitAnswer(result, confidence);\n    };\n\n    recognition.onerror = (event: any) => {\n      console.error('ìŒì„±ì¸ì‹ ì˜¤ë¥˜:', event.error);\n      stopSpeechRecognition();\n      \n      switch (event.error) {\n        case 'no-speech':\n          handleRecognitionTimeout();\n          break;\n        case 'audio-capture':\n          const audioError = 'ë§ˆì´í¬ì— ì ‘ê·¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì € ì„¤ì •ì„ í™•ì¸í•´ì£¼ì„¸ìš”.';\n          setSpeechResult(audioError);\n          onError?.(audioError);\n          break;\n        case 'not-allowed':\n          const permissionError = 'ë§ˆì´í¬ ê¶Œí•œì´ ê±°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤. ì„¤ì •ì—ì„œ ê¶Œí•œì„ í—ˆìš©í•´ì£¼ì„¸ìš”.';\n          setSpeechResult(permissionError);\n          onError?.(permissionError);\n          break;\n        case 'network':\n          const networkError = 'ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì„ í™•ì¸í•´ì£¼ì„¸ìš”.';\n          setSpeechResult(networkError);\n          onError?.(networkError);\n          break;\n        case 'aborted':\n          console.log('ìŒì„± ì¸ì‹ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.');\n          setCurrentPhase('idle');\n          break;\n        default:\n          const errorMsg = `ìŒì„± ì¸ì‹ ì˜¤ë¥˜: ${event.error}`;\n          setSpeechResult(errorMsg);\n          onError?.(errorMsg);\n      }\n    };\n\n    recognition.onend = () => {\n      console.log('ìŒì„±ì¸ì‹ ì¢…ë£Œ');\n      if (!hasReceivedResult && !recognitionStopped) {\n        recognitionStopped = true;\n        handleRecognitionTimeout();\n      }\n    };\n\n    try {\n      recognition.start();\n    } catch (error) {\n      console.error('ìŒì„±ì¸ì‹ ì‹œì‘ ì‹¤íŒ¨:', error);\n      stopSpeechRecognition();\n      const errorMsg = 'ìŒì„± ì¸ì‹ì„ ì‹œì‘í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';\n      setSpeechResult(errorMsg);\n      onError?.(errorMsg);\n    }\n  }, [isRecording, forceStopAllTimers, onError]);\n\n  /**\n   * Stop speech recognition safely\n   */\n  const stopSpeechRecognition = useCallback(() => {\n    if (recognitionRef.current && isRecording) {\n      recognitionRef.current.stop();\n    }\n    setIsRecording(false);\n    \n    if (recordingTimeoutRef.current) {\n      clearTimeout(recordingTimeoutRef.current);\n      recordingTimeoutRef.current = null;\n    }\n\n    if (timerIntervalRef.current) {\n      clearInterval(timerIntervalRef.current);\n      timerIntervalRef.current = null;\n    }\n  }, [isRecording]);\n\n  /**\n   * Handle recognition timeout\n   */\n  const handleRecognitionTimeout = useCallback(() => {\n    console.log('ìŒì„±ì¸ì‹ íƒ€ì„ì•„ì›ƒ');\n    setCurrentPhase('completed');\n    setSpeechResult('ìŒì„±ì„ ì¸ì‹í•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.');\n    \n    // íƒ€ì„ì•„ì›ƒì„ ì˜¤ë‹µìœ¼ë¡œ ì²˜ë¦¬\n    onResult('', false, 0, 0);\n  }, [onResult]);\n\n  /**\n   * Evaluate user answer and submit result\n   */\n  const evaluateAndSubmitAnswer = useCallback((userAnswer: string, confidence: number) => {\n    const isCorrect = userAnswer.toLowerCase().trim() === expectedEnglish.toLowerCase().trim();\n    const responseTime = recognitionStartTime ? Date.now() - recognitionStartTime : 0;\n    \n    console.log(`ë‹µë³€ í‰ê°€: \"${userAnswer}\" vs \"${expectedEnglish}\" = ${isCorrect ? 'ì •ë‹µ' : 'ì˜¤ë‹µ'}`);\n    \n    setCurrentPhase('completed');\n    setSpeechResult(`ì¸ì‹ëœ ë‹µë³€: \"${userAnswer}\"`);\n    \n    // Show correct answer if enabled and answer was wrong\n    if (showCorrectAnswer && !isCorrect) {\n      setShowAnswer(true);\n      // Always speak the correct answer in English when wrong (new enhancement)\n      console.log(`í‹€ë¦° ë‹µë³€ - ì •ë‹µ TTS ì¬ìƒ: \"${expectedEnglish}\"`);\n      setTimeout(() => {\n        speakText(expectedEnglish, 'en').catch(error => {\n          console.warn('ì˜ì–´ TTS ì‹¤íŒ¨:', error);\n        });\n      }, 500); // Shorter delay for better user experience\n    }\n    \n    // ê²°ê³¼ ì „ë‹¬\n    onResult(userAnswer, isCorrect, confidence, responseTime);\n  }, [expectedEnglish, onResult, recognitionStartTime, showCorrectAnswer, voiceSettings.englishEnabled, speakText]);\n\n  /**\n   * Play beep sound before speech recognition (matching original HTML)\n   */\n  const playMicrophoneStartSound = useCallback(() => {\n    if ('AudioContext' in window || 'webkitAudioContext' in window) {\n      const AudioContext = window.AudioContext || window.webkitAudioContext;\n      const audioCtx = new AudioContext();\n      \n      const oscillator = audioCtx.createOscillator();\n      const gainNode = audioCtx.createGain();\n      \n      oscillator.connect(gainNode);\n      gainNode.connect(audioCtx.destination);\n      \n      oscillator.frequency.setValueAtTime(800, audioCtx.currentTime);\n      gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);\n      gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.2);\n      \n      oscillator.start(audioCtx.currentTime);\n      oscillator.stop(audioCtx.currentTime + 0.2);\n    }\n  }, []);\n\n  /**\n   * Start countdown before speech recognition (matching original HTML flow)\n   */\n  const startCountdownBeforeSpeechRecognition = useCallback(() => {\n    setCurrentPhase('countdown');\n    const waitTime = getCountdownTime();\n    \n    console.log(`ì‚¬ê³ ì‹œê°„ ì¹´ìš´íŠ¸ë‹¤ìš´ ì‹œì‘ - ${waitTime}ì´ˆ ëŒ€ê¸°`);\n    \n    forceStopAllTimers();\n    \n    setCountdownTimer(waitTime);\n    \n    countdownIntervalRef.current = setInterval(() => {\n      setCountdownTimer(prev => {\n        const remaining = prev - 1;\n        console.log(`ì‚¬ê³ ì‹œê°„ ë‚¨ìŒ: ${remaining}ì´ˆ`);\n        \n        if (remaining <= 0) {\n          if (countdownIntervalRef.current) {\n            clearInterval(countdownIntervalRef.current);\n            countdownIntervalRef.current = null;\n          }\n          \n          // Play beep sound before speech recognition (like original HTML)\n          console.log('ğŸ”” ì‚¬ê³ ì‹œê°„ ì¢…ë£Œ - ë§ˆì´í¬ ì‹œì‘ìŒ ì¬ìƒ');\n          playMicrophoneStartSound();\n          \n          // Start speech recognition immediately after beep\n          setTimeout(() => {\n            console.log('ğŸ¤ ìŒì„±ì¸ì‹ í•¨ìˆ˜ í˜¸ì¶œ ì‹œì‘');\n            startSpeechRecognition();\n          }, 100); // Small delay to ensure beep plays\n        }\n        return remaining;\n      });\n    }, 1000);\n  }, [getCountdownTime, forceStopAllTimers, startSpeechRecognition, playMicrophoneStartSound]);\n\n  /**\n   * Main flow start function with proper TTS initialization\n   */\n  const startFlow = useCallback(async () => {\n    if (disabled || !koreanText) return;\n    \n    console.log('Pattern Training Flow ì‹œì‘');\n    \n    // Reset all states\n    setCurrentPhase('tts');\n    setSpeechResult('');\n    setCountdownTimer(0);\n    setRecognitionTimer(0);\n    setShowAnswer(false);\n    \n    try {\n      // Initialize TTS first (handles browser autoplay policy)\n      if (!ttsInitialized) {\n        console.log('TTS ì´ˆê¸°í™” ì¤‘...');\n        await initializeTTS();\n      }\n      \n      // Step 1: Play Korean TTS\n      console.log(`í•œêµ­ì–´ TTS ì‹œì‘: \"${koreanText}\"`);\n      await speakText(koreanText, 'ko');\n      \n      // Step 2: Start countdown immediately after TTS (no additional delay)\n      startCountdownBeforeSpeechRecognition();\n      \n    } catch (error) {\n      console.error('Flow ì‹œì‘ ì˜¤ë¥˜:', error);\n      setCurrentPhase('idle');\n      const errorMsg = error instanceof Error ? error.message : 'Flow ì‹œì‘ ì‹¤íŒ¨';\n      onError?.(errorMsg);\n    }\n  }, [disabled, koreanText, speakText, startCountdownBeforeSpeechRecognition, onError, ttsInitialized, initializeTTS]);\n\n  // Auto-start effect (prevent duplicate execution)\n  useEffect(() => {\n    if (autoStart && koreanText && currentPhase === 'idle' && !disabled) {\n      console.log('Auto-start triggered for:', koreanText);\n      startFlow();\n    }\n  }, [koreanText]); // Only depend on koreanText to prevent re-execution\n\n  // Cleanup effect on unmount\n  useEffect(() => {\n    return () => {\n      try {\n        forceStopAllTimers();\n        setCurrentPhase('idle');\n        setIsRecording(false);\n        \n        if (recognitionRef.current) {\n          try {\n            recognitionRef.current.abort();\n          } catch (error) {\n            console.warn('Error aborting recognition on unmount:', error);\n          }\n          recognitionRef.current = null;\n        }\n        \n        try {\n          // ğŸ”§ í”ŒëŸ¬ê·¸ì¸ì„ í†µí•œ TTS ì¤‘ì§€ (ë™ê¸°ì ìœ¼ë¡œ ì²˜ë¦¬)\n          import('@/container/ServiceContainer').then((module) => {\n            const container = module.default.getInstanceSync();\n            const speechService = container.getSpeechProcessingService();\n            speechService.stopAllSpeech();\n          }).catch((error) => {\n            console.warn('ğŸ”§ Error stopping TTS on unmount (plugin):', error);\n          });\n        } catch (error) {\n          console.warn('ğŸ”§ Error importing ServiceContainer on unmount:', error);\n        }\n        \n        console.log('PatternTrainingFlowSimple cleanup completed');\n      } catch (error) {\n        console.error('Error during cleanup:', error);\n      }\n    };\n  }, [forceStopAllTimers]);\n\n  return (\n    <div className={`text-center ${className}`}>\n      {/* Korean text display */}\n      <div className=\"mb-8\">\n        <div className=\"text-3xl font-bold text-gray-800 mb-4 min-h-[60px] flex items-center justify-center\">\n          {koreanText || 'ë¬¸ì œë¥¼ ê¸°ë‹¤ë¦¬ëŠ” ì¤‘...'}\n        </div>\n        \n        {/* Show correct answer when enabled */}\n        {showAnswer && showCorrectAnswer && (\n          <div className=\"text-2xl font-semibold text-green-600 mb-4 animate-pulse\">\n            ì •ë‹µ: {expectedEnglish}\n          </div>\n        )}\n      </div>\n\n      {/* Flow status display */}\n      {currentPhase !== 'idle' && (\n        <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-6 mb-6\">\n          <div className=\"text-center\">\n            <div className=\"text-lg font-semibold text-blue-800 mb-4\">\n              {currentPhase === 'tts' && 'ğŸ”Š ë¬¸ì œë¥¼ ë“¤ë ¤ë“œë¦¬ê³  ìˆìŠµë‹ˆë‹¤...'}\n              {currentPhase === 'countdown' && `â³ ${countdownTimer}ì´ˆ í›„ ìŒì„± ì¸ì‹ ì‹œì‘...`}\n              {currentPhase === 'recognition' && `ğŸ¤ ë§ì”€í•´ ì£¼ì„¸ìš”... (${recognitionTimer.toFixed(1)}ì´ˆ / 6ì´ˆ)`}\n              {currentPhase === 'completed' && 'âœ… ì™„ë£Œ!'}\n            </div>\n            \n            {/* Progress bar for recognition */}\n            {currentPhase === 'recognition' && (\n              <>\n                <div className=\"w-full bg-blue-200 rounded-full h-2 mb-4\">\n                  <div \n                    className=\"bg-blue-600 h-2 rounded-full transition-all duration-100\"\n                    style={{ width: `${Math.min((recognitionTimer / 6) * 100, 100)}%` }}\n                  />\n                </div>\n                \n                <div className=\"flex items-center justify-center space-x-3\">\n                  <div className=\"w-3 h-3 bg-red-500 rounded-full animate-pulse\"></div>\n                  <span className=\"text-sm text-blue-700\">ìŒì„±ì„ ì¸ì‹í•˜ê³  ìˆìŠµë‹ˆë‹¤...</span>\n                </div>\n              </>\n            )}\n            \n            {/* TTS indicator */}\n            {currentPhase === 'tts' && (\n              <div className=\"flex items-center justify-center space-x-3\">\n                <div className=\"w-3 h-3 bg-green-500 rounded-full animate-pulse\"></div>\n                <span className=\"text-sm text-blue-700\">í•œêµ­ì–´ ë¬¸ì œë¥¼ ì¬ìƒ ì¤‘...</span>\n              </div>\n            )}\n            \n            {/* Countdown indicator */}\n            {currentPhase === 'countdown' && (\n              <div className=\"flex items-center justify-center space-x-3\">\n                <div className=\"w-3 h-3 bg-yellow-500 rounded-full animate-pulse\"></div>\n                <span className=\"text-sm text-blue-700\">ìƒê°í•  ì‹œê°„ì„ ë“œë¦¬ê³  ìˆìŠµë‹ˆë‹¤</span>\n              </div>\n            )}\n          </div>\n        </div>\n      )}\n\n      {/* Speech result display */}\n      {speechResult && (\n        <div className=\"mb-4 p-4 bg-gray-50 border border-gray-200 rounded-lg\">\n          <div className=\"text-sm text-gray-600 mb-1\">ìŒì„± ì¸ì‹ ê²°ê³¼:</div>\n          <div className=\"font-medium text-gray-800\">\"{speechResult}\"</div>\n        </div>\n      )}\n\n      {/* Control buttons */}\n      <div className=\"space-y-4\">\n        {/* Manual start button */}\n        {currentPhase === 'idle' && !autoStart && (\n          <button\n            onClick={async () => {\n              // Initialize TTS on user interaction to comply with autoplay policy\n              if (!ttsInitialized) {\n                await initializeTTS();\n              }\n              startFlow();\n            }}\n            disabled={disabled || !koreanText}\n            className=\"px-8 py-4 bg-blue-600 text-white font-bold rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors text-lg\"\n          >\n            ğŸ¤ ì‹œì‘í•˜ê¸°\n          </button>\n        )}\n        \n        {/* Emergency stop button */}\n        {(currentPhase === 'tts' || currentPhase === 'countdown' || currentPhase === 'recognition') && (\n          <button\n            onClick={() => {\n              forceStopAllTimers();\n              setCurrentPhase('idle');\n              onError?.('ì‚¬ìš©ìê°€ í”Œë¡œìš°ë¥¼ ì¤‘ì§€í–ˆìŠµë‹ˆë‹¤.');\n            }}\n            className=\"px-4 py-2 bg-red-600 text-white font-medium rounded-lg hover:bg-red-700 transition-colors text-sm\"\n          >\n            â¹ï¸ ì¤‘ì§€\n          </button>\n        )}\n      </div>\n\n      {/* Debug info (remove in production) */}\n      {process.env.NODE_ENV === 'development' && (\n        <div className=\"mt-4 text-xs text-gray-400 space-y-1\">\n          <div>Phase: {currentPhase}</div>\n          <div>Stage: {stage} | Countdown: {getCountdownTime()}s</div>\n          <div>Recording: {isRecording ? 'Yes' : 'No'}</div>\n          <div>TTS Initialized: {ttsInitialized ? 'Yes' : 'No'}</div>\n          <div>Voice: KO={voiceSettings.koreanEnabled ? 'On' : 'Off'} | EN={voiceSettings.englishEnabled ? 'On' : 'Off'} | Speed={voiceSettings.speed}x</div>\n          {mistakeId && <div>Review Mode: {mistakeId}</div>}\n        </div>\n      )}\n    </div>\n  );\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\PerformanceDashboard.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'container'. Either include it or remove the dependency array.","line":63,"column":6,"nodeType":"ArrayExpression","endLine":63,"endColumn":43,"suggestions":[{"desc":"Update the dependencies array to be: [state.isVisible, state.isMonitoring, container]","fix":{"range":[1980,2017],"text":"[state.isVisible, state.isMonitoring, container]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'container'. Either include it or remove the dependency array.","line":86,"column":6,"nodeType":"ArrayExpression","endLine":86,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [container]","fix":{"range":[2614,2616],"text":"[container]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Performance Dashboard Component\r\n * @description ì‹¤ì‹œê°„ ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ - Service Containerì™€ ì—°ë™\r\n */\r\n\r\nimport React, { useState, useEffect, useRef } from 'react';\r\nimport { getServiceContainerSync } from '@/container/ServiceContainer';\r\nimport type { PerformanceStats, PerformanceEvent } from '@/plugins/performance/IPerformancePlugin';\r\n\r\ninterface DashboardState {\r\n  isVisible: boolean;\r\n  stats: PerformanceStats | null;\r\n  recentEvents: PerformanceEvent[];\r\n  containerStatus: any;\r\n  audioLatencyHistory: number[];\r\n  isMonitoring: boolean;\r\n}\r\n\r\nexport const PerformanceDashboard: React.FC = () => {\r\n  const [state, setState] = useState<DashboardState>({\r\n    isVisible: false,\r\n    stats: null,\r\n    recentEvents: [],\r\n    containerStatus: null,\r\n    audioLatencyHistory: [],\r\n    isMonitoring: false\r\n  });\r\n\r\n  const intervalRef = useRef<NodeJS.Timeout>();\r\n  const container = getServiceContainerSync();\r\n\r\n  // ì‹¤ì‹œê°„ ë°ì´í„° ì—…ë°ì´íŠ¸\r\n  useEffect(() => {\r\n    if (state.isVisible && state.isMonitoring) {\r\n      intervalRef.current = setInterval(async () => {\r\n        try {\r\n          // Performance Pluginì—ì„œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°\r\n          const performancePlugin = await container.ensurePerformancePlugin();\r\n          const statsResult = await performancePlugin.getPerformanceStats();\r\n          \r\n          if (statsResult.success) {\r\n            setState(prev => ({\r\n              ...prev,\r\n              stats: statsResult.data,\r\n              containerStatus: container.getServicesStatus(),\r\n              audioLatencyHistory: [\r\n                ...prev.audioLatencyHistory.slice(-9), // ìµœê·¼ 10ê°œë§Œ ìœ ì§€\r\n                statsResult.data.audioPerformance.averageLatency\r\n              ]\r\n            }));\r\n          }\r\n        } catch (error) {\r\n          console.error('[PerformanceDashboard] Data update failed:', error);\r\n        }\r\n      }, 1000);\r\n    }\r\n\r\n    return () => {\r\n      if (intervalRef.current) {\r\n        clearInterval(intervalRef.current);\r\n      }\r\n    };\r\n  }, [state.isVisible, state.isMonitoring]);\r\n\r\n  // Performance Plugin ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ\r\n  useEffect(() => {\r\n    const handlePerformanceEvent = (event: PerformanceEvent) => {\r\n      setState(prev => ({\r\n        ...prev,\r\n        recentEvents: [\r\n          event,\r\n          ...prev.recentEvents.slice(0, 4) // ìµœê·¼ 5ê°œë§Œ ìœ ì§€\r\n        ]\r\n      }));\r\n    };\r\n\r\n    container.ensurePerformancePlugin().then(plugin => {\r\n      plugin.onPerformanceEvent(handlePerformanceEvent);\r\n    });\r\n\r\n    return () => {\r\n      container.ensurePerformancePlugin().then(plugin => {\r\n        plugin.offPerformanceEvent(handlePerformanceEvent);\r\n      });\r\n    };\r\n  }, []);\r\n\r\n  const toggleDashboard = () => {\r\n    setState(prev => ({ ...prev, isVisible: !prev.isVisible }));\r\n  };\r\n\r\n  const toggleMonitoring = async () => {\r\n    try {\r\n      const performancePlugin = await container.ensurePerformancePlugin();\r\n      \r\n      if (state.isMonitoring) {\r\n        performancePlugin.stopMonitoring();\r\n      } else {\r\n        performancePlugin.startMonitoring();\r\n      }\r\n      \r\n      setState(prev => ({ ...prev, isMonitoring: !prev.isMonitoring }));\r\n    } catch (error) {\r\n      console.error('[PerformanceDashboard] Toggle monitoring failed:', error);\r\n    }\r\n  };\r\n\r\n  const generateReport = async () => {\r\n    try {\r\n      const performancePlugin = await container.ensurePerformancePlugin();\r\n      const reportResult = await performancePlugin.generatePerformanceReport();\r\n      \r\n      if (reportResult.success) {\r\n        console.log('[PerformanceDashboard] Report generated:', reportResult.data);\r\n        // ë¦¬í¬íŠ¸ë¥¼ JSONìœ¼ë¡œ ë‹¤ìš´ë¡œë“œ\r\n        const blob = new Blob([JSON.stringify(reportResult.data, null, 2)], {\r\n          type: 'application/json'\r\n        });\r\n        const url = URL.createObjectURL(blob);\r\n        const a = document.createElement('a');\r\n        a.href = url;\r\n        a.download = `performance-report-${new Date().toISOString()}.json`;\r\n        a.click();\r\n        URL.revokeObjectURL(url);\r\n      }\r\n    } catch (error) {\r\n      console.error('[PerformanceDashboard] Report generation failed:', error);\r\n    }\r\n  };\r\n\r\n  const clearMetrics = async () => {\r\n    try {\r\n      const performancePlugin = await container.ensurePerformancePlugin();\r\n      await performancePlugin.clearMetrics();\r\n      setState(prev => ({\r\n        ...prev,\r\n        stats: null,\r\n        recentEvents: [],\r\n        audioLatencyHistory: []\r\n      }));\r\n    } catch (error) {\r\n      console.error('[PerformanceDashboard] Clear metrics failed:', error);\r\n    }\r\n  };\r\n\r\n  const getLatencyColor = (latency: number) => {\r\n    if (latency < 1000) return 'text-green-500';\r\n    if (latency < 2000) return 'text-yellow-500';\r\n    return 'text-red-500';\r\n  };\r\n\r\n  const getScoreColor = (score: number) => {\r\n    if (score >= 80) return 'text-green-500';\r\n    if (score >= 60) return 'text-yellow-500';\r\n    return 'text-red-500';\r\n  };\r\n\r\n  if (!state.isVisible) {\r\n    return (\r\n      <div className=\"fixed bottom-4 right-4 z-50\">\r\n        <button\r\n          onClick={toggleDashboard}\r\n          className=\"bg-blue-500 hover:bg-blue-600 text-white p-3 rounded-full shadow-lg transition-colors\"\r\n          title=\"Open Performance Dashboard\"\r\n        >\r\n          ğŸ“Š\r\n        </button>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"fixed bottom-4 right-4 z-50 bg-white dark:bg-gray-800 rounded-lg shadow-2xl border border-gray-300 dark:border-gray-600 w-96 max-h-[80vh] overflow-y-auto\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700\">\r\n        <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white\">\r\n          Performance Monitor\r\n        </h3>\r\n        <div className=\"flex items-center space-x-2\">\r\n          <button\r\n            onClick={toggleMonitoring}\r\n            className={`px-3 py-1 rounded text-sm font-medium transition-colors ${\r\n              state.isMonitoring\r\n                ? 'bg-red-500 hover:bg-red-600 text-white'\r\n                : 'bg-green-500 hover:bg-green-600 text-white'\r\n            }`}\r\n          >\r\n            {state.isMonitoring ? 'Stop' : 'Start'}\r\n          </button>\r\n          <button\r\n            onClick={toggleDashboard}\r\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200\"\r\n          >\r\n            âœ•\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"p-4 space-y-4\">\r\n        {/* Service Container Status */}\r\n        {state.containerStatus && (\r\n          <div className=\"bg-gray-50 dark:bg-gray-700 rounded-lg p-3\">\r\n            <h4 className=\"font-medium text-gray-900 dark:text-white mb-2\">Service Status</h4>\r\n            <div className=\"grid grid-cols-2 gap-2 text-sm\">\r\n              {Object.entries(state.containerStatus).map(([key, value]) => (\r\n                <div key={key} className=\"flex justify-between\">\r\n                  <span className=\"text-gray-600 dark:text-gray-300\">\r\n                    {key.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase())}:\r\n                  </span>\r\n                  <span className={typeof value === 'boolean' ? (value ? 'text-green-500' : 'text-red-500') : 'text-gray-900 dark:text-white'}>\r\n                    {typeof value === 'boolean' ? (value ? 'âœ“' : 'âœ—') : value}\r\n                  </span>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Performance Stats */}\r\n        {state.stats && (\r\n          <div className=\"space-y-3\">\r\n            {/* Audio Performance */}\r\n            <div className=\"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-3\">\r\n              <h4 className=\"font-medium text-blue-900 dark:text-blue-100 mb-2\">Audio Performance</h4>\r\n              <div className=\"space-y-1 text-sm\">\r\n                <div className=\"flex justify-between\">\r\n                  <span>Average Latency:</span>\r\n                  <span className={getLatencyColor(state.stats.audioPerformance.averageLatency)}>\r\n                    {state.stats.audioPerformance.averageLatency.toFixed(0)}ms\r\n                  </span>\r\n                </div>\r\n                <div className=\"flex justify-between\">\r\n                  <span>Measurements:</span>\r\n                  <span>{state.stats.audioPerformance.totalMeasurements}</span>\r\n                </div>\r\n                <div className=\"flex justify-between\">\r\n                  <span>Score:</span>\r\n                  <span className={getScoreColor(state.stats.audioPerformance.performanceScore)}>\r\n                    {state.stats.audioPerformance.performanceScore.toFixed(1)}\r\n                  </span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* API Performance */}\r\n            <div className=\"bg-green-50 dark:bg-green-900/20 rounded-lg p-3\">\r\n              <h4 className=\"font-medium text-green-900 dark:text-green-100 mb-2\">API Performance</h4>\r\n              <div className=\"space-y-1 text-sm\">\r\n                <div className=\"flex justify-between\">\r\n                  <span>Response Time:</span>\r\n                  <span>{state.stats.apiPerformance.averageResponseTime.toFixed(0)}ms</span>\r\n                </div>\r\n                <div className=\"flex justify-between\">\r\n                  <span>Total Calls:</span>\r\n                  <span>{state.stats.apiPerformance.totalCalls}</span>\r\n                </div>\r\n                <div className=\"flex justify-between\">\r\n                  <span>Error Rate:</span>\r\n                  <span className={state.stats.apiPerformance.errorRate > 5 ? 'text-red-500' : 'text-green-500'}>\r\n                    {(state.stats.apiPerformance.errorRate * 100).toFixed(1)}%\r\n                  </span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Memory Usage */}\r\n            <div className=\"bg-purple-50 dark:bg-purple-900/20 rounded-lg p-3\">\r\n              <h4 className=\"font-medium text-purple-900 dark:text-purple-100 mb-2\">Memory Usage</h4>\r\n              <div className=\"space-y-1 text-sm\">\r\n                <div className=\"flex justify-between\">\r\n                  <span>Current:</span>\r\n                  <span>{(state.stats.memory.currentUsage / 1024 / 1024).toFixed(1)} MB</span>\r\n                </div>\r\n                <div className=\"flex justify-between\">\r\n                  <span>Peak:</span>\r\n                  <span>{(state.stats.memory.peakUsage / 1024 / 1024).toFixed(1)} MB</span>\r\n                </div>\r\n                <div className=\"flex justify-between\">\r\n                  <span>Average:</span>\r\n                  <span>{(state.stats.memory.averageUsage / 1024 / 1024).toFixed(1)} MB</span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Audio Latency Chart */}\r\n        {state.audioLatencyHistory.length > 0 && (\r\n          <div className=\"bg-gray-50 dark:bg-gray-700 rounded-lg p-3\">\r\n            <h4 className=\"font-medium text-gray-900 dark:text-white mb-2\">Latency Trend</h4>\r\n            <div className=\"flex items-end space-x-1 h-16\">\r\n              {state.audioLatencyHistory.map((latency, index) => (\r\n                <div\r\n                  key={index}\r\n                  className=\"bg-blue-500 rounded-t\"\r\n                  style={{\r\n                    height: `${Math.min(100, (latency / 3000) * 100)}%`,\r\n                    width: '100%'\r\n                  }}\r\n                  title={`${latency.toFixed(0)}ms`}\r\n                />\r\n              ))}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Recent Events */}\r\n        {state.recentEvents.length > 0 && (\r\n          <div className=\"bg-gray-50 dark:bg-gray-700 rounded-lg p-3\">\r\n            <h4 className=\"font-medium text-gray-900 dark:text-white mb-2\">Recent Events</h4>\r\n            <div className=\"space-y-1\">\r\n              {state.recentEvents.map((event, index) => (\r\n                <div key={index} className=\"text-xs flex justify-between\">\r\n                  <span className={\r\n                    event.type === 'error' ? 'text-red-500' :\r\n                    event.type === 'warning' ? 'text-yellow-500' :\r\n                    'text-gray-600 dark:text-gray-300'\r\n                  }>\r\n                    {event.type}\r\n                  </span>\r\n                  <span className=\"text-gray-500\">\r\n                    {new Date(event.timestamp).toLocaleTimeString()}\r\n                  </span>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Actions */}\r\n        <div className=\"flex space-x-2\">\r\n          <button\r\n            onClick={generateReport}\r\n            className=\"flex-1 bg-blue-500 hover:bg-blue-600 text-white py-2 px-3 rounded text-sm font-medium transition-colors\"\r\n          >\r\n            Export Report\r\n          </button>\r\n          <button\r\n            onClick={clearMetrics}\r\n            className=\"flex-1 bg-gray-500 hover:bg-gray-600 text-white py-2 px-3 rounded text-sm font-medium transition-colors\"\r\n          >\r\n            Clear Data\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PerformanceDashboard;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\PracticeHistory.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'loadInterviews' and 'loadStorageInfo'. Either include them or remove the dependency array.","line":21,"column":6,"nodeType":"ArrayExpression","endLine":21,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [loadInterviews, loadStorageInfo]","fix":{"range":[910,912],"text":"[loadInterviews, loadStorageInfo]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'stopAllAudio'. Either include it or remove the dependency array.","line":28,"column":6,"nodeType":"ArrayExpression","endLine":28,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [stopAllAudio]","fix":{"range":[1013,1015],"text":"[stopAllAudio]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useRef, useCallback, memo } from 'react';\nimport { interviewStorage, InterviewRecord } from '../services/interviewStorage.ts';\nimport { webSpeechAPI } from '../services/webSpeechAPI.ts';\n\ninterface Props {\n  onBack: () => void;\n}\n\nconst InterviewHistory: React.FC<Props> = memo(({ onBack }) => {\n  const [interviews, setInterviews] = useState<InterviewRecord[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [selectedInterview, setSelectedInterview] = useState<InterviewRecord | null>(null);\n  const [storageInfo, setStorageInfo] = useState<{ used: number; quota: number }>({ used: 0, quota: 0 });\n  const [playingIndex, setPlayingIndex] = useState<number | null>(null);\n  const currentAudioRef = useRef<HTMLAudioElement | null>(null);\n  const audioUrlRef = useRef<string | null>(null);\n\n  useEffect(() => {\n    loadInterviews();\n    loadStorageInfo();\n  }, []);\n\n  // ì»´í¬ë„ŒíŠ¸ ì–¸ë§ˆìš´íŠ¸ ì‹œ ì˜¤ë””ì˜¤ ì¤‘ì§€\n  useEffect(() => {\n    return () => {\n      stopAllAudio();\n    };\n  }, []);\n\n  // selectedInterviewê°€ ë³€ê²½ë  ë•Œ ì˜¤ë””ì˜¤ ì¤‘ì§€\n  useEffect(() => {\n    stopAllAudio();\n  }, [selectedInterview, stopAllAudio]);\n\n  const stopAllAudio = useCallback(() => {\n    // TTS ì¤‘ì§€\n    webSpeechAPI.stopSpeaking();\n    \n    // HTML Audio ì¤‘ì§€\n    if (currentAudioRef.current) {\n      currentAudioRef.current.pause();\n      currentAudioRef.current.currentTime = 0;\n      currentAudioRef.current = null;\n    }\n    \n    // URL ì •ë¦¬\n    if (audioUrlRef.current) {\n      URL.revokeObjectURL(audioUrlRef.current);\n      audioUrlRef.current = null;\n    }\n    \n    setPlayingIndex(null);\n  }, []);\n\n  const loadInterviews = useCallback(async () => {\n    try {\n      setLoading(true);\n      const records = await interviewStorage.getAllInterviews();\n      setInterviews(records);\n    } catch (error) {\n      console.error('ë©´ì ‘ ê¸°ë¡ ë¡œë“œ ì‹¤íŒ¨:', error);\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  const loadStorageInfo = useCallback(async () => {\n    try {\n      const info = await interviewStorage.getStorageUsage();\n      setStorageInfo(info);\n    } catch (error) {\n      console.error('ì €ì¥ ê³µê°„ ì •ë³´ ë¡œë“œ ì‹¤íŒ¨:', error);\n    }\n  }, []);\n\n  const deleteInterview = useCallback(async (id: string) => {\n    if (window.confirm('ì´ ë©´ì ‘ ê¸°ë¡ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {\n      try {\n        await interviewStorage.deleteInterview(id);\n        await loadInterviews();\n        setSelectedInterview(null);\n        alert('ë©´ì ‘ ê¸°ë¡ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');\n      } catch (error) {\n        console.error('ë©´ì ‘ ê¸°ë¡ ì‚­ì œ ì‹¤íŒ¨:', error);\n        alert('ë©´ì ‘ ê¸°ë¡ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');\n      }\n    }\n  }, [loadInterviews]);\n\n  const formatDate = useCallback((date: Date) => {\n    return new Date(date).toLocaleString('ko-KR', {\n      year: 'numeric',\n      month: 'short',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  }, []);\n\n  const formatTime = useCallback((seconds: number) => {\n    const minutes = Math.floor(seconds / 60);\n    const remainingSeconds = seconds % 60;\n    return `${minutes}ë¶„ ${remainingSeconds}ì´ˆ`;\n  }, []);\n\n  const formatBytes = useCallback((bytes: number) => {\n    if (bytes === 0) return '0 Bytes';\n    const k = 1024;\n    const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\n  }, []);\n\n  const playAnswer = async (qa: any, index: number) => {\n    if (playingIndex === index) {\n      // í˜„ì¬ ì¬ìƒ ì¤‘ì¸ ê²½ìš° ì¤‘ì§€\n      stopAllAudio();\n      return;\n    }\n\n    try {\n      // ì´ì „ ì˜¤ë””ì˜¤ ì¤‘ì§€\n      stopAllAudio();\n      \n      setPlayingIndex(index);\n      \n      // ì‹¤ì œ ë…¹ìŒëœ ìŒì„±ì´ ìˆìœ¼ë©´ ê·¸ê²ƒì„ ì¬ìƒ, ì—†ìœ¼ë©´ TTS ì‚¬ìš©\n      if (qa.audioBlob && qa.audioBlob.size > 0) {\n        try {\n          // ì˜¤ë””ì˜¤ blob ìœ íš¨ì„± ê²€ì‚¬\n          if (!(qa.audioBlob instanceof Blob)) {\n            console.warn('ì˜¤ë””ì˜¤ ë°ì´í„°ê°€ Blob í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤. TTSë¡œ ëŒ€ì²´í•©ë‹ˆë‹¤.');\n            await playTTS(qa.answer);\n            return;\n          }\n\n          // ì§€ì›ë˜ëŠ” ì˜¤ë””ì˜¤ íƒ€ì…ì¸ì§€ í™•ì¸\n          const audioType = qa.audioBlob.type;\n          if (!audioType || !audioType.startsWith('audio/')) {\n            console.warn('ì§€ì›ë˜ì§€ ì•ŠëŠ” ì˜¤ë””ì˜¤ í˜•ì‹ì…ë‹ˆë‹¤:', audioType, 'TTSë¡œ ëŒ€ì²´í•©ë‹ˆë‹¤.');\n            await playTTS(qa.answer);\n            return;\n          }\n\n          const audio = new Audio();\n          const audioUrl = URL.createObjectURL(qa.audioBlob);\n          \n          // refì— ì €ì¥\n          currentAudioRef.current = audio;\n          audioUrlRef.current = audioUrl;\n          \n          // ì˜¤ë””ì˜¤ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •\n          const cleanup = () => {\n            setPlayingIndex(null);\n            if (audioUrlRef.current) {\n              URL.revokeObjectURL(audioUrlRef.current);\n              audioUrlRef.current = null;\n            }\n            currentAudioRef.current = null;\n          };\n          \n          audio.onended = cleanup;\n          audio.onerror = (e) => {\n            console.error(`[InterviewHistory] ì˜¤ë””ì˜¤ ì¬ìƒ ì‹¤íŒ¨ (ë‹µë³€ ${index + 1}):`, e);\n            console.log(`[InterviewHistory] ì˜¤ë””ì˜¤ blob ì •ë³´:`, {\n              size: qa.audioBlob?.size || 'undefined',\n              type: qa.audioBlob?.type || 'undefined',\n              url: audioUrl,\n              hasBlob: !!qa.audioBlob,\n              blobConstructor: qa.audioBlob?.constructor?.name\n            });\n            \n            // ì¦‰ì‹œ ì •ë¦¬í•˜ê³  TTSë¡œ ëŒ€ì²´\n            try {\n              cleanup();\n              console.log(`[InterviewHistory] TTSë¡œ ëŒ€ì²´ ì¬ìƒ ì‹œì‘: \"${qa.answer.substring(0, 50)}...\"`);\n              playTTS(qa.answer).catch(ttsError => {\n                console.error('[InterviewHistory] TTS ì¬ìƒë„ ì‹¤íŒ¨:', ttsError);\n                setPlayingIndex(null);\n              });\n            } catch (fallbackError) {\n              console.error('[InterviewHistory] í´ë°± ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜:', fallbackError);\n              setPlayingIndex(null);\n            }\n          };\n\n          // íƒ€ì„ì•„ì›ƒ ì„¤ì • (5ì´ˆ í›„ì—ë„ ë¡œë“œë˜ì§€ ì•Šìœ¼ë©´ TTSë¡œ ëŒ€ì²´)\n          const loadTimeout = setTimeout(() => {\n            console.warn('ì˜¤ë””ì˜¤ ë¡œë“œ ì‹œê°„ ì´ˆê³¼, TTSë¡œ ëŒ€ì²´í•©ë‹ˆë‹¤.');\n            cleanup();\n            playTTS(qa.answer);\n          }, 5000);\n          \n          audio.oncanplaythrough = () => {\n            clearTimeout(loadTimeout);\n            // ğŸ”§ FIX: Check paused state before calling play() to prevent duplicate sounds\n            if (audio.paused) {\n              console.log('[DEBUG] ğŸ”Š PracticeHistory: ì¬ìƒ ì‹œì‘ (paused=true)');\n              audio.play().catch((e) => {\n                console.error('ì˜¤ë””ì˜¤ play() ì‹¤íŒ¨:', e);\n                cleanup();\n                playTTS(qa.answer);\n              });\n            } else {\n              console.log('[DEBUG] ğŸš« PracticeHistory: ì´ë¯¸ ì¬ìƒ ì¤‘ - ìŠ¤í‚¨');\n            }\n          };\n\n          audio.onloadeddata = () => {\n            clearTimeout(loadTimeout);\n          };\n          \n          audio.src = audioUrl;\n          audio.load(); // ëª…ì‹œì ìœ¼ë¡œ ë¡œë“œ\n        } catch (error) {\n          console.error('ì˜¤ë””ì˜¤ ê°ì²´ ìƒì„± ì‹¤íŒ¨:', error);\n          await playTTS(qa.answer);\n        }\n      } else {\n        // ë…¹ìŒëœ ìŒì„±ì´ ì—†ìœ¼ë©´ TTS ì‚¬ìš©\n        await playTTS(qa.answer);\n      }\n    } catch (error) {\n      console.error('ë‹µë³€ ì¬ìƒ ì˜¤ë¥˜:', error);\n      setPlayingIndex(null);\n    }\n  };\n\n  const playTTS = async (answer: string) => {\n    try {\n      console.log('[InterviewHistory] TTS ì¬ìƒ ì‹œì‘:', {\n        textLength: answer.length,\n        preview: answer.substring(0, 100),\n        ttsSupported: webSpeechAPI.isTTSSupported()\n      });\n      \n      if (!webSpeechAPI.isTTSSupported()) {\n        throw new Error('ë¸Œë¼ìš°ì €ì—ì„œ TTSë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');\n      }\n      \n      await webSpeechAPI.speak(answer, 'ko-KR');\n      console.log('[InterviewHistory] TTS ì¬ìƒ ì™„ë£Œ');\n      setPlayingIndex(null);\n    } catch (error) {\n      console.error('[InterviewHistory] TTS ì¬ìƒ ì˜¤ë¥˜:', error);\n      alert('ìŒì„± ì¬ìƒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì €ì—ì„œ ìŒì„± í•©ì„±ì„ ì§€ì›í•˜ì§€ ì•Šê±°ë‚˜ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');\n      setPlayingIndex(null);\n    }\n  };\n\n  if (selectedInterview) {\n    return (\n      <div style={{\n        minHeight: '100vh',\n        background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',\n        color: 'white',\n        fontFamily: 'Arial, sans-serif',\n        padding: '20px'\n      }}>\n        <div style={{\n          background: 'rgba(255,255,255,0.95)',\n          padding: '40px',\n          borderRadius: '15px',\n          boxShadow: '0 10px 30px rgba(0,0,0,0.2)',\n          maxWidth: '900px',\n          margin: '0 auto',\n          color: '#333'\n        }}>\n          <div style={{\n            display: 'flex',\n            justifyContent: 'space-between',\n            alignItems: 'center',\n            marginBottom: '30px',\n            paddingBottom: '20px',\n            borderBottom: '2px solid #f0f0f0'\n          }}>\n            <h2 style={{ margin: 0, fontSize: '1.8rem' }}>\n              ğŸ“ ë©´ì ‘ ê¸°ë¡ ìƒì„¸\n            </h2>\n            <div style={{ display: 'flex', gap: '10px' }}>\n              <button\n                onClick={() => deleteInterview(selectedInterview.id)}\n                style={{\n                  padding: '10px 20px',\n                  background: '#ff4757',\n                  color: 'white',\n                  border: 'none',\n                  borderRadius: '8px',\n                  fontSize: '14px',\n                  cursor: 'pointer'\n                }}\n              >\n                ğŸ—‘ï¸ ì‚­ì œ\n              </button>\n              <button\n                onClick={() => {\n                  stopAllAudio();\n                  setSelectedInterview(null);\n                }}\n                style={{\n                  padding: '10px 20px',\n                  background: '#666',\n                  color: 'white',\n                  border: 'none',\n                  borderRadius: '8px',\n                  fontSize: '14px',\n                  cursor: 'pointer'\n                }}\n              >\n                â† ëª©ë¡ìœ¼ë¡œ\n              </button>\n            </div>\n          </div>\n\n          {/* ë©´ì ‘ ê¸°ë³¸ ì •ë³´ */}\n          <div style={{\n            background: '#f8f9fa',\n            padding: '20px',\n            borderRadius: '10px',\n            marginBottom: '25px'\n          }}>\n            <h3 style={{ margin: '0 0 15px 0', color: '#495057' }}>ğŸ¢ ë©´ì ‘ ì •ë³´</h3>\n            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(250px, 1fr))', gap: '15px' }}>\n              <div><strong>íšŒì‚¬:</strong> {selectedInterview.config.company}</div>\n              <div><strong>ì§ë¬´:</strong> {selectedInterview.config.position}</div>\n              <div><strong>ê²½ë ¥:</strong> {selectedInterview.config.experience}</div>\n              <div><strong>ë©´ì ‘ ë‚ ì§œ:</strong> {formatDate(selectedInterview.timestamp)}</div>\n              {selectedInterview.config.companyType && (\n                <div><strong>íšŒì‚¬ ê·œëª¨:</strong> {selectedInterview.config.companyType}</div>\n              )}\n              {selectedInterview.config.industryType && (\n                <div><strong>ì—…ê³„:</strong> {selectedInterview.config.industryType}</div>\n              )}\n            </div>\n          </div>\n\n          {/* ë©´ì ‘ í†µê³„ */}\n          <div style={{\n            background: '#e8f5e8',\n            padding: '20px',\n            borderRadius: '10px',\n            marginBottom: '25px'\n          }}>\n            <h3 style={{ margin: '0 0 15px 0', color: '#2d5016' }}>ğŸ“Š ë©´ì ‘ í†µê³„</h3>\n            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '15px' }}>\n              <div><strong>ì‹¤ì œ ë©´ì ‘ì‹œê°„:</strong> {formatTime(selectedInterview.statistics.actualInterviewTime || selectedInterview.statistics.totalTime - (selectedInterview.statistics.totalFeedbackTime || 0))}</div>\n              <div><strong>ë‹µë³€ ì‹œê°„:</strong> {formatTime(selectedInterview.statistics.totalAnswerTime)}</div>\n              <div><strong>ì‚¬ê³  ì‹œê°„:</strong> {formatTime(selectedInterview.statistics.totalThinkingTime)} <span style={{fontSize: '0.8rem', color: '#666'}}>(ì§ˆë¬¸ ë“£ê³  ìƒê°í•˜ëŠ” ì‹œê°„)</span></div>\n              {selectedInterview.statistics.totalFeedbackTime && (\n                <div><strong>ë©´ì ‘ê´€ í”¼ë“œë°±:</strong> {formatTime(selectedInterview.statistics.totalFeedbackTime)}</div>\n              )}\n              <div><strong>ì§ˆë¬¸ ê°œìˆ˜:</strong> {selectedInterview.statistics.questionCount}ê°œ</div>\n            </div>\n          </div>\n\n          {/* ì§ˆë¬¸ê³¼ ë‹µë³€ */}\n          <div>\n            <h3 style={{ margin: '0 0 20px 0', color: '#333' }}>ğŸ’¬ ì§ˆë¬¸ê³¼ ë‹µë³€</h3>\n            {selectedInterview.questionsAndAnswers.map((qa, index) => (\n              <div key={index} style={{\n                background: 'white',\n                border: '1px solid #e9ecef',\n                borderRadius: '10px',\n                padding: '20px',\n                marginBottom: '20px'\n              }}>\n                <div style={{\n                  background: '#667eea',\n                  color: 'white',\n                  padding: '10px 15px',\n                  borderRadius: '8px',\n                  marginBottom: '15px',\n                  fontSize: '16px',\n                  fontWeight: '500'\n                }}>\n                  Q{index + 1}. {qa.question}\n                </div>\n                <div style={{\n                  background: '#f8f9fc',\n                  padding: '15px',\n                  borderRadius: '8px',\n                  borderLeft: '4px solid #4CAF50',\n                  lineHeight: '1.6'\n                }}>\n                  <div style={{ marginBottom: '10px' }}>\n                    <strong>ë‹µë³€:</strong> {qa.answer}\n                  </div>\n                  <div style={{ \n                    display: 'flex', \n                    justifyContent: 'space-between', \n                    alignItems: 'center',\n                    marginTop: '15px' \n                  }}>\n                    <div style={{ fontSize: '0.9rem', color: '#666' }}>\n                      <strong>ë‹µë³€ ì‹œê°„:</strong> {formatTime(qa.answerTime)}\n                    </div>\n                    <button\n                      onClick={() => playAnswer(qa, index)}\n                      style={{\n                        padding: '8px 16px',\n                        background: playingIndex === index ? '#ff4757' : (qa.audioBlob ? '#2196F3' : '#4CAF50'),\n                        color: 'white',\n                        border: 'none',\n                        borderRadius: '6px',\n                        fontSize: '14px',\n                        cursor: 'pointer',\n                        display: 'flex',\n                        alignItems: 'center',\n                        gap: '5px'\n                      }}\n                    >\n                      {playingIndex === index ? (\n                        <>â¹ï¸ ì¤‘ì§€</>\n                      ) : qa.audioBlob ? (\n                        <>ğŸµ ë‚´ ëª©ì†Œë¦¬ ë“£ê¸°</>\n                      ) : (\n                        <>ğŸ”Š TTSë¡œ ë“£ê¸°</>\n                      )}\n                    </button>\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div style={{\n      minHeight: '100vh',\n      background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',\n      color: 'white',\n      fontFamily: 'Arial, sans-serif',\n      padding: '20px'\n    }}>\n      <div style={{\n        background: 'rgba(255,255,255,0.95)',\n        padding: '40px',\n        borderRadius: '15px',\n        boxShadow: '0 10px 30px rgba(0,0,0,0.2)',\n        maxWidth: '1200px',\n        margin: '0 auto',\n        color: '#333'\n      }}>\n        <div style={{\n          display: 'flex',\n          justifyContent: 'space-between',\n          alignItems: 'center',\n          marginBottom: '30px',\n          paddingBottom: '20px',\n          borderBottom: '2px solid #f0f0f0'\n        }}>\n          <h2 style={{ margin: 0, fontSize: '1.8rem' }}>\n            ğŸ“š ë©´ì ‘ ê¸°ë¡\n          </h2>\n          <button\n            onClick={() => {\n              stopAllAudio();\n              onBack();\n            }}\n            style={{\n              padding: '12px 24px',\n              background: '#667eea',\n              color: 'white',\n              border: 'none',\n              borderRadius: '8px',\n              fontSize: '16px',\n              cursor: 'pointer'\n            }}\n          >\n            â† ë©”ì¸ìœ¼ë¡œ\n          </button>\n        </div>\n\n        {/* ì €ì¥ ê³µê°„ ì •ë³´ */}\n        {storageInfo.quota > 0 && (\n          <div style={{\n            background: '#fff3cd',\n            padding: '15px',\n            borderRadius: '8px',\n            marginBottom: '25px',\n            fontSize: '0.9rem'\n          }}>\n            ğŸ’¾ ì €ì¥ ê³µê°„: {formatBytes(storageInfo.used)} / {formatBytes(storageInfo.quota)} ì‚¬ìš© ì¤‘\n            ({((storageInfo.used / storageInfo.quota) * 100).toFixed(1)}%)\n          </div>\n        )}\n\n        {loading ? (\n          <div style={{ textAlign: 'center', padding: '50px', fontSize: '1.2rem', color: '#666' }}>\n            ë©´ì ‘ ê¸°ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...\n          </div>\n        ) : interviews.length === 0 ? (\n          <div style={{ textAlign: 'center', padding: '50px' }}>\n            <div style={{ fontSize: '4rem', marginBottom: '20px' }}>ğŸ“</div>\n            <div style={{ fontSize: '1.2rem', color: '#666', marginBottom: '10px' }}>\n              ì•„ì§ ì €ì¥ëœ ë©´ì ‘ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.\n            </div>\n            <div style={{ fontSize: '1rem', color: '#999' }}>\n              ë©´ì ‘ì„ ì™„ë£Œí•˜ë©´ ì—¬ê¸°ì— ê¸°ë¡ì´ ì €ì¥ë©ë‹ˆë‹¤.\n            </div>\n          </div>\n        ) : (\n          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(350px, 1fr))', gap: '20px' }}>\n            {interviews.map((interview) => (\n              <div\n                key={interview.id}\n                onClick={() => setSelectedInterview(interview)}\n                style={{\n                  background: 'white',\n                  border: '1px solid #e9ecef',\n                  borderRadius: '12px',\n                  padding: '20px',\n                  cursor: 'pointer',\n                  transition: 'transform 0.2s, box-shadow 0.2s',\n                  boxShadow: '0 2px 8px rgba(0,0,0,0.1)'\n                }}\n                onMouseEnter={(e) => {\n                  e.currentTarget.style.transform = 'translateY(-3px)';\n                  e.currentTarget.style.boxShadow = '0 8px 25px rgba(0,0,0,0.15)';\n                }}\n                onMouseLeave={(e) => {\n                  e.currentTarget.style.transform = 'translateY(0)';\n                  e.currentTarget.style.boxShadow = '0 2px 8px rgba(0,0,0,0.1)';\n                }}\n              >\n                <div style={{\n                  display: 'flex',\n                  justifyContent: 'space-between',\n                  alignItems: 'flex-start',\n                  marginBottom: '15px'\n                }}>\n                  <div>\n                    <h3 style={{ margin: '0 0 5px 0', fontSize: '1.3rem', fontWeight: 'bold' }}>\n                      {interview.config.company}\n                    </h3>\n                    <div style={{ color: '#666', fontSize: '1rem' }}>\n                      {interview.config.position}\n                    </div>\n                  </div>\n                  <div style={{\n                    background: '#e8f5e8',\n                    color: '#2d5016',\n                    padding: '4px 10px',\n                    borderRadius: '12px',\n                    fontSize: '0.8rem',\n                    fontWeight: '600'\n                  }}>\n                    {interview.config.experience}\n                  </div>\n                </div>\n\n                <div style={{ marginBottom: '15px', fontSize: '0.9rem', color: '#666' }}>\n                  ğŸ“… {formatDate(interview.timestamp)}\n                </div>\n\n                <div style={{\n                  display: 'grid',\n                  gridTemplateColumns: '1fr 1fr',\n                  gap: '10px',\n                  marginBottom: '15px',\n                  fontSize: '0.85rem'\n                }}>\n                  <div><strong>ì‹¤ì œ ë©´ì ‘:</strong> {formatTime(interview.statistics.actualInterviewTime || interview.statistics.totalTime - (interview.statistics.totalFeedbackTime || 0))}</div>\n                  <div><strong>ì§ˆë¬¸ ìˆ˜:</strong> {interview.statistics.questionCount}ê°œ</div>\n                  <div><strong>ë‹µë³€ ì‹œê°„:</strong> {formatTime(interview.statistics.totalAnswerTime)}</div>\n                  <div><strong>ì‚¬ê³  ì‹œê°„:</strong> {formatTime(interview.statistics.totalThinkingTime)}</div>\n                </div>\n\n                <div style={{\n                  textAlign: 'center',\n                  color: '#667eea',\n                  fontSize: '0.9rem',\n                  fontWeight: '600'\n                }}>\n                  í´ë¦­í•˜ì—¬ ìƒì„¸ ë³´ê¸° â†’\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n});\n\nexport default InterviewHistory;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\PracticeRoom.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\PracticeSetup.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\ProgressDashboard.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadProgressData'. Either include it or remove the dependency array.","line":37,"column":6,"nodeType":"ArrayExpression","endLine":37,"endColumn":14,"suggestions":[{"desc":"Update the dependencies array to be: [loadProgressData, userId]","fix":{"range":[1098,1106],"text":"[loadProgressData, userId]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, memo } from 'react';\r\nimport { progressManagementService } from '../services/progressManagement';\r\n\r\ninterface ProgressDashboardProps {\r\n  userId: string;\r\n}\r\n\r\ninterface LevelProgress {\r\n  level: number;\r\n  totalStages: number;\r\n  completedStages: number;\r\n  averageCompletionRate: number;\r\n  totalTimeSpent: number;\r\n  overallAccuracy: number;\r\n  weakStages: string[];\r\n  strongStages: string[];\r\n}\r\n\r\ninterface OverallProgress {\r\n  totalLevels: number;\r\n  completedLevels: number;\r\n  currentLevel: number;\r\n  totalTimeSpent: number;\r\n  overallAccuracy: number;\r\n  totalSentencesStudied: number;\r\n  achievementBadges: string[];\r\n}\r\n\r\nconst ProgressDashboard: React.FC<ProgressDashboardProps> = memo(({ userId }) => {\r\n  const [overallProgress, setOverallProgress] = useState<OverallProgress | null>(null);\r\n  const [levelProgresses, setLevelProgresses] = useState<LevelProgress[]>([]);\r\n  const [selectedLevel, setSelectedLevel] = useState<number>(1);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    loadProgressData();\r\n  }, [userId]);\r\n\r\n  const loadProgressData = async () => {\r\n    setIsLoading(true);\r\n    try {\r\n      // ì „ì²´ ì§„ë„ì™€ ë ˆë²¨ë³„ ì§„ë„ë¥¼ ë³‘ë ¬ë¡œ ë¡œë“œ\r\n      const [overall, ...levels] = await Promise.all([\r\n        progressManagementService.getOverallProgress(userId),\r\n        ...Array.from({length: 10}, (_, i) => \r\n          progressManagementService.getLevelProgress(userId, i + 1)\r\n        )\r\n      ]);\r\n      \r\n      setOverallProgress(overall);\r\n      setLevelProgresses(levels);\r\n      setSelectedLevel(overall.currentLevel);\r\n      \r\n    } catch (error) {\r\n      console.error('ì§„ë„ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const formatTime = (minutes: number): string => {\r\n    if (minutes < 60) {\r\n      return `${Math.round(minutes)}ë¶„`;\r\n    } else {\r\n      const hours = Math.floor(minutes / 60);\r\n      const remainingMinutes = Math.round(minutes % 60);\r\n      return `${hours}ì‹œê°„ ${remainingMinutes}ë¶„`;\r\n    }\r\n  };\r\n\r\n  const formatPercentage = (value: number): string => {\r\n    return `${Math.round(value * 100)}%`;\r\n  };\r\n\r\n  const getLevelStatusColor = (completionRate: number, accuracy: number): string => {\r\n    if (completionRate >= 0.8 && accuracy >= 0.9) return 'bg-green-500';\r\n    if (completionRate >= 0.6 && accuracy >= 0.7) return 'bg-blue-500';\r\n    if (completionRate >= 0.3) return 'bg-yellow-500';\r\n    return 'bg-gray-400';\r\n  };\r\n\r\n  const getLevelTitle = (level: number): string => {\r\n    const titles = {\r\n      1: 'ê¸°ì´ˆ í‘œí˜„',\r\n      2: 'ê¸°ë³¸ íŒ¨í„´',\r\n      3: 'ê³ ê¸‰ ë¬¸ë²•',\r\n      4: 'ë¹„ì¦ˆë‹ˆìŠ¤',\r\n      5: 'í•™ìˆ  ì—°êµ¬',\r\n      6: 'ì‹¤ìš© ì˜ì–´',\r\n      7: 'ë¹„ì¦ˆë‹ˆìŠ¤ ì˜ì–´',\r\n      8: 'ê³ ê¸‰ ë‹´í™”',\r\n      9: 'ì „ë¬¸ê°€ ë‹´í™”',\r\n      10: 'ì›ì–´ë¯¼ ìˆ˜ì¤€'\r\n    };\r\n    return titles[level as keyof typeof titles] || `Level ${level}`;\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center min-h-64\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4\"></div>\r\n          <p className=\"text-gray-600\">ì§„ë„ ë°ì´í„°ë¥¼ ë¡œë“œí•˜ê³  ìˆìŠµë‹ˆë‹¤...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!overallProgress) {\r\n    return (\r\n      <div className=\"text-center py-12\">\r\n        <h3 className=\"text-lg font-medium text-gray-900 mb-2\">ì§„ë„ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤</h3>\r\n        <p className=\"text-gray-600\">í•™ìŠµì„ ì‹œì‘í•˜ë©´ ì§„ë„ë¥¼ ì¶”ì í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const selectedLevelData = levelProgresses.find(lp => lp.level === selectedLevel);\r\n\r\n  return (\r\n    <div className=\"max-w-6xl mx-auto p-6\">\r\n      <div className=\"mb-6\">\r\n        <h2 className=\"text-2xl font-bold text-gray-900 mb-2\">ğŸ“Š í•™ìŠµ ì§„ë„ ê´€ë¦¬</h2>\r\n        <p className=\"text-gray-600\">ì „ì²´ í•™ìŠµ í˜„í™©ê³¼ ë ˆë²¨ë³„ ìƒì„¸ ì§„ë„ë¥¼ í™•ì¸í•˜ì„¸ìš”</p>\r\n      </div>\r\n\r\n      {/* ì „ì²´ ì§„ë„ ìš”ì•½ */}\r\n      <div className=\"bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg p-6 mb-8\">\r\n        <h3 className=\"text-lg font-semibold mb-4\">ğŸ¯ ì „ì²´ í•™ìŠµ í˜„í™©</h3>\r\n        \r\n        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6\">\r\n          <div className=\"text-center\">\r\n            <div className=\"text-2xl font-bold\">{overallProgress.currentLevel}</div>\r\n            <div className=\"text-sm opacity-90\">í˜„ì¬ ë ˆë²¨</div>\r\n          </div>\r\n          <div className=\"text-center\">\r\n            <div className=\"text-2xl font-bold\">{overallProgress.completedLevels}/{overallProgress.totalLevels}</div>\r\n            <div className=\"text-sm opacity-90\">ì™„ë£Œ ë ˆë²¨</div>\r\n          </div>\r\n          <div className=\"text-center\">\r\n            <div className=\"text-2xl font-bold\">{formatTime(overallProgress.totalTimeSpent)}</div>\r\n            <div className=\"text-sm opacity-90\">ì´ í•™ìŠµ ì‹œê°„</div>\r\n          </div>\r\n          <div className=\"text-center\">\r\n            <div className=\"text-2xl font-bold\">{formatPercentage(overallProgress.overallAccuracy)}</div>\r\n            <div className=\"text-sm opacity-90\">ì „ì²´ ì •í™•ë„</div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* ì„±ì·¨ ë°°ì§€ */}\r\n        {overallProgress.achievementBadges.length > 0 && (\r\n          <div>\r\n            <h4 className=\"font-medium mb-3\">ğŸ† íšë“í•œ ë°°ì§€</h4>\r\n            <div className=\"flex flex-wrap gap-2\">\r\n              {overallProgress.achievementBadges.map((badge, index) => (\r\n                <span key={index} className=\"px-3 py-1 bg-white bg-opacity-20 rounded-full text-sm\">\r\n                  {badge}\r\n                </span>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* ë ˆë²¨ë³„ ì§„ë„ */}\r\n      <div className=\"bg-white border border-gray-200 rounded-lg p-6 mb-8\">\r\n        <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">ğŸ“š ë ˆë²¨ë³„ ì§„ë„</h3>\r\n        \r\n        <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4 mb-6\">\r\n          {levelProgresses.map((levelProgress) => (\r\n            <div\r\n              key={levelProgress.level}\r\n              onClick={() => setSelectedLevel(levelProgress.level)}\r\n              className={`cursor-pointer border-2 rounded-lg p-4 transition-all ${\r\n                selectedLevel === levelProgress.level\r\n                  ? 'border-blue-500 bg-blue-50'\r\n                  : 'border-gray-200 hover:border-gray-300'\r\n              }`}\r\n            >\r\n              <div className=\"text-center\">\r\n                <div className={`w-8 h-8 rounded-full mx-auto mb-2 flex items-center justify-center text-white text-sm font-bold ${\r\n                  getLevelStatusColor(levelProgress.averageCompletionRate, levelProgress.overallAccuracy)\r\n                }`}>\r\n                  L{levelProgress.level}\r\n                </div>\r\n                <div className=\"text-sm font-medium text-gray-900\">\r\n                  {getLevelTitle(levelProgress.level)}\r\n                </div>\r\n                <div className=\"text-xs text-gray-600 mt-1\">\r\n                  {levelProgress.completedStages}/{levelProgress.totalStages} ì™„ë£Œ\r\n                </div>\r\n                <div className=\"text-xs text-gray-600\">\r\n                  {formatPercentage(levelProgress.averageCompletionRate)}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      {/* ì„ íƒëœ ë ˆë²¨ ìƒì„¸ ì •ë³´ */}\r\n      {selectedLevelData && (\r\n        <div className=\"bg-white border border-gray-200 rounded-lg p-6\">\r\n          <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">\r\n            ğŸ“– Level {selectedLevel} - {getLevelTitle(selectedLevel)} ìƒì„¸ í˜„í™©\r\n          </h3>\r\n          \r\n          {/* ìƒì„¸ ë©”íŠ¸ë¦­ */}\r\n          <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6\">\r\n            <div className=\"bg-gray-50 rounded-lg p-4 text-center\">\r\n              <div className=\"text-2xl font-bold text-blue-600\">\r\n                {selectedLevelData.completedStages}/{selectedLevelData.totalStages}\r\n              </div>\r\n              <div className=\"text-sm text-gray-600\">ì™„ë£Œ ìŠ¤í…Œì´ì§€</div>\r\n            </div>\r\n            \r\n            <div className=\"bg-gray-50 rounded-lg p-4 text-center\">\r\n              <div className=\"text-2xl font-bold text-green-600\">\r\n                {formatPercentage(selectedLevelData.averageCompletionRate)}\r\n              </div>\r\n              <div className=\"text-sm text-gray-600\">í‰ê·  ì™„ë£Œìœ¨</div>\r\n            </div>\r\n            \r\n            <div className=\"bg-gray-50 rounded-lg p-4 text-center\">\r\n              <div className=\"text-2xl font-bold text-purple-600\">\r\n                {formatPercentage(selectedLevelData.overallAccuracy)}\r\n              </div>\r\n              <div className=\"text-sm text-gray-600\">ì „ì²´ ì •í™•ë„</div>\r\n            </div>\r\n            \r\n            <div className=\"bg-gray-50 rounded-lg p-4 text-center\">\r\n              <div className=\"text-2xl font-bold text-orange-600\">\r\n                {formatTime(selectedLevelData.totalTimeSpent)}\r\n              </div>\r\n              <div className=\"text-sm text-gray-600\">í•™ìŠµ ì‹œê°„</div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* ì§„ë„ ë°” */}\r\n          <div className=\"mb-6\">\r\n            <div className=\"flex justify-between text-sm text-gray-600 mb-2\">\r\n              <span>ë ˆë²¨ ì§„í–‰ë„</span>\r\n              <span>{formatPercentage(selectedLevelData.completedStages / selectedLevelData.totalStages)}</span>\r\n            </div>\r\n            <div className=\"w-full bg-gray-200 rounded-full h-3\">\r\n              <div \r\n                className=\"bg-blue-600 h-3 rounded-full transition-all duration-300\"\r\n                style={{ width: `${(selectedLevelData.completedStages / selectedLevelData.totalStages) * 100}%` }}\r\n              ></div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* ì·¨ì•½ì  ë° ê°•ì  */}\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n            {/* ì·¨ì•½í•œ ìŠ¤í…Œì´ì§€ */}\r\n            <div>\r\n              <h4 className=\"font-medium text-gray-900 mb-3\">âš ï¸ ì§‘ì¤‘ í•„ìš” ìŠ¤í…Œì´ì§€</h4>\r\n              {selectedLevelData.weakStages.length > 0 ? (\r\n                <div className=\"space-y-2\">\r\n                  {selectedLevelData.weakStages.map((stageId, index) => (\r\n                    <div key={index} className=\"flex items-center gap-3 p-3 bg-red-50 border border-red-200 rounded-lg\">\r\n                      <span className=\"w-2 h-2 bg-red-500 rounded-full\"></span>\r\n                      <span className=\"text-sm text-red-800\">{stageId}</span>\r\n                      <button className=\"ml-auto text-xs text-red-600 hover:text-red-800\">\r\n                        ë³µìŠµí•˜ê¸°\r\n                      </button>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              ) : (\r\n                <p className=\"text-sm text-gray-600 italic\">ì·¨ì•½í•œ ìŠ¤í…Œì´ì§€ê°€ ì—†ìŠµë‹ˆë‹¤! ğŸ‰</p>\r\n              )}\r\n            </div>\r\n\r\n            {/* ê°•ì  ìŠ¤í…Œì´ì§€ */}\r\n            <div>\r\n              <h4 className=\"font-medium text-gray-900 mb-3\">âœ¨ ì˜í•˜ëŠ” ìŠ¤í…Œì´ì§€</h4>\r\n              {selectedLevelData.strongStages.length > 0 ? (\r\n                <div className=\"space-y-2\">\r\n                  {selectedLevelData.strongStages.map((stageId, index) => (\r\n                    <div key={index} className=\"flex items-center gap-3 p-3 bg-green-50 border border-green-200 rounded-lg\">\r\n                      <span className=\"w-2 h-2 bg-green-500 rounded-full\"></span>\r\n                      <span className=\"text-sm text-green-800\">{stageId}</span>\r\n                      <span className=\"ml-auto text-xs text-green-600\">ë§ˆìŠ¤í„°!</span>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              ) : (\r\n                <p className=\"text-sm text-gray-600 italic\">ì•„ì§ ë§ˆìŠ¤í„°í•œ ìŠ¤í…Œì´ì§€ê°€ ì—†ìŠµë‹ˆë‹¤.</p>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n});\r\n\r\nexport default ProgressDashboard;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\ProgressIndicator.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'status?.step'. Either include it or remove the dependency array.","line":96,"column":6,"nodeType":"ArrayExpression","endLine":96,"endColumn":59,"suggestions":[{"desc":"Update the dependencies array to be: [onComplete, onError, operation, stepMessages, speak, status?.step]","fix":{"range":[3372,3425],"text":"[onComplete, onError, operation, stepMessages, speak, status?.step]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback, useMemo, memo } from 'react';\r\nimport { io, Socket } from 'socket.io-client';\r\nimport { useVoiceGuidance } from '../hooks/useVoiceGuidance';\r\n\r\ninterface ProgressState {\r\n  step: string;\r\n  message?: string;\r\n  progress?: number;\r\n  data?: any;\r\n}\r\n\r\ninterface ProgressIndicatorProps {\r\n  operation: 'migrate' | 'validate' | 'pipeline';\r\n  onComplete?: (result: any) => void;\r\n  onError?: (error: any) => void;\r\n}\r\n\r\nexport const ProgressIndicator: React.FC<ProgressIndicatorProps> = memo(({\r\n  operation,\r\n  onComplete,\r\n  onError\r\n}) => {\r\n  const [socket, setSocket] = useState<Socket | null>(null);\r\n  const [status, setStatus] = useState<ProgressState | null>(null);\r\n  const [isRunning, setIsRunning] = useState(false);\r\n  const [logs, setLogs] = useState<string[]>([]);\r\n  const { speak } = useVoiceGuidance();\r\n\r\n  // Memoize step messages to prevent recreation on every render\r\n  const stepMessages = useMemo(() => ({\r\n    'STARTING': 'Starting operation',\r\n    'VALIDATION': 'Validating files',\r\n    'BACKUP': 'Creating backup',\r\n    'MIGRATION': 'Migrating files',\r\n    'FINALIZATION': 'Finalizing',\r\n    'STT_START': 'Starting speech recognition',\r\n    'STT_DONE': 'Speech recognition complete',\r\n    'LLM_START': 'Processing with AI',\r\n    'LLM_DONE': 'AI processing complete',\r\n    'TTS_START': 'Generating speech',\r\n    'TTS_DONE': 'Speech generation complete'\r\n  }), []);\r\n\r\n  // Memoize step weights to prevent recreation on every render\r\n  const stepWeights = useMemo(() => ({\r\n    'STARTING': 5,\r\n    'VALIDATION': 20,\r\n    'BACKUP': 30,\r\n    'MIGRATION': 70,\r\n    'FINALIZATION': 90,\r\n    'COMPLETED': 100,\r\n    'STT_START': 10,\r\n    'STT_DONE': 30,\r\n    'LLM_START': 50,\r\n    'LLM_DONE': 80,\r\n    'TTS_START': 90,\r\n    'TTS_DONE': 100\r\n  }), []);\r\n\r\n  useEffect(() => {\r\n    const socketConnection = io('http://localhost:8081');\r\n    setSocket(socketConnection);\r\n\r\n    socketConnection.on('progress', (msg: ProgressState) => {\r\n      console.log('[PROGRESS EVENT]', msg.step, msg.data, { progress: msg.progress, message: msg.message });\r\n      setStatus(msg);\r\n      setLogs(prev => [...prev, `[${new Date().toLocaleTimeString()}] ${msg.step}: ${msg.message || ''}`]);\r\n      \r\n      // Voice guidance for progress updates\r\n      if (stepMessages[msg.step]) {\r\n        speak(stepMessages[msg.step], 'system');\r\n      }\r\n    });\r\n\r\n    socketConnection.on('result', (res: any) => {\r\n      console.log('[RESULT EVENT]', res, { operation, timestamp: new Date().toISOString() });\r\n      setStatus({ step: 'COMPLETED', message: 'Operation completed successfully' });\r\n      setIsRunning(false);\r\n      setLogs(prev => [...prev, `[${new Date().toLocaleTimeString()}] RESULT: Success`]);\r\n      speak(`${operation} completed successfully`, 'system');\r\n      onComplete?.(res);\r\n    });\r\n\r\n    socketConnection.on('error', (err: any) => {\r\n      console.error('[ERROR EVENT]', err, { operation, step: status?.step, timestamp: new Date().toISOString() });\r\n      setStatus({ step: 'ERROR', message: err.message });\r\n      setIsRunning(false);\r\n      setLogs(prev => [...prev, `[${new Date().toLocaleTimeString()}] ERROR: ${err.message}`]);\r\n      speak(`${operation} failed: ${err.message}`, 'system');\r\n      onError?.(err);\r\n    });\r\n\r\n    return () => {\r\n      socketConnection.disconnect();\r\n    };\r\n  }, [onComplete, onError, operation, stepMessages, speak]);\r\n\r\n  const startOperation = useCallback((payload?: any) => {\r\n    if (!socket || isRunning) return;\r\n    \r\n    console.log('[OPERATION START]', { operation, payload, isRunning, socketConnected: !!socket });\r\n    setIsRunning(true);\r\n    setStatus({ step: 'STARTING', message: 'Initializing...' });\r\n    setLogs([`[${new Date().toLocaleTimeString()}] Starting ${operation} operation`]);\r\n    speak(`Starting ${operation} operation`, 'system');\r\n    \r\n    switch (operation) {\r\n      case 'migrate':\r\n        socket.emit('migrate-batch', payload);\r\n        break;\r\n      case 'validate':\r\n        socket.emit('validate-curriculum', payload);\r\n        break;\r\n      case 'pipeline':\r\n        socket.emit('pipeline', payload);\r\n        break;\r\n    }\r\n  }, [socket, isRunning, operation, speak]);\r\n\r\n  const getProgressPercentage = useCallback(() => {\r\n    if (!status) return 0;\r\n    if (status.progress) return status.progress;\r\n    \r\n    return stepWeights[status.step] || 0;\r\n  }, [status, stepWeights]);\r\n\r\n  const getStepColor = useCallback(() => {\r\n    if (!status) return 'bg-gray-200';\r\n    if (status.step === 'ERROR') return 'bg-red-500';\r\n    if (status.step === 'COMPLETED') return 'bg-green-500';\r\n    return 'bg-blue-500';\r\n  }, [status]);\r\n\r\n  return (\r\n    <div className=\"w-full max-w-2xl mx-auto p-6 bg-white rounded-lg shadow-lg\">\r\n      <div className=\"mb-4\">\r\n        <h3 className=\"text-lg font-semibold mb-2 capitalize\">{operation} Progress</h3>\r\n        \r\n        <div className=\"w-full bg-gray-200 rounded-full h-2.5\">\r\n          <div \r\n            className={`h-2.5 rounded-full transition-all duration-300 ${getStepColor()}`}\r\n            style={{ width: `${getProgressPercentage()}%` }}\r\n          />\r\n        </div>\r\n        \r\n        {status && (\r\n          <div className=\"mt-2 text-sm text-gray-600\">\r\n            <span className=\"font-medium\">{status.step}</span>\r\n            {status.message && <span className=\"ml-2\">{status.message}</span>}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {!isRunning && (\r\n        <button\r\n          onClick={() => startOperation()}\r\n          className=\"w-full bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded transition-colors\"\r\n          aria-label={`Start ${operation} operation`}\r\n        >\r\n          <span aria-hidden=\"true\">ğŸ™ï¸</span> Start {operation}\r\n        </button>\r\n      )}\r\n\r\n      {isRunning && (\r\n        <button\r\n          disabled\r\n          className=\"w-full bg-gray-400 text-white font-bold py-2 px-4 rounded cursor-not-allowed\"\r\n          aria-label={`${operation} operation in progress`}\r\n          aria-describedby=\"operation-status\"\r\n        >\r\n          <span aria-hidden=\"true\">â³</span> {operation} in progress...\r\n        </button>\r\n      )}\r\n      \r\n      {status && (\r\n        <div id=\"operation-status\" className=\"sr-only\" aria-live=\"polite\">\r\n          Current step: {status.step}. {status.message}\r\n        </div>\r\n      )}\r\n\r\n      {logs.length > 0 && (\r\n        <div className=\"mt-4\">\r\n          <h4 className=\"text-sm font-medium mb-2\">Activity Log:</h4>\r\n          <div className=\"bg-gray-50 rounded p-3 max-h-48 overflow-y-auto\">\r\n            {logs.map((log, index) => (\r\n              <div key={index} className=\"text-xs text-gray-700 font-mono\">\r\n                {log}\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n});\r\n\r\nexport default ProgressIndicator;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\QuestionCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\QuestionDisplay.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\ReviewAnalyticsDashboard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\ReviewCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\ReviewSystem.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\SentenceServiceTest.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\SmartReviewSession.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'initializeSession'. Either include it or remove the dependency array.","line":44,"column":6,"nodeType":"ArrayExpression","endLine":44,"endColumn":14,"suggestions":[{"desc":"Update the dependencies array to be: [initializeSession, userId]","fix":{"range":[1352,1360],"text":"[initializeSession, userId]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has missing dependencies: 'calculateAccuracy' and 'completeSession'. Either include them or remove the dependency array.","line":170,"column":6,"nodeType":"ArrayExpression","endLine":170,"endColumn":78,"suggestions":[{"desc":"Update the dependencies array to be: [sentences, currentIndex, startTime, calculateAccuracy, userAnswer, userId, completeSession]","fix":{"range":[5631,5703],"text":"[sentences, currentIndex, startTime, calculateAccuracy, userAnswer, userId, completeSession]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'analyzeImprovementAreas'. Either include it or remove the dependency array.","line":194,"column":6,"nodeType":"ArrayExpression","endLine":194,"endColumn":34,"suggestions":[{"desc":"Update the dependencies array to be: [sessionResults, analyzeImprovementAreas, onComplete]","fix":{"range":[6586,6614],"text":"[sessionResults, analyzeImprovementAreas, onComplete]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback, memo } from 'react';\r\nimport { reviewAlgorithmService } from '../services/reviewAlgorithm';\r\nimport { ErrorBoundary } from './ErrorBoundary';\r\nimport { getRandomSentences } from '../services/sentenceService';\r\n\r\ninterface ReviewSentence {\r\n  id: string;\r\n  kr: string;\r\n  en: string;\r\n  level: number;\r\n  stage: string;\r\n  difficulty: 'easy' | 'medium' | 'hard';\r\n}\r\n\r\ninterface ReviewSessionProps {\r\n  userId: string;\r\n  onComplete: (results: ReviewResults) => void;\r\n}\r\n\r\ninterface ReviewResults {\r\n  totalSentences: number;\r\n  correctAnswers: number;\r\n  averageTime: number;\r\n  improvementAreas: string[];\r\n}\r\n\r\nconst SmartReviewSession: React.FC<ReviewSessionProps> = memo(({ userId, onComplete }) => {\r\n  const [sentences, setSentences] = useState<ReviewSentence[]>([]);\r\n  const [currentIndex, setCurrentIndex] = useState(0);\r\n  const [userAnswer, setUserAnswer] = useState('');\r\n  const [showAnswer, setShowAnswer] = useState(false);\r\n  const [startTime, setStartTime] = useState<number>(0);\r\n  const [sessionResults, setSessionResults] = useState<any[]>([]);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [sessionStats, setSessionStats] = useState({\r\n    correct: 0,\r\n    total: 0,\r\n    streak: 0,\r\n    maxStreak: 0\r\n  });\r\n\r\n  useEffect(() => {\r\n    initializeSession();\r\n  }, [userId]);\r\n\r\n  const initializeSession = useCallback(async () => {\r\n    console.log('[DEBUG] ğŸ”„ ë³µìŠµ ì„¸ì…˜ ì´ˆê¸°í™” ì‹œì‘:', { userId });\r\n    setIsLoading(true);\r\n    try {\r\n      // ì˜¤ëŠ˜ì˜ ë³µìŠµ ë¬¸ì¥ë“¤ ê°€ì ¸ì˜¤ê¸°\r\n      const sentenceIds = await reviewAlgorithmService.getTodayReviewSentences(userId, 30);\r\n      console.log('[DEBUG] ğŸ“ ë³µìŠµ ë¬¸ì¥ IDë“¤:', sentenceIds);\r\n      \r\n      // ì‹¤ì œ ë¬¸ì¥ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° - ë‹¤ì–‘í•œ ë ˆë²¨ì—ì„œ ëœë¤ ì„ íƒ\r\n      const reviewSentences: ReviewSentence[] = [];\r\n      const levels = [1, 2, 3, 4, 5, 6];\r\n      const stagesPerLevel = ['S01', 'S02', 'S03', 'S04', 'S05'];\r\n      \r\n      for (let i = 0; i < sentenceIds.length && i < 30; i++) {\r\n        const level = levels[Math.floor(Math.random() * levels.length)];\r\n        const stage = stagesPerLevel[Math.floor(Math.random() * stagesPerLevel.length)];\r\n        const stageId = `Lv${level}-P1-${stage}`;\r\n        \r\n        console.log('[DEBUG] ğŸ² ë¬¸ì¥ ìš”ì²­:', { level, stageId, index: i });\r\n        \r\n        try {\r\n          const sentences = await getRandomSentences(level, stageId, 1);\r\n          if (sentences.length > 0) {\r\n            const sentenceData = sentences[0];\r\n            reviewSentences.push({\r\n              id: sentenceData.sentence.id,\r\n              kr: sentenceData.sentence.kr,\r\n              en: sentenceData.sentence.en,\r\n              level: level,\r\n              stage: stageId,\r\n              difficulty: level <= 2 ? 'easy' : level <= 4 ? 'medium' : 'hard'\r\n            });\r\n            console.log('[DEBUG] âœ… ë¬¸ì¥ ì¶”ê°€:', { kr: sentenceData.sentence.kr });\r\n          } else {\r\n            console.warn('[DEBUG] âš ï¸ ë¬¸ì¥ ì—†ìŒ, fallback ì‚¬ìš©:', { level, stageId });\r\n            // Fallback ë¬¸ì¥\r\n            reviewSentences.push({\r\n              id: `fallback-${i}`,\r\n              kr: `ë³µìŠµ ë¬¸ì¥ ${i + 1}`,\r\n              en: `Review sentence ${i + 1}`,\r\n              level: level,\r\n              stage: stageId,\r\n              difficulty: 'medium'\r\n            });\r\n          }\r\n        } catch (error) {\r\n          console.error('[DEBUG] âŒ ë¬¸ì¥ ë¡œë“œ ì‹¤íŒ¨:', error);\r\n          // Fallback ë¬¸ì¥ ì¶”ê°€\r\n          reviewSentences.push({\r\n            id: `error-fallback-${i}`,\r\n            kr: `ë³µìŠµ ë¬¸ì¥ ${i + 1}`,\r\n            en: `Review sentence ${i + 1}`,\r\n            level: level,\r\n            stage: stageId,\r\n            difficulty: 'medium'\r\n          });\r\n        }\r\n      }\r\n      \r\n      console.log('[DEBUG] ğŸ“š ë³µìŠµ ì„¸ì…˜ ë¬¸ì¥ë“¤ ë¡œë“œ ì™„ë£Œ:', { count: reviewSentences.length });\r\n      setSentences(reviewSentences);\r\n      setStartTime(Date.now());\r\n    } catch (error) {\r\n      console.error('[DEBUG] âŒ ë³µìŠµ ì„¸ì…˜ ì´ˆê¸°í™” ì‹¤íŒ¨:', error);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, [userId]);\r\n\r\n  const handleSubmitAnswer = useCallback(() => {\r\n    if (!userAnswer.trim()) return;\r\n    \r\n    setShowAnswer(true);\r\n  }, [userAnswer]);\r\n\r\n  const handleDifficultyFeedback = useCallback(async (difficulty: 'easy' | 'medium' | 'hard') => {\r\n    const currentSentence = sentences[currentIndex];\r\n    const responseTime = Date.now() - startTime;\r\n    \r\n    // ì •í™•ë„ ê³„ì‚° (ê°„ë‹¨í•œ ìœ ì‚¬ë„ ë¹„êµ)\r\n    const accuracy = calculateAccuracy(userAnswer, currentSentence.en);\r\n    \r\n    // ë³µìŠµ ì„¸ì…˜ ë°ì´í„° ì €ì¥\r\n    const sessionData = {\r\n      sentenceId: currentSentence.id,\r\n      userId,\r\n      accuracy,\r\n      responseTime,\r\n      difficulty,\r\n      timestamp: new Date(),\r\n      reviewCount: 0, // ì‹¤ì œë¡œëŠ” ê¸°ì¡´ ì¹´ìš´íŠ¸ + 1\r\n      intervalDays: 1\r\n    };\r\n\r\n    // ì•Œê³ ë¦¬ì¦˜ì— í”¼ë“œë°± ì „ë‹¬ ë° ë‹¤ìŒ ë³µìŠµ ì¼ì • ê³„ì‚°\r\n    try {\r\n      // await reviewAlgorithmService.recordReviewSession(sessionData);\r\n      \r\n      // ì„¸ì…˜ ê²°ê³¼ ê¸°ë¡\r\n      setSessionResults(prev => [...prev, { ...sessionData, correct: accuracy > 0.7 }]);\r\n      \r\n      // í†µê³„ ì—…ë°ì´íŠ¸\r\n      const isCorrect = accuracy > 0.7;\r\n      setSessionStats(prev => ({\r\n        correct: prev.correct + (isCorrect ? 1 : 0),\r\n        total: prev.total + 1,\r\n        streak: isCorrect ? prev.streak + 1 : 0,\r\n        maxStreak: Math.max(prev.maxStreak, isCorrect ? prev.streak + 1 : prev.streak)\r\n      }));\r\n      \r\n    } catch (error) {\r\n      console.error('ë³µìŠµ ê²°ê³¼ ì €ì¥ ì‹¤íŒ¨:', error);\r\n    }\r\n\r\n    // ë‹¤ìŒ ë¬¸ì¥ìœ¼ë¡œ ì´ë™\r\n    if (currentIndex < sentences.length - 1) {\r\n      setCurrentIndex(prev => prev + 1);\r\n      setUserAnswer('');\r\n      setShowAnswer(false);\r\n      setStartTime(Date.now());\r\n    } else {\r\n      // ì„¸ì…˜ ì™„ë£Œ\r\n      completeSession();\r\n    }\r\n  }, [sentences, currentIndex, userAnswer, userId, startTime, sessionResults]);\r\n\r\n  const calculateAccuracy = useCallback((userAnswer: string, correctAnswer: string): number => {\r\n    // ê°„ë‹¨í•œ ìœ ì‚¬ë„ ê³„ì‚° (ì‹¤ì œë¡œëŠ” ë” ì •êµí•œ ì•Œê³ ë¦¬ì¦˜ ì‚¬ìš©)\r\n    const userWords = userAnswer.toLowerCase().split(' ');\r\n    const correctWords = correctAnswer.toLowerCase().split(' ');\r\n    \r\n    let matches = 0;\r\n    correctWords.forEach(word => {\r\n      if (userWords.includes(word)) matches++;\r\n    });\r\n    \r\n    return correctWords.length > 0 ? matches / correctWords.length : 0;\r\n  }, []);\r\n\r\n  const completeSession = useCallback(() => {\r\n    const results: ReviewResults = {\r\n      totalSentences: sessionResults.length,\r\n      correctAnswers: sessionResults.filter(r => r.correct).length,\r\n      averageTime: sessionResults.reduce((sum, r) => sum + r.responseTime, 0) / sessionResults.length,\r\n      improvementAreas: analyzeImprovementAreas()\r\n    };\r\n    \r\n    onComplete(results);\r\n  }, [sessionResults, onComplete]);\r\n\r\n  const analyzeImprovementAreas = (): string[] => {\r\n    const areas: string[] = [];\r\n    \r\n    // ì‘ë‹µ ì‹œê°„ ë¶„ì„\r\n    const avgTime = sessionResults.reduce((sum, r) => sum + r.responseTime, 0) / sessionResults.length;\r\n    if (avgTime > 10000) areas.push('ì‘ë‹µ ì†ë„ ê°œì„ ');\r\n    \r\n    // ì •í™•ë„ ë¶„ì„\r\n    const accuracy = sessionResults.filter(r => r.correct).length / sessionResults.length;\r\n    if (accuracy < 0.7) areas.push('ì •í™•ë„ í–¥ìƒ');\r\n    \r\n    // ì–´ë ¤ìš´ ë¬¸ì¥ ë¶„ì„\r\n    const hardSentenceErrors = sessionResults.filter(r => r.difficulty === 'hard' && !r.correct);\r\n    if (hardSentenceErrors.length > 2) areas.push('ê³ ê¸‰ ë¬¸ë²• ì§‘ì¤‘ í•™ìŠµ');\r\n    \r\n    return areas;\r\n  };\r\n\r\n  const getProgressPercentage = () => {\r\n    return sentences.length > 0 ? ((currentIndex + 1) / sentences.length) * 100 : 0;\r\n  };\r\n\r\n  const getDifficultyColor = (difficulty: string) => {\r\n    switch (difficulty) {\r\n      case 'easy': return 'text-green-600';\r\n      case 'medium': return 'text-yellow-600';\r\n      case 'hard': return 'text-red-600';\r\n      default: return 'text-gray-600';\r\n    }\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center min-h-64\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4\"></div>\r\n          <p className=\"text-gray-600\">ê°œì¸ ë§ì¶¤ ë³µìŠµ ì„¸ì…˜ì„ ì¤€ë¹„í•˜ê³  ìˆìŠµë‹ˆë‹¤...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (sentences.length === 0) {\r\n    return (\r\n      <div className=\"text-center py-12\">\r\n        <h3 className=\"text-lg font-medium text-gray-900 mb-2\">ì˜¤ëŠ˜ ë³µìŠµí•  ë¬¸ì¥ì´ ì—†ìŠµë‹ˆë‹¤!</h3>\r\n        <p className=\"text-gray-600\">ìƒˆë¡œìš´ í•™ìŠµì„ ì‹œì‘í•˜ê±°ë‚˜ ë‚´ì¼ ë‹¤ì‹œ í™•ì¸í•´ë³´ì„¸ìš”.</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const currentSentence = sentences[currentIndex];\r\n\r\n  return (\r\n    <ErrorBoundary \r\n      level=\"component\"\r\n      onError={(error, errorInfo) => {\r\n        console.error('[DEBUG] SmartReviewSession ì—ëŸ¬:', error, errorInfo);\r\n      }}\r\n    >\r\n      <div className=\"max-w-4xl mx-auto p-6\">\r\n      {/* ì§„í–‰ë¥  ë° í†µê³„ */}\r\n      <div className=\"mb-6\">\r\n        <div className=\"flex justify-between items-center mb-4\">\r\n          <h2 className=\"text-2xl font-bold text-gray-900\">ğŸ§  ìŠ¤ë§ˆíŠ¸ ë³µìŠµ</h2>\r\n          <div className=\"flex gap-4 text-sm\">\r\n            <span className=\"text-green-600\">ì •ë‹µ: {sessionStats.correct}</span>\r\n            <span className=\"text-gray-600\">ì´ê³„: {sessionStats.total}</span>\r\n            <span className=\"text-blue-600\">ì—°ì†: {sessionStats.streak}</span>\r\n          </div>\r\n        </div>\r\n        \r\n        <div className=\"w-full bg-gray-200 rounded-full h-2 mb-2\">\r\n          <div \r\n            className=\"bg-blue-600 h-2 rounded-full transition-all duration-300\"\r\n            style={{ width: `${getProgressPercentage()}%` }}\r\n          ></div>\r\n        </div>\r\n        \r\n        <div className=\"flex justify-between text-sm text-gray-600\">\r\n          <span>{currentIndex + 1} / {sentences.length}</span>\r\n          <span className={getDifficultyColor(currentSentence.difficulty)}>\r\n            {currentSentence.difficulty.toUpperCase()}\r\n          </span>\r\n        </div>\r\n      </div>\r\n\r\n      {/* ë¬¸ì¥ ì •ë³´ */}\r\n      <div className=\"bg-white border border-gray-200 rounded-lg p-6 mb-6\">\r\n        <div className=\"flex justify-between items-start mb-4\">\r\n          <div>\r\n            <span className=\"text-sm text-gray-500\">{currentSentence.stage}</span>\r\n            <span className=\"ml-2 px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded\">\r\n              Level {currentSentence.level}\r\n            </span>\r\n          </div>\r\n        </div>\r\n        \r\n        <div className=\"mb-6\">\r\n          <p className=\"text-lg text-gray-900 mb-2\">ë‹¤ìŒ ë¬¸ì¥ì„ ì˜ì–´ë¡œ ë²ˆì—­í•˜ì„¸ìš”:</p>\r\n          <p className=\"text-xl font-medium text-blue-900 bg-blue-50 p-4 rounded-lg\">\r\n            {currentSentence.kr}\r\n          </p>\r\n        </div>\r\n\r\n        {/* ë‹µë³€ ì…ë ¥ */}\r\n        <div className=\"mb-6\">\r\n          <textarea\r\n            value={userAnswer}\r\n            onChange={(e) => setUserAnswer(e.target.value)}\r\n            placeholder=\"ì˜ì–´ ë²ˆì—­ì„ ì…ë ¥í•˜ì„¸ìš”...\"\r\n            className=\"w-full p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n            rows={3}\r\n            disabled={showAnswer}\r\n          />\r\n        </div>\r\n\r\n        {/* ë‹µë³€ í™•ì¸ ë˜ëŠ” ê²°ê³¼ */}\r\n        {!showAnswer ? (\r\n          <button\r\n            onClick={handleSubmitAnswer}\r\n            disabled={!userAnswer.trim()}\r\n            className=\"w-full px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors\"\r\n          >\r\n            ë‹µë³€ í™•ì¸\r\n          </button>\r\n        ) : (\r\n          <div>\r\n            <div className=\"mb-6 p-4 bg-gray-50 rounded-lg\">\r\n              <h4 className=\"font-medium text-gray-900 mb-2\">ì •ë‹µ:</h4>\r\n              <p className=\"text-lg text-gray-800\">{currentSentence.en}</p>\r\n              \r\n              <h4 className=\"font-medium text-gray-900 mt-4 mb-2\">ë‚´ ë‹µë³€:</h4>\r\n              <p className=\"text-lg text-blue-800\">{userAnswer}</p>\r\n            </div>\r\n\r\n            <div className=\"mb-4\">\r\n              <p className=\"text-sm text-gray-600 mb-3\">ì´ ë¬¸ì œì˜ ë‚œì´ë„ëŠ” ì–´ë– ì…¨ë‚˜ìš”?</p>\r\n              <div className=\"flex gap-3\">\r\n                <button\r\n                  onClick={() => handleDifficultyFeedback('easy')}\r\n                  className=\"flex-1 px-4 py-2 bg-green-100 text-green-800 rounded-lg hover:bg-green-200 transition-colors\"\r\n                >\r\n                  ğŸ˜Š ì‰¬ì› ì–´ìš”\r\n                </button>\r\n                <button\r\n                  onClick={() => handleDifficultyFeedback('medium')}\r\n                  className=\"flex-1 px-4 py-2 bg-yellow-100 text-yellow-800 rounded-lg hover:bg-yellow-200 transition-colors\"\r\n                >\r\n                  ğŸ¤” ë³´í†µì´ì—ìš”\r\n                </button>\r\n                <button\r\n                  onClick={() => handleDifficultyFeedback('hard')}\r\n                  className=\"flex-1 px-4 py-2 bg-red-100 text-red-800 rounded-lg hover:bg-red-200 transition-colors\"\r\n                >\r\n                  ğŸ˜… ì–´ë ¤ì› ì–´ìš”\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* ì„¸ì…˜ í†µê³„ (ì‹¤ì‹œê°„) */}\r\n      {sessionStats.total > 0 && (\r\n        <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\r\n          <h4 className=\"font-medium text-blue-900 mb-2\">í˜„ì¬ ì„¸ì…˜ í†µê³„</h4>\r\n          <div className=\"grid grid-cols-3 gap-4 text-sm\">\r\n            <div className=\"text-center\">\r\n              <div className=\"text-lg font-bold text-blue-600\">\r\n                {Math.round((sessionStats.correct / sessionStats.total) * 100)}%\r\n              </div>\r\n              <div className=\"text-gray-600\">ì •í™•ë„</div>\r\n            </div>\r\n            <div className=\"text-center\">\r\n              <div className=\"text-lg font-bold text-green-600\">{sessionStats.maxStreak}</div>\r\n              <div className=\"text-gray-600\">ìµœê³  ì—°ì†</div>\r\n            </div>\r\n            <div className=\"text-center\">\r\n              <div className=\"text-lg font-bold text-purple-600\">\r\n                {sessionResults.length > 0 ? \r\n                  Math.round(sessionResults.reduce((sum, r) => sum + r.responseTime, 0) / sessionResults.length / 1000) : 0}ì´ˆ\r\n              </div>\r\n              <div className=\"text-gray-600\">í‰ê·  ì‹œê°„</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n      </div>\r\n    </ErrorBoundary>\r\n  );\r\n});\r\n\r\nSmartReviewSession.displayName = 'SmartReviewSession';\r\n\r\nexport default SmartReviewSession;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\SpeakingFlowController.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'currentPhase' and 'startSpeakingFlow'. Either include them or remove the dependency array.","line":70,"column":6,"nodeType":"ArrayExpression","endLine":70,"endColumn":36,"suggestions":[{"desc":"Update the dependencies array to be: [autoStart, disabled, card.id, currentPhase, startSpeakingFlow]","fix":{"range":[2260,2290],"text":"[autoStart, disabled, card.id, currentPhase, startSpeakingFlow]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useRef } from 'react';\r\nimport type { DrillCard } from '@/types';\r\n\r\ninterface SpeakingFlowControllerProps {\r\n  card: DrillCard;\r\n  stage: 1 | 2 | 3;\r\n  onResult: (transcript: string, confidence: number) => void;\r\n  onError?: (error: string) => void;\r\n  disabled?: boolean;\r\n  autoStart?: boolean;\r\n}\r\n\r\ntype FlowPhase = 'idle' | 'tts' | 'countdown' | 'recognition' | 'waiting' | 'completed';\r\n\r\nexport const SpeakingFlowController: React.FC<SpeakingFlowControllerProps> = ({\r\n  card,\r\n  stage,\r\n  onResult,\r\n  onError,\r\n  disabled = false,\r\n  autoStart = false,\r\n}) => {\r\n  const [currentPhase, setCurrentPhase] = useState<FlowPhase>('idle');\r\n  const [countdown, setCountdown] = useState<number>(0);\r\n  const [speechTimer, setSpeechTimer] = useState<number>(0);\r\n  const [recognizedText, setRecognizedText] = useState<string>('');\r\n  const [isCompleted, setIsCompleted] = useState(false);\r\n\r\n  // Refs for cleanup\r\n  const countdownIntervalRef = useRef<NodeJS.Timeout | null>(null);\r\n  const speechTimerRef = useRef<NodeJS.Timeout | null>(null);\r\n  const recognitionTimeoutRef = useRef<NodeJS.Timeout | null>(null);\r\n  const recognitionRef = useRef<any>(null);\r\n\r\n  // Stage configuration\r\n  const stageConfig = {\r\n    1: { thinkingTime: 3, description: '3ì´ˆ ì‚¬ê³ ì‹œê°„' },\r\n    2: { thinkingTime: 2, description: '2ì´ˆ ì‚¬ê³ ì‹œê°„' }, \r\n    3: { thinkingTime: 1, description: '1ì´ˆ ì‚¬ê³ ì‹œê°„' },\r\n  };\r\n\r\n  // Cleanup function\r\n  const cleanup = () => {\r\n    if (countdownIntervalRef.current) {\r\n      clearInterval(countdownIntervalRef.current);\r\n      countdownIntervalRef.current = null;\r\n    }\r\n    if (speechTimerRef.current) {\r\n      clearInterval(speechTimerRef.current);\r\n      speechTimerRef.current = null;\r\n    }\r\n    if (recognitionTimeoutRef.current) {\r\n      clearTimeout(recognitionTimeoutRef.current);\r\n      recognitionTimeoutRef.current = null;\r\n    }\r\n    if (recognitionRef.current) {\r\n      recognitionRef.current.stop();\r\n      recognitionRef.current = null;\r\n    }\r\n  };\r\n\r\n  // Auto start effect\r\n  useEffect(() => {\r\n    if (autoStart && !disabled && currentPhase === 'idle') {\r\n      const timer = setTimeout(() => {\r\n        startSpeakingFlow();\r\n      }, 500);\r\n      return () => clearTimeout(timer);\r\n    }\r\n  }, [autoStart, disabled, card.id]);\r\n\r\n  // Cleanup on unmount\r\n  useEffect(() => {\r\n    return cleanup;\r\n  }, []);\r\n\r\n  // Reset when card changes\r\n  useEffect(() => {\r\n    setCurrentPhase('idle');\r\n    setIsCompleted(false);\r\n    setRecognizedText('');\r\n    cleanup();\r\n  }, [card.id]);\r\n\r\n  const startSpeakingFlow = async () => {\r\n    if (disabled || isCompleted) return;\r\n    \r\n    console.log('ğŸ¤ Speaking í”Œë¡œìš° ì‹œì‘:', card.front_ko);\r\n    setCurrentPhase('tts');\r\n    setIsCompleted(false);\r\n    \r\n    try {\r\n      // ğŸ”§ í”ŒëŸ¬ê·¸ì¸ì„ í†µí•œ í•œêµ­ì–´ TTS ì¬ìƒ\r\n      console.log('ğŸ”Š TTS ì¬ìƒ ì‹œì‘ (í”ŒëŸ¬ê·¸ì¸):', card.front_ko);\r\n\r\n      try {\r\n        const ServiceContainer = (await import('@/container/ServiceContainer')).default;\r\n        const container = ServiceContainer.getInstanceSync();\r\n        const speechService = container.getSpeechProcessingService();\r\n\r\n        // ê¸°ì¡´ TTS ì¤‘ì§€\r\n        speechService.stopAllSpeech();\r\n\r\n        console.log('ğŸ”Š TTS ì‹œì‘ë¨ (í”ŒëŸ¬ê·¸ì¸):', card.front_ko);\r\n\r\n        await speechService.speakAnswer(card.front_ko, {\r\n          language: 'ko-KR',\r\n          rate: 0.8,\r\n          volume: 1.0,\r\n          pitch: 1.0\r\n        });\r\n\r\n        console.log('ğŸ”Š TTS ì™„ë£Œë¨ (í”ŒëŸ¬ê·¸ì¸):', card.front_ko);\r\n        setTimeout(() => {\r\n          if (!isCompleted) startCountdown();\r\n        }, 1000);\r\n\r\n      } catch (speechError) {\r\n        console.error('ğŸ”Š TTS í”ŒëŸ¬ê·¸ì¸ ì˜¤ë¥˜:', speechError);\r\n        // í”ŒëŸ¬ê·¸ì¸ ì‹¤íŒ¨ì‹œ ì¹´ìš´íŠ¸ë‹¤ìš´ ì‹œì‘\r\n        setTimeout(() => {\r\n          if (!isCompleted) startCountdown();\r\n        }, 2000);\r\n      }\r\n    } catch (error) {\r\n      console.error('ğŸ”§ TTS ì‹œìŠ¤í…œ ì˜¤ë¥˜:', error);\r\n      if (onError) {\r\n        onError('ìŒì„± ì¬ìƒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');\r\n      }\r\n    }\r\n  };\r\n\r\n  const startCountdown = () => {\r\n    console.log('â³ ì‚¬ê³ ì‹œê°„ ì¹´ìš´íŠ¸ë‹¤ìš´ ì‹œì‘');\r\n    setCurrentPhase('countdown');\r\n    \r\n    const thinkingTime = stageConfig[stage].thinkingTime;\r\n    setCountdown(thinkingTime);\r\n    \r\n    countdownIntervalRef.current = setInterval(() => {\r\n      setCountdown(prev => {\r\n        if (prev <= 1) {\r\n          if (countdownIntervalRef.current) {\r\n            clearInterval(countdownIntervalRef.current);\r\n            countdownIntervalRef.current = null;\r\n          }\r\n          \r\n          // ë¹„í”„ìŒ ì¬ìƒ í›„ ìŒì„± ì¸ì‹ ì‹œì‘\r\n          playBeepSound();\r\n          setTimeout(() => {\r\n            if (!isCompleted) startSpeechRecognition();\r\n          }, 200);\r\n          \r\n          return 0;\r\n        }\r\n        return prev - 1;\r\n      });\r\n    }, 1000);\r\n  };\r\n\r\n  const playBeepSound = () => {\r\n    try {\r\n      const audioContext = new (window.AudioContext || (window as any).webkitAudioContext)();\r\n      const oscillator = audioContext.createOscillator();\r\n      const gainNode = audioContext.createGain();\r\n      \r\n      oscillator.connect(gainNode);\r\n      gainNode.connect(audioContext.destination);\r\n      \r\n      oscillator.frequency.setValueAtTime(800, audioContext.currentTime);\r\n      oscillator.type = 'sine';\r\n      gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);\r\n      gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);\r\n      \r\n      oscillator.start(audioContext.currentTime);\r\n      oscillator.stop(audioContext.currentTime + 0.2);\r\n    } catch (error) {\r\n      console.error('ë¹„í”„ìŒ ì¬ìƒ ì‹¤íŒ¨:', error);\r\n    }\r\n  };\r\n\r\n  const startSpeechRecognition = () => {\r\n    if (isCompleted || currentPhase === 'recognition') {\r\n      console.log('âš ï¸ ì´ë¯¸ ìŒì„± ì¸ì‹ ì¤‘ì´ê±°ë‚˜ ì™„ë£Œë¨ - ì¤‘ë³µ ì‹¤í–‰ ë°©ì§€');\r\n      return;\r\n    }\r\n    \r\n    console.log('ğŸ¤ ìŒì„± ì¸ì‹ ì‹œì‘ - 10ì´ˆ ì œí•œ');\r\n    setCurrentPhase('recognition');\r\n    setSpeechTimer(0);\r\n    setRecognizedText('');\r\n    \r\n    // ìŒì„±ì¸ì‹ íƒ€ì´ë¨¸ ì‹œì‘\r\n    speechTimerRef.current = setInterval(() => {\r\n      setSpeechTimer(prev => prev + 0.1);\r\n    }, 100);\r\n\r\n    if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {\r\n      const SpeechRecognition = (window as any).webkitSpeechRecognition || (window as any).SpeechRecognition;\r\n      const recognition = new SpeechRecognition();\r\n      recognitionRef.current = recognition;\r\n      \r\n      recognition.continuous = false;\r\n      recognition.interimResults = true; // HTML ë²„ì „ê³¼ ë™ì¼\r\n      recognition.lang = 'en-US';\r\n      recognition.maxAlternatives = 5; // HTML ë²„ì „ê³¼ ë™ì¼\r\n      \r\n      // ìŒì„±ì¸ì‹ ì •í™•ë„ ê°œì„  ì„¤ì • (HTML ë²„ì „ì—ì„œ ê°€ì ¸ì˜´)\r\n      if (recognition.serviceURI) {\r\n        recognition.serviceURI = 'wss://www.google.com/speech-api/v2/recognize';\r\n      }\r\n      \r\n      let recognitionCompleted = false;\r\n      \r\n      recognition.onstart = () => {\r\n        console.log('ğŸ¯ ìŒì„± ì¸ì‹ ì‹œì‘ë¨');\r\n      };\r\n      \r\n      recognition.onresult = (event: any) => {\r\n        if (recognitionCompleted || isCompleted) return;\r\n        recognitionCompleted = true;\r\n        \r\n        console.log('âœ… ìŒì„± ì¸ì‹ ì™„ë£Œ');\r\n        \r\n        if (event.results && event.results.length > 0) {\r\n          const transcript = event.results[0][0].transcript;\r\n          const confidence = event.results[0][0].confidence || 0.9;\r\n          \r\n          console.log('ğŸ“ ì¸ì‹ëœ í…ìŠ¤íŠ¸:', transcript);\r\n          setRecognizedText(transcript);\r\n          \r\n          // ì •ë¦¬ ì‘ì—…\r\n          cleanup();\r\n          setCurrentPhase('completed');\r\n          setIsCompleted(true);\r\n          \r\n          // ê²°ê³¼ ì „ë‹¬ - HTML ë²„ì „ì²˜ëŸ¼ ì¦‰ì‹œ ì „ë‹¬í•˜ê³  4ì´ˆ í›„ ë‹¤ìŒìœ¼ë¡œ\r\n          onResult(transcript.trim(), confidence);\r\n        }\r\n      };\r\n      \r\n      recognition.onerror = (event: any) => {\r\n        if (recognitionCompleted || isCompleted) return;\r\n        recognitionCompleted = true;\r\n        \r\n        console.error('ğŸ˜¨ ìŒì„± ì¸ì‹ ì˜¤ë¥˜:', event.error);\r\n        cleanup();\r\n        setCurrentPhase('completed');\r\n        setIsCompleted(true);\r\n        \r\n        // ì˜¤ë¥˜ê°€ ë°œìƒí•´ë„ ë¹ˆ ë‹µë³€ìœ¼ë¡œ ì²˜ë¦¬í•˜ì—¬ ë‹¤ìŒìœ¼ë¡œ ì§„í–‰\r\n        console.log('ğŸ”„ ìŒì„± ì¸ì‹ ì˜¤ë¥˜ - ë¹ˆ ë‹µë³€ìœ¼ë¡œ ì²˜ë¦¬í•˜ì—¬ ì§„í–‰');\r\n        setTimeout(() => {\r\n          onResult('', 0.1); // ë¹ˆ ë‹µë³€ìœ¼ë¡œ ì²˜ë¦¬\r\n        }, 0);\r\n      };\r\n      \r\n      recognition.onend = () => {\r\n        console.log('ğŸ”‡ ìŒì„± ì¸ì‹ ì¢…ë£Œ');\r\n      };\r\n      \r\n      // 10ì´ˆ íƒ€ì„ì•„ì›ƒ ì„¤ì • (ë” ê¸¸ê²Œ)\r\n      recognitionTimeoutRef.current = setTimeout(() => {\r\n        if (recognitionCompleted || isCompleted) return;\r\n        recognitionCompleted = true;\r\n        \r\n        console.log('â° ìŒì„± ì¸ì‹ ì‹œê°„ ì´ˆê³¼ (10ì´ˆ) - ë¹ˆ ë‹µë³€ìœ¼ë¡œ ì²˜ë¦¬í•˜ì—¬ ì§„í–‰');\r\n        recognition.stop();\r\n        cleanup();\r\n        setCurrentPhase('completed');\r\n        setIsCompleted(true);\r\n        \r\n        // ì‹œê°„ ì´ˆê³¼ ì‹œì—ë„ ë¹ˆ ë‹µë³€ìœ¼ë¡œ ì²˜ë¦¬í•˜ì—¬ ë‹¤ìŒìœ¼ë¡œ ì§„í–‰\r\n        setTimeout(() => {\r\n          onResult('', 0.1);\r\n        }, 0);\r\n      }, 10000);\r\n      \r\n      recognition.start();\r\n    } else {\r\n      if (onError) {\r\n        onError('ì´ ë¸Œë¼ìš°ì €ëŠ” ìŒì„± ì¸ì‹ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleManualStart = () => {\r\n    if (!disabled && currentPhase === 'idle') {\r\n      startSpeakingFlow();\r\n    }\r\n  };\r\n\r\n  const handleStop = () => {\r\n    cleanup();\r\n    setCurrentPhase('idle');\r\n    setIsCompleted(false);\r\n    setRecognizedText('');\r\n  };\r\n\r\n  return (\r\n    <div className=\"bg-white rounded-lg shadow-lg p-6\">\r\n      <div className=\"text-center\">\r\n        {/* Phase Status Display */}\r\n        {currentPhase !== 'idle' && (\r\n          <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-6 mb-6\">\r\n            <div className=\"text-center\">\r\n              <div className=\"text-lg font-semibold text-blue-800 mb-4\">\r\n                {currentPhase === 'tts' && 'ğŸ”Š í•œêµ­ì–´ë¥¼ ë“¤ë ¤ë“œë¦¬ê³  ìˆìŠµë‹ˆë‹¤...'}\r\n                {currentPhase === 'countdown' && `â³ ${countdown}ì´ˆ í›„ ìŒì„± ì¸ì‹ ì‹œì‘ (${stageConfig[stage].description})`}\r\n                {currentPhase === 'recognition' && `ğŸ¤ ì§€ê¸ˆ ì˜ì–´ë¡œ ë§í•´ì£¼ì„¸ìš”! (${speechTimer.toFixed(1)}ì´ˆ / 10ì´ˆ)`}\r\n                {currentPhase === 'waiting' && 'âŒ› ì ì‹œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”...'}\r\n                {currentPhase === 'completed' && 'âœ… ìŒì„± ì¸ì‹ ì™„ë£Œ!'}\r\n              </div>\r\n              \r\n              {currentPhase === 'recognition' && (\r\n                <>\r\n                  {/* ì§„í–‰ ë°” */}\r\n                  <div className=\"w-full bg-blue-200 rounded-full h-3 mb-4\">\r\n                    <div \r\n                      className=\"bg-red-500 h-3 rounded-full transition-all duration-100\"\r\n                      style={{ width: `${Math.min((speechTimer / 10) * 100, 100)}%` }}\r\n                    />\r\n                  </div>\r\n                  \r\n                  {/* ë…¹ìŒ í‘œì‹œê¸° */}\r\n                  <div className=\"flex items-center justify-center space-x-3\">\r\n                    <div className=\"w-3 h-3 bg-red-500 rounded-full animate-pulse\"></div>\r\n                    <span className=\"text-sm text-blue-700\">\r\n                      ìŒì„±ì„ ì¸ì‹í•˜ê³  ìˆìŠµë‹ˆë‹¤... ({speechTimer.toFixed(1)}ì´ˆ / 10ì´ˆ)\r\n                    </span>\r\n                  </div>\r\n                </>\r\n              )}\r\n              \r\n              {currentPhase === 'tts' && (\r\n                <div className=\"flex items-center justify-center space-x-3\">\r\n                  <div className=\"w-3 h-3 bg-green-500 rounded-full animate-pulse\"></div>\r\n                  <span className=\"text-sm text-blue-700\">í•œêµ­ì–´ ë¬¸ì œë¥¼ ì¬ìƒ ì¤‘...</span>\r\n                </div>\r\n              )}\r\n              \r\n              {currentPhase === 'countdown' && countdown > 0 && (\r\n                <div className=\"flex items-center justify-center space-x-3\">\r\n                  <div className=\"w-3 h-3 bg-yellow-500 rounded-full animate-pulse\"></div>\r\n                  <span className=\"text-sm text-blue-700\">ì‚¬ê³ ì‹œê°„: {countdown}ì´ˆ ë‚¨ìŒ</span>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Manual start button */}\r\n        {currentPhase === 'idle' && !autoStart && (\r\n          <button\r\n            onClick={handleManualStart}\r\n            disabled={disabled}\r\n            className=\"px-8 py-4 bg-blue-600 text-white font-bold rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors text-lg\"\r\n          >\r\n            ğŸ¤ Speaking ì‹œì‘í•˜ê¸°\r\n          </button>\r\n        )}\r\n        \r\n        {/* Stop button during recognition */}\r\n        {currentPhase === 'recognition' && (\r\n          <button\r\n            onClick={handleStop}\r\n            className=\"px-6 py-3 bg-red-600 text-white font-bold rounded-lg hover:bg-red-700 transition-colors\"\r\n          >\r\n            â¹ï¸ ì¤‘ì§€\r\n          </button>\r\n        )}\r\n\r\n        {/* Recognized text display */}\r\n        {recognizedText && (\r\n          <div className=\"mt-4 p-4 bg-green-50 border border-green-200 rounded-lg\">\r\n            <div className=\"text-sm text-green-600 mb-1\">ì¸ì‹ëœ ìŒì„±:</div>\r\n            <div className=\"font-medium text-green-800\">\"{recognizedText}\"</div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\SpeakingStageSelector.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\SpeechRecorder.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'autoFlow', 'autoFlowState', and 'handleAutoFlowStart'. Either include them or remove the dependency array.","line":61,"column":6,"nodeType":"ArrayExpression","endLine":61,"endColumn":39,"suggestions":[{"desc":"Update the dependencies array to be: [koreanText, autoStart, disabled, autoFlow, autoFlowState, handleAutoFlowStart]","fix":{"range":[2086,2119],"text":"[koreanText, autoStart, disabled, autoFlow, autoFlowState, handleAutoFlowStart]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'autoTimeout' and 'timerInterval'. Either include them or remove the dependency array.","line":69,"column":6,"nodeType":"ArrayExpression","endLine":69,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [autoTimeout, timerInterval]","fix":{"range":[2307,2309],"text":"[autoTimeout, timerInterval]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'onResult' and 'speech.confidence'. Either include them or remove the dependency array. If 'onResult' changes too often, find the parent component that defines it and wrap that definition in useCallback.","line":316,"column":6,"nodeType":"ArrayExpression","endLine":316,"endColumn":52,"suggestions":[{"desc":"Update the dependencies array to be: [speech.transcript, autoFlow, isAutoRecording, speech.confidence, onResult]","fix":{"range":[9549,9595],"text":"[speech.transcript, autoFlow, isAutoRecording, speech.confidence, onResult]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback, useMemo, memo } from 'react';\r\nimport { useSpeech } from '@/hooks/useSpeech';\r\n\r\ninterface SpeechRecorderProps {\r\n  onResult: (transcript: string, confidence: number) => void;\r\n  onError?: (error: string) => void;\r\n  phraseHints?: string[];\r\n  disabled?: boolean;\r\n  className?: string;\r\n  // Auto-flow props\r\n  autoFlow?: boolean;\r\n  koreanText?: string;\r\n  autoStart?: boolean;\r\n  onAutoFlowStateChange?: (state: 'idle' | 'tts' | 'beep' | 'waiting' | 'recording') => void;\r\n}\r\n\r\nexport const SpeechRecorder: React.FC<SpeechRecorderProps> = memo(({\r\n  onResult,\r\n  onError,\r\n  phraseHints = [], // ìŒì„± ì¸ì‹ íŒíŠ¸ (í–¥í›„ êµ¬í˜„ ì˜ˆì •)\r\n  disabled = false,\r\n  className = '',\r\n  autoFlow = false,\r\n  koreanText = '',\r\n  autoStart = false,\r\n  onAutoFlowStateChange,\r\n}) => {\r\n  const [isPressed, setIsPressed] = useState(false);\r\n  const [autoFlowState, setAutoFlowState] = useState<'idle' | 'tts' | 'beep' | 'waiting' | 'recording'>('idle');\r\n  const [isAutoRecording, setIsAutoRecording] = useState(false);\r\n  const [speechTimer, setSpeechTimer] = useState<number>(0);\r\n  const [timerInterval, setTimerInterval] = useState<NodeJS.Timeout | null>(null);\r\n  const [autoTimeout, setAutoTimeout] = useState<NodeJS.Timeout | null>(null);\r\n  \r\n  const speechConfig = useMemo(() => ({\r\n    apiBaseUrl: import.meta.env.VITE_API_BASE_URL,\r\n    preferCloudSTT: false, // Start with browser STT\r\n    language: 'en-US',\r\n  }), []);\r\n  \r\n  const speech = useSpeech(speechConfig);\r\n\r\n  // Auto-flow state management\r\n  const updateAutoFlowState = useCallback((newState: typeof autoFlowState) => {\r\n    setAutoFlowState(newState);\r\n    if (onAutoFlowStateChange) {\r\n      onAutoFlowStateChange(newState);\r\n    }\r\n  }, [onAutoFlowStateChange]);\r\n\r\n  // Auto-start effect\r\n  useEffect(() => {\r\n    if (autoFlow && autoStart && koreanText && autoFlowState === 'idle' && !disabled) {\r\n      // 0.5ì´ˆ ë”œë ˆì´ í›„ ìë™ ì‹œì‘\r\n      const startDelay = setTimeout(() => {\r\n        handleAutoFlowStart();\r\n      }, 500);\r\n      \r\n      return () => clearTimeout(startDelay);\r\n    }\r\n  }, [koreanText, autoStart, disabled]);\r\n\r\n  // Cleanup timers\r\n  useEffect(() => {\r\n    return () => {\r\n      if (timerInterval) clearInterval(timerInterval);\r\n      if (autoTimeout) clearTimeout(autoTimeout);\r\n    };\r\n  }, []);\r\n\r\n  const playBeep = useCallback(() => {\r\n    try {\r\n      const audioContext = new (window.AudioContext || (window as any).webkitAudioContext)();\r\n      const oscillator = audioContext.createOscillator();\r\n      const gainNode = audioContext.createGain();\r\n      \r\n      oscillator.connect(gainNode);\r\n      gainNode.connect(audioContext.destination);\r\n      \r\n      oscillator.frequency.setValueAtTime(800, audioContext.currentTime);\r\n      oscillator.type = 'sine';\r\n      gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);\r\n      \r\n      oscillator.start();\r\n      oscillator.stop(audioContext.currentTime + 0.2);\r\n    } catch (error) {\r\n      console.error('ë¹„í”„ìŒ ì¬ìƒ ì‹¤íŒ¨:', error);\r\n    }\r\n  }, []);\r\n\r\n  // Auto-flow start button handler\r\n  const handleAutoFlowStart = async () => {\r\n    if (disabled || !autoFlow || !koreanText) return;\r\n    \r\n    console.log('ğŸ¤ ìë™ Speaking í”Œë¡œìš° ì‹œì‘');\r\n    updateAutoFlowState('tts');\r\n    \r\n    try {\r\n      // 1. í•œêµ­ì–´ TTS ì¬ìƒ\r\n      if (speech.isTTSAvailable) {\r\n        await speech.speak(koreanText, 'ko-KR');\r\n        \r\n        // TTS ì™„ë£Œ í›„ 1ì´ˆ ëŒ€ê¸°\r\n        setTimeout(() => {\r\n          playBeepAndStartRecording();\r\n        }, 1000);\r\n      } else {\r\n        // TTSê°€ ì—†ìœ¼ë©´ 2ì´ˆ ëŒ€ê¸° í›„ ë…¹ìŒ ì‹œì‘\r\n        setTimeout(() => {\r\n          playBeepAndStartRecording();\r\n        }, 2000);\r\n      }\r\n    } catch (error) {\r\n      console.error('TTS ì¬ìƒ ì‹¤íŒ¨:', error);\r\n      updateAutoFlowState('idle');\r\n      if (onError) {\r\n        onError('ìŒì„± ì¬ìƒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');\r\n      }\r\n    }\r\n  };\r\n\r\n  const playBeepAndStartRecording = () => {\r\n    console.log('ğŸ”” ë¹„í”„ìŒ ì¬ìƒ ë° ë…¹ìŒ ì‹œì‘');\r\n    updateAutoFlowState('beep');\r\n    \r\n    // ë¹„í”„ìŒ ì¬ìƒ\r\n    playBeep();\r\n    \r\n    // ë¹„í”„ìŒ í›„ 500ms ëŒ€ê¸° í›„ ë…¹ìŒ ì‹œì‘\r\n    setTimeout(() => {\r\n      startDirectSpeechRecognition();\r\n    }, 500);\r\n  };\r\n\r\n  const startDirectSpeechRecognition = () => {\r\n    console.log('ğŸ¤ ì§ì ‘ ìŒì„± ì¸ì‹ ì‹œì‘');\r\n    updateAutoFlowState('recording');\r\n    setIsAutoRecording(true);\r\n    \r\n    // íƒ€ì´ë¨¸ ì‹œì‘\r\n    setSpeechTimer(0);\r\n    const interval = setInterval(() => {\r\n      setSpeechTimer(prev => prev + 0.1);\r\n    }, 100);\r\n    setTimerInterval(interval);\r\n    \r\n    // Web Speech API ì§ì ‘ ì‚¬ìš©\r\n    if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {\r\n      const SpeechRecognition = (window as any).webkitSpeechRecognition || (window as any).SpeechRecognition;\r\n      const recognition = new SpeechRecognition();\r\n      \r\n      recognition.continuous = false;\r\n      recognition.interimResults = false;\r\n      recognition.lang = 'en-US';\r\n      recognition.maxAlternatives = 1;\r\n      \r\n      // phraseHints í™œìš© (grammar íŒíŠ¸ ì œê³µ)\r\n      if (phraseHints.length > 0) {\r\n        console.log('ğŸ¯ Speech recognition hints applied:', phraseHints);\r\n        // ì‹¤ì œ êµ¬í˜„: ë¸Œë¼ìš°ì €ë³„ë¡œ ë‹¤ë¥¸ ë°©ì‹ìœ¼ë¡œ íŒíŠ¸ ì ìš©\r\n        if (recognition.grammars) {\r\n          const grammarList = new (window as any).SpeechGrammarList();\r\n          const grammar = `#JSGF V1.0; grammar phrases; public <phrase> = ${phraseHints.join(' | ')};`;\r\n          grammarList.addFromString(grammar, 1);\r\n          recognition.grammars = grammarList;\r\n        }\r\n      }\r\n      \r\n      let isCompleted = false; // í•µì‹¬: ì¤‘ë³µ ì²˜ë¦¬ ë°©ì§€\r\n      \r\n      recognition.onstart = () => {\r\n        console.log('ğŸ¯ ìŒì„± ì¸ì‹ ì‹œì‘ë¨');\r\n      };\r\n      \r\n      recognition.onresult = (event: any) => {\r\n        if (isCompleted) {\r\n          console.log('âš ï¸ ì´ë¯¸ ì²˜ë¦¬ëœ ê²°ê³¼ - ê±´ë„ˆëœ€');\r\n          return;\r\n        }\r\n        isCompleted = true;\r\n        \r\n        console.log('ğŸ¤ ìŒì„± ì¸ì‹ ê²°ê³¼ ìˆ˜ì‹ :', event);\r\n        \r\n        if (event.results && event.results.length > 0) {\r\n          const transcript = event.results[0][0].transcript;\r\n          const confidence = event.results[0][0].confidence || 0.9;\r\n          \r\n          console.log('ğŸ¯ ì¸ì‹ëœ í…ìŠ¤íŠ¸:', transcript);\r\n          console.log('ğŸ¯ ì‹ ë¢°ë„:', confidence);\r\n          \r\n          // ì¦‰ì‹œ ìŒì„± ì¸ì‹ ì¤‘ì§€ë¥¼ ìœ„í•´ recognition.stop() í˜¸ì¶œ\r\n          recognition.stop();\r\n          \r\n          // íƒ€ì´ë¨¸ ì •ë¦¬\r\n          clearAllTimers();\r\n          \r\n          // ìƒíƒœ ì´ˆê¸°í™”\r\n          updateAutoFlowState('idle');\r\n          setIsAutoRecording(false);\r\n          setSpeechTimer(0);\r\n          \r\n          // ê²°ê³¼ ì „ë‹¬ - ì¦‰ì‹œ ì‹¤í–‰\r\n          console.log('ğŸš€ SpeechRecorder: onResult ì½œë°± í˜¸ì¶œ', { \r\n            transcript: transcript.trim(), \r\n            confidence,\r\n            onResultType: typeof onResult \r\n          });\r\n          \r\n          // setTimeoutìœ¼ë¡œ React ìƒíƒœ ì—…ë°ì´íŠ¸ í›„ ì½œë°± ì‹¤í–‰ ë³´ì¥\r\n          setTimeout(() => {\r\n            console.log('ğŸ¯ SpeechRecorder: ì½œë°± ì‹¤í–‰');\r\n            onResult(transcript.trim(), confidence);\r\n          }, 0);\r\n        }\r\n      };\r\n      \r\n      recognition.onerror = (event: any) => {\r\n        if (isCompleted) return;\r\n        isCompleted = true;\r\n        \r\n        console.error('ğŸ˜¨ ìŒì„± ì¸ì‹ ì˜¤ë¥˜:', event.error);\r\n        \r\n        clearAllTimers();\r\n        updateAutoFlowState('idle');\r\n        setIsAutoRecording(false);\r\n        setSpeechTimer(0);\r\n        \r\n        if (onError) {\r\n          onError(`ìŒì„± ì¸ì‹ ì˜¤ë¥˜: ${event.error}`);\r\n        }\r\n      };\r\n      \r\n      recognition.onend = () => {\r\n        console.log('ğŸ”Š ìŒì„± ì¸ì‹ ì¢…ë£Œ');\r\n        \r\n        // ë§Œì•½ ì•„ì§ ë…¹ìŒ ìƒíƒœì´ê³  ê²°ê³¼ê°€ ì—†ì—ˆë‹¤ë©´ ì‹¤íŒ¨ë¡œ ì²˜ë¦¬\r\n        if (!isCompleted && isAutoRecording) {\r\n          console.log('ğŸ˜¨ ìŒì„± ì¸ì‹ ì‹¤íŒ¨ - ê²°ê³¼ ì—†ì´ ì¢…ë£Œ');\r\n          isCompleted = true;\r\n          \r\n          clearAllTimers();\r\n          updateAutoFlowState('idle');\r\n          setIsAutoRecording(false);\r\n          setSpeechTimer(0);\r\n          \r\n          if (onError) {\r\n            onError('ìŒì„±ì„ ì¸ì‹í•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');\r\n          }\r\n        }\r\n      };\r\n      \r\n      // 10ì´ˆ íƒ€ì„ì•„ì›ƒ ì„¤ì •\r\n      const timeout = setTimeout(() => {\r\n        if (isCompleted) return;\r\n        isCompleted = true;\r\n        \r\n        console.log('â° 10ì´ˆ íƒ€ì„ì•„ì›ƒ - ë…¹ìŒ ì¤‘ì§€');\r\n        recognition.stop();\r\n        clearAllTimers();\r\n        updateAutoFlowState('idle');\r\n        setIsAutoRecording(false);\r\n        setSpeechTimer(0);\r\n        \r\n        if (onError) {\r\n          onError('ìŒì„± ì¸ì‹ ì‹œê°„ì´ ì´ˆê³¼ë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');\r\n        }\r\n      }, 10000);\r\n      setAutoTimeout(timeout);\r\n      \r\n      // ìŒì„± ì¸ì‹ ì‹œì‘\r\n      recognition.start();\r\n    } else {\r\n      // Web Speech APIê°€ ì§€ì›ë˜ì§€ ì•ŠëŠ” ê²½ìš°\r\n      console.error('ğŸ˜¨ Web Speech APIê°€ ì§€ì›ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤');\r\n      clearAllTimers();\r\n      updateAutoFlowState('idle');\r\n      setIsAutoRecording(false);\r\n      setSpeechTimer(0);\r\n      \r\n      if (onError) {\r\n        onError('ì´ ë¸Œë¼ìš°ì €ëŠ” ìŒì„± ì¸ì‹ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');\r\n      }\r\n    }\r\n  };\r\n\r\n  const clearAllTimers = () => {\r\n    if (timerInterval) {\r\n      clearInterval(timerInterval);\r\n      setTimerInterval(null);\r\n    }\r\n    if (autoTimeout) {\r\n      clearTimeout(autoTimeout);\r\n      setAutoTimeout(null);\r\n    }\r\n  };\r\n\r\n  // ê¸°ì¡´ useSpeech í›„í¬ ê²°ê³¼ ì²˜ë¦¬ëŠ” ì œê±° (ì§ì ‘ Web Speech API ì‚¬ìš©ìœ¼ë¡œ ëŒ€ì²´)\r\n\r\n  // Manual button handlers (for non-auto mode)\r\n  const handleManualStart = useCallback(() => {\r\n    if (disabled) return;\r\n    setIsPressed(true);\r\n    speech.startRecording();\r\n  }, [disabled, speech]);\r\n\r\n  const handleManualStop = useCallback(() => {\r\n    setIsPressed(false);\r\n    speech.stopRecording();\r\n  }, [speech]);\r\n\r\n  // Handle speech results for manual mode\r\n  useEffect(() => {\r\n    if (speech.transcript && !autoFlow && !isAutoRecording) {\r\n      onResult(speech.transcript, speech.confidence);\r\n    }\r\n  }, [speech.transcript, autoFlow, isAutoRecording]);\r\n\r\n  // Error handling\r\n  useEffect(() => {\r\n    if (speech.error && onError) {\r\n      onError(speech.error);\r\n    }\r\n  }, [speech.error, onError]);\r\n\r\n  if (autoFlow) {\r\n    return (\r\n      <div className={`text-center ${className}`}>\r\n        {/* Auto-flow status display */}\r\n        {autoFlowState !== 'idle' && (\r\n          <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-6 mb-6\">\r\n            <div className=\"text-center\">\r\n              <div className=\"text-lg font-semibold text-blue-800 mb-4\">\r\n                {autoFlowState === 'tts' && 'ğŸ”Š ë¬¸ì œë¥¼ ë“¤ë ¤ë“œë¦¬ê³  ìˆìŠµë‹ˆë‹¤...'}\r\n                {autoFlowState === 'beep' && 'ğŸ”” ê³§ ë…¹ìŒì´ ì‹œì‘ë©ë‹ˆë‹¤...'}\r\n                {autoFlowState === 'recording' && `ğŸ¤ ë§ì”€í•´ ì£¼ì„¸ìš”... (${speechTimer.toFixed(1)}ì´ˆ)`}\r\n              </div>\r\n              \r\n              {autoFlowState === 'recording' && (\r\n                <>\r\n                  {/* ì§„í–‰ ë°” */}\r\n                  <div className=\"w-full bg-blue-200 rounded-full h-2 mb-4\">\r\n                    <div \r\n                      className=\"bg-blue-600 h-2 rounded-full transition-all duration-100\"\r\n                      style={{ width: `${Math.min((speechTimer / 10) * 100, 100)}%` }}\r\n                    />\r\n                  </div>\r\n                  \r\n                  {/* ë…¹ìŒ í‘œì‹œê¸° */}\r\n                  <div className=\"flex items-center justify-center space-x-3\">\r\n                    <div className=\"w-3 h-3 bg-red-500 rounded-full animate-pulse\"></div>\r\n                    <span className=\"text-sm text-blue-700\">\r\n                      ìŒì„±ì„ ì¸ì‹í•˜ê³  ìˆìŠµë‹ˆë‹¤... ({speechTimer.toFixed(1)}ì´ˆ / 10ì´ˆ)\r\n                    </span>\r\n                  </div>\r\n                </>\r\n              )}\r\n              \r\n              {autoFlowState === 'tts' && (\r\n                <div className=\"flex items-center justify-center space-x-3\">\r\n                  <div className=\"w-3 h-3 bg-green-500 rounded-full animate-pulse\"></div>\r\n                  <span className=\"text-sm text-blue-700\">í•œêµ­ì–´ ë¬¸ì œë¥¼ ì¬ìƒ ì¤‘...</span>\r\n                </div>\r\n              )}\r\n              \r\n              {autoFlowState === 'beep' && (\r\n                <div className=\"flex items-center justify-center space-x-3\">\r\n                  <div className=\"w-3 h-3 bg-yellow-500 rounded-full animate-pulse\"></div>\r\n                  <span className=\"text-sm text-blue-700\">ì‹ í˜¸ìŒ í›„ ë§ì”€í•´ ì£¼ì„¸ìš”</span>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Manual start button for auto-flow mode */}\r\n        {autoFlowState === 'idle' && !autoStart && (\r\n          <button\r\n            onClick={handleAutoFlowStart}\r\n            disabled={disabled}\r\n            className=\"min-h-[60px] min-w-[60px] px-8 py-4 bg-blue-600 text-white font-bold rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors text-lg touch-manipulation\"\r\n            aria-label={autoFlowState === 'idle' ? 'ìŒì„± ë…¹ìŒ ì„¸ì…˜ ì‹œì‘í•˜ê¸°' : 'ë…¹ìŒ ì§„í–‰ ì¤‘'}\r\n            aria-pressed={autoFlowState !== 'idle'}\r\n            aria-describedby=\"recording-instructions\"\r\n            role=\"button\"\r\n          >\r\n            ğŸ¤ ì‹œì‘í•˜ê¸°\r\n          </button>\r\n        )}\r\n        \r\n        {/* Screen reader instructions */}\r\n        <div id=\"recording-instructions\" className=\"sr-only\">\r\n          ì´ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ìë™ ìŒì„± ë…¹ìŒì´ ì‹œì‘ë©ë‹ˆë‹¤. í•œêµ­ì–´ í…ìŠ¤íŠ¸ê°€ ì¬ìƒëœ í›„ ì˜ì–´ë¡œ ë§ì”€í•´ ì£¼ì„¸ìš”.\r\n        </div>\r\n        \r\n        {/* Live status updates for screen readers */}\r\n        <div aria-live=\"polite\" aria-atomic=\"true\" className=\"sr-only\">\r\n          {autoFlowState === 'tts' && 'í•œêµ­ì–´ ì˜¤ë””ì˜¤ë¥¼ ì¬ìƒí•˜ê³  ìˆìŠµë‹ˆë‹¤...'}\r\n          {autoFlowState === 'beep' && 'ì‹ í˜¸ìŒ í›„ ë…¹ìŒì´ ì‹œì‘ë©ë‹ˆë‹¤...'}\r\n          {autoFlowState === 'recording' && `ë…¹ìŒ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤. ${speechTimer.toFixed(1)}ì´ˆê°€ ê²½ê³¼ë˜ì—ˆìŠµë‹ˆë‹¤.`}\r\n        </div>\r\n        \r\n        {/* ë…¹ìŒ ì¤‘ì§€ ë²„íŠ¼ */}\r\n        {autoFlowState === 'recording' && (\r\n          <button\r\n            onClick={() => {\r\n              clearAllTimers();\r\n              updateAutoFlowState('idle');\r\n              setIsAutoRecording(false);\r\n              setSpeechTimer(0);\r\n              if (onError) {\r\n                onError('ì‚¬ìš©ìê°€ ë…¹ìŒì„ ì¤‘ì§€í–ˆìŠµë‹ˆë‹¤.');\r\n              }\r\n            }}\r\n            className=\"min-h-[44px] min-w-[44px] px-6 py-3 bg-red-600 text-white font-bold rounded-lg hover:bg-red-700 transition-colors touch-manipulation\"\r\n            aria-label=\"ë…¹ìŒ ì¤‘ì§€í•˜ê¸°\"\r\n          >\r\n            â¹ï¸ ë…¹ìŒ ì¤‘ì§€\r\n          </button>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Manual mode UI\r\n  return (\r\n    <div className={`text-center ${className}`}>\r\n      <div className=\"mb-4\">\r\n        <button\r\n          onMouseDown={handleManualStart}\r\n          onMouseUp={handleManualStop}\r\n          onTouchStart={handleManualStart}\r\n          onTouchEnd={handleManualStop}\r\n          disabled={disabled}\r\n          className={`min-h-[60px] min-w-[60px] px-8 py-4 font-bold rounded-lg transition-all duration-200 text-lg touch-manipulation ${\r\n            isPressed \r\n              ? 'bg-red-600 text-white transform scale-105' \r\n              : 'bg-blue-600 text-white hover:bg-blue-700'\r\n          } disabled:bg-gray-400 disabled:cursor-not-allowed`}\r\n          aria-label={isPressed ? 'ë…¹ìŒ ì¤‘ì…ë‹ˆë‹¤. ë²„íŠ¼ì—ì„œ ì†ì„ ë–¼ë©´ ì¤‘ì§€ë©ë‹ˆë‹¤.' : 'ëˆŒëŸ¬ì„œ ìŒì„± ë…¹ìŒì„ ì‹œì‘í•˜ì„¸ìš”'}\r\n          aria-pressed={isPressed}\r\n        >\r\n          {isPressed ? 'ğŸ”´ ë…¹ìŒ ì¤‘... (ë²„íŠ¼ì„ ë–¼ì„¸ìš”)' : 'ğŸ¤ ëˆŒëŸ¬ì„œ ë§í•˜ê¸°'}\r\n        </button>\r\n      </div>\r\n\r\n      {speech.isRecording && (\r\n        <div className=\"text-sm text-gray-600\">\r\n          <div className=\"flex items-center justify-center space-x-2 mb-2\">\r\n            <div className=\"w-2 h-2 bg-red-500 rounded-full animate-pulse\"></div>\r\n            <span>ìŒì„±ì„ ì¸ì‹í•˜ê³  ìˆìŠµë‹ˆë‹¤...</span>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {speech.transcript && (\r\n        <div className=\"mt-4 p-4 bg-green-50 border border-green-200 rounded-lg\">\r\n          <div className=\"text-sm text-green-600 mb-1\">ì¸ì‹ëœ ìŒì„±:</div>\r\n          <div className=\"font-medium text-green-800\">\"{speech.transcript}\"</div>\r\n          <div className=\"text-xs text-green-500 mt-1\">\r\n            ì •í™•ë„: {Math.round(speech.confidence * 100)}%\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"mt-4 text-xs text-gray-500\">\r\n        <p>ë²„íŠ¼ì„ ëˆ„ë¥´ê³  ìˆëŠ” ë™ì•ˆ ìŒì„±ì´ ë…¹ìŒë©ë‹ˆë‹¤</p>\r\n        <p>ëª…í™•í•˜ê³  ì²œì²œíˆ ë§í•´ì£¼ì„¸ìš”</p>\r\n      </div>\r\n    </div>\r\n  );\r\n});","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\SpeedModeSession.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\StageFocusSession.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\StageSelectionModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\StageSelector.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useMemo' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":51,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":58}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback, useMemo, memo } from 'react';\r\nimport { stageFocusService } from '@/services/stageFocusMode';\r\n\r\ninterface StageSelectorProps {\r\n  level: number;\r\n  onStageSelect: (stage: number) => void;\r\n  onClose: () => void;\r\n}\r\n\r\ninterface StageInfo {\r\n  stage: number;\r\n  title: string;\r\n  difficulty: string;\r\n  questionCount: number;\r\n  completed: boolean;\r\n  lastPracticed?: Date;\r\n}\r\n\r\nexport const StageSelector: React.FC<StageSelectorProps> = memo(({\r\n  level,\r\n  onStageSelect,\r\n  onClose\r\n}) => {\r\n  const [stages, setStages] = useState<StageInfo[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [selectedStage, setSelectedStage] = useState<number | null>(null);\r\n\r\n  useEffect(() => {\r\n    loadStages();\r\n  }, [level, loadStages]);\r\n\r\n  const loadStages = useCallback(async () => {\r\n    try {\r\n      setLoading(true);\r\n      const response = await stageFocusService.getAvailableStages(level);\r\n      setStages(response.stages);\r\n    } catch (error) {\r\n      console.error('ìŠ¤í…Œì´ì§€ ë¡œë”© ì‹¤íŒ¨:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [level]);\r\n\r\n  const handleStageClick = useCallback((stage: number) => {\r\n    setSelectedStage(stage);\r\n  }, []);\r\n\r\n  const handleStartPractice = useCallback(() => {\r\n    if (selectedStage) {\r\n      onStageSelect(selectedStage);\r\n    }\r\n  }, [selectedStage, onStageSelect]);\r\n\r\n  const getDifficultyColor = useCallback((difficulty: string) => {\r\n    switch (difficulty) {\r\n      case 'easy': return 'bg-green-100 text-green-800 border-green-200';\r\n      case 'medium': return 'bg-yellow-100 text-yellow-800 border-yellow-200';\r\n      case 'hard': return 'bg-red-100 text-red-800 border-red-200';\r\n      default: return 'bg-gray-100 text-gray-800 border-gray-200';\r\n    }\r\n  }, []);\r\n\r\n  const formatLastPracticed = useCallback((date?: Date) => {\r\n    if (!date) return 'ë¯¸í•™ìŠµ';\r\n    \r\n    const now = new Date();\r\n    const diffMs = now.getTime() - date.getTime();\r\n    const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));\r\n    \r\n    if (diffDays === 0) return 'ì˜¤ëŠ˜';\r\n    if (diffDays === 1) return '1ì¼ ì „';\r\n    if (diffDays <= 7) return `${diffDays}ì¼ ì „`;\r\n    if (diffDays <= 30) return `${Math.floor(diffDays / 7)}ì£¼ ì „`;\r\n    return `${Math.floor(diffDays / 30)}ê°œì›” ì „`;\r\n  }, []);\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n        <div className=\"bg-white rounded-lg p-8 max-w-2xl w-full mx-4\">\r\n          <div className=\"text-center\">\r\n            <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4\"></div>\r\n            <div className=\"text-gray-600\">ìŠ¤í…Œì´ì§€ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n      <div className=\"bg-white rounded-lg max-w-4xl w-full mx-4 max-h-[90vh] overflow-hidden\">\r\n        {/* í—¤ë” */}\r\n        <div className=\"bg-gradient-to-r from-blue-600 to-purple-600 text-white p-6\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <h2 className=\"text-2xl font-bold mb-2\">ğŸ¯ Stage ì§‘ì¤‘ ëª¨ë“œ</h2>\r\n              <p className=\"text-blue-100\">Level {level} - ì›í•˜ëŠ” ìŠ¤í…Œì´ì§€ë¥¼ ì„ íƒí•˜ì„¸ìš”</p>\r\n            </div>\r\n            <button\r\n              onClick={onClose}\r\n              className=\"text-white hover:text-gray-200 transition-colors\"\r\n            >\r\n              <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n              </svg>\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* ìŠ¤í…Œì´ì§€ ëª©ë¡ */}\r\n        <div className=\"p-6 overflow-y-auto\" style={{ maxHeight: 'calc(90vh - 200px)' }}>\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n            {stages.map((stage) => (\r\n              <div\r\n                key={stage.stage}\r\n                onClick={() => handleStageClick(stage.stage)}\r\n                className={`cursor-pointer rounded-lg border-2 p-4 transition-all duration-200 hover:shadow-md ${\r\n                  selectedStage === stage.stage\r\n                    ? 'border-blue-500 bg-blue-50'\r\n                    : 'border-gray-200 hover:border-gray-300'\r\n                }`}\r\n              >\r\n                {/* ìŠ¤í…Œì´ì§€ í—¤ë” */}\r\n                <div className=\"flex items-center justify-between mb-3\">\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <span className=\"text-lg font-bold text-gray-800\">\r\n                      Stage {stage.stage}\r\n                    </span>\r\n                    {stage.completed && (\r\n                      <span className=\"text-green-500\">\r\n                        <svg className=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                          <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clipRule=\"evenodd\" />\r\n                        </svg>\r\n                      </span>\r\n                    )}\r\n                  </div>\r\n                  <span className={`text-xs px-2 py-1 rounded border ${getDifficultyColor(stage.difficulty)}`}>\r\n                    {stage.difficulty}\r\n                  </span>\r\n                </div>\r\n\r\n                {/* ìŠ¤í…Œì´ì§€ ì •ë³´ */}\r\n                <h3 className=\"font-medium text-gray-900 mb-2 text-sm\">\r\n                  {stage.title}\r\n                </h3>\r\n\r\n                {/* ìƒíƒœ ì •ë³´ */}\r\n                <div className=\"space-y-1 text-xs text-gray-600\">\r\n                  <div className=\"flex justify-between\">\r\n                    <span>ë¬¸ì¥ ìˆ˜:</span>\r\n                    <span className=\"font-medium\">{stage.questionCount}ê°œ</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between\">\r\n                    <span>ë§ˆì§€ë§‰ í•™ìŠµ:</span>\r\n                    <span className=\"font-medium\">{formatLastPracticed(stage.lastPracticed)}</span>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* ì„ íƒ í‘œì‹œ */}\r\n                {selectedStage === stage.stage && (\r\n                  <div className=\"mt-3 text-center\">\r\n                    <span className=\"text-blue-600 font-medium text-sm\">âœ“ ì„ íƒë¨</span>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        {/* í•˜ë‹¨ ì•¡ì…˜ */}\r\n        <div className=\"bg-gray-50 px-6 py-4 flex justify-between\">\r\n          <button\r\n            onClick={onClose}\r\n            className=\"px-6 py-2 text-gray-600 hover:text-gray-800 transition-colors\"\r\n          >\r\n            ì·¨ì†Œ\r\n          </button>\r\n          \r\n          <div className=\"flex gap-3\">\r\n            <div className=\"text-sm text-gray-600 flex items-center\">\r\n              {selectedStage ? (\r\n                <>\r\n                  <span className=\"text-blue-600 font-medium\">Stage {selectedStage}</span>\r\n                  <span className=\"ml-2\">ì„ íƒë¨</span>\r\n                </>\r\n              ) : (\r\n                'ìŠ¤í…Œì´ì§€ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”'\r\n              )}\r\n            </div>\r\n            \r\n            <button\r\n              onClick={handleStartPractice}\r\n              disabled={!selectedStage}\r\n              className=\"bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white px-6 py-2 rounded-lg transition-colors font-medium\"\r\n            >\r\n              ì§‘ì¤‘ ì—°ìŠµ ì‹œì‘\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n});","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\StatisticsPanel.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\TrainingHeader.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\UserProfile.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AuthModal' is defined but never used. Allowed unused vars must match /^_/u.","line":3,"column":8,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useCallback, useMemo, memo } from 'react';\r\nimport { useAuth } from '../hooks/useAuth';\r\nimport AuthModal from './AuthModal';\r\n\r\nexport const UserProfile: React.FC = memo(() => {\r\n  const { user, userProgress, logout, isLoading, isAuthenticated, isAnonymous } = useAuth();\r\n  const [showDropdown, setShowDropdown] = useState(false);\r\n\r\n  const handleLogout = useCallback(async () => {\r\n    try {\r\n      await logout();\r\n      setShowDropdown(false);\r\n    } catch (error) {\r\n      console.error('ë¡œê·¸ì•„ì›ƒ ì‹¤íŒ¨:', error);\r\n    }\r\n  }, [logout]);\r\n\r\n  // All hooks must be called before any conditional returns\r\n  const displayName = useMemo(() => {\r\n    if (user?.displayName) return user.displayName;\r\n    if (user?.email) return user.email.split('@')[0];\r\n    if (isAnonymous) return 'ìµëª… ì‚¬ìš©ì';\r\n    return 'ì‚¬ìš©ì';\r\n  }, [user?.displayName, user?.email, isAnonymous]);\r\n\r\n  const levelProgress = useMemo(() => {\r\n    if (!userProgress) return 0;\r\n    const currentLevelExp = userProgress.exp % 100;\r\n    return currentLevelExp;\r\n  }, [userProgress]);\r\n\r\n  // Conditional renders after all hooks\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"flex items-center space-x-2\">\r\n        <div className=\"w-8 h-8 bg-gray-200 rounded-full animate-pulse\"></div>\r\n        <div className=\"w-16 h-4 bg-gray-200 rounded animate-pulse\"></div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!isAuthenticated) {\r\n    return (\r\n      <div className=\"flex items-center space-x-2 text-gray-500\">\r\n        <div className=\"w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center\">\r\n          <span className=\"text-xs\">ğŸ‘¤</span>\r\n        </div>\r\n        <span className=\"text-sm\">ì²´í—˜ ëª¨ë“œ</span>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"relative\">\r\n      <button\r\n        onClick={() => setShowDropdown(!showDropdown)}\r\n        className=\"flex items-center space-x-3 px-3 py-2 rounded-lg hover:bg-gray-100 transition-colors\"\r\n      >\r\n        <div className=\"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold\">\r\n          {displayName.charAt(0).toUpperCase()}\r\n        </div>\r\n        \r\n        <div className=\"text-left\">\r\n          <div className=\"text-sm font-medium text-gray-900\">\r\n            {displayName}\r\n            {isAnonymous && <span className=\"text-xs text-gray-500 ml-1\">(ì²´í—˜)</span>}\r\n          </div>\r\n          <div className=\"text-xs text-gray-600\">\r\n            Level {userProgress?.level || 1} â€¢ Stage {userProgress?.stage || 1}\r\n          </div>\r\n        </div>\r\n        \r\n        <svg className={`w-4 h-4 text-gray-500 transform transition-transform ${showDropdown ? 'rotate-180' : ''}`} fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\r\n        </svg>\r\n      </button>\r\n\r\n      {showDropdown && (\r\n        <div className=\"absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-lg border z-50\">\r\n          <div className=\"p-4 border-b\">\r\n            <div className=\"flex items-center space-x-3 mb-3\">\r\n              <div className=\"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold text-lg\">\r\n                {displayName.charAt(0).toUpperCase()}\r\n              </div>\r\n              <div>\r\n                <div className=\"font-medium text-gray-900\">{displayName}</div>\r\n                <div className=\"text-sm text-gray-600\">{user?.email}</div>\r\n                {isAnonymous && (\r\n                  <div className=\"text-xs text-orange-600\">ì²´í—˜ ê³„ì • (ë°ì´í„°ê°€ ì €ì¥ë˜ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤)</div>\r\n                )}\r\n              </div>\r\n            </div>\r\n\r\n            {userProgress && (\r\n              <div className=\"space-y-3\">\r\n                <div className=\"grid grid-cols-3 gap-3 text-center\">\r\n                  <div className=\"bg-blue-50 p-2 rounded\">\r\n                    <div className=\"text-lg font-bold text-blue-600\">{userProgress.level}</div>\r\n                    <div className=\"text-xs text-blue-500\">Level</div>\r\n                  </div>\r\n                  <div className=\"bg-green-50 p-2 rounded\">\r\n                    <div className=\"text-lg font-bold text-green-600\">{userProgress.exp}</div>\r\n                    <div className=\"text-xs text-green-500\">EXP</div>\r\n                  </div>\r\n                  <div className=\"bg-orange-50 p-2 rounded\">\r\n                    <div className=\"text-lg font-bold text-orange-600\">{userProgress.streak}</div>\r\n                    <div className=\"text-xs text-orange-500\">ì—°ì†</div>\r\n                  </div>\r\n                </div>\r\n\r\n                <div>\r\n                  <div className=\"flex justify-between text-sm mb-1\">\r\n                    <span>ë‹¤ìŒ ë ˆë²¨ê¹Œì§€</span>\r\n                    <span>{levelProgress}/100 EXP</span>\r\n                  </div>\r\n                  <div className=\"w-full bg-gray-200 rounded-full h-2\">\r\n                    <div \r\n                      className=\"bg-blue-500 h-2 rounded-full transition-all duration-300\"\r\n                      style={{ width: `${levelProgress}%` }}\r\n                    />\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"text-xs text-gray-500 space-y-1\">\r\n                  <div>ì´ í•™ìŠµ ì„¸ì…˜: {userProgress.totalSessions}íšŒ</div>\r\n                  {userProgress.lastStudyDate && (\r\n                    <div>ë§ˆì§€ë§‰ í•™ìŠµ: {new Date(userProgress.lastStudyDate).toLocaleDateString()}</div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          <div className=\"p-2\">\r\n            {isAnonymous && (\r\n              <div className=\"px-3 py-2 text-xs text-orange-600 bg-orange-50 rounded-md mb-2\">\r\n                ğŸ’¡ ê³„ì •ì„ ìƒì„±í•˜ë©´ ì§„í–‰ë„ê°€ ì˜êµ¬ì ìœ¼ë¡œ ì €ì¥ë©ë‹ˆë‹¤.\r\n              </div>\r\n            )}\r\n            \r\n            <button\r\n              onClick={handleLogout}\r\n              className=\"w-full text-left px-3 py-2 text-sm text-red-600 hover:bg-red-50 rounded-md\"\r\n            >\r\n              ğŸšª ë¡œê·¸ì•„ì›ƒ\r\n            </button>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n});\r\n\r\nexport default UserProfile;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\VoiceControls.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\VoiceGuidanceSettings.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\WordBank.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\WritingModeFeedback.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\WritingModeInput.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\srs\\MemoryStrengthChart.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\srs\\ReviewDashboard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\srs\\ReviewSessionCard.tsx","messages":[{"ruleId":"no-undef","severity":1,"message":"'results' is not defined.","line":110,"column":30,"nodeType":"Identifier","messageId":"undef","endLine":110,"endColumn":37},{"ruleId":"no-undef","severity":1,"message":"'results' is not defined.","line":111,"column":42,"nodeType":"Identifier","messageId":"undef","endLine":111,"endColumn":49},{"ruleId":"no-undef","severity":1,"message":"'results' is not defined.","line":112,"column":37,"nodeType":"Identifier","messageId":"undef","endLine":112,"endColumn":44},{"ruleId":"no-undef","severity":1,"message":"'results' is not defined.","line":112,"column":91,"nodeType":"Identifier","messageId":"undef","endLine":112,"endColumn":98},{"ruleId":"no-undef","severity":1,"message":"'results' is not defined.","line":118,"column":26,"nodeType":"Identifier","messageId":"undef","endLine":118,"endColumn":33},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has an unnecessary dependency: 'results'. Either exclude it or remove the dependency array. Outer scope values like 'results' aren't valid dependencies because mutating them doesn't re-render the component.","line":124,"column":6,"nodeType":"ArrayExpression","endLine":124,"endColumn":116,"suggestions":[{"desc":"Update the dependencies array to be: [currentCard, userAnswer, questionStartTime, currentIndex, cards.length, srsEngine, sessionStartTime]","fix":{"range":[3797,3907],"text":"[currentCard, userAnswer, questionStartTime, currentIndex, cards.length, srsEngine, sessionStartTime]"}}]},{"ruleId":"no-undef","severity":1,"message":"'results' is not defined.","line":124,"column":108,"nodeType":"Identifier","messageId":"undef","endLine":124,"endColumn":115}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Review Session Card Component\r\n * \r\n * ê¸°ëŠ¥:\r\n * - ë³µìŠµ ì„¸ì…˜ ì§„í–‰ UI\r\n * - ì¹´ë“œë³„ ë³µìŠµ ì¸í„°í˜ì´ìŠ¤\r\n * - ì‹¤ì‹œê°„ ê¸°ì–µ ê°•ë„ ì—…ë°ì´íŠ¸\r\n * - ì„¸ì…˜ ì™„ë£Œ ì²˜ë¦¬\r\n */\r\n\r\nimport React, { useState, useCallback, useEffect } from 'react';\r\nimport { ReviewCard } from '@/services/srs/SRSEngine';\r\nimport { useSRSEngine } from '@/hooks/useSRSEngine';\r\n\r\nexport interface ReviewSessionCardProps {\r\n  userId: string;\r\n  cards: ReviewCard[];\r\n  onComplete: (results: Array<{ cardId: string; isCorrect: boolean; responseTime: number; confidence: number }>) => void;\r\n  onCancel: () => void;\r\n  className?: string;\r\n}\r\n\r\ntype SessionPhase = 'ready' | 'reviewing' | 'feedback' | 'completed';\r\n\r\nexport const ReviewSessionCard: React.FC<ReviewSessionCardProps> = ({\r\n  userId,\r\n  cards,\r\n  onComplete,\r\n  onCancel,\r\n  className = ''\r\n}) => {\r\n  const srsEngine = useSRSEngine({ userId });\r\n  \r\n  // ì„¸ì…˜ ìƒíƒœ\r\n  const [phase, setPhase] = useState<SessionPhase>('ready');\r\n  const [currentIndex, setCurrentIndex] = useState(0);\r\n  const [userAnswer, setUserAnswer] = useState('');\r\n  const [sessionResults, setSessionResults] = useState<Array<{\r\n    cardId: string;\r\n    isCorrect: boolean;\r\n    responseTime: number;\r\n    confidence: number;\r\n    userAnswer: string;\r\n    correctAnswer: string;\r\n  }>>([]);\r\n  \r\n  // íƒ€ì´ë° ê´€ë ¨\r\n  const [questionStartTime, setQuestionStartTime] = useState<number>(0);\r\n  const [sessionStartTime, setSessionStartTime] = useState<number>(0);\r\n\r\n  // í˜„ì¬ ì¹´ë“œ\r\n  const currentCard = cards[currentIndex];\r\n  \r\n  // ì§„í–‰ë¥ \r\n  const progress = ((currentIndex + (phase === 'completed' ? 1 : 0)) / cards.length) * 100;\r\n\r\n  // ì„¸ì…˜ ì‹œì‘\r\n  const startSession = useCallback(() => {\r\n    setPhase('reviewing');\r\n    setSessionStartTime(Date.now());\r\n    setQuestionStartTime(Date.now());\r\n  }, []);\r\n\r\n  // ë‹µë³€ ì œì¶œ\r\n  const submitAnswer = useCallback(() => {\r\n    if (!currentCard || userAnswer.trim() === '') return;\r\n\r\n    const responseTime = Date.now() - questionStartTime;\r\n    const isCorrect = userAnswer.trim().toLowerCase() === currentCard.content.english.trim().toLowerCase();\r\n    \r\n    // ì‚¬ìš©ìì—ê²Œ ì‹ ë¢°ë„ í™•ì¸ (ê°„ë‹¨í•œ êµ¬í˜„)\r\n    const confidence = isCorrect ? 0.8 : 0.3;\r\n\r\n    // ê²°ê³¼ ê¸°ë¡\r\n    const result = {\r\n      cardId: currentCard.id,\r\n      isCorrect,\r\n      responseTime,\r\n      confidence,\r\n      userAnswer: userAnswer.trim(),\r\n      correctAnswer: currentCard.content.english\r\n    };\r\n\r\n    setSessionResults(prev => [...prev, result]);\r\n\r\n    // ì¦‰ì‹œ SRS ì—”ì§„ì— ë°˜ì˜\r\n    srsEngine.processReviewSession(currentCard.id, {\r\n      cardId: currentCard.id,\r\n      userAnswer: userAnswer.trim(),\r\n      correctAnswer: currentCard.content.english,\r\n      isCorrect,\r\n      responseTime,\r\n      difficulty: responseTime > 10000 ? 'hard' : responseTime > 5000 ? 'medium' : 'easy',\r\n      confidence\r\n    });\r\n\r\n    setPhase('feedback');\r\n\r\n    // í”¼ë“œë°± í‘œì‹œ í›„ ë‹¤ìŒ ì¹´ë“œ ë˜ëŠ” ì™„ë£Œ\r\n    setTimeout(() => {\r\n      if (currentIndex + 1 < cards.length) {\r\n        // ë‹¤ìŒ ì¹´ë“œë¡œ\r\n        setCurrentIndex(prev => prev + 1);\r\n        setUserAnswer('');\r\n        setPhase('reviewing');\r\n        setQuestionStartTime(Date.now());\r\n      } else {\r\n        // ì„¸ì…˜ ì™„ë£Œ - sessionStartTime í™œìš©í•œ í†µê³„ ìƒì„±\r\n        const totalSessionTime = Date.now() - sessionStartTime;\r\n        const correctCount = results.filter(r => r.isCorrect).length;\r\n        const accuracy = (correctCount / results.length) * 100;\r\n        const averageResponseTime = results.reduce((sum, r) => sum + r.responseTime, 0) / results.length;\r\n        \r\n        console.log('ğŸ¯ SRS Session completed:', {\r\n          totalTime: `${Math.round(totalSessionTime / 1000)}s`,\r\n          accuracy: `${accuracy.toFixed(1)}%`,\r\n          avgResponseTime: `${Math.round(averageResponseTime / 1000)}s`,\r\n          cardsReviewed: results.length\r\n        });\r\n        \r\n        setPhase('completed');\r\n      }\r\n    }, 2000);\r\n  }, [currentCard, userAnswer, questionStartTime, currentIndex, cards.length, srsEngine, sessionStartTime, results]);\r\n\r\n  // ê±´ë„ˆë›°ê¸°\r\n  const skipCard = useCallback(() => {\r\n    if (!currentCard) return;\r\n\r\n    const responseTime = Date.now() - questionStartTime;\r\n    const result = {\r\n      cardId: currentCard.id,\r\n      isCorrect: false,\r\n      responseTime,\r\n      confidence: 0.1,\r\n      userAnswer: '(ê±´ë„ˆëœ€)',\r\n      correctAnswer: currentCard.content.english\r\n    };\r\n\r\n    setSessionResults(prev => [...prev, result]);\r\n\r\n    // SRS ì—”ì§„ì— ë°˜ì˜\r\n    srsEngine.processReviewSession(currentCard.id, {\r\n      cardId: currentCard.id,\r\n      userAnswer: '',\r\n      correctAnswer: currentCard.content.english,\r\n      isCorrect: false,\r\n      responseTime,\r\n      difficulty: 'hard',\r\n      confidence: 0.1\r\n    });\r\n\r\n    if (currentIndex + 1 < cards.length) {\r\n      setCurrentIndex(prev => prev + 1);\r\n      setUserAnswer('');\r\n      setQuestionStartTime(Date.now());\r\n    } else {\r\n      setPhase('completed');\r\n    }\r\n  }, [currentCard, questionStartTime, currentIndex, cards.length, srsEngine]);\r\n\r\n  // ì„¸ì…˜ ì™„ë£Œ ì²˜ë¦¬\r\n  const handleComplete = useCallback(() => {\r\n    const finalResults = sessionResults.map(result => ({\r\n      cardId: result.cardId,\r\n      isCorrect: result.isCorrect,\r\n      responseTime: result.responseTime,\r\n      confidence: result.confidence\r\n    }));\r\n\r\n    onComplete(finalResults);\r\n  }, [sessionResults, onComplete]);\r\n\r\n  // í‚¤ë³´ë“œ ì´ë²¤íŠ¸ ì²˜ë¦¬\r\n  useEffect(() => {\r\n    const handleKeyPress = (event: KeyboardEvent) => {\r\n      if (phase === 'reviewing' && event.key === 'Enter' && userAnswer.trim() !== '') {\r\n        submitAnswer();\r\n      } else if (phase === 'reviewing' && event.key === 'Escape') {\r\n        skipCard();\r\n      }\r\n    };\r\n\r\n    window.addEventListener('keydown', handleKeyPress);\r\n    return () => window.removeEventListener('keydown', handleKeyPress);\r\n  }, [phase, userAnswer, submitAnswer, skipCard]);\r\n\r\n  // ì„¸ì…˜ í†µê³„ ê³„ì‚°\r\n  const sessionStats = {\r\n    correct: sessionResults.filter(r => r.isCorrect).length,\r\n    total: sessionResults.length,\r\n    averageTime: sessionResults.length > 0 ? \r\n      sessionResults.reduce((sum, r) => sum + r.responseTime, 0) / sessionResults.length : 0,\r\n    accuracy: sessionResults.length > 0 ? \r\n      sessionResults.filter(r => r.isCorrect).length / sessionResults.length : 0\r\n  };\r\n\r\n  if (cards.length === 0) {\r\n    return (\r\n      <div className={`bg-white rounded-xl shadow-lg p-6 text-center ${className}`}>\r\n        <h2 className=\"text-xl font-bold text-gray-800 mb-4\">ë³µìŠµí•  ì¹´ë“œê°€ ì—†ìŠµë‹ˆë‹¤</h2>\r\n        <p className=\"text-gray-600 mb-6\">ìƒˆë¡œìš´ ì¹´ë“œë¥¼ ì¶”ê°€í•˜ê±°ë‚˜ ë‚˜ì¤‘ì— ë‹¤ì‹œ ì‹œë„í•´ë³´ì„¸ìš”.</p>\r\n        <button\r\n          onClick={onCancel}\r\n          className=\"px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors\"\r\n        >\r\n          ëŒì•„ê°€ê¸°\r\n        </button>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className={`bg-white rounded-xl shadow-lg p-6 ${className}`}>\r\n      {/* í—¤ë” */}\r\n      <div className=\"mb-6\">\r\n        <div className=\"flex items-center justify-between mb-2\">\r\n          <h2 className=\"text-xl font-bold text-gray-800\">ë³µìŠµ ì„¸ì…˜</h2>\r\n          <button\r\n            onClick={onCancel}\r\n            className=\"text-gray-500 hover:text-gray-700\"\r\n            title=\"ì„¸ì…˜ ì¢…ë£Œ\"\r\n          >\r\n            âœ•\r\n          </button>\r\n        </div>\r\n        \r\n        {/* ì§„í–‰ë¥  */}\r\n        <div className=\"w-full bg-gray-200 rounded-full h-2 mb-2\">\r\n          <div \r\n            className=\"bg-blue-600 h-2 rounded-full transition-all duration-300\"\r\n            style={{ width: `${progress}%` }}\r\n          ></div>\r\n        </div>\r\n        \r\n        <div className=\"flex items-center justify-between text-sm text-gray-600\">\r\n          <span>{currentIndex + 1} / {cards.length}</span>\r\n          <span>{sessionStats.total > 0 && `ì •ë‹µë¥ : ${(sessionStats.accuracy * 100).toFixed(0)}%`}</span>\r\n        </div>\r\n      </div>\r\n\r\n      {/* ì„¸ì…˜ ì‹œì‘ í™”ë©´ */}\r\n      {phase === 'ready' && (\r\n        <div className=\"text-center py-8\">\r\n          <h3 className=\"text-lg font-semibold text-gray-800 mb-4\">ë³µìŠµ ì„¸ì…˜ì„ ì‹œì‘í•˜ì‹œê² ìŠµë‹ˆê¹Œ?</h3>\r\n          <p className=\"text-gray-600 mb-6\">ì´ {cards.length}ê°œì˜ ì¹´ë“œë¥¼ ë³µìŠµí•©ë‹ˆë‹¤.</p>\r\n          <div className=\"flex items-center justify-center space-x-4\">\r\n            <button\r\n              onClick={startSession}\r\n              className=\"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors\"\r\n            >\r\n              ì‹œì‘í•˜ê¸°\r\n            </button>\r\n            <button\r\n              onClick={onCancel}\r\n              className=\"px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors\"\r\n            >\r\n              ì·¨ì†Œ\r\n            </button>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* ë³µìŠµ ì§„í–‰ í™”ë©´ */}\r\n      {phase === 'reviewing' && currentCard && (\r\n        <div className=\"space-y-6\">\r\n          {/* ë¬¸ì œ ì¹´ë“œ */}\r\n          <div className=\"bg-blue-50 rounded-lg p-6 border border-blue-100 text-center\">\r\n            <h3 className=\"text-2xl font-bold text-blue-900 mb-2\">{currentCard.content.korean}</h3>\r\n            {currentCard.content.pattern && (\r\n              <p className=\"text-sm text-blue-600\">íŒ¨í„´: {currentCard.content.pattern}</p>\r\n            )}\r\n          </div>\r\n\r\n          {/* ë‹µë³€ ì…ë ¥ */}\r\n          <div className=\"space-y-4\">\r\n            <label className=\"block text-sm font-medium text-gray-700\">\r\n              ì˜ì–´ë¡œ ë²ˆì—­í•˜ì„¸ìš”:\r\n            </label>\r\n            <input\r\n              type=\"text\"\r\n              value={userAnswer}\r\n              onChange={(e) => setUserAnswer(e.target.value)}\r\n              onKeyDown={(e) => e.key === 'Enter' && userAnswer.trim() && submitAnswer()}\r\n              placeholder=\"ì˜ì–´ ë²ˆì—­ì„ ì…ë ¥í•˜ì„¸ìš”...\"\r\n              className=\"w-full px-4 py-3 text-lg border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n              autoFocus\r\n            />\r\n          </div>\r\n\r\n          {/* ì»¨íŠ¸ë¡¤ ë²„íŠ¼ */}\r\n          <div className=\"flex items-center justify-between\">\r\n            <button\r\n              onClick={skipCard}\r\n              className=\"px-4 py-2 text-gray-600 hover:text-gray-800 underline\"\r\n            >\r\n              ê±´ë„ˆë›°ê¸° (ESC)\r\n            </button>\r\n            <button\r\n              onClick={submitAnswer}\r\n              disabled={userAnswer.trim() === ''}\r\n              className=\"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors\"\r\n            >\r\n              ì œì¶œ (Enter)\r\n            </button>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* í”¼ë“œë°± í™”ë©´ */}\r\n      {phase === 'feedback' && currentCard && (\r\n        <div className=\"space-y-6 text-center\">\r\n          {/* ì •ë‹µ/ì˜¤ë‹µ í‘œì‹œ */}\r\n          <div className={`rounded-lg p-6 border ${\r\n            sessionResults[sessionResults.length - 1]?.isCorrect\r\n              ? 'bg-green-50 border-green-100'\r\n              : 'bg-red-50 border-red-100'\r\n          }`}>\r\n            <div className={`text-6xl mb-4 ${\r\n              sessionResults[sessionResults.length - 1]?.isCorrect ? 'text-green-600' : 'text-red-600'\r\n            }`}>\r\n              {sessionResults[sessionResults.length - 1]?.isCorrect ? 'âœ…' : 'âŒ'}\r\n            </div>\r\n            \r\n            <h3 className={`text-xl font-bold mb-2 ${\r\n              sessionResults[sessionResults.length - 1]?.isCorrect ? 'text-green-800' : 'text-red-800'\r\n            }`}>\r\n              {sessionResults[sessionResults.length - 1]?.isCorrect ? 'ì •ë‹µ!' : 'í‹€ë ¸ìŠµë‹ˆë‹¤'}\r\n            </h3>\r\n\r\n            <div className=\"space-y-2 text-lg\">\r\n              <p><strong>ì •ë‹µ:</strong> {currentCard.content.english}</p>\r\n              {!sessionResults[sessionResults.length - 1]?.isCorrect && (\r\n                <p><strong>ì…ë ¥:</strong> {sessionResults[sessionResults.length - 1]?.userAnswer}</p>\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          {/* ê¸°ì–µ ê°•ë„ ì—…ë°ì´íŠ¸ ì •ë³´ */}\r\n          <div className=\"bg-gray-50 rounded-lg p-4\">\r\n            <p className=\"text-sm text-gray-600\">\r\n              ê¸°ì–µ ê°•ë„ê°€ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤: {(currentCard.memory.strength * 100).toFixed(0)}% \r\n              {sessionResults[sessionResults.length - 1]?.isCorrect ? ' â†—ï¸' : ' â†˜ï¸'}\r\n            </p>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* ì™„ë£Œ í™”ë©´ */}\r\n      {phase === 'completed' && (\r\n        <div className=\"text-center py-8\">\r\n          <div className=\"text-6xl mb-4\">ğŸ‰</div>\r\n          <h3 className=\"text-2xl font-bold text-gray-800 mb-4\">ë³µìŠµ ì™„ë£Œ!</h3>\r\n          \r\n          {/* ì„¸ì…˜ í†µê³„ */}\r\n          <div className=\"bg-gray-50 rounded-lg p-6 mb-6\">\r\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 text-center\">\r\n              <div>\r\n                <p className=\"text-2xl font-bold text-green-600\">{sessionStats.correct}</p>\r\n                <p className=\"text-sm text-gray-600\">ì •ë‹µ</p>\r\n              </div>\r\n              <div>\r\n                <p className=\"text-2xl font-bold text-red-600\">{sessionStats.total - sessionStats.correct}</p>\r\n                <p className=\"text-sm text-gray-600\">ì˜¤ë‹µ</p>\r\n              </div>\r\n              <div>\r\n                <p className=\"text-2xl font-bold text-blue-600\">{(sessionStats.accuracy * 100).toFixed(0)}%</p>\r\n                <p className=\"text-sm text-gray-600\">ì •ë‹µë¥ </p>\r\n              </div>\r\n              <div>\r\n                <p className=\"text-2xl font-bold text-purple-600\">{(sessionStats.averageTime / 1000).toFixed(1)}s</p>\r\n                <p className=\"text-sm text-gray-600\">í‰ê·  ì‹œê°„</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <button\r\n            onClick={handleComplete}\r\n            className=\"px-8 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-lg font-semibold\"\r\n          >\r\n            ì™„ë£Œ\r\n          </button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ReviewSessionCard;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\ui\\StageGrid.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\ui\\StageInfoPanel.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\components\\ui\\ThemeToggle.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\config\\curriculum.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\config\\stageConfig.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\container\\ServiceContainer.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\data\\patternData.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\env.d.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\factories\\AdapterFactory.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\hooks\\useAccessibility.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useRef' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":44,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":50}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback, useRef } from 'react';\n\n/**\n * ì ‘ê·¼ì„± ê´€ë ¨ ìœ í‹¸ë¦¬í‹° í›…\n * \n * Note: ë³µì¡í•œ custom hookë“¤ì€ hooks-in-callback ì—ëŸ¬ë¡œ ì¸í•´ ì œê±°ë¨\n * í•„ìš”ì‹œ ë³„ë„ì˜ custom hook íŒŒì¼ë¡œ ë¶„ë¦¬í•˜ì—¬ êµ¬í˜„ í•„ìš”\n */\nexport const useAccessibility = () => {\n  const [prefersReducedMotion, setPrefersReducedMotion] = useState(false);\n  const [highContrast, setHighContrast] = useState(false);\n  const [fontSize, setFontSize] = useState('medium');\n\n  // ì ‘ê·¼ì„± ì„¤ì • ê°ì§€\n  useEffect(() => {\n    // Reduced motion ê°ì§€\n    const motionQuery = window.matchMedia('(prefers-reduced-motion: reduce)');\n    setPrefersReducedMotion(motionQuery.matches);\n\n    // High contrast ê°ì§€\n    const contrastQuery = window.matchMedia('(prefers-contrast: high)');\n    setHighContrast(contrastQuery.matches);\n\n    const handleMotionChange = (e: MediaQueryListEvent) => {\n      setPrefersReducedMotion(e.matches);\n    };\n\n    const handleContrastChange = (e: MediaQueryListEvent) => {\n      setHighContrast(e.matches);\n    };\n\n    if (motionQuery.addEventListener) {\n      motionQuery.addEventListener('change', handleMotionChange);\n      contrastQuery.addEventListener('change', handleContrastChange);\n      \n      return () => {\n        motionQuery.removeEventListener('change', handleMotionChange);\n        contrastQuery.removeEventListener('change', handleContrastChange);\n      };\n    }\n  }, []);\n\n  /**\n   * ARIA ë ˆì´ë¸” ìƒì„± í—¬í¼\n   */\n  const createAriaLabel = useCallback((\n    label: string, \n    description?: string\n  ): { 'aria-label': string; 'aria-describedby'?: string } => {\n    const result: { 'aria-label': string; 'aria-describedby'?: string } = {\n      'aria-label': label\n    };\n\n    if (description) {\n      const descriptionId = `desc-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n      result['aria-describedby'] = descriptionId;\n    }\n\n    return result;\n  }, []);\n\n  /**\n   * í¬ì»¤ìŠ¤ ê´€ë¦¬ ìœ í‹¸ë¦¬í‹°\n   */\n  const focusElement = useCallback((element: HTMLElement | null) => {\n    if (element && element.focus) {\n      element.focus();\n    }\n  }, []);\n\n  /**\n   * í‚¤ë³´ë“œ ë„¤ë¹„ê²Œì´ì…˜ í—¬í¼\n   */\n  const isNavigationKey = useCallback((key: string): boolean => {\n    return ['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'Tab', 'Enter', 'Space', 'Escape'].includes(key);\n  }, []);\n\n  return {\n    // ì ‘ê·¼ì„± ìƒíƒœ\n    prefersReducedMotion,\n    highContrast,\n    fontSize,\n    \n    // ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜\n    createAriaLabel,\n    focusElement,\n    isNavigationKey,\n    \n    // ì„¤ì • ë³€ê²½\n    setFontSize\n  };\n};\n\nexport default useAccessibility;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\hooks\\useAnimations.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The ref value 'animationTimeouts.current' will likely have changed by the time this effect cleanup function runs. If this ref points to a node rendered by React, copy 'animationTimeouts.current' to a variable inside the effect, and use that variable in the cleanup function.","line":33,"column":25,"nodeType":"Identifier","endLine":33,"endColumn":32}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useState, useCallback, useRef } from 'react';\n\n/**\n * ì¢…í•© ì• ë‹ˆë©”ì´ì…˜ ìœ í‹¸ë¦¬í‹° í›…\n * ì• ë‹ˆë©”ì´ì…˜ ê´€ë ¨ ê¸°ëŠ¥ë“¤ì„ í†µí•© ì œê³µ\n * \n * Note: ë³µì¡í•œ custom hookë“¤ì€ hooks-in-callback ì—ëŸ¬ë¡œ ì¸í•´ ì œê±°ë¨\n * í•„ìš”ì‹œ ë³„ë„ì˜ custom hook íŒŒì¼ë¡œ ë¶„ë¦¬í•˜ì—¬ êµ¬í˜„ í•„ìš”\n */\nexport const useAnimations = () => {\n  const animationTimeouts = useRef<Set<NodeJS.Timeout>>(new Set());\n  const [prefersReducedMotion, setPrefersReducedMotion] = useState(false);\n\n  // Reduced motion ê°ì§€\n  useEffect(() => {\n    const mediaQuery = window.matchMedia('(prefers-reduced-motion: reduce)');\n    setPrefersReducedMotion(mediaQuery.matches);\n\n    const handleChange = (e: MediaQueryListEvent) => {\n      setPrefersReducedMotion(e.matches);\n    };\n\n    if (mediaQuery.addEventListener) {\n      mediaQuery.addEventListener('change', handleChange);\n      return () => mediaQuery.removeEventListener('change', handleChange);\n    }\n  }, []);\n\n  // ì»´í¬ë„ŒíŠ¸ ì–¸ë§ˆìš´íŠ¸ ì‹œ ëª¨ë“  ì• ë‹ˆë©”ì´ì…˜ íƒ€ì´ë¨¸ ì •ë¦¬\n  useEffect(() => {\n    return () => {\n      animationTimeouts.current.forEach(clearTimeout);\n      animationTimeouts.current.clear();\n    };\n  }, []);\n\n  /**\n   * ê¸°ë³¸ ì• ë‹ˆë©”ì´ì…˜ í´ë˜ìŠ¤ ìƒì„±\n   */\n  const getAnimationClasses = useCallback((animationClass: string, fallbackClass = '') => {\n    return prefersReducedMotion ? fallbackClass : animationClass;\n  }, [prefersReducedMotion]);\n\n  /**\n   * ì• ë‹ˆë©”ì´ì…˜ í´ë˜ìŠ¤ í—¬í¼\n   */\n  const getFadeInClasses = useCallback((isVisible: boolean) => {\n    return getAnimationClasses(\n      isVisible ? 'opacity-100 transition-opacity duration-300' : 'opacity-0',\n      'opacity-100'\n    );\n  }, [getAnimationClasses]);\n\n  return {\n    // ìƒíƒœ\n    prefersReducedMotion,\n    \n    // ìœ í‹¸ë¦¬í‹°\n    getAnimationClasses,\n    getFadeInClasses,\n    \n    // ì• ë‹ˆë©”ì´ì…˜ íƒ€ì´ë¨¸ ê´€ë¦¬\n    animationTimeouts: animationTimeouts.current\n  };\n};\n\nexport default useAnimations;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\hooks\\useAnswerEvaluation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\hooks\\useAsyncStatus.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\hooks\\useAudioFlowController.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\hooks\\useAudioManager.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'VoiceSettings' is defined but never used. Allowed unused vars must match /^_/u.","line":10,"column":46,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":59}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * useAudioManager - TTS ë° ì˜¤ë””ì˜¤ ê´€ë¦¬ í›… (í”ŒëŸ¬ê·¸ì¸ ê¸°ë°˜)\r\n * - í”ŒëŸ¬ê·¸ì¸ ì•„í‚¤í…ì²˜ë¥¼ í†µí•œ TTS ê´€ë¦¬\r\n * - ê³ ê¸‰ TTS ì„¤ì • ì§€ì›  \r\n * - ìì—°ìŠ¤ëŸ¬ìš´ ìŒì„± ì¶œë ¥\r\n * - ê°œì¸í™”ëœ ìŒì„± ì„¤ì • ì ìš©\r\n */\r\n\r\nimport { useCallback, useEffect, useState } from 'react';\r\nimport { useLocalStorage, STORAGE_KEYS, type VoiceSettings } from './useLocalStorage';\r\nimport { getSpeechPlugin, type ISpeechPlugin } from '@/plugins';\r\nimport { NonEmptyString } from '@/types/core';\r\n\r\ninterface UseAudioManagerReturn {\r\n  playKoreanTTS: (text: string) => Promise<void>;\r\n  playEnglishTTS: (text: string) => Promise<void>;\r\n  playBeepSound: (type?: 'start' | 'countdown' | 'recognition') => Promise<void>;\r\n  stopAllAudio: () => void;\r\n  isPlaying: boolean;\r\n}\r\n\r\nexport const useAudioManager = (): UseAudioManagerReturn => {\r\n  const { value: voiceSettings } = useLocalStorage(STORAGE_KEYS.VOICE_SETTINGS);\r\n  const [speechPlugin, setSpeechPlugin] = useState<ISpeechPlugin | null>(null);\r\n  const [isPlayingState, setIsPlayingState] = useState(false);\r\n\r\n  // í”ŒëŸ¬ê·¸ì¸ ì´ˆê¸°í™”\r\n  useEffect(() => {\r\n    const initializePlugin = async () => {\r\n      try {\r\n        const plugin = await getSpeechPlugin();\r\n        if (plugin) {\r\n          setSpeechPlugin(plugin);\r\n          console.log('ğŸ”Š SpeechPlugin ì´ˆê¸°í™” ì™„ë£Œ');\r\n        }\r\n      } catch (error) {\r\n        console.error('âŒ SpeechPlugin ì´ˆê¸°í™” ì‹¤íŒ¨:', error);\r\n      }\r\n    };\r\n\r\n    initializePlugin();\r\n  }, []);\r\n\r\n\r\n  /**\r\n   * í•œêµ­ì–´ TTS ì¬ìƒ - 100% í”ŒëŸ¬ê·¸ì¸ ê¸°ë°˜\r\n   */\r\n  const playKoreanTTS = useCallback(async (text: string): Promise<void> => {\r\n    if (!voiceSettings.koreanEnabled) {\r\n      console.log('ğŸ”‡ í•œêµ­ì–´ ìŒì„±ì´ ë¹„í™œì„±í™”ë¨');\r\n      return;\r\n    }\r\n\r\n    if (!speechPlugin) {\r\n      console.warn('âš ï¸ SpeechPlugin ë¯¸ì´ˆê¸°í™” - í•œêµ­ì–´ TTS ìŠ¤í‚µ');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      // ê¸°ì¡´ ìŒì„± ì¤‘ë‹¨\r\n      speechPlugin.stopAll();\r\n      \r\n      // í”ŒëŸ¬ê·¸ì¸ì„ í†µí•œ TTS ì‹¤í–‰\r\n      const result = await speechPlugin.speakText(text as NonEmptyString, {\r\n        language: 'ko-KR' as NonEmptyString,\r\n        rate: voiceSettings.speed,\r\n        volume: voiceSettings.volume,\r\n        pitch: voiceSettings.pitch\r\n      });\r\n\r\n      if (result.isErr) {\r\n        console.error('âŒ í•œêµ­ì–´ TTS í”ŒëŸ¬ê·¸ì¸ ì˜¤ë¥˜:', result.error);\r\n        // í”ŒëŸ¬ê·¸ì¸ ì‹¤íŒ¨ ì‹œì—ë„ í´ë°±í•˜ì§€ ì•ŠìŒ (100% í”ŒëŸ¬ê·¸ì¸ ì›ì¹™)\r\n        return;\r\n      }\r\n\r\n      console.log('ğŸ”Š í•œêµ­ì–´ TTS ì™„ë£Œ (í”ŒëŸ¬ê·¸ì¸)');\r\n    } catch (error) {\r\n      console.error('âŒ í•œêµ­ì–´ TTS ì˜ˆì™¸:', error);\r\n    }\r\n  }, [speechPlugin, voiceSettings]);\r\n\r\n  /**\r\n   * ì˜ì–´ TTS ì¬ìƒ - 100% í”ŒëŸ¬ê·¸ì¸ ê¸°ë°˜\r\n   */\r\n  const playEnglishTTS = useCallback(async (text: string): Promise<void> => {\r\n    if (!voiceSettings.englishEnabled) {\r\n      console.log('ğŸ”‡ ì˜ì–´ ìŒì„±ì´ ë¹„í™œì„±í™”ë¨');\r\n      return;\r\n    }\r\n\r\n    if (!speechPlugin) {\r\n      console.warn('âš ï¸ SpeechPlugin ë¯¸ì´ˆê¸°í™” - ì˜ì–´ TTS ìŠ¤í‚µ');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      // ê¸°ì¡´ ìŒì„± ì¤‘ë‹¨\r\n      speechPlugin.stopAll();\r\n      \r\n      // í”ŒëŸ¬ê·¸ì¸ì„ í†µí•œ TTS ì‹¤í–‰\r\n      const result = await speechPlugin.speakText(text as NonEmptyString, {\r\n        language: 'en-US' as NonEmptyString,\r\n        rate: voiceSettings.speed,\r\n        volume: voiceSettings.volume,\r\n        pitch: voiceSettings.pitch\r\n      });\r\n\r\n      if (result.isErr) {\r\n        console.error('âŒ ì˜ì–´ TTS í”ŒëŸ¬ê·¸ì¸ ì˜¤ë¥˜:', result.error);\r\n        // í”ŒëŸ¬ê·¸ì¸ ì‹¤íŒ¨ ì‹œì—ë„ í´ë°±í•˜ì§€ ì•ŠìŒ (100% í”ŒëŸ¬ê·¸ì¸ ì›ì¹™)\r\n        return;\r\n      }\r\n\r\n      console.log('ğŸ”Š ì˜ì–´ TTS ì™„ë£Œ (í”ŒëŸ¬ê·¸ì¸)');\r\n    } catch (error) {\r\n      console.error('âŒ ì˜ì–´ TTS ì˜ˆì™¸:', error);\r\n    }\r\n  }, [speechPlugin, voiceSettings]);\r\n\r\n  /**\r\n   * ëª¨ë“  ìŒì„± ì¬ìƒ ì¤‘ë‹¨ - 100% í”ŒëŸ¬ê·¸ì¸ ê¸°ë°˜\r\n   */\r\n  const stopAllAudio = useCallback((): void => {\r\n    if (!speechPlugin) {\r\n      console.warn('âš ï¸ SpeechPlugin ë¯¸ì´ˆê¸°í™” - ìŒì„± ì¤‘ë‹¨ ë¶ˆê°€');\r\n      return;\r\n    }\r\n\r\n    const result = speechPlugin.stopAll();\r\n    if (result.isErr) {\r\n      console.error('âŒ í”ŒëŸ¬ê·¸ì¸ ìŒì„± ì¤‘ë‹¨ ì˜¤ë¥˜:', result.error);\r\n    }\r\n  }, [speechPlugin]);\r\n\r\n  // ìŒì„± ì¬ìƒ ìƒíƒœë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ì—…ë°ì´íŠ¸\r\n  useEffect(() => {\r\n    if (!speechPlugin) return;\r\n    \r\n    const checkPlayingStatus = () => {\r\n      const currentlyPlaying = speechPlugin.isProcessing();\r\n      setIsPlayingState(currentlyPlaying);\r\n    };\r\n    \r\n    // 100msë§ˆë‹¤ ì¬ìƒ ìƒíƒœ í™•ì¸\r\n    const interval = setInterval(checkPlayingStatus, 100);\r\n    return () => clearInterval(interval);\r\n  }, [speechPlugin]);\r\n\r\n  /**\r\n   * ì‚ì†Œë¦¬ ì¬ìƒ í•¨ìˆ˜ - 100% í”ŒëŸ¬ê·¸ì¸ ê¸°ë°˜\r\n   */\r\n  const playBeepSound = useCallback(async (type: 'start' | 'countdown' | 'recognition' = 'start'): Promise<void> => {\r\n    if (!speechPlugin) {\r\n      console.warn('âš ï¸ SpeechPlugin ë¯¸ì´ˆê¸°í™” - ì‚ì†Œë¦¬ ì¬ìƒ ë¶ˆê°€');\r\n      return;\r\n    }\r\n\r\n    const frequencies = {\r\n      start: 800,\r\n      countdown: 600,\r\n      recognition: 1000\r\n    };\r\n    \r\n    const result = await speechPlugin.playBeep({\r\n      frequency: frequencies[type],\r\n      duration: 200,\r\n      volume: 0.1\r\n    });\r\n    \r\n    if (result.isErr) {\r\n      console.error('âŒ í”ŒëŸ¬ê·¸ì¸ ì‚ì†Œë¦¬ ì¬ìƒ ì˜¤ë¥˜:', result.error);\r\n    }\r\n  }, [speechPlugin]);\r\n\r\n  return {\r\n    playKoreanTTS,\r\n    playEnglishTTS,\r\n    playBeepSound,\r\n    stopAllAudio,\r\n    isPlaying: isPlayingState\r\n  };\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\hooks\\useAudioService.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'serviceContainer' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":190,"column":15,"nodeType":null,"messageId":"unusedVar","endLine":190,"endColumn":31},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'options.config' and 'options.serviceContainer'. Either include them or remove the dependency array.","line":210,"column":6,"nodeType":"ArrayExpression","endLine":210,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [options.config, options.serviceContainer]","fix":{"range":[5878,5880],"text":"[options.config, options.serviceContainer]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useCallback, useRef, useEffect } from 'react';\r\nimport { ServiceContainer } from '@/container/ServiceContainer';\r\n\r\ninterface AudioConfig {\r\n  volume?: number;\r\n  autoCleanup?: boolean;\r\n  maxInstances?: number;\r\n}\r\n\r\ninterface UseAudioServiceOptions {\r\n  config?: AudioConfig;\r\n  serviceContainer?: ServiceContainer;\r\n}\r\n\r\ninterface AudioInstance {\r\n  id: string;\r\n  element: HTMLAudioElement;\r\n  isPlaying: boolean;\r\n  createdAt: number;\r\n}\r\n\r\nclass AudioService {\r\n  private instances = new Map<string, AudioInstance>();\r\n  private maxInstances = 10;\r\n  private cleanupInterval: NodeJS.Timeout | null = null;\r\n\r\n  constructor(config?: AudioConfig) {\r\n    this.maxInstances = config?.maxInstances || 10;\r\n    \r\n    if (config?.autoCleanup !== false) {\r\n      this.startCleanupInterval();\r\n    }\r\n  }\r\n\r\n  private startCleanupInterval() {\r\n    this.cleanupInterval = setInterval(() => {\r\n      this.cleanup();\r\n    }, 30000); // Clean up every 30 seconds\r\n  }\r\n\r\n  private cleanup() {\r\n    const now = Date.now();\r\n    const fiveMinutes = 5 * 60 * 1000;\r\n\r\n    for (const [id, instance] of this.instances.entries()) {\r\n      if (!instance.isPlaying && (now - instance.createdAt) > fiveMinutes) {\r\n        this.destroy(id);\r\n      }\r\n    }\r\n\r\n    // If we still have too many instances, remove the oldest inactive ones\r\n    const inactiveInstances = Array.from(this.instances.entries())\r\n      .filter(([, instance]) => !instance.isPlaying)\r\n      .sort(([, a], [, b]) => a.createdAt - b.createdAt);\r\n\r\n    while (this.instances.size > this.maxInstances && inactiveInstances.length > 0) {\r\n      const [id] = inactiveInstances.shift()!;\r\n      this.destroy(id);\r\n    }\r\n  }\r\n\r\n  create(src: string, config?: AudioConfig): string {\r\n    const id = `audio_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n    \r\n    // Clean up if we have too many instances\r\n    if (this.instances.size >= this.maxInstances) {\r\n      this.cleanup();\r\n    }\r\n\r\n    const audio = new Audio(src);\r\n    audio.volume = config?.volume || 1;\r\n    \r\n    // Preload the audio\r\n    audio.preload = 'auto';\r\n\r\n    const instance: AudioInstance = {\r\n      id,\r\n      element: audio,\r\n      isPlaying: false,\r\n      createdAt: Date.now()\r\n    };\r\n\r\n    // Set up event listeners\r\n    audio.addEventListener('play', () => {\r\n      instance.isPlaying = true;\r\n    });\r\n\r\n    audio.addEventListener('pause', () => {\r\n      instance.isPlaying = false;\r\n    });\r\n\r\n    audio.addEventListener('ended', () => {\r\n      instance.isPlaying = false;\r\n    });\r\n\r\n    audio.addEventListener('error', (error) => {\r\n      console.warn(`Audio error for instance ${id}:`, error);\r\n      instance.isPlaying = false;\r\n    });\r\n\r\n    this.instances.set(id, instance);\r\n    return id;\r\n  }\r\n\r\n  async play(id: string): Promise<void> {\r\n    const instance = this.instances.get(id);\r\n    if (!instance) {\r\n      throw new Error(`Audio instance ${id} not found`);\r\n    }\r\n\r\n    try {\r\n      await instance.element.play();\r\n    } catch (error) {\r\n      console.warn(`Failed to play audio ${id}:`, error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  pause(id: string): void {\r\n    const instance = this.instances.get(id);\r\n    if (instance) {\r\n      instance.element.pause();\r\n    }\r\n  }\r\n\r\n  stop(id: string): void {\r\n    const instance = this.instances.get(id);\r\n    if (instance) {\r\n      instance.element.pause();\r\n      instance.element.currentTime = 0;\r\n    }\r\n  }\r\n\r\n  setVolume(id: string, volume: number): void {\r\n    const instance = this.instances.get(id);\r\n    if (instance) {\r\n      instance.element.volume = Math.max(0, Math.min(1, volume));\r\n    }\r\n  }\r\n\r\n  isPlaying(id: string): boolean {\r\n    const instance = this.instances.get(id);\r\n    return instance ? instance.isPlaying : false;\r\n  }\r\n\r\n  destroy(id: string): void {\r\n    const instance = this.instances.get(id);\r\n    if (instance) {\r\n      instance.element.pause();\r\n      instance.element.src = '';\r\n      instance.element.load(); // Reset the element\r\n      this.instances.delete(id);\r\n    }\r\n  }\r\n\r\n  destroyAll(): void {\r\n    for (const id of this.instances.keys()) {\r\n      this.destroy(id);\r\n    }\r\n  }\r\n\r\n  getActiveCount(): number {\r\n    return Array.from(this.instances.values()).filter(instance => instance.isPlaying).length;\r\n  }\r\n\r\n  getTotalCount(): number {\r\n    return this.instances.size;\r\n  }\r\n\r\n  dispose(): void {\r\n    if (this.cleanupInterval) {\r\n      clearInterval(this.cleanupInterval);\r\n      this.cleanupInterval = null;\r\n    }\r\n    this.destroyAll();\r\n  }\r\n}\r\n\r\n// Global audio service instance\r\nlet globalAudioService: AudioService | null = null;\r\n\r\nexport function useAudioService(options: UseAudioServiceOptions = {}) {\r\n  const serviceRef = useRef<AudioService | null>(null);\r\n\r\n  // ğŸ”§ ì˜ì¡´ì„± ì£¼ì…: ServiceContainerë¥¼ í†µí•œ AudioService íšë“\r\n  useEffect(() => {\r\n    if (!globalAudioService) {\r\n      try {\r\n        // ğŸ”§ Direct ìƒì„± ì œê±°: ServiceContainerë¥¼ í†µí•´ AudioService íšë“ ì‹œë„\r\n        const serviceContainer = options.serviceContainer || ServiceContainer.getInstance();\r\n        \r\n        // TODO: ServiceContainerì— AudioService ë“±ë¡ ë©”ì„œë“œ êµ¬í˜„ í•„ìš”\r\n        // globalAudioService = await serviceContainer.getAudioService(options.config);\r\n        \r\n        // ğŸ”§ Fallback: ServiceContainerì— AudioServiceê°€ ì—†ìœ¼ë©´ ì§ì ‘ ìƒì„±\r\n        console.warn('[useAudioService] AudioService not available in ServiceContainer, creating instance directly');\r\n        globalAudioService = new AudioService(options.config);\r\n      } catch (error) {\r\n        console.error('[useAudioService] Failed to get AudioService from container:', error);\r\n        // ğŸ”§ Final Fallback: ì—ëŸ¬ ì‹œ ì§ì ‘ ìƒì„±\r\n        globalAudioService = new AudioService(options.config);\r\n      }\r\n    }\r\n    serviceRef.current = globalAudioService;\r\n\r\n    return () => {\r\n      // Only dispose when the last component unmounts\r\n      // This is handled by the global service cleanup\r\n    };\r\n  }, []);\r\n\r\n  // Cleanup on unmount\r\n  useEffect(() => {\r\n    return () => {\r\n      // Individual components don't dispose the global service\r\n      // The service manages its own cleanup\r\n    };\r\n  }, []);\r\n\r\n  const createAudio = useCallback((src: string, audioConfig?: AudioConfig) => {\r\n    return serviceRef.current?.create(src, audioConfig) || '';\r\n  }, []);\r\n\r\n  const playAudio = useCallback(async (id: string) => {\r\n    return serviceRef.current?.play(id);\r\n  }, []);\r\n\r\n  const pauseAudio = useCallback((id: string) => {\r\n    serviceRef.current?.pause(id);\r\n  }, []);\r\n\r\n  const stopAudio = useCallback((id: string) => {\r\n    serviceRef.current?.stop(id);\r\n  }, []);\r\n\r\n  const setAudioVolume = useCallback((id: string, volume: number) => {\r\n    serviceRef.current?.setVolume(id, volume);\r\n  }, []);\r\n\r\n  const isAudioPlaying = useCallback((id: string) => {\r\n    return serviceRef.current?.isPlaying(id) || false;\r\n  }, []);\r\n\r\n  const destroyAudio = useCallback((id: string) => {\r\n    serviceRef.current?.destroy(id);\r\n  }, []);\r\n\r\n  const getStats = useCallback(() => {\r\n    if (!serviceRef.current) return { active: 0, total: 0 };\r\n    return {\r\n      active: serviceRef.current.getActiveCount(),\r\n      total: serviceRef.current.getTotalCount()\r\n    };\r\n  }, []);\r\n\r\n  return {\r\n    createAudio,\r\n    playAudio,\r\n    pauseAudio,\r\n    stopAudio,\r\n    setAudioVolume,\r\n    isAudioPlaying,\r\n    destroyAudio,\r\n    getStats\r\n  };\r\n}\r\n\r\n// Export function to manually dispose the global service (for app cleanup)\r\nexport function disposeGlobalAudioService() {\r\n  if (globalAudioService) {\r\n    globalAudioService.dispose();\r\n    globalAudioService = null;\r\n  }\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\hooks\\useAuth.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'userProgress?.level' and 'userProgress?.stage'. Either include them or remove the dependency array.","line":66,"column":6,"nodeType":"ArrayExpression","endLine":66,"endColumn":18,"suggestions":[{"desc":"Update the dependencies array to be: [setAppUser, userProgress?.level, userProgress?.stage]","fix":{"range":[1900,1912],"text":"[setAppUser, userProgress?.level, userProgress?.stage]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { getAuthService, getFirestoreService } from '../lib/firebase';\r\nimport { useAppStore } from '../store/useAppStore';\r\n\r\ninterface UserProgress {\r\n  level: number;\r\n  stage: number;\r\n  exp: number;\r\n  streak: number;\r\n  lastStudyDate: string;\r\n  totalSessions: number;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\nexport const useAuth = () => {\r\n  const [user, setUser] = useState<any | null>(null);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [userProgress, setUserProgress] = useState<UserProgress | null>(null);\r\n  const { setUser: setAppUser } = useAppStore();\r\n\r\n  useEffect(() => {\r\n    console.log('[DEBUG] ğŸ” Auth state ë¦¬ìŠ¤ë„ˆ ì„¤ì •');\r\n    \r\n    const setupAuthListener = async () => {\r\n      const auth = await getAuthService();\r\n      const { onAuthStateChanged } = await import('firebase/auth');\r\n      \r\n      const unsubscribe = onAuthStateChanged(auth, async (firebaseUser) => {\r\n      console.log('[DEBUG] ğŸ”„ Auth state ë³€ê²½:', firebaseUser?.uid || 'null');\r\n      \r\n      setUser(firebaseUser);\r\n      \r\n      if (firebaseUser) {\r\n        // Firebase ì‚¬ìš©ìê°€ ë¡œê·¸ì¸í–ˆì„ ë•Œ ì§„í–‰ë„ ë¡œë“œ\r\n        await loadUserProgress(firebaseUser.uid);\r\n        \r\n        // App Store ì—…ë°ì´íŠ¸\r\n        setAppUser({\r\n          id: firebaseUser.uid,\r\n          level: userProgress?.level || 1,\r\n          stage: userProgress?.stage || 1,\r\n          isAuthenticated: true,\r\n          displayName: firebaseUser.displayName,\r\n          email: firebaseUser.email,\r\n          isAnonymous: firebaseUser.isAnonymous\r\n        });\r\n      } else {\r\n        // ë¡œê·¸ì•„ì›ƒ ì‹œ ì´ˆê¸°í™”\r\n        setUserProgress(null);\r\n        setAppUser({\r\n          id: '',\r\n          level: 1,\r\n          stage: 1,\r\n          isAuthenticated: false\r\n        });\r\n      }\r\n      \r\n        setIsLoading(false);\r\n      });\r\n\r\n      return unsubscribe;\r\n    };\r\n\r\n    setupAuthListener();\r\n  }, [setAppUser]);\r\n\r\n  const loadUserProgress = async (userId: string): Promise<UserProgress | null> => {\r\n    try {\r\n      console.log('[DEBUG] ğŸ“Š ì‚¬ìš©ì ì§„í–‰ë„ ë¡œë“œ ì‹œë„:', userId);\r\n      \r\n      const db = await getFirestoreService();\r\n      const { doc, getDoc, setDoc } = await import('firebase/firestore');\r\n      const userRef = doc(db, 'userProgress', userId);\r\n      const userSnap = await getDoc(userRef);\r\n      \r\n      if (userSnap.exists()) {\r\n        const progress = userSnap.data() as UserProgress;\r\n        console.log('[DEBUG] âœ… ê¸°ì¡´ ì§„í–‰ë„ ë¡œë“œ:', progress);\r\n        setUserProgress(progress);\r\n        return progress;\r\n      } else {\r\n        // ìƒˆ ì‚¬ìš©ì - ê¸°ë³¸ ì§„í–‰ë„ ìƒì„±\r\n        const newProgress: UserProgress = {\r\n          level: 1,\r\n          stage: 1,\r\n          exp: 0,\r\n          streak: 0,\r\n          lastStudyDate: '',\r\n          totalSessions: 0,\r\n          createdAt: new Date().toISOString(),\r\n          updatedAt: new Date().toISOString()\r\n        };\r\n        \r\n        await setDoc(userRef, newProgress);\r\n        console.log('[DEBUG] ğŸ†• ìƒˆ ì‚¬ìš©ì ì§„í–‰ë„ ìƒì„±:', newProgress);\r\n        setUserProgress(newProgress);\r\n        return newProgress;\r\n      }\r\n    } catch (error) {\r\n      console.error('[DEBUG] âŒ ì§„í–‰ë„ ë¡œë“œ ì‹¤íŒ¨:', error);\r\n      return null;\r\n    }\r\n  };\r\n\r\n  const updateUserProgress = async (updates: Partial<UserProgress>): Promise<boolean> => {\r\n    if (!user) {\r\n      console.warn('[DEBUG] âš ï¸ ë¡œê·¸ì¸ë˜ì§€ ì•Šì€ ìƒíƒœì—ì„œ ì§„í–‰ë„ ì—…ë°ì´íŠ¸ ì‹œë„');\r\n      return false;\r\n    }\r\n\r\n    try {\r\n      console.log('[DEBUG] ğŸ“ˆ ì§„í–‰ë„ ì—…ë°ì´íŠ¸:', updates);\r\n      \r\n      const db = await getFirestoreService();\r\n      const { doc, updateDoc } = await import('firebase/firestore');\r\n      const userRef = doc(db, 'userProgress', user.uid);\r\n      const updatedData = {\r\n        ...updates,\r\n        updatedAt: new Date().toISOString()\r\n      };\r\n      \r\n      await updateDoc(userRef, updatedData);\r\n      \r\n      // ë¡œì»¬ ìƒíƒœ ì—…ë°ì´íŠ¸\r\n      setUserProgress(prev => prev ? { ...prev, ...updatedData } : null);\r\n      \r\n      // App Store ì—…ë°ì´íŠ¸\r\n      if (updates.level !== undefined || updates.stage !== undefined) {\r\n        setAppUser({\r\n          id: user.uid,\r\n          level: updates.level ?? userProgress?.level ?? 1,\r\n          stage: updates.stage ?? userProgress?.stage ?? 1,\r\n          isAuthenticated: true,\r\n          displayName: user.displayName,\r\n          email: user.email,\r\n          isAnonymous: user.isAnonymous\r\n        });\r\n      }\r\n      \r\n      console.log('[DEBUG] âœ… ì§„í–‰ë„ ì—…ë°ì´íŠ¸ ì„±ê³µ');\r\n      return true;\r\n    } catch (error) {\r\n      console.error('[DEBUG] âŒ ì§„í–‰ë„ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:', error);\r\n      return false;\r\n    }\r\n  };\r\n\r\n  const logout = async (): Promise<void> => {\r\n    try {\r\n      console.log('[DEBUG] ğŸšª ë¡œê·¸ì•„ì›ƒ ì‹œë„');\r\n      const auth = await getAuthService();\r\n      const { signOut } = await import('firebase/auth');\r\n      await signOut(auth);\r\n      console.log('[DEBUG] âœ… ë¡œê·¸ì•„ì›ƒ ì„±ê³µ');\r\n    } catch (error) {\r\n      console.error('[DEBUG] âŒ ë¡œê·¸ì•„ì›ƒ ì‹¤íŒ¨:', error);\r\n      throw error;\r\n    }\r\n  };\r\n\r\n  const addExp = async (expGain: number): Promise<boolean> => {\r\n    if (!userProgress) return false;\r\n\r\n    const newExp = userProgress.exp + expGain;\r\n    const newLevel = Math.floor(newExp / 100) + 1; // 100 exp per level\r\n    \r\n    const updates: Partial<UserProgress> = {\r\n      exp: newExp,\r\n      level: Math.max(userProgress.level, newLevel),\r\n      totalSessions: userProgress.totalSessions + 1\r\n    };\r\n\r\n    // ì—°ì† í•™ìŠµ ì²˜ë¦¬\r\n    const today = new Date().toISOString().split('T')[0];\r\n    const lastStudy = userProgress.lastStudyDate?.split('T')[0];\r\n    \r\n    if (lastStudy === today) {\r\n      // ê°™ì€ ë‚  - streak ìœ ì§€\r\n    } else {\r\n      const yesterday = new Date();\r\n      yesterday.setDate(yesterday.getDate() - 1);\r\n      const yesterdayStr = yesterday.toISOString().split('T')[0];\r\n      \r\n      if (lastStudy === yesterdayStr) {\r\n        // ì—°ì† í•™ìŠµ\r\n        updates.streak = userProgress.streak + 1;\r\n      } else {\r\n        // ì—°ì† ëŠê¹€\r\n        updates.streak = 1;\r\n      }\r\n    }\r\n    \r\n    updates.lastStudyDate = new Date().toISOString();\r\n    \r\n    return await updateUserProgress(updates);\r\n  };\r\n\r\n  return {\r\n    user,\r\n    userProgress,\r\n    isLoading,\r\n    loadUserProgress,\r\n    updateUserProgress,\r\n    logout,\r\n    addExp,\r\n    isAuthenticated: !!user,\r\n    isAnonymous: user?.isAnonymous || false\r\n  };\r\n};\r\n\r\nexport default useAuth;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\hooks\\useCountdown.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\hooks\\useCountdownTimer.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\hooks\\useInterview.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'maxRetries' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":117,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":117,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'debugMode' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":119,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":119,"endColumn":14},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has missing dependencies: 'setError' and 'speakQuestion'. Either include them or remove the dependency array.","line":346,"column":6,"nodeType":"ArrayExpression","endLine":346,"endColumn":82,"suggestions":[{"desc":"Update the dependencies array to be: [measureRender, updateState, clearError, startSessionTimer, autoStartSpeech, speakQuestion, setError]","fix":{"range":[10099,10175],"text":"[measureRender, updateState, clearError, startSessionTimer, autoStartSpeech, speakQuestion, setError]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'speakQuestion'. Either include it or remove the dependency array.","line":431,"column":6,"nodeType":"ArrayExpression","endLine":431,"endColumn":120,"suggestions":[{"desc":"Update the dependencies array to be: [state.interviewId, state.questionCount, setError, updateState, autoStartSpeech, updateMetrics, clearSessionTimer, speakQuestion]","fix":{"range":[12534,12648],"text":"[state.interviewId, state.questionCount, setError, updateState, autoStartSpeech, updateMetrics, clearSessionTimer, speakQuestion]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * @fileoverview ë©´ì ‘ ì„¸ì…˜ ê´€ë¦¬ Hook - ì „ë¬¸ì ì¸ ì—ëŸ¬ ì²˜ë¦¬ ë° ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ í¬í•¨\r\n * @description AI ë©´ì ‘ ì‹œë®¬ë ˆì´í„°ì˜ ë©´ì ‘ ìƒíƒœì™€ ë¡œì§ì„ ê´€ë¦¬í•˜ëŠ” ì»¤ìŠ¤í…€ Hook\r\n * @author DaSiStart Team\r\n * @version 2.0.0\r\n */\r\n\r\nimport { useState, useCallback, useRef, useEffect } from 'react';\r\nimport { \r\n  interviewAPI, \r\n  webSpeechAPI,\r\n  type InterviewConfig,\r\n  type InterviewStartResponse,\r\n  type EvaluationResponse,\r\n  type QuestionResponse,\r\n  type SessionInfo\r\n} from '../services/api';\r\nimport { \r\n  handleError,\r\n  handleApiError,\r\n  ErrorType,\r\n  LogCategory,\r\n  logInfo,\r\n  logError,\r\n  logWarn,\r\n  interviewLogger,\r\n  type StructuredError\r\n} from '../utils/index.ts';\r\nimport { usePerformanceMonitoring } from './usePerformanceMonitoring';\r\n\r\n// ====== íƒ€ì… ì •ì˜ ======\r\n\r\nexport interface InterviewState {\r\n  // ê¸°ë³¸ ìƒíƒœ\r\n  isActive: boolean;\r\n  isLoading: boolean;\r\n  isPaused: boolean;\r\n  \r\n  // ì„¸ì…˜ ì •ë³´\r\n  interviewId: string | null;\r\n  sessionToken: string | null;\r\n  \r\n  // ì§„í–‰ ìƒíƒœ\r\n  currentQuestion: string;\r\n  questionCount: number;\r\n  totalQuestions: number;\r\n  \r\n  // ì—ëŸ¬ ë° ì„±ëŠ¥\r\n  error: StructuredError | null;\r\n  lastUpdateTime: number;\r\n}\r\n\r\nexport interface InterviewActions {\r\n  // ë©´ì ‘ ê´€ë¦¬\r\n  startInterview: (config: InterviewConfig) => Promise<InterviewStartResponse>;\r\n  pauseInterview: () => void;\r\n  resumeInterview: () => void;\r\n  endInterview: () => Promise<void>;\r\n  \r\n  // ì§ˆë¬¸ ë° ë‹µë³€\r\n  getNextQuestion: () => Promise<QuestionResponse | null>;\r\n  evaluateAnswer: (answer: string) => Promise<EvaluationResponse>;\r\n  \r\n  // ìŒì„± ì²˜ë¦¬\r\n  speakQuestion: (question?: string) => Promise<void>;\r\n  stopSpeaking: () => void;\r\n  \r\n  // ìƒíƒœ ê´€ë¦¬\r\n  clearError: () => void;\r\n  refreshSession: () => Promise<SessionInfo | null>;\r\n  \r\n  // ë””ë²„ê·¸ ë° ìœ í‹¸ë¦¬í‹°\r\n  exportSessionData: () => any;\r\n  getSessionStatistics: () => any;\r\n}\r\n\r\nexport interface InterviewMetrics {\r\n  sessionDuration: number;\r\n  averageQuestionTime: number;\r\n  totalQuestions: number;\r\n  completedQuestions: number;\r\n  averageScore: number;\r\n  errorCount: number;\r\n  performanceScore: number;\r\n}\r\n\r\nexport interface InterviewHookOptions {\r\n  autoStartSpeech?: boolean;\r\n  enablePerformanceTracking?: boolean;\r\n  maxRetries?: number;\r\n  sessionTimeout?: number;\r\n  debugMode?: boolean;\r\n}\r\n\r\nexport interface InterviewHookResult extends InterviewState, InterviewActions {\r\n  // ì¶”ê°€ ìƒíƒœ\r\n  lastEvaluation: EvaluationResponse | null;\r\n  currentConfig: InterviewConfig | null;\r\n  metrics: InterviewMetrics;\r\n  \r\n  // ìœ í‹¸ë¦¬í‹°\r\n  isComplete: boolean;\r\n  progress: number;\r\n  canProceed: boolean;\r\n  \r\n  // ë¸Œë¼ìš°ì € ì§€ì›\r\n  isSpeechSupported: boolean;\r\n  isTTSSupported: boolean;\r\n}\r\n\r\n// ====== ë©”ì¸ Hook ======\r\n\r\nexport const useInterview = (options: InterviewHookOptions = {}): InterviewHookResult => {\r\n  const {\r\n    autoStartSpeech = true,\r\n    enablePerformanceTracking = true,\r\n    maxRetries = 3,\r\n    sessionTimeout = 30 * 60 * 1000, // 30ë¶„\r\n    debugMode = process.env.NODE_ENV === 'development'\r\n  } = options;\r\n\r\n  // âœ… CLAUDE.local ì¤€ìˆ˜: í”ŒëŸ¬ê·¸ì¸ ê¸°ë°˜ ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§\r\n  const { \r\n    measureRender, \r\n    measureAudio,\r\n    measureAudioLatency, \r\n    endAudioLatency \r\n  } = usePerformanceMonitoring('useInterview');\r\n\r\n  // ====== ìƒíƒœ ê´€ë¦¬ ======\r\n\r\n  const [state, setState] = useState<InterviewState>({\r\n    isActive: false,\r\n    isLoading: false,\r\n    isPaused: false,\r\n    interviewId: null,\r\n    sessionToken: null,\r\n    currentQuestion: '',\r\n    questionCount: 0,\r\n    totalQuestions: 5,\r\n    error: null,\r\n    lastUpdateTime: Date.now()\r\n  });\r\n\r\n  const [lastEvaluation, setLastEvaluation] = useState<EvaluationResponse | null>(null);\r\n  const [metrics, setMetrics] = useState<InterviewMetrics>({\r\n    sessionDuration: 0,\r\n    averageQuestionTime: 0,\r\n    totalQuestions: 5,\r\n    completedQuestions: 0,\r\n    averageScore: 0,\r\n    errorCount: 0,\r\n    performanceScore: 100\r\n  });\r\n\r\n  // ====== Refs ======\r\n\r\n  const currentConfig = useRef<InterviewConfig | null>(null);\r\n  const sessionStartTime = useRef<number>(0);\r\n  const questionStartTime = useRef<number>(0);\r\n  const retryCount = useRef<number>(0);\r\n  const sessionTimeoutRef = useRef<NodeJS.Timeout | null>(null);\r\n  const evaluationScores = useRef<number[]>([]);\r\n  const questionTimes = useRef<number[]>([]);\r\n\r\n  // ====== ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ ======\r\n\r\n  const updateState = useCallback((updates: Partial<InterviewState>) => {\r\n    setState(prev => ({\r\n      ...prev,\r\n      ...updates,\r\n      lastUpdateTime: Date.now()\r\n    }));\r\n  }, []);\r\n\r\n  const setError = useCallback((error: StructuredError | null) => {\r\n    updateState({ error });\r\n    \r\n    if (error) {\r\n      logError(LogCategory.INTERVIEW, error.message, error.originalError, {\r\n        component: 'useInterview',\r\n        interviewId: state.interviewId,\r\n        questionCount: state.questionCount\r\n      });\r\n      \r\n      setMetrics(prev => ({\r\n        ...prev,\r\n        errorCount: prev.errorCount + 1\r\n      }));\r\n    }\r\n  }, [state.interviewId, state.questionCount, updateState]);\r\n\r\n  const clearError = useCallback(() => {\r\n    setError(null);\r\n  }, [setError]);\r\n\r\n  // ====== ì„¸ì…˜ íƒ€ì´ë¨¸ ê´€ë¦¬ ======\r\n\r\n  const startSessionTimer = useCallback(() => {\r\n    if (sessionTimeoutRef.current) {\r\n      clearTimeout(sessionTimeoutRef.current);\r\n    }\r\n    \r\n    sessionTimeoutRef.current = setTimeout(() => {\r\n      logWarn(LogCategory.INTERVIEW, 'ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ', {\r\n        sessionDuration: Date.now() - sessionStartTime.current,\r\n        interviewId: state.interviewId\r\n      });\r\n      \r\n      setError(handleError(\r\n        ErrorType.INTERVIEW_SESSION_EXPIRED,\r\n        'ë©´ì ‘ ì„¸ì…˜ì´ ì‹œê°„ ì´ˆê³¼ë˜ì—ˆìŠµë‹ˆë‹¤.',\r\n        { component: 'useInterview', action: 'sessionTimeout' }\r\n      ));\r\n    }, sessionTimeout);\r\n  }, [sessionTimeout, state.interviewId, setError]);\r\n\r\n  const clearSessionTimer = useCallback(() => {\r\n    if (sessionTimeoutRef.current) {\r\n      clearTimeout(sessionTimeoutRef.current);\r\n      sessionTimeoutRef.current = null;\r\n    }\r\n  }, []);\r\n\r\n  // ====== ë©”íŠ¸ë¦­ìŠ¤ ì—…ë°ì´íŠ¸ ======\r\n\r\n  const updateMetrics = useCallback(() => {\r\n    const now = Date.now();\r\n    const sessionDuration = sessionStartTime.current ? now - sessionStartTime.current : 0;\r\n    const averageQuestionTime = questionTimes.current.length > 0 \r\n      ? questionTimes.current.reduce((sum, time) => sum + time, 0) / questionTimes.current.length \r\n      : 0;\r\n    const averageScore = evaluationScores.current.length > 0\r\n      ? evaluationScores.current.reduce((sum, score) => sum + score, 0) / evaluationScores.current.length\r\n      : 0;\r\n\r\n    // âœ… measureAudio í™œìš© - ì˜¤ë””ì˜¤ ì„±ëŠ¥ í†µê³„ ìˆ˜ì§‘\r\n    let audioPerformanceScore = 100;\r\n    if (enablePerformanceTracking) {\r\n      const audioLatencyData = measureAudio('interview-session-audio');\r\n      if (audioLatencyData) {\r\n        // í‰ê·  ì˜¤ë””ì˜¤ ì§€ì—°ì‹œê°„ì´ 1ì´ˆ ë¯¸ë§Œì´ë©´ 100ì , 3ì´ˆ ì´ìƒì´ë©´ 0ì \r\n        const avgLatency = audioLatencyData.averageLatency || 0;\r\n        audioPerformanceScore = Math.max(0, Math.min(100, 100 - ((avgLatency - 1000) / 20)));\r\n        \r\n        logInfo(LogCategory.PERFORMANCE, 'ì˜¤ë””ì˜¤ ì„±ëŠ¥ í†µê³„ ì—…ë°ì´íŠ¸', {\r\n          averageLatency: avgLatency,\r\n          audioPerformanceScore,\r\n          totalMeasurements: audioLatencyData.measurementCount || 0\r\n        });\r\n      }\r\n    }\r\n\r\n    setMetrics({\r\n      sessionDuration,\r\n      averageQuestionTime,\r\n      totalQuestions: state.totalQuestions,\r\n      completedQuestions: state.questionCount,\r\n      averageScore,\r\n      errorCount: metrics.errorCount,\r\n      performanceScore: Math.max(0, 100 - metrics.errorCount * 10),\r\n      // âœ… ì˜¤ë””ì˜¤ ì„±ëŠ¥ ì ìˆ˜ ì¶”ê°€\r\n      audioPerformanceScore: Math.round(audioPerformanceScore)\r\n    });\r\n  }, [state.totalQuestions, state.questionCount, metrics.errorCount, enablePerformanceTracking, measureAudio]);\r\n\r\n  // ====== ë©´ì ‘ ê´€ë¦¬ í•¨ìˆ˜ë“¤ ======\r\n\r\n  const startInterview = useCallback(async (config: InterviewConfig): Promise<InterviewStartResponse> => {\r\n    const endRenderMeasure = measureRender(Object.keys(config).length, 'startInterview');\r\n    \r\n    try {\r\n      updateState({ isLoading: true, error: null });\r\n      clearError();\r\n      retryCount.current = 0;\r\n\r\n      // ì„¤ì • ê²€ì¦\r\n      if (!config.position || !config.company || !config.jobDescription) {\r\n        throw handleError(\r\n          ErrorType.INTERVIEW_CONFIG_INVALID,\r\n          'ë©´ì ‘ ì„¤ì •ì´ ì™„ì „í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.',\r\n          { component: 'useInterview', action: 'startInterview', additionalData: config }\r\n        );\r\n      }\r\n\r\n      interviewLogger.start(config);\r\n      \r\n      const response = await interviewAPI.start(config);\r\n      \r\n      if (!response.success || !response.data) {\r\n        throw handleError(\r\n          ErrorType.API_SERVER_ERROR,\r\n          response.error || 'ë©´ì ‘ ì‹œì‘ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.',\r\n          { component: 'useInterview', action: 'startInterview' }\r\n        );\r\n      }\r\n\r\n      // ìƒíƒœ ì—…ë°ì´íŠ¸\r\n      currentConfig.current = config;\r\n      sessionStartTime.current = Date.now();\r\n      questionStartTime.current = Date.now();\r\n      \r\n      updateState({\r\n        isActive: true,\r\n        isLoading: false,\r\n        interviewId: response.data.interviewId,\r\n        sessionToken: response.data.sessionToken,\r\n        currentQuestion: response.data.question,\r\n        questionCount: response.data.questionCount,\r\n        totalQuestions: response.data.totalQuestions,\r\n        error: null\r\n      });\r\n\r\n      // ì„¸ì…˜ íƒ€ì´ë¨¸ ì‹œì‘\r\n      startSessionTimer();\r\n      \r\n      // ìë™ ìŒì„± ì¬ìƒ\r\n      if (autoStartSpeech && response.data.question) {\r\n        try {\r\n          await speakQuestion(response.data.question);\r\n        } catch (speechError) {\r\n          logWarn(LogCategory.SPEECH, 'ì´ˆê¸° ì§ˆë¬¸ ìŒì„± ì¬ìƒ ì‹¤íŒ¨', speechError);\r\n        }\r\n      }\r\n\r\n      logInfo(LogCategory.INTERVIEW, 'ë©´ì ‘ ì‹œì‘ë¨', {\r\n        interviewId: response.data.interviewId,\r\n        position: config.position,\r\n        company: config.company,\r\n        totalQuestions: response.data.totalQuestions\r\n      });\r\n\r\n      return response.data;\r\n    } catch (error: any) {\r\n      const structuredError = error.type ? error : handleApiError(error, {\r\n        component: 'useInterview',\r\n        action: 'startInterview'\r\n      });\r\n      \r\n      setError(structuredError);\r\n      updateState({ isLoading: false });\r\n      throw structuredError;\r\n    } finally {\r\n      endRenderMeasure();\r\n    }\r\n  }, [updateState, clearError, startSessionTimer, autoStartSpeech, measureRender]);\r\n\r\n  const getNextQuestion = useCallback(async (): Promise<QuestionResponse | null> => {\r\n    if (!state.interviewId || !currentConfig.current) {\r\n      const error = handleError(\r\n        ErrorType.INTERVIEW_SESSION_INVALID,\r\n        'ìœ íš¨í•˜ì§€ ì•Šì€ ë©´ì ‘ ì„¸ì…˜ì…ë‹ˆë‹¤.',\r\n        { component: 'useInterview', action: 'getNextQuestion' }\r\n      );\r\n      setError(error);\r\n      return null;\r\n    }\r\n\r\n    try {\r\n      updateState({ isLoading: true });\r\n      \r\n      // ì´ì „ ì§ˆë¬¸ ì‹œê°„ ê¸°ë¡\r\n      if (questionStartTime.current) {\r\n        const questionTime = Date.now() - questionStartTime.current;\r\n        questionTimes.current.push(questionTime);\r\n      }\r\n\r\n      const response = await interviewAPI.getNextQuestion({\r\n        interviewId: state.interviewId,\r\n        position: currentConfig.current.position\r\n      });\r\n\r\n      if (!response.success) {\r\n        throw handleApiError(new Error(response.error), {\r\n          component: 'useInterview',\r\n          action: 'getNextQuestion'\r\n        });\r\n      }\r\n\r\n      const data = response.data!;\r\n      \r\n      if (data.isComplete) {\r\n        // ë©´ì ‘ ì™„ë£Œ\r\n        interviewLogger.end(\r\n          Date.now() - sessionStartTime.current,\r\n          state.questionCount\r\n        );\r\n        \r\n        updateState({\r\n          isActive: false,\r\n          isLoading: false,\r\n          currentQuestion: ''\r\n        });\r\n        \r\n        clearSessionTimer();\r\n        return data;\r\n      }\r\n\r\n      // ë‹¤ìŒ ì§ˆë¬¸ ì„¤ì •\r\n      questionStartTime.current = Date.now();\r\n      \r\n      updateState({\r\n        currentQuestion: data.question || '',\r\n        questionCount: data.questionCount || state.questionCount + 1,\r\n        isLoading: false\r\n      });\r\n\r\n      interviewLogger.questionGenerated(data.question || '', data.questionCount || 0);\r\n\r\n      // ìë™ ìŒì„± ì¬ìƒ\r\n      if (autoStartSpeech && data.question) {\r\n        try {\r\n          await speakQuestion(data.question);\r\n        } catch (speechError) {\r\n          logWarn(LogCategory.SPEECH, 'ì§ˆë¬¸ ìŒì„± ì¬ìƒ ì‹¤íŒ¨', speechError);\r\n        }\r\n      }\r\n\r\n      updateMetrics();\r\n      return data;\r\n    } catch (error: any) {\r\n      const structuredError = error.type ? error : handleApiError(error, {\r\n        component: 'useInterview',\r\n        action: 'getNextQuestion'\r\n      });\r\n      \r\n      setError(structuredError);\r\n      updateState({ isLoading: false });\r\n      return null;\r\n    }\r\n  }, [state.interviewId, state.questionCount, updateState, setError, clearSessionTimer, autoStartSpeech, updateMetrics]);\r\n\r\n  const evaluateAnswer = useCallback(async (answer: string): Promise<EvaluationResponse> => {\r\n    if (!state.interviewId || !state.currentQuestion || !currentConfig.current) {\r\n      throw handleError(\r\n        ErrorType.INTERVIEW_SESSION_INVALID,\r\n        'ë©´ì ‘ ì„¸ì…˜ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.',\r\n        { component: 'useInterview', action: 'evaluateAnswer' }\r\n      );\r\n    }\r\n\r\n    if (!answer.trim()) {\r\n      throw handleError(\r\n        ErrorType.VALIDATION_ERROR,\r\n        'ë‹µë³€ ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤.',\r\n        { component: 'useInterview', action: 'evaluateAnswer' }\r\n      );\r\n    }\r\n\r\n    try {\r\n      updateState({ isLoading: true });\r\n\r\n      const response = await interviewAPI.evaluate({\r\n        question: state.currentQuestion,\r\n        answer: answer.trim(),\r\n        position: currentConfig.current.position,\r\n        company: currentConfig.current.company,\r\n        interviewId: state.interviewId\r\n      });\r\n\r\n      if (!response.success || !response.data) {\r\n        throw handleApiError(new Error(response.error), {\r\n          component: 'useInterview',\r\n          action: 'evaluateAnswer'\r\n        });\r\n      }\r\n\r\n      const evaluation = response.data;\r\n      setLastEvaluation(evaluation);\r\n      evaluationScores.current.push(evaluation.score);\r\n\r\n      interviewLogger.answerEvaluated(evaluation.score, evaluation.feedback);\r\n      \r\n      logInfo(LogCategory.INTERVIEW, 'ë‹µë³€ í‰ê°€ ì™„ë£Œ', {\r\n        score: evaluation.score,\r\n        answerLength: answer.length,\r\n        interviewId: state.interviewId\r\n      });\r\n\r\n      updateState({ isLoading: false });\r\n      updateMetrics();\r\n      \r\n      return evaluation;\r\n    } catch (error: any) {\r\n      const structuredError = error.type ? error : handleApiError(error, {\r\n        component: 'useInterview',\r\n        action: 'evaluateAnswer'\r\n      });\r\n      \r\n      setError(structuredError);\r\n      updateState({ isLoading: false });\r\n      throw structuredError;\r\n    }\r\n  }, [state.interviewId, state.currentQuestion, updateState, setError, updateMetrics]);\r\n\r\n  const pauseInterview = useCallback(() => {\r\n    if (!state.isActive) return;\r\n    \r\n    updateState({ isPaused: true });\r\n    clearSessionTimer();\r\n    webSpeechAPI.stopSpeaking();\r\n    \r\n    logInfo(LogCategory.INTERVIEW, 'ë©´ì ‘ ì¼ì‹œì •ì§€', {\r\n      interviewId: state.interviewId,\r\n      questionCount: state.questionCount\r\n    });\r\n  }, [state.isActive, state.interviewId, state.questionCount, updateState, clearSessionTimer]);\r\n\r\n  const resumeInterview = useCallback(() => {\r\n    if (!state.isPaused) return;\r\n    \r\n    updateState({ isPaused: false });\r\n    startSessionTimer();\r\n    \r\n    logInfo(LogCategory.INTERVIEW, 'ë©´ì ‘ ì¬ê°œ', {\r\n      interviewId: state.interviewId,\r\n      questionCount: state.questionCount\r\n    });\r\n  }, [state.isPaused, state.interviewId, state.questionCount, updateState, startSessionTimer]);\r\n\r\n  const endInterview = useCallback(async (): Promise<void> => {\r\n    try {\r\n      if (state.interviewId) {\r\n        await interviewAPI.end(state.interviewId);\r\n      }\r\n    } catch (error) {\r\n      logWarn(LogCategory.INTERVIEW, 'ë©´ì ‘ ì¢…ë£Œ API í˜¸ì¶œ ì‹¤íŒ¨', error);\r\n    } finally {\r\n      // ë¡œì»¬ ìƒíƒœëŠ” í•­ìƒ ì´ˆê¸°í™”\r\n      setState({\r\n        isActive: false,\r\n        isLoading: false,\r\n        isPaused: false,\r\n        interviewId: null,\r\n        sessionToken: null,\r\n        currentQuestion: '',\r\n        questionCount: 0,\r\n        totalQuestions: 5,\r\n        error: null,\r\n        lastUpdateTime: Date.now()\r\n      });\r\n      \r\n      currentConfig.current = null;\r\n      setLastEvaluation(null);\r\n      clearSessionTimer();\r\n      webSpeechAPI.stopSpeaking();\r\n      \r\n      const sessionDuration = sessionStartTime.current ? Date.now() - sessionStartTime.current : 0;\r\n      \r\n      interviewLogger.end(sessionDuration, state.questionCount);\r\n      \r\n      logInfo(LogCategory.INTERVIEW, 'ë©´ì ‘ ì¢…ë£Œ', {\r\n        sessionDuration,\r\n        completedQuestions: state.questionCount,\r\n        averageScore: evaluationScores.current.length > 0 \r\n          ? evaluationScores.current.reduce((sum, score) => sum + score, 0) / evaluationScores.current.length \r\n          : 0\r\n      });\r\n      \r\n      // ë©”íŠ¸ë¦­ìŠ¤ ë¦¬ì…‹\r\n      evaluationScores.current = [];\r\n      questionTimes.current = [];\r\n      sessionStartTime.current = 0;\r\n      questionStartTime.current = 0;\r\n    }\r\n  }, [state.interviewId, state.questionCount, clearSessionTimer]);\r\n\r\n  // ====== ìŒì„± ì²˜ë¦¬ í•¨ìˆ˜ë“¤ ======\r\n\r\n  const speakQuestion = useCallback(async (question?: string): Promise<void> => {\r\n    const textToSpeak = question || state.currentQuestion;\r\n    if (!textToSpeak) {\r\n      throw handleError(\r\n        ErrorType.VALIDATION_ERROR,\r\n        'ì¬ìƒí•  ì§ˆë¬¸ì´ ì—†ìŠµë‹ˆë‹¤.',\r\n        { component: 'useInterview', action: 'speakQuestion' }\r\n      );\r\n    }\r\n\r\n    if (!webSpeechAPI.isTTSSupported()) {\r\n      throw handleError(\r\n        ErrorType.TTS_NOT_SUPPORTED,\r\n        'ì´ ë¸Œë¼ìš°ì €ì—ì„œëŠ” ìŒì„± í•©ì„±ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.',\r\n        { component: 'useInterview', action: 'speakQuestion' }\r\n      );\r\n    }\r\n\r\n    // âœ… CLAUDE.local ì¤€ìˆ˜: í”ŒëŸ¬ê·¸ì¸ì„ í†µí•œ ì˜¤ë””ì˜¤ ì§€ì—° ì¸¡ì • ì‹œì‘\r\n    const latencyMeasurementId = await measureAudioLatency();\r\n    \r\n    try {\r\n      await webSpeechAPI.speak(textToSpeak, 'ko-KR');\r\n      \r\n      // âœ… CLAUDE.local ì¤€ìˆ˜: í”ŒëŸ¬ê·¸ì¸ì„ í†µí•œ TTS ì§€ì—° ì¸¡ì • ì¢…ë£Œ \r\n      if (latencyMeasurementId) {\r\n        const performanceScore = await endAudioLatency(latencyMeasurementId, textToSpeak);\r\n        \r\n        // ì„±ëŠ¥ ì¶”ì ì´ í™œì„±í™”ëœ ê²½ìš° ë¡œê¹…\r\n        if (enablePerformanceTracking) {\r\n          logInfo(LogCategory.PERFORMANCE, 'TTS ì§€ì—°ì‹œê°„ ì¸¡ì • ì™„ë£Œ (í”ŒëŸ¬ê·¸ì¸)', {\r\n            measurementId: latencyMeasurementId,\r\n            performanceScore,\r\n            textLength: textToSpeak.length,\r\n            text: textToSpeak.substring(0, 50) + (textToSpeak.length > 50 ? '...' : '')\r\n          });\r\n        }\r\n      }\r\n    } catch (error: any) {\r\n      // âœ… ì—ëŸ¬ ë°œìƒ ì‹œì—ë„ ì¸¡ì • ì¢…ë£Œ (ì‹¤íŒ¨ë¡œ ê¸°ë¡)\r\n      if (latencyMeasurementId) {\r\n        await endAudioLatency(latencyMeasurementId, `ERROR: ${error.message}`);\r\n      }\r\n      \r\n      const structuredError = error.type ? error : handleError(\r\n        ErrorType.TTS_SYNTHESIS_ERROR,\r\n        error,\r\n        { component: 'useInterview', action: 'speakQuestion' }\r\n      );\r\n      setError(structuredError);\r\n      throw structuredError;\r\n    }\r\n  }, [state.currentQuestion, setError, measureAudioLatency, endAudioLatency, enablePerformanceTracking]);\r\n\r\n  const stopSpeaking = useCallback(() => {\r\n    try {\r\n      webSpeechAPI.stopSpeaking();\r\n    } catch (error: any) {\r\n      logWarn(LogCategory.SPEECH, 'ìŒì„± ì¬ìƒ ì¤‘ì§€ ì‹¤íŒ¨', error);\r\n    }\r\n  }, []);\r\n\r\n  // ====== ì„¸ì…˜ ê´€ë¦¬ í•¨ìˆ˜ë“¤ ======\r\n\r\n  const refreshSession = useCallback(async (): Promise<SessionInfo | null> => {\r\n    if (!state.interviewId) return null;\r\n\r\n    try {\r\n      const response = await interviewAPI.getSession(state.interviewId);\r\n      \r\n      if (response.success && response.data) {\r\n        return response.data;\r\n      }\r\n      \r\n      return null;\r\n    } catch (error: any) {\r\n      logError(LogCategory.INTERVIEW, 'ì„¸ì…˜ ì •ë³´ ì¡°íšŒ ì‹¤íŒ¨', error);\r\n      return null;\r\n    }\r\n  }, [state.interviewId]);\r\n\r\n  // ====== ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë“¤ ======\r\n\r\n  const exportSessionData = useCallback(() => {\r\n    return {\r\n      state,\r\n      config: currentConfig.current,\r\n      metrics,\r\n      lastEvaluation,\r\n      evaluationHistory: evaluationScores.current,\r\n      questionTimeHistory: questionTimes.current,\r\n      sessionDuration: sessionStartTime.current ? Date.now() - sessionStartTime.current : 0,\r\n      exportTime: new Date().toISOString()\r\n    };\r\n  }, [state, metrics, lastEvaluation]);\r\n\r\n  const getSessionStatistics = useCallback(() => {\r\n    const sessionDuration = sessionStartTime.current ? Date.now() - sessionStartTime.current : 0;\r\n    \r\n    return {\r\n      ...metrics,\r\n      sessionDuration,\r\n      isActive: state.isActive,\r\n      progress: state.totalQuestions > 0 ? (state.questionCount / state.totalQuestions) * 100 : 0,\r\n      timePerQuestion: questionTimes.current.length > 0 \r\n        ? questionTimes.current.reduce((sum, time) => sum + time, 0) / questionTimes.current.length \r\n        : 0\r\n    };\r\n  }, [metrics, state.isActive, state.questionCount, state.totalQuestions]);\r\n\r\n  // ====== ê³„ì‚°ëœ ê°’ë“¤ ======\r\n\r\n  const isComplete = state.questionCount >= state.totalQuestions;\r\n  const progress = state.totalQuestions > 0 ? (state.questionCount / state.totalQuestions) * 100 : 0;\r\n  const canProceed = state.isActive && !state.isLoading && !state.isPaused && state.currentQuestion.trim().length > 0;\r\n  const isSpeechSupported = webSpeechAPI.isSupported();\r\n  const isTTSSupported = webSpeechAPI.isTTSSupported();\r\n\r\n  // ====== í´ë¦°ì—… Effect ======\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      clearSessionTimer();\r\n      webSpeechAPI.stopSpeaking();\r\n    };\r\n  }, [clearSessionTimer]);\r\n\r\n  // ====== ë©”íŠ¸ë¦­ìŠ¤ ì—…ë°ì´íŠ¸ Effect ======\r\n\r\n  useEffect(() => {\r\n    if (state.isActive) {\r\n      const interval = setInterval(updateMetrics, 5000); // 5ì´ˆë§ˆë‹¤ ë©”íŠ¸ë¦­ìŠ¤ ì—…ë°ì´íŠ¸\r\n      return () => clearInterval(interval);\r\n    }\r\n  }, [state.isActive, updateMetrics]);\r\n\r\n  // ====== ë°˜í™˜ ê°’ ======\r\n\r\n  return {\r\n    // ìƒíƒœ\r\n    ...state,\r\n    lastEvaluation,\r\n    currentConfig: currentConfig.current,\r\n    metrics,\r\n\r\n    // ê³„ì‚°ëœ ê°’ë“¤\r\n    isComplete,\r\n    progress,\r\n    canProceed,\r\n    isSpeechSupported,\r\n    isTTSSupported,\r\n\r\n    // ì•¡ì…˜ë“¤\r\n    startInterview,\r\n    pauseInterview,\r\n    resumeInterview,\r\n    endInterview,\r\n    getNextQuestion,\r\n    evaluateAnswer,\r\n    speakQuestion,\r\n    stopSpeaking,\r\n    clearError,\r\n    refreshSession,\r\n    exportSessionData,\r\n    getSessionStatistics\r\n  };\r\n};\r\n\r\nexport default useInterview;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\hooks\\useLocalStorage.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\hooks\\usePatternData.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'LevelServiceFactory' is defined but never used. Allowed unused vars must match /^_/u.","line":3,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isLoading' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":46,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":46,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useCallback, useMemo, useEffect } from 'react';\nimport { QuestionItem, LevelSystemData, PatternDataManager } from '@/data/patternData';\nimport { LevelServiceFactory } from '@/services/curriculum/LevelServiceFactory';\n\nexport interface UsePatternDataProps {\n  levelSystemData?: LevelSystemData | null;\n  reviewQuestions?: QuestionItem[];\n  initialStage?: number;\n}\n\nexport interface UsePatternDataReturn {\n  // Current state\n  currentQuestions: QuestionItem[];\n  currentIndex: number;\n  currentQuestion: QuestionItem | null;\n  currentStage: number;\n  \n  // Progress tracking\n  totalQuestions: number;\n  progress: number;\n  isCompleted: boolean;\n  \n  // Navigation\n  nextQuestion: () => void;\n  previousQuestion: () => void;\n  goToQuestion: (index: number) => void;\n  resetQuestions: () => void;\n  \n  // Stage management\n  setStage: (stage: number) => void;\n  regenerateQuestions: () => void;\n  \n  // Utilities\n  isLastQuestion: boolean;\n  hasQuestions: boolean;\n}\n\nexport const usePatternData = ({\n  levelSystemData = null,\n  reviewQuestions = [],\n  initialStage = 1\n}: UsePatternDataProps = {}): UsePatternDataReturn => {\n  const [currentStage, setCurrentStage] = useState(initialStage);\n  const [currentIndex, setCurrentIndex] = useState(0);\n  const [currentQuestions, setCurrentQuestions] = useState<QuestionItem[]>([]);\n  const [isLoading, setIsLoading] = useState(false);\n\n  // Generate questions with useEffect for async handling\n  useEffect(() => {\n    const generateQuestions = async () => {\n      if (reviewQuestions.length > 0) {\n        console.log('ë³µìŠµ ëª¨ë“œ: ë³µìŠµ ë¬¸ì œ ì‚¬ìš©', reviewQuestions.length);\n        setCurrentQuestions(reviewQuestions);\n        return;\n      }\n\n      if (!levelSystemData) {\n        setCurrentQuestions([]);\n        return;\n      }\n\n      setIsLoading(true);\n      \n      try {\n        // ë°±ì—”ë“œ APIì—ì„œ ì˜¬ë°”ë¥¸ JSON ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ë¯€ë¡œ í´ë¼ì´ì–¸íŠ¸ ìƒì„± ë¶ˆí•„ìš”\n        console.log(`ğŸ“‹ ë°ì´í„°ëŠ” ë°±ì—”ë“œ APIì—ì„œ ì œê³µ: Level ${levelSystemData.level}, Stage ${currentStage}`);\n        // StudyPageëŠ” api.getCards()ë¥¼ í†µí•´ ë°±ì—”ë“œì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜´\n        setCurrentQuestions([]); // ì´ hookì€ StudyPageì—ì„œ ì‚¬ìš©ë˜ì§€ ì•ŠìŒ\n      } catch (error) {\n        console.error('âŒ ë¬¸ì œ ìƒì„± ì˜¤ë¥˜:', error);\n        // ì˜¤ë¥˜ ì‹œ ê¸°ì¡´ ë°©ì‹ìœ¼ë¡œ í´ë°±\n        const generated = PatternDataManager.generateQuestions(levelSystemData, currentStage);\n        console.log('ğŸ”„ í´ë°±: ê¸°ì¡´ ë°©ì‹ ì‚¬ìš©', generated.length);\n        setCurrentQuestions(generated);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    generateQuestions();\n  }, [levelSystemData, currentStage, reviewQuestions]);\n\n  // Current question\n  const currentQuestion = useMemo(() => {\n    if (currentIndex >= 0 && currentIndex < currentQuestions.length) {\n      return currentQuestions[currentIndex];\n    }\n    return null;\n  }, [currentQuestions, currentIndex]);\n\n  // Progress calculations\n  const totalQuestions = currentQuestions.length;\n  const progress = totalQuestions > 0 ? (currentIndex / totalQuestions) * 100 : 0;\n  const isCompleted = currentIndex >= totalQuestions;\n  const isLastQuestion = currentIndex === totalQuestions - 1;\n  const hasQuestions = totalQuestions > 0;\n\n  // Navigation functions\n  const nextQuestion = useCallback(() => {\n    setCurrentIndex(prev => Math.min(prev + 1, totalQuestions));\n  }, [totalQuestions]);\n\n  const previousQuestion = useCallback(() => {\n    setCurrentIndex(prev => Math.max(prev - 1, 0));\n  }, []);\n\n  const goToQuestion = useCallback((index: number) => {\n    if (index >= 0 && index < totalQuestions) {\n      setCurrentIndex(index);\n    }\n  }, [totalQuestions]);\n\n  const resetQuestions = useCallback(() => {\n    setCurrentIndex(0);\n  }, []);\n\n  // Stage management\n  const setStage = useCallback((stage: number) => {\n    setCurrentStage(stage);\n    setCurrentIndex(0); // Reset to first question when stage changes\n  }, []);\n\n  const regenerateQuestions = useCallback(() => {\n    // Force regeneration by updating stage (this will trigger useMemo dependency)\n    setCurrentIndex(0);\n    // Questions will automatically regenerate due to useMemo dependency on currentStage\n  }, []);\n\n  return {\n    // Current state\n    currentQuestions,\n    currentIndex,\n    currentQuestion,\n    currentStage,\n    \n    // Progress tracking\n    totalQuestions,\n    progress,\n    isCompleted,\n    \n    // Navigation\n    nextQuestion,\n    previousQuestion,\n    goToQuestion,\n    resetQuestions,\n    \n    // Stage management\n    setStage,\n    regenerateQuestions,\n    \n    // Utilities\n    isLastQuestion,\n    hasQuestions\n  };\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\hooks\\usePatternTrainingManager.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The ref value 'timerManagerRef.current' will likely have changed by the time this effect cleanup function runs. If this ref points to a node rendered by React, copy 'timerManagerRef.current' to a variable inside the effect, and use that variable in the cleanup function.","line":62,"column":23,"nodeType":"Identifier","endLine":62,"endColumn":30},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The ref value 'eventManagerRef.current' will likely have changed by the time this effect cleanup function runs. If this ref points to a node rendered by React, copy 'eventManagerRef.current' to a variable inside the effect, and use that variable in the cleanup function.","line":63,"column":23,"nodeType":"Identifier","endLine":63,"endColumn":30}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * usePatternTrainingManager - íŒ¨í„´ íŠ¸ë ˆì´ë‹ í†µí•© ê´€ë¦¬ í›…\r\n * \r\n * ì—­í• :\r\n * - TimerManagerì™€ EventLifecycleManager í†µí•©\r\n * - íƒ€ì´ë¨¸/ì´ë²¤íŠ¸ ë¼ì´í”„ì‚¬ì´í´ ìë™ ê´€ë¦¬\r\n * - ì¼ì‹œì •ì§€/ì¬ê°œ ê¸°ëŠ¥ í†µí•© ì œê³µ\r\n */\r\n\r\nimport { useRef, useCallback, useEffect } from 'react';\r\nimport TimerManager, { type TimerConfig } from '@/services/timers/TimerManager';\r\nimport EventLifecycleManager from '@/services/events/EventLifecycleManager';\r\n\r\nexport interface PatternTrainingManagerConfig {\r\n  onCountdownTick?: (remainingTime: number) => void;\r\n  onCountdownComplete?: () => void;\r\n  onRecognitionTick?: (remainingTime: number) => void;\r\n  onRecognitionComplete?: () => void;\r\n  onWaitingTick?: (remainingTime: number) => void;\r\n  onWaitingComplete?: () => void;\r\n  onCompletionEvent?: (stageId: string) => void;\r\n}\r\n\r\nexport interface PatternTrainingManager {\r\n  // íƒ€ì´ë¨¸ ê´€ë¦¬\r\n  startCountdown: (duration: number) => void;\r\n  startRecognition: (duration: number) => void;\r\n  startWaiting: (duration: number) => void;\r\n  stopAllTimers: () => void;\r\n  pauseAllTimers: () => void;\r\n  resumeAllTimers: () => void;\r\n  \r\n  // ì™„ë£Œ ì´ë²¤íŠ¸ ê´€ë¦¬\r\n  handleStageCompletion: (stageId: string) => boolean;\r\n  \r\n  // TTS ì´ë²¤íŠ¸ ê´€ë¦¬\r\n  manageTTSEvents: (utterance: SpeechSynthesisUtterance) => void;\r\n  \r\n  // ìŒì„±ì¸ì‹ ì´ë²¤íŠ¸ ê´€ë¦¬\r\n  manageRecognitionEvents: (recognition: any) => void;\r\n  \r\n  // íƒ€ì´ë¨¸ ìƒíƒœ ì¡°íšŒ\r\n  getTimerState: () => { remainingTime?: number } | null;\r\n  \r\n  // ì •ë¦¬\r\n  cleanup: () => void;\r\n  \r\n  // ë””ë²„ê·¸\r\n  debug: () => void;\r\n}\r\n\r\nexport const usePatternTrainingManager = (\r\n  config: PatternTrainingManagerConfig\r\n): PatternTrainingManager => {\r\n  const timerManagerRef = useRef<TimerManager>(TimerManager.getInstance());\r\n  const eventManagerRef = useRef<EventLifecycleManager>(EventLifecycleManager.getInstance());\r\n  const timerConfigsRef = useRef<Map<string, TimerConfig>>(new Map());\r\n\r\n  // ì»´í¬ë„ŒíŠ¸ ì–¸ë§ˆìš´íŠ¸ì‹œ ìë™ ì •ë¦¬\r\n  useEffect(() => {\r\n    return () => {\r\n      timerManagerRef.current.clearAllTimers();\r\n      eventManagerRef.current.clearAllEvents();\r\n    };\r\n  }, []);\r\n\r\n  // ì •ê¸°ì ìœ¼ë¡œ ì˜¤ë˜ëœ ì´ë²¤íŠ¸ ì •ë¦¬\r\n  useEffect(() => {\r\n    const cleanupInterval = setInterval(() => {\r\n      eventManagerRef.current.cleanupOldEvents();\r\n    }, 30000); // 30ì´ˆë§ˆë‹¤\r\n\r\n    return () => clearInterval(cleanupInterval);\r\n  }, []);\r\n\r\n  /**\r\n   * ì¹´ìš´íŠ¸ë‹¤ìš´ íƒ€ì´ë¨¸ ì‹œì‘\r\n   */\r\n  const startCountdown = useCallback((duration: number): void => {\r\n    const timerConfig: TimerConfig = {\r\n      id: 'countdown',\r\n      type: 'countdown',\r\n      interval: 1000,\r\n      callback: (remainingTime: number) => {\r\n        config.onCountdownTick?.(remainingTime);\r\n      },\r\n      onComplete: () => {\r\n        config.onCountdownComplete?.(\r\n);\r\n      }\r\n    };\r\n\r\n    timerConfigsRef.current.set('countdown', timerConfig);\r\n    timerManagerRef.current.startTimer(timerConfig, duration);\r\n  }, [config]);\r\n\r\n  /**\r\n   * ìŒì„±ì¸ì‹ íƒ€ì´ë¨¸ ì‹œì‘\r\n   */\r\n  const startRecognition = useCallback((duration: number): void => {\r\n    const timerConfig: TimerConfig = {\r\n      id: 'recognition',\r\n      type: 'recognition',\r\n      interval: 1000,\r\n      callback: (remainingTime: number) => {\r\n        config.onRecognitionTick?.(remainingTime);\r\n      },\r\n      onComplete: () => {\r\n        config.onRecognitionComplete?.();\r\n      }\r\n    };\r\n\r\n    timerConfigsRef.current.set('recognition', timerConfig);\r\n    timerManagerRef.current.startTimer(timerConfig, duration);\r\n  }, [config]);\r\n\r\n  /**\r\n   * ëŒ€ê¸° íƒ€ì´ë¨¸ ì‹œì‘\r\n   */\r\n  const startWaiting = useCallback((duration: number): void => {\r\n    const timerConfig: TimerConfig = {\r\n      id: 'waiting',\r\n      type: 'waiting',\r\n      interval: 1000,\r\n      callback: (remainingTime: number) => {\r\n        config.onWaitingTick?.(remainingTime);\r\n      },\r\n      onComplete: () => {\r\n        config.onWaitingComplete?.();\r\n      }\r\n    };\r\n\r\n    timerConfigsRef.current.set('waiting', timerConfig);\r\n    timerManagerRef.current.startTimer(timerConfig, duration);\r\n  }, [config]);\r\n\r\n  /**\r\n   * ëª¨ë“  íƒ€ì´ë¨¸ ì¤‘ì§€\r\n   */\r\n  const stopAllTimers = useCallback((): void => {\r\n    timerManagerRef.current.clearAllTimers();\r\n  }, []);\r\n\r\n  /**\r\n   * ëª¨ë“  íƒ€ì´ë¨¸ ì¼ì‹œì •ì§€\r\n   */\r\n  const pauseAllTimers = useCallback((): void => {\r\n    timerManagerRef.current.pauseAllTimers();\r\n  }, []);\r\n\r\n  /**\r\n   * ëª¨ë“  íƒ€ì´ë¨¸ ì¬ê°œ\r\n   */\r\n  const resumeAllTimers = useCallback((): void => {\r\n    timerManagerRef.current.resumeAllTimers(undefined, timerConfigsRef.current);\r\n  }, []);\r\n\r\n  /**\r\n   * ìŠ¤í…Œì´ì§€ ì™„ë£Œ ì´ë²¤íŠ¸ ì²˜ë¦¬ (ì¤‘ë³µ ë°©ì§€)\r\n   */\r\n  const handleStageCompletion = useCallback((stageId: string): boolean => {\r\n    const completionId = `stage-completion-${stageId}-${Date.now()}`;\r\n    \r\n    return eventManagerRef.current.handleCompletion(completionId, () => {\r\n      config.onCompletionEvent?.(stageId);\r\n      \r\n      // ì™„ë£Œ ì•Œë¦¼ì€ onCompletionEventì—ì„œ ì²˜ë¦¬ë˜ë¯€ë¡œ ì¤‘ë³µ ì œê±°\r\n    });\r\n  }, [config]);\r\n\r\n  /**\r\n   * TTS ì´ë²¤íŠ¸ ê´€ë¦¬\r\n   */\r\n  const manageTTSEvents = useCallback((utterance: SpeechSynthesisUtterance): void => {\r\n    // TTS ì‹œì‘ ì´ë²¤íŠ¸\r\n    eventManagerRef.current.manageTTSEvent(\r\n      utterance,\r\n      'start',\r\n      () => console.log('ğŸ”Š [Manager] TTS ì‹œì‘')\r\n    );\r\n\r\n    // TTS ì™„ë£Œ ì´ë²¤íŠ¸\r\n    eventManagerRef.current.manageTTSEvent(\r\n      utterance,\r\n      'end',\r\n      () => console.log('ğŸ”Š [Manager] TTS ì™„ë£Œ')\r\n    );\r\n\r\n    // TTS ì˜¤ë¥˜ ì´ë²¤íŠ¸\r\n    eventManagerRef.current.manageTTSEvent(\r\n      utterance,\r\n      'error',\r\n      (e: any) => console.error('âŒ [Manager] TTS ì˜¤ë¥˜:', e)\r\n    );\r\n  }, []);\r\n\r\n  /**\r\n   * ìŒì„±ì¸ì‹ ì´ë²¤íŠ¸ ê´€ë¦¬\r\n   */\r\n  const manageRecognitionEvents = useCallback((recognition: any): void => {\r\n    // ìŒì„±ì¸ì‹ ê²°ê³¼ ì´ë²¤íŠ¸\r\n    eventManagerRef.current.manageRecognitionEvent(\r\n      recognition,\r\n      'result',\r\n      (event: any) => {\r\n        console.log('ğŸ¤ [Manager] ìŒì„±ì¸ì‹ ê²°ê³¼:', event.results[0][0].transcript);\r\n      }\r\n    );\r\n\r\n    // ìŒì„±ì¸ì‹ ì¢…ë£Œ ì´ë²¤íŠ¸\r\n    eventManagerRef.current.manageRecognitionEvent(\r\n      recognition,\r\n      'end',\r\n      () => console.log('ğŸ¤ [Manager] ìŒì„±ì¸ì‹ ì¢…ë£Œ')\r\n    );\r\n\r\n    // ìŒì„±ì¸ì‹ ì˜¤ë¥˜ ì´ë²¤íŠ¸\r\n    eventManagerRef.current.manageRecognitionEvent(\r\n      recognition,\r\n      'error',\r\n      (e: any) => console.error('âŒ [Manager] ìŒì„±ì¸ì‹ ì˜¤ë¥˜:', e)\r\n    );\r\n  }, []);\r\n\r\n  /**\r\n   * ëª¨ë“  ë¦¬ì†ŒìŠ¤ ì •ë¦¬\r\n   */\r\n  const cleanup = useCallback((): void => {\r\n    timerManagerRef.current.clearAllTimers();\r\n    eventManagerRef.current.clearAllEvents();\r\n    timerConfigsRef.current.clear();\r\n  }, []);\r\n\r\n  /**\r\n   * í˜„ì¬ í™œì„± íƒ€ì´ë¨¸ ìƒíƒœ ì¡°íšŒ\r\n   */\r\n  const getTimerState = useCallback(() => {\r\n    const activeTimers = timerManagerRef.current.getActiveTimers();\r\n    if (activeTimers.length > 0) {\r\n      return { remainingTime: activeTimers[0].remainingTime };\r\n    }\r\n    return null;\r\n  }, []);\r\n\r\n  /**\r\n   * ë””ë²„ê·¸ ì •ë³´ ì¶œë ¥\r\n   */\r\n  const debug = useCallback((): void => {\r\n    console.log('ğŸ” [PatternTrainingManager] ë””ë²„ê·¸ ì •ë³´:');\r\n    timerManagerRef.current.debug();\r\n    eventManagerRef.current.debug();\r\n  }, []);\r\n\r\n  return {\r\n    startCountdown,\r\n    startRecognition,\r\n    startWaiting,\r\n    stopAllTimers,\r\n    pauseAllTimers,\r\n    resumeAllTimers,\r\n    handleStageCompletion,\r\n    manageTTSEvents,\r\n    manageRecognitionEvents,\r\n    getTimerState,\r\n    cleanup,\r\n    debug\r\n  };\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\hooks\\usePerformanceMonitoring.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The ref value 'eventHandlersRef.current' will likely have changed by the time this effect cleanup function runs. If this ref points to a node rendered by React, copy 'eventHandlersRef.current' to a variable inside the effect, and use that variable in the cleanup function.","line":87,"column":26,"nodeType":"Identifier","endLine":87,"endColumn":33}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Performance Monitoring Hook\r\n * @description IPerformancePluginì„ ì‚¬ìš©í•œ ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ React Hook\r\n * CLAUDE.local ê·œì¹™ ì¤€ìˆ˜: í”ŒëŸ¬ê·¸ì¸ ìš°ì„  ì•„í‚¤í…ì²˜ + ì¸í„°í˜ì´ìŠ¤ ìš°ì„  ì„¤ê³„\r\n */\r\n\r\nimport { useState, useEffect, useCallback, useRef } from 'react';\r\nimport { getPerformancePlugin } from '@/plugins/PluginManager';\r\nimport {\r\n  IPerformancePlugin,\r\n  PerformanceStats,\r\n  PerformanceEvent,\r\n  PerformanceEventHandler\r\n} from '@/plugins/performance/IPerformancePlugin';\r\nimport { logInfo, logError, LogCategory } from '@/utils/index';\r\n\r\n// Hook ìƒíƒœ íƒ€ì…\r\nexport interface UsePerformanceMonitoringState {\r\n  plugin: IPerformancePlugin | null;\r\n  isPluginReady: boolean;\r\n  pluginError: string | null;\r\n  isMonitoring: boolean;\r\n  stats: PerformanceStats | null;\r\n}\r\n\r\n// Hook ì•¡ì…˜ íƒ€ì…\r\nexport interface UsePerformanceMonitoringActions {\r\n  // âœ… CLAUDE.local ì¤€ìˆ˜: í”ŒëŸ¬ê·¸ì¸ì„ í†µí•œ ì˜¤ë””ì˜¤ ì§€ì—° ì¸¡ì •\r\n  measureAudioLatency: () => Promise<string | null>;\r\n  endAudioLatency: (measurementId: string, transcription?: string) => Promise<number>;\r\n  \r\n  // âœ… CLAUDE.local ì¤€ìˆ˜: measureAudio ê¸°ëŠ¥ (ì˜¤ë””ì˜¤ ì„±ëŠ¥ ì ìˆ˜)\r\n  measureAudio: (latencyMs: number, transcription?: string) => Promise<number>;\r\n  \r\n  // API ë° ë Œë”ë§ ì¸¡ì •\r\n  measureRender: (componentName: string, propsCount: number, reason?: string) => () => void;\r\n  measureAPI: <T>(endpoint: string, method: string, apiCall: () => Promise<T>) => Promise<T>;\r\n  \r\n  // ì„±ëŠ¥ ë³´ê³ ì„œ\r\n  generateReport: () => Promise<any>;\r\n  getStats: () => Promise<PerformanceStats | null>;\r\n  \r\n  // ëª¨ë‹ˆí„°ë§ ì œì–´\r\n  startMonitoring: () => Promise<boolean>;\r\n  stopMonitoring: () => void;\r\n  \r\n  // ì„¤ì • ê´€ë¦¬\r\n  updateThresholds: (thresholds: {\r\n    audioLatency?: number;\r\n    apiResponseTime?: number;\r\n    renderTime?: number;\r\n    memoryUsage?: number;\r\n  }) => Promise<boolean>;\r\n}\r\n\r\n// Hook ë°˜í™˜ íƒ€ì…\r\nexport type UsePerformanceMonitoringReturn = UsePerformanceMonitoringState & UsePerformanceMonitoringActions;\r\n\r\n/**\r\n * Performance Monitoring Hook\r\n * âœ… CLAUDE.local ì¤€ìˆ˜: í”ŒëŸ¬ê·¸ì¸ ìš°ì„  ì•„í‚¤í…ì²˜\r\n * @param componentName ì»´í¬ë„ŒíŠ¸ ì´ë¦„ (ë Œë”ë§ ì¸¡ì •ìš©)\r\n */\r\nexport const usePerformanceMonitoring = (componentName?: string): UsePerformanceMonitoringReturn => {\r\n  // State\r\n  const [state, setState] = useState<UsePerformanceMonitoringState>({\r\n    plugin: null,\r\n    isPluginReady: false,\r\n    pluginError: null,\r\n    isMonitoring: false,\r\n    stats: null\r\n  });\r\n  \r\n  // Refs\r\n  const eventHandlersRef = useRef<Set<PerformanceEventHandler>>(new Set());\r\n  const isMountedRef = useRef(true);\r\n\r\n  // ì»´í¬ë„ŒíŠ¸ ì–¸ë§ˆìš´íŠ¸ ì‹œ ì •ë¦¬\r\n  useEffect(() => {\r\n    return () => {\r\n      isMountedRef.current = false;\r\n      // ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì •ë¦¬\r\n      if (state.plugin) {\r\n        eventHandlersRef.current.forEach(handler => {\r\n          state.plugin!.offPerformanceEvent(handler);\r\n        });\r\n        eventHandlersRef.current.clear();\r\n      }\r\n    };\r\n  }, [state.plugin]);\r\n\r\n  // Safe state update\r\n  const safeSetState = useCallback((updater: Partial<UsePerformanceMonitoringState>) => {\r\n    if (isMountedRef.current) {\r\n      setState(prev => ({ ...prev, ...updater }));\r\n    }\r\n  }, []);\r\n\r\n  // í”ŒëŸ¬ê·¸ì¸ ì´ˆê¸°í™”\r\n  const initializePlugin = useCallback(async (): Promise<boolean> => {\r\n    if (state.plugin && state.isPluginReady) {\r\n      return true;\r\n    }\r\n\r\n    try {\r\n      logInfo(LogCategory.PERFORMANCE, 'Initializing Performance Plugin...');\r\n      \r\n      const pluginResult = await getPerformancePlugin();\r\n      if (!pluginResult.success) {\r\n        throw pluginResult.error;\r\n      }\r\n\r\n      const plugin = pluginResult.data;\r\n      \r\n      // ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì„¤ì •\r\n      const eventHandler: PerformanceEventHandler = (event: PerformanceEvent) => {\r\n        if (event.type === 'threshold_exceeded' || event.type === 'warning') {\r\n          logInfo(LogCategory.PERFORMANCE, 'Performance alert', event.data);\r\n        }\r\n      };\r\n      \r\n      plugin.onPerformanceEvent(eventHandler);\r\n      eventHandlersRef.current.add(eventHandler);\r\n      \r\n      // ëª¨ë‹ˆí„°ë§ ì‹œì‘\r\n      const startResult = plugin.startMonitoring();\r\n      if (!startResult.success) {\r\n        throw startResult.error;\r\n      }\r\n\r\n      safeSetState({\r\n        plugin,\r\n        isPluginReady: true,\r\n        pluginError: null,\r\n        isMonitoring: plugin.isMonitoring()\r\n      });\r\n\r\n      logInfo(LogCategory.PERFORMANCE, 'Performance Plugin initialized successfully');\r\n      return true;\r\n    } catch (error) {\r\n      const errorMessage = error instanceof Error ? error.message : 'Failed to initialize plugin';\r\n      logError(LogCategory.PERFORMANCE, 'Performance Plugin initialization failed', error);\r\n      \r\n      safeSetState({\r\n        plugin: null,\r\n        isPluginReady: false,\r\n        pluginError: errorMessage\r\n      });\r\n      \r\n      return false;\r\n    }\r\n  }, [state.plugin, state.isPluginReady, safeSetState]);\r\n\r\n  // í”ŒëŸ¬ê·¸ì¸ ìë™ ì´ˆê¸°í™”\r\n  useEffect(() => {\r\n    if (!state.plugin && !state.pluginError) {\r\n      initializePlugin();\r\n    }\r\n  }, [state.plugin, state.pluginError, initializePlugin]);\r\n\r\n  // âœ… CLAUDE.local ì¤€ìˆ˜: í”ŒëŸ¬ê·¸ì¸ì„ í†µí•œ ì˜¤ë””ì˜¤ ì§€ì—° ì¸¡ì •\r\n  const measureAudioLatency = useCallback(async (): Promise<string | null> => {\r\n    if (!state.plugin || !state.isPluginReady) {\r\n      logError(LogCategory.PERFORMANCE, 'Performance plugin not ready for audio measurement');\r\n      return null;\r\n    }\r\n\r\n    try {\r\n      const result = await state.plugin.measureAudioLatency();\r\n      if (result.success) {\r\n        return result.data;\r\n      } else {\r\n        logError(LogCategory.PERFORMANCE, 'Failed to start audio latency measurement', result.error);\r\n        return null;\r\n      }\r\n    } catch (error) {\r\n      logError(LogCategory.PERFORMANCE, 'Audio latency measurement error', error);\r\n      return null;\r\n    }\r\n  }, [state.plugin, state.isPluginReady]);\r\n\r\n  const endAudioLatency = useCallback(async (measurementId: string, transcription?: string): Promise<number> => {\r\n    if (!state.plugin || !state.isPluginReady) {\r\n      logError(LogCategory.PERFORMANCE, 'Performance plugin not ready for ending audio measurement');\r\n      return 0;\r\n    }\r\n\r\n    try {\r\n      const result = await state.plugin.endAudioLatency(measurementId, transcription);\r\n      if (result.success) {\r\n        logInfo(LogCategory.PERFORMANCE, 'Audio latency measurement completed', {\r\n          measurementId,\r\n          latency: result.data.totalLatency,\r\n          score: result.data.performanceScore\r\n        });\r\n        return result.data.performanceScore;\r\n      } else {\r\n        logError(LogCategory.PERFORMANCE, 'Failed to end audio latency measurement', result.error);\r\n        return 0;\r\n      }\r\n    } catch (error) {\r\n      logError(LogCategory.PERFORMANCE, 'End audio latency measurement error', error);\r\n      return 0;\r\n    }\r\n  }, [state.plugin, state.isPluginReady]);\r\n\r\n  // âœ… CLAUDE.local ì¤€ìˆ˜: measureAudio ê¸°ëŠ¥ (ì˜¤ë””ì˜¤ ì„±ëŠ¥ ì ìˆ˜ ê³„ì‚°)\r\n  const measureAudio = useCallback(async (latencyMs: number, transcription?: string): Promise<number> => {\r\n    if (!state.plugin || !state.isPluginReady) {\r\n      return 0;\r\n    }\r\n\r\n    try {\r\n      const result = await state.plugin.calculateAudioScore(latencyMs, transcription);\r\n      if (result.success) {\r\n        return result.data;\r\n      } else {\r\n        logError(LogCategory.PERFORMANCE, 'Failed to calculate audio score', result.error);\r\n        return 0;\r\n      }\r\n    } catch (error) {\r\n      logError(LogCategory.PERFORMANCE, 'Audio score calculation error', error);\r\n      return 0;\r\n    }\r\n  }, [state.plugin, state.isPluginReady]);\r\n\r\n  // ë Œë”ë§ ì¸¡ì •\r\n  const measureRender = useCallback((\r\n    compName: string, \r\n    propsCount: number, \r\n    reason?: string\r\n  ): (() => void) => {\r\n    if (!state.plugin || !state.isPluginReady) {\r\n      return () => {}; // no-op\r\n    }\r\n\r\n    const name = compName || componentName || 'Unknown';\r\n    const result = state.plugin.measureComponentRender(name, propsCount, reason);\r\n    \r\n    if (result.success) {\r\n      return result.data;\r\n    } else {\r\n      logError(LogCategory.PERFORMANCE, 'Failed to start render measurement', result.error);\r\n      return () => {};\r\n    }\r\n  }, [state.plugin, state.isPluginReady, componentName]);\r\n\r\n  // API ì¸¡ì •\r\n  const measureAPI = useCallback(async <T>(\r\n    endpoint: string,\r\n    method: string,\r\n    apiCall: () => Promise<T>\r\n  ): Promise<T> => {\r\n    if (!state.plugin || !state.isPluginReady) {\r\n      // í”ŒëŸ¬ê·¸ì¸ì´ ì¤€ë¹„ë˜ì§€ ì•Šì€ ê²½ìš° ê·¸ëƒ¥ API í˜¸ì¶œ ì‹¤í–‰\r\n      return apiCall();\r\n    }\r\n\r\n    try {\r\n      const result = await state.plugin.measureAPICall(endpoint, method, apiCall);\r\n      if (result.success) {\r\n        return result.data;\r\n      } else {\r\n        throw result.error;\r\n      }\r\n    } catch (error) {\r\n      logError(LogCategory.PERFORMANCE, 'API measurement error', error);\r\n      throw error;\r\n    }\r\n  }, [state.plugin, state.isPluginReady]);\r\n\r\n  // ì„±ëŠ¥ ë³´ê³ ì„œ ìƒì„±\r\n  const generateReport = useCallback(async () => {\r\n    if (!state.plugin || !state.isPluginReady) {\r\n      return null;\r\n    }\r\n\r\n    try {\r\n      const result = await state.plugin.generatePerformanceReport();\r\n      if (result.success) {\r\n        return result.data;\r\n      } else {\r\n        logError(LogCategory.PERFORMANCE, 'Failed to generate performance report', result.error);\r\n        return null;\r\n      }\r\n    } catch (error) {\r\n      logError(LogCategory.PERFORMANCE, 'Performance report generation error', error);\r\n      return null;\r\n    }\r\n  }, [state.plugin, state.isPluginReady]);\r\n\r\n  // ì„±ëŠ¥ í†µê³„ ì¡°íšŒ\r\n  const getStats = useCallback(async (): Promise<PerformanceStats | null> => {\r\n    if (!state.plugin || !state.isPluginReady) {\r\n      return null;\r\n    }\r\n\r\n    try {\r\n      const result = await state.plugin.getPerformanceStats();\r\n      if (result.success) {\r\n        safeSetState({ stats: result.data });\r\n        return result.data;\r\n      } else {\r\n        logError(LogCategory.PERFORMANCE, 'Failed to get performance stats', result.error);\r\n        return null;\r\n      }\r\n    } catch (error) {\r\n      logError(LogCategory.PERFORMANCE, 'Performance stats retrieval error', error);\r\n      return null;\r\n    }\r\n  }, [state.plugin, state.isPluginReady, safeSetState]);\r\n\r\n  // ëª¨ë‹ˆí„°ë§ ì‹œì‘\r\n  const startMonitoring = useCallback(async (): Promise<boolean> => {\r\n    if (!state.plugin) {\r\n      const initSuccess = await initializePlugin();\r\n      if (!initSuccess) {\r\n        return false;\r\n      }\r\n    }\r\n\r\n    if (!state.plugin || !state.isPluginReady) {\r\n      return false;\r\n    }\r\n\r\n    try {\r\n      const result = state.plugin.startMonitoring();\r\n      if (result.success) {\r\n        safeSetState({ isMonitoring: true });\r\n        return true;\r\n      } else {\r\n        logError(LogCategory.PERFORMANCE, 'Failed to start monitoring', result.error);\r\n        return false;\r\n      }\r\n    } catch (error) {\r\n      logError(LogCategory.PERFORMANCE, 'Start monitoring error', error);\r\n      return false;\r\n    }\r\n  }, [state.plugin, state.isPluginReady, initializePlugin, safeSetState]);\r\n\r\n  // ëª¨ë‹ˆí„°ë§ ì¤‘ì§€\r\n  const stopMonitoring = useCallback(() => {\r\n    if (!state.plugin || !state.isPluginReady) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const result = state.plugin.stopMonitoring();\r\n      if (result.success) {\r\n        safeSetState({ isMonitoring: false });\r\n      } else {\r\n        logError(LogCategory.PERFORMANCE, 'Failed to stop monitoring', result.error);\r\n      }\r\n    } catch (error) {\r\n      logError(LogCategory.PERFORMANCE, 'Stop monitoring error', error);\r\n    }\r\n  }, [state.plugin, state.isPluginReady, safeSetState]);\r\n\r\n  // âœ… CLAUDE.local ì¤€ìˆ˜: ì„¤ì • ê¸°ë°˜ ì„ê³„ê°’ ë™ì  ë³€ê²½\r\n  const updateThresholds = useCallback(async (thresholds: {\r\n    audioLatency?: number;\r\n    apiResponseTime?: number;\r\n    renderTime?: number;\r\n    memoryUsage?: number;\r\n  }): Promise<boolean> => {\r\n    if (!state.plugin || !state.isPluginReady) {\r\n      return false;\r\n    }\r\n\r\n    try {\r\n      const result = state.plugin.updateThresholds(thresholds);\r\n      if (result.success) {\r\n        logInfo(LogCategory.PERFORMANCE, 'Performance thresholds updated', thresholds);\r\n        return true;\r\n      } else {\r\n        logError(LogCategory.PERFORMANCE, 'Failed to update thresholds', result.error);\r\n        return false;\r\n      }\r\n    } catch (error) {\r\n      logError(LogCategory.PERFORMANCE, 'Threshold update error', error);\r\n      return false;\r\n    }\r\n  }, [state.plugin, state.isPluginReady]);\r\n\r\n  return {\r\n    // State\r\n    ...state,\r\n    \r\n    // Actions\r\n    measureAudioLatency,\r\n    endAudioLatency,\r\n    measureAudio,\r\n    measureRender,\r\n    measureAPI,\r\n    generateReport,\r\n    getStats,\r\n    startMonitoring,\r\n    stopMonitoring,\r\n    updateThresholds\r\n  };\r\n};\r\n\r\nexport default usePerformanceMonitoring;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\hooks\\usePerformanceOptimization.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\hooks\\usePluginSpeech.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Result' is defined but never used. Allowed unused vars must match /^_/u.","line":9,"column":42,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":48},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'fallbackToWebAPI' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":79,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":79,"endColumn":21}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Speech í”ŒëŸ¬ê·¸ì¸ ì‚¬ìš©ì„ ìœ„í•œ React Hook\r\n * @description ê¸°ì¡´ í•˜ë“œì½”ë”©ëœ webSpeechAPI ëŒ€ì‹  í”ŒëŸ¬ê·¸ì¸ ì‹œìŠ¤í…œ ì‚¬ìš©\r\n */\r\n\r\nimport { useState, useEffect, useCallback, useRef } from 'react';\r\nimport { getSpeechPlugin, isPluginAvailable } from '@/plugins';\r\nimport type { ISpeechPlugin, SpeechProcessingState } from '@/plugins/speech/ISpeechPlugin';\r\nimport { NonEmptyString, PositiveNumber, Result } from '@/types/core';\r\n\r\n// Hook ì˜µì…˜\r\nexport interface UsePluginSpeechOptions {\r\n  readonly autoInitialize?: boolean;\r\n  readonly fallbackToWebAPI?: boolean;\r\n  readonly onStateChange?: (state: SpeechProcessingState) => void;\r\n  readonly onError?: (error: string) => void;\r\n}\r\n\r\n// Hook ë°˜í™˜ íƒ€ì…\r\nexport interface UsePluginSpeechReturn {\r\n  // í”ŒëŸ¬ê·¸ì¸ ìƒíƒœ\r\n  readonly isAvailable: boolean;\r\n  readonly isLoading: boolean;\r\n  readonly processingState: SpeechProcessingState;\r\n  readonly error: string | null;\r\n  \r\n  // TTS ê¸°ëŠ¥\r\n  readonly speakText: (\r\n    text: string,\r\n    options?: {\r\n      language?: string;\r\n      rate?: number;\r\n      volume?: number;\r\n    }\r\n  ) => Promise<boolean>;\r\n  \r\n  // ìŒì„± ì¸ì‹ ê¸°ëŠ¥\r\n  readonly recognizeSpeech: (\r\n    options?: {\r\n      language?: string;\r\n      maxDuration?: number;\r\n      continuous?: boolean;\r\n    }\r\n  ) => Promise<{ success: boolean; transcript?: string; confidence?: number }>;\r\n  \r\n  readonly startListening: (\r\n    onResult: (transcript: string, confidence: number) => void,\r\n    options?: {\r\n      language?: string;\r\n      continuous?: boolean;\r\n    }\r\n  ) => boolean;\r\n  \r\n  readonly stopListening: () => boolean;\r\n  \r\n  // ì‹ í˜¸ìŒ\r\n  readonly playBeep: (\r\n    options?: {\r\n      frequency?: number;\r\n      duration?: number;\r\n    }\r\n  ) => Promise<boolean>;\r\n  \r\n  // ì œì–´\r\n  readonly stopAll: () => boolean;\r\n  readonly isProcessing: () => boolean;\r\n  \r\n  // ê¸°ëŠ¥ í™•ì¸\r\n  readonly getSupportedLanguages: () => Promise<string[]>;\r\n  readonly getAvailableVoices: () => Promise<SpeechSynthesisVoice[]>;\r\n}\r\n\r\n/**\r\n * Speech í”ŒëŸ¬ê·¸ì¸ ì‚¬ìš© Hook\r\n */\r\nexport function usePluginSpeech(options: UsePluginSpeechOptions = {}): UsePluginSpeechReturn {\r\n  const {\r\n    autoInitialize = true,\r\n    fallbackToWebAPI = true,\r\n    onStateChange,\r\n    onError\r\n  } = options;\r\n\r\n  // ìƒíƒœ\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [processingState, setProcessingState] = useState<SpeechProcessingState>('idle');\r\n  const [error, setError] = useState<string | null>(null);\r\n  \r\n  // í”ŒëŸ¬ê·¸ì¸ ì¸ìŠ¤í„´ìŠ¤\r\n  const speechPluginRef = useRef<ISpeechPlugin | null>(null);\r\n  const isAvailable = isPluginAvailable('speech');\r\n\r\n  // í”ŒëŸ¬ê·¸ì¸ ì´ˆê¸°í™”\r\n  useEffect(() => {\r\n    if (!autoInitialize) return;\r\n\r\n    const initializePlugin = async () => {\r\n      try {\r\n        setIsLoading(true);\r\n        setError(null);\r\n\r\n        const result = await getSpeechPlugin();\r\n        if (result.success) {\r\n          speechPluginRef.current = result.data;\r\n          \r\n          // ìƒíƒœ ë³€ê²½ ë¦¬ìŠ¤ë„ˆ ë“±ë¡\r\n          result.data.onSpeechEvent((event) => {\r\n            if (event.type === 'stateChange' && event.data?.state) {\r\n              setProcessingState(event.data.state);\r\n              onStateChange?.(event.data.state);\r\n            }\r\n            if (event.type === 'error' && event.data?.error) {\r\n              const errorMsg = typeof event.data.error === 'string' \r\n                ? event.data.error \r\n                : 'Unknown plugin error';\r\n              setError(errorMsg);\r\n              onError?.(errorMsg);\r\n            }\r\n          });\r\n\r\n          console.log('âœ… Speech plugin initialized successfully');\r\n        } else {\r\n          throw new Error(`Failed to initialize speech plugin: ${result.error}`);\r\n        }\r\n      } catch (err) {\r\n        const errorMsg = err instanceof Error ? err.message : 'Plugin initialization failed';\r\n        setError(errorMsg);\r\n        onError?.(errorMsg);\r\n        console.error('âŒ Speech plugin initialization failed:', err);\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n    };\r\n\r\n    initializePlugin();\r\n  }, [autoInitialize, onStateChange, onError]);\r\n\r\n  // TTS í•¨ìˆ˜\r\n  const speakText = useCallback(async (\r\n    text: string,\r\n    options: {\r\n      language?: string;\r\n      rate?: number;\r\n      volume?: number;\r\n    } = {}\r\n  ): Promise<boolean> => {\r\n    const plugin = speechPluginRef.current;\r\n    if (!plugin) {\r\n      console.warn('Speech plugin not available');\r\n      return false;\r\n    }\r\n\r\n    try {\r\n      const result = await plugin.speakText(\r\n        text as NonEmptyString,\r\n        {\r\n          language: options.language as NonEmptyString | undefined,\r\n          rate: options.rate as PositiveNumber | undefined,\r\n          volume: options.volume\r\n        }\r\n      );\r\n      return result.success;\r\n    } catch (error) {\r\n      console.error('TTS error:', error);\r\n      return false;\r\n    }\r\n  }, []);\r\n\r\n  // ìŒì„± ì¸ì‹ í•¨ìˆ˜\r\n  const recognizeSpeech = useCallback(async (\r\n    options: {\r\n      language?: string;\r\n      maxDuration?: number;\r\n      continuous?: boolean;\r\n    } = {}\r\n  ): Promise<{ success: boolean; transcript?: string; confidence?: number }> => {\r\n    const plugin = speechPluginRef.current;\r\n    if (!plugin) {\r\n      console.warn('Speech plugin not available');\r\n      return { success: false };\r\n    }\r\n\r\n    try {\r\n      const result = await plugin.recognizeSpeech({\r\n        language: options.language as NonEmptyString | undefined,\r\n        maxDuration: options.maxDuration as PositiveNumber | undefined,\r\n        continuous: options.continuous\r\n      });\r\n\r\n      if (result.success && result.data.success) {\r\n        return {\r\n          success: true,\r\n          transcript: result.data.transcript,\r\n          confidence: result.data.confidence\r\n        };\r\n      } else {\r\n        return { \r\n          success: false,\r\n          transcript: undefined,\r\n          confidence: undefined\r\n        };\r\n      }\r\n    } catch (error) {\r\n      console.error('Speech recognition error:', error);\r\n      return { success: false };\r\n    }\r\n  }, []);\r\n\r\n  // ì‹¤ì‹œê°„ ìŒì„± ì¸ì‹ ì‹œì‘\r\n  const startListening = useCallback((\r\n    onResult: (transcript: string, confidence: number) => void,\r\n    options: {\r\n      language?: string;\r\n      continuous?: boolean;\r\n    } = {}\r\n  ): boolean => {\r\n    const plugin = speechPluginRef.current;\r\n    if (!plugin) {\r\n      console.warn('Speech plugin not available');\r\n      return false;\r\n    }\r\n\r\n    try {\r\n      const result = plugin.startListening(\r\n        onResult,\r\n        {\r\n          language: options.language as NonEmptyString | undefined,\r\n          continuous: options.continuous\r\n        }\r\n      );\r\n      return result.success;\r\n    } catch (error) {\r\n      console.error('Start listening error:', error);\r\n      return false;\r\n    }\r\n  }, []);\r\n\r\n  // ìŒì„± ì¸ì‹ ì¤‘ì§€\r\n  const stopListening = useCallback((): boolean => {\r\n    const plugin = speechPluginRef.current;\r\n    if (!plugin) return false;\r\n\r\n    try {\r\n      const result = plugin.stopListening();\r\n      return result.success;\r\n    } catch (error) {\r\n      console.error('Stop listening error:', error);\r\n      return false;\r\n    }\r\n  }, []);\r\n\r\n  // ì‹ í˜¸ìŒ ì¬ìƒ\r\n  const playBeep = useCallback(async (\r\n    options: {\r\n      frequency?: number;\r\n      duration?: number;\r\n    } = {}\r\n  ): Promise<boolean> => {\r\n    const plugin = speechPluginRef.current;\r\n    if (!plugin) {\r\n      console.warn('Speech plugin not available');\r\n      return false;\r\n    }\r\n\r\n    try {\r\n      const result = await plugin.playBeep({\r\n        frequency: options.frequency as PositiveNumber | undefined,\r\n        duration: options.duration as PositiveNumber | undefined\r\n      });\r\n      return result.success;\r\n    } catch (error) {\r\n      console.error('Play beep error:', error);\r\n      return false;\r\n    }\r\n  }, []);\r\n\r\n  // ëª¨ë“  ì²˜ë¦¬ ì¤‘ì§€\r\n  const stopAll = useCallback((): boolean => {\r\n    const plugin = speechPluginRef.current;\r\n    if (!plugin) return false;\r\n\r\n    try {\r\n      const result = plugin.stopAll();\r\n      return result.success;\r\n    } catch (error) {\r\n      console.error('Stop all error:', error);\r\n      return false;\r\n    }\r\n  }, []);\r\n\r\n  // ì²˜ë¦¬ ìƒíƒœ í™•ì¸\r\n  const isProcessing = useCallback((): boolean => {\r\n    const plugin = speechPluginRef.current;\r\n    return plugin?.isProcessing() ?? false;\r\n  }, []);\r\n\r\n  // ì§€ì› ì–¸ì–´ ì¡°íšŒ\r\n  const getSupportedLanguages = useCallback(async (): Promise<string[]> => {\r\n    const plugin = speechPluginRef.current;\r\n    if (!plugin) return [];\r\n\r\n    try {\r\n      const result = await plugin.getSupportedLanguages();\r\n      return result.success ? result.data : [];\r\n    } catch (error) {\r\n      console.error('Get supported languages error:', error);\r\n      return [];\r\n    }\r\n  }, []);\r\n\r\n  // ì‚¬ìš© ê°€ëŠ¥í•œ ìŒì„± ì¡°íšŒ\r\n  const getAvailableVoices = useCallback(async (): Promise<SpeechSynthesisVoice[]> => {\r\n    const plugin = speechPluginRef.current;\r\n    if (!plugin) return [];\r\n\r\n    try {\r\n      const result = await plugin.getAvailableVoices();\r\n      return result.success ? result.data : [];\r\n    } catch (error) {\r\n      console.error('Get available voices error:', error);\r\n      return [];\r\n    }\r\n  }, []);\r\n\r\n  return {\r\n    // ìƒíƒœ\r\n    isAvailable,\r\n    isLoading,\r\n    processingState,\r\n    error,\r\n    \r\n    // ë©”ì„œë“œ\r\n    speakText,\r\n    recognizeSpeech,\r\n    startListening,\r\n    stopListening,\r\n    playBeep,\r\n    stopAll,\r\n    isProcessing,\r\n    getSupportedLanguages,\r\n    getAvailableVoices\r\n  };\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\hooks\\useQuestionProgress.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'index' is defined but never used. Allowed unused args must match /^_/u.","line":111,"column":33,"nodeType":null,"messageId":"unusedVar","endLine":111,"endColumn":38}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * ë¬¸ì œ ì§„í–‰ ê´€ë¦¬ í›…\r\n * í•˜ë“œì½”ë”© ë°©ì§€ ì›ì¹™ì— ë”°ë¼ ëª¨ë“ˆí™”ëœ ë¬¸ì œ ì§„í–‰ ë¡œì§\r\n * \r\n * @architecture Plugin-style question progression for Pattern Training\r\n */\r\n\r\nimport { useState, useCallback } from 'react';\r\n\r\nexport interface Question {\r\n  ko: string;\r\n  en: string;\r\n  id?: string;\r\n}\r\n\r\nexport interface QuestionProgressConfig {\r\n  questions: Question[];\r\n  onQuestionStart?: (question: Question, index: number) => void;\r\n  onQuestionComplete?: (question: Question, index: number) => void;\r\n  onAllComplete?: () => void;\r\n}\r\n\r\nexport interface QuestionProgressState {\r\n  currentIndex: number;\r\n  currentQuestion: Question | null;\r\n  isComplete: boolean;\r\n  progress: number; // 0-100%\r\n  totalQuestions: number;\r\n}\r\n\r\n/**\r\n * ë¬¸ì œ ì§„í–‰ ê´€ë¦¬ í›…\r\n * ì™„ì „íˆ ëª¨ë“ˆí™”ë˜ì–´ ì¬ì‚¬ìš© ê°€ëŠ¥\r\n */\r\nexport function useQuestionProgress(config: QuestionProgressConfig): QuestionProgressState & {\r\n  nextQuestion: () => void;\r\n  resetProgress: () => void;\r\n  jumpToQuestion: (index: number) => void;\r\n} {\r\n  const { questions, onQuestionStart, onQuestionComplete, onAllComplete } = config;\r\n  \r\n  const [currentIndex, setCurrentIndex] = useState(0);\r\n  \r\n  const currentQuestion = questions[currentIndex] || null;\r\n  const isComplete = currentIndex >= questions.length;\r\n  const progress = questions.length > 0 ? (currentIndex / questions.length) * 100 : 0;\r\n  \r\n  const nextQuestion = useCallback(() => {\r\n    console.log(`ğŸ¯ [${new Date().toLocaleTimeString()}] nextQuestion í˜¸ì¶œ: ${currentIndex} -> ${currentIndex + 1}`);\r\n    \r\n    if (currentIndex < questions.length) {\r\n      // í˜„ì¬ ë¬¸ì œ ì™„ë£Œ ì½œë°±\r\n      onQuestionComplete?.(questions[currentIndex], currentIndex);\r\n    }\r\n    \r\n    const nextIndex = currentIndex + 1;\r\n    \r\n    if (nextIndex >= questions.length) {\r\n      console.log(`ğŸ‰ [${new Date().toLocaleTimeString()}] ëª¨ë“  ë¬¸ì œ ì™„ë£Œ!`);\r\n      onAllComplete?.();\r\n      return;\r\n    }\r\n    \r\n    setCurrentIndex(nextIndex);\r\n    \r\n    // ë‹¤ìŒ ë¬¸ì œ ì‹œì‘ ì½œë°±\r\n    const nextQuestion = questions[nextIndex];\r\n    if (nextQuestion) {\r\n      console.log(`ğŸ“ [${new Date().toLocaleTimeString()}] ë¬¸ì œ ${nextIndex + 1}: \"${nextQuestion.ko}\" â†’ \"${nextQuestion.en}\"`);\r\n      onQuestionStart?.(nextQuestion, nextIndex);\r\n    }\r\n  }, [currentIndex, questions, onQuestionStart, onQuestionComplete, onAllComplete]);\r\n\r\n  const resetProgress = useCallback(() => {\r\n    setCurrentIndex(0);\r\n    if (questions.length > 0) {\r\n      onQuestionStart?.(questions[0], 0);\r\n    }\r\n  }, [questions, onQuestionStart]);\r\n\r\n  const jumpToQuestion = useCallback((index: number) => {\r\n    if (index >= 0 && index < questions.length) {\r\n      setCurrentIndex(index);\r\n      onQuestionStart?.(questions[index], index);\r\n    }\r\n  }, [questions, onQuestionStart]);\r\n\r\n  return {\r\n    currentIndex,\r\n    currentQuestion,\r\n    isComplete,\r\n    progress,\r\n    totalQuestions: questions.length,\r\n    nextQuestion,\r\n    resetProgress,\r\n    jumpToQuestion\r\n  };\r\n}\r\n\r\n/**\r\n * íŒ¨í„´ íŠ¸ë ˆì´ë‹ ì „ìš© ë¬¸ì œ ì§„í–‰ í›…\r\n * TTS + íƒ€ì´ë¨¸ í†µí•©\r\n */\r\nexport function usePatternTrainingProgress(\r\n  questions: Question[],\r\n  onTTSComplete: (question: Question) => void,\r\n  onTrainingComplete: () => void\r\n) {\r\n  return useQuestionProgress({\r\n    questions,\r\n    onQuestionStart: (question, index) => {\r\n      console.log(`ğŸ¤ [${new Date().toLocaleTimeString()}] TTS ì¬ìƒ ì‹œì‘: \"${question.ko}\"`);\r\n      // TTS ì¬ìƒ ë¡œì§ì€ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì²˜ë¦¬\r\n      onTTSComplete(question);\r\n    },\r\n    onAllComplete: () => {\r\n      console.log(`ğŸ‰ [${new Date().toLocaleTimeString()}] íŒ¨í„´ íŠ¸ë ˆì´ë‹ ì™„ë£Œ!`);\r\n      onTrainingComplete();\r\n    }\r\n  });\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\hooks\\useResponsiveDesign.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\hooks\\useReviewSchedule.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\hooks\\useSRSEngine.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\hooks\\useSimpleSpeechRecognition.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\hooks\\useSpacedRepetition.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ReviewCard' is defined but never used. Allowed unused vars must match /^_/u.","line":14,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":14,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'accuracy' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":268,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":268,"endColumn":21}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useCallback, useMemo } from 'react';\nimport { QuestionItem } from '@/data/patternData';\nimport { \n  useLocalStorage, \n  STORAGE_KEYS, \n  MistakeItem, \n  UserStats,\n  StorageManager \n} from './useLocalStorage';\n\n// ğŸ”„ LEGACY ADAPTER: ìƒˆ SRS ì‹œìŠ¤í…œìœ¼ë¡œ ì ì§„ì  ë§ˆì´ê·¸ë ˆì´ì…˜ ì¤‘\n// 2025-01-12: useSRSEngine.tsë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤\nimport { useSRSEngine } from './useSRSEngine';\nimport { ReviewCard } from '@/services/srs/SRSEngine';\n\n/**\n * @deprecated ì´ í›…ì€ ì™„ì „íˆ ë ˆê±°ì‹œì…ë‹ˆë‹¤.\n * âš ï¸  ë” ì´ìƒ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”.\n * âœ…  ëŒ€ì‹  useSRSEngine.tsë¥¼ ì‚¬ìš©í•˜ì„¸ìš”.\n *\n * ë§ˆì´ê·¸ë ˆì´ì…˜ ê°€ì´ë“œ:\n * 1. import { useSpacedRepetition } â†’ import { useSRSEngine }\n * 2. const { dueReviews } = useSpacedRepetition() â†’ const srs = useSRSEngine({ userId })\n * 3. srs.cards.filter(card => card.isDue) ì‚¬ìš©\n *\n * 2025-01-12: ì´ íŒŒì¼ì€ ë‹¤ìŒ ë²„ì „ì—ì„œ ì œê±°ë  ì˜ˆì •ì…ë‹ˆë‹¤.\n */\n\n// ë§ê°ê³¡ì„  ë³µìŠµ ê°„ê²© (ë°€ë¦¬ì´ˆ)\nexport const REVIEW_INTERVALS = {\n  FIRST: 1 * 24 * 60 * 60 * 1000,    // 1ì¼\n  SECOND: 3 * 24 * 60 * 60 * 1000,   // 3ì¼\n  THIRD: 7 * 24 * 60 * 60 * 1000,    // 7ì¼\n  FOURTH: 14 * 24 * 60 * 60 * 1000   // 14ì¼\n};\n\nexport interface MistakeData {\n  level: number;\n  stage: number;\n  korean: string;\n  english: string;\n  pattern: string;\n  verb?: string;\n  userAnswer: string;\n  responseTime: number;\n  difficulty: number;\n}\n\nexport interface UseSpacedRepetitionReturn {\n  // Mistakes management\n  mistakes: MistakeItem[];\n  addMistake: (mistake: MistakeData) => void;\n  \n  // Review system\n  dueReviews: MistakeItem[];\n  completedReview: (mistakeId: string, isCorrect: boolean) => void;\n  \n  // Statistics\n  stats: UserStats;\n  updateStats: (sessionData: {\n    totalQuestions: number;\n    correctAnswers: number;\n    totalMistakes: number;\n    studyTime: number;\n  }) => void;\n  \n  // Review questions generation\n  getReviewQuestions: (mode: 'all' | 'pattern' | 'weak-patterns', patternName?: string) => QuestionItem[];\n  \n  // Utilities\n  mistakeCount: number;\n  reviewCount: number;\n  masteredCount: number;\n  clearAllData: () => void;\n  debugPrint: () => void;\n}\n\nexport const useSpacedRepetition = (): UseSpacedRepetitionReturn => {\n  \n  // ğŸ”„ ADAPTER PATTERN: SSOT SRS ì‹œìŠ¤í…œ ì‚¬ìš©\n  const srsEngine = useSRSEngine({ \n    userId: 'legacy-user', \n    storageKey: 'legacy-srs-cards'\n  });\n  \n  // ê¸°ì¡´ ë¡œì»¬ìŠ¤í† ë¦¬ì§€ ì‹œìŠ¤í…œ (ì ì§„ì  ì´ì „ ì¤‘)\n  const { \n    value: mistakes, \n    updateValue: updateMistakes \n  } = useLocalStorage(STORAGE_KEYS.MISTAKES);\n\n  const { \n    value: stats, \n    updateValue: updateStatsValue \n  } = useLocalStorage(STORAGE_KEYS.USER_STATS);\n\n  // Get due reviews (SSOT ì‹œìŠ¤í…œ + ë ˆê±°ì‹œ í˜¸í™˜)\n  const dueReviews = useMemo(() => {\n    // ğŸ”„ NEW: SSOT ì‹œìŠ¤í…œì—ì„œ ë³µìŠµ ì˜ˆì • ì¹´ë“œë“¤ ê°€ì ¸ì˜¤ê¸°\n    const newDueCards = srsEngine.dueCards;\n    \n    // ğŸ”„ LEGACY: ê¸°ì¡´ mistakes ì‹œìŠ¤í…œ (ì ì§„ì  ì œê±° ì˜ˆì •)\n    const now = Date.now();\n    const legacyDueReviews = mistakes.filter(mistake => \n      !mistake.mastered && mistake.nextReview <= now\n    );\n\n    // ğŸ”— ADAPTER: ë ˆê±°ì‹œ í˜•íƒœë¡œ ë³€í™˜í•˜ì—¬ ë°˜í™˜\n    const adaptedNewCards = newDueCards.map(card => ({\n      id: card.id,\n      korean: card.content.korean,\n      english: card.content.english,\n      pattern: card.content.pattern || 'unknown',\n      level: card.content.level,\n      stage: card.content.stage,\n      nextReview: card.memory.nextReview.getTime(),\n      mastered: card.memory.strength > 0.9, // ë†’ì€ ê¸°ì–µë ¥ = ë§ˆìŠ¤í„°\n      reviewCount: card.memory.reviewCount,\n      mistakeCount: card.performance.mistakes\n    } as MistakeItem));\n\n    // ìš°ì„ : SSOT ì‹œìŠ¤í…œ, ëŒ€ì²´: ë ˆê±°ì‹œ ì‹œìŠ¤í…œ\n    return adaptedNewCards.length > 0 ? adaptedNewCards : legacyDueReviews;\n  }, [srsEngine.dueCards, mistakes]);\n\n  // Statistics\n  const mistakeCount = mistakes.length;\n  const reviewCount = mistakes.filter(m => m.reviewCount > 0).length;\n  const masteredCount = mistakes.filter(m => m.mastered).length;\n\n  // Add a new mistake (SSOT ì–´ëŒ‘í„°)\n  const addMistake = useCallback((mistake: MistakeData) => {\n    console.warn('âš ï¸ [DEPRECATED] useSpacedRepetition.addMistakeëŠ” deprecatedì…ë‹ˆë‹¤. useSRSEngineì„ ì‚¬ìš©í•˜ì„¸ìš”.');\n    \n    // ğŸ”„ NEW: SSOT ì‹œìŠ¤í…œì— ì¶”ê°€\n    try {\n      const newCard = srsEngine.addCard({\n        korean: mistake.korean,\n        english: mistake.english,\n        level: mistake.level,\n        stage: mistake.stage,\n        pattern: mistake.pattern\n      });\n      \n      // í‹€ë¦° ë‹µì•ˆì„ ë°˜ì˜í•œ ë¦¬ë·° ì„¸ì…˜ ì²˜ë¦¬\n      srsEngine.processReviewSession(newCard.id, {\n        userAnswer: mistake.userAnswer,\n        correctAnswer: mistake.english,\n        isCorrect: false,\n        responseTime: mistake.responseTime,\n        difficulty: 'medium',\n        confidence: 0.3\n      });\n      \n      console.log(`âœ… [NEW SRS] ìƒˆ í‹€ë¦° ë¬¸ì œ ì¶”ê°€: ${mistake.korean}`);\n      \n    } catch (error) {\n      console.error('NEW SRS ì‹œìŠ¤í…œì— ì¶”ê°€ ì‹¤íŒ¨, ë ˆê±°ì‹œ ì‹œìŠ¤í…œ ì‚¬ìš©:', error);\n      \n      // ğŸ”„ FALLBACK: ë ˆê±°ì‹œ ì‹œìŠ¤í…œì— ì¶”ê°€\n      updateMistakes(prevMistakes => {\n        const now = Date.now();\n        const newMistakes = [...prevMistakes];\n        \n        const existingIndex = newMistakes.findIndex(m => \n          m.korean === mistake.korean && \n          m.english === mistake.english &&\n          m.pattern === mistake.pattern\n        );\n\n        if (existingIndex >= 0) {\n          // Update existing mistake\n          const existing = newMistakes[existingIndex];\n          newMistakes[existingIndex] = {\n            ...existing,\n            mistakeCount: existing.mistakeCount + 1,\n            lastMistake: now,\n            totalResponseTime: existing.totalResponseTime + mistake.responseTime,\n            averageResponseTime: (existing.totalResponseTime + mistake.responseTime) / (existing.mistakeCount + 1),\n            nextReview: now + REVIEW_INTERVALS.FIRST,\n            reviewStage: 0,\n            lastUserAnswer: mistake.userAnswer\n          };\n          \n          console.log(`ğŸ“¦ [LEGACY] ê¸°ì¡´ í‹€ë¦° ë¬¸ì œ ì—…ë°ì´íŠ¸: ${mistake.korean}`);\n        } else {\n          // Add new mistake\n          const newMistake: MistakeItem = {\n            id: `mistake_${now}_${Math.random().toString(36).substr(2, 9)}`,\n            level: mistake.level,\n            stage: mistake.stage,\n            korean: mistake.korean,\n            english: mistake.english,\n            pattern: mistake.pattern,\n            verb: mistake.verb,\n            userAnswer: mistake.userAnswer,\n            mistakeCount: 1,\n            firstMistake: now,\n            lastMistake: now,\n            nextReview: now + REVIEW_INTERVALS.FIRST,\n            reviewStage: 0,\n            reviewCount: 0,\n            difficulty: mistake.difficulty,\n            totalResponseTime: mistake.responseTime,\n            averageResponseTime: mistake.responseTime,\n            mastered: false\n          };\n          \n          newMistakes.push(newMistake);\n          console.log(`ğŸ“¦ [LEGACY] ìƒˆ í‹€ë¦° ë¬¸ì œ ì¶”ê°€: ${mistake.korean}`);\n        }\n\n        return newMistakes;\n      });\n    }\n  }, [srsEngine, updateMistakes]);\n\n  // Complete a review (mark as correct or incorrect)\n  const completedReview = useCallback((mistakeId: string, isCorrect: boolean) => {\n    updateMistakes(prevMistakes => {\n      const newMistakes = [...prevMistakes];\n      const mistakeIndex = newMistakes.findIndex(m => m.id === mistakeId);\n      \n      if (mistakeIndex >= 0) {\n        const mistake = newMistakes[mistakeIndex];\n        mistake.reviewCount += 1;\n        mistake.lastReview = Date.now();\n\n        if (isCorrect) {\n          // Correct answer: move to next review stage\n          mistake.reviewStage += 1;\n          \n          if (mistake.reviewStage >= 4) {\n            // All 4 stages completed: mark as mastered\n            mistake.mastered = true;\n            mistake.masteredDate = Date.now();\n            console.log(`ë§ˆìŠ¤í„° ì™„ë£Œ: ${mistake.korean}`);\n          } else {\n            // Set next review time based on current stage\n            const intervals = [\n              REVIEW_INTERVALS.FIRST,\n              REVIEW_INTERVALS.SECOND, \n              REVIEW_INTERVALS.THIRD,\n              REVIEW_INTERVALS.FOURTH\n            ];\n            mistake.nextReview = Date.now() + intervals[mistake.reviewStage];\n          }\n        } else {\n          // Incorrect answer: restart from stage 0\n          mistake.reviewStage = 0;\n          mistake.nextReview = Date.now() + REVIEW_INTERVALS.FIRST;\n          mistake.mistakeCount += 1;\n        }\n      }\n      \n      return newMistakes;\n    });\n  }, [updateMistakes]);\n\n  // Update user statistics\n  const updateStats = useCallback((sessionData: {\n    totalQuestions: number;\n    correctAnswers: number;\n    totalMistakes: number;\n    studyTime: number;\n  }) => {\n    updateStatsValue(prevStats => {\n      const accuracy = sessionData.totalQuestions > 0 \n        ? (sessionData.correctAnswers / sessionData.totalQuestions) * 100 \n        : 0;\n\n      const newTotalQuestions = prevStats.totalQuestions + sessionData.totalQuestions;\n      const newTotalCorrect = prevStats.totalCorrect + sessionData.correctAnswers;\n      const newAverageAccuracy = newTotalQuestions > 0 \n        ? (newTotalCorrect / newTotalQuestions) * 100 \n        : 0;\n\n      return {\n        ...prevStats,\n        totalSessions: prevStats.totalSessions + 1,\n        totalQuestions: newTotalQuestions,\n        totalCorrect: newTotalCorrect,\n        totalMistakes: prevStats.totalMistakes + sessionData.totalMistakes,\n        averageAccuracy: newAverageAccuracy,\n        totalStudyTime: prevStats.totalStudyTime + sessionData.studyTime,\n        lastUpdated: Date.now()\n      };\n    });\n  }, [updateStatsValue]);\n\n  // Generate review questions based on mode\n  const getReviewQuestions = useCallback((\n    mode: 'all' | 'pattern' | 'weak-patterns', \n    patternName?: string\n  ): QuestionItem[] => {\n    const now = Date.now();\n    let targetMistakes: MistakeItem[] = [];\n\n    if (mode === 'all') {\n      // All due reviews\n      targetMistakes = mistakes.filter(m => !m.mastered && m.nextReview <= now);\n    } else if (mode === 'pattern' && patternName) {\n      // Specific pattern reviews\n      targetMistakes = mistakes.filter(m => \n        !m.mastered && \n        m.nextReview <= now && \n        m.pattern === patternName\n      );\n    } else if (mode === 'weak-patterns') {\n      // Weak patterns (low mastery rate or high mistake count)\n      const patternStats = new Map<string, { total: number; mastered: number }>();\n      \n      mistakes.forEach(m => {\n        const current = patternStats.get(m.pattern) || { total: 0, mastered: 0 };\n        current.total += 1;\n        if (m.mastered) current.mastered += 1;\n        patternStats.set(m.pattern, current);\n      });\n      \n      const weakPatterns = Array.from(patternStats.entries())\n        .filter(([_, stats]) => stats.total >= 3 && (stats.mastered / stats.total) < 0.5)\n        .map(([pattern]) => pattern);\n      \n      targetMistakes = mistakes.filter(m => \n        !m.mastered && \n        m.nextReview <= now && \n        weakPatterns.includes(m.pattern)\n      );\n    }\n\n    // Convert to QuestionItem format\n    return targetMistakes.map(mistake => ({\n      korean: mistake.korean,\n      english: mistake.english,\n      pattern: mistake.pattern,\n      verb: mistake.verb,\n      level: mistake.level,\n      stage: mistake.stage,\n      mistakeId: mistake.id // Add for tracking\n    } as QuestionItem & { mistakeId: string }));\n  }, [mistakes]);\n\n  // Clear all data\n  const clearAllData = useCallback(() => {\n    StorageManager.clearAllData();\n  }, []);\n\n  // Debug print\n  const debugPrint = useCallback(() => {\n    StorageManager.debugPrint();\n  }, []);\n\n  return {\n    // Mistakes management\n    mistakes,\n    addMistake,\n    \n    // Review system\n    dueReviews,\n    completedReview,\n    \n    // Statistics\n    stats,\n    updateStats,\n    \n    // Review questions generation\n    getReviewQuestions,\n    \n    // Utilities\n    mistakeCount,\n    reviewCount,\n    masteredCount,\n    clearAllData,\n    debugPrint\n  };\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\hooks\\useSpeech.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'phraseHints' is assigned a value but never used. Allowed unused args must match /^_/u.","line":47,"column":45,"nodeType":null,"messageId":"unusedVar","endLine":47,"endColumn":56},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'phraseHints' is assigned a value but never used. Allowed unused args must match /^_/u.","line":71,"column":44,"nodeType":null,"messageId":"unusedVar","endLine":71,"endColumn":55},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'speech'. Either include it or remove the dependency array.","line":129,"column":6,"nodeType":"ArrayExpression","endLine":129,"endColumn":80,"suggestions":[{"desc":"Update the dependencies array to be: [speech, options.language]","fix":{"range":[3525,3599],"text":"[speech, options.language]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'speech'. Either include it or remove the dependency array.","line":178,"column":6,"nodeType":"ArrayExpression","endLine":178,"endColumn":88,"suggestions":[{"desc":"Update the dependencies array to be: [speech, options.language]","fix":{"range":[4927,5009],"text":"[speech, options.language]"}}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'frequency' is assigned a value but never used. Allowed unused args must match /^_/u.","line":181,"column":39,"nodeType":null,"messageId":"unusedVar","endLine":181,"endColumn":48},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'duration' is assigned a value but never used. Allowed unused args must match /^_/u.","line":181,"column":64,"nodeType":null,"messageId":"unusedVar","endLine":181,"endColumn":72},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'speech'. Either include it or remove the dependency array.","line":198,"column":6,"nodeType":"ArrayExpression","endLine":198,"endColumn":55,"suggestions":[{"desc":"Update the dependencies array to be: [speech]","fix":{"range":[5710,5759],"text":"[speech]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'speech'. Either include it or remove the dependency array.","line":204,"column":6,"nodeType":"ArrayExpression","endLine":204,"endColumn":22,"suggestions":[{"desc":"Update the dependencies array to be: [speech]","fix":{"range":[5924,5940],"text":"[speech]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'speech'. Either include it or remove the dependency array.","line":252,"column":6,"nodeType":"ArrayExpression","endLine":252,"endColumn":22,"suggestions":[{"desc":"Update the dependencies array to be: [speech]","fix":{"range":[7680,7696],"text":"[speech]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'speech'. Either include it or remove the dependency array.","line":287,"column":6,"nodeType":"ArrayExpression","endLine":287,"endColumn":22,"suggestions":[{"desc":"Update the dependencies array to be: [speech]","fix":{"range":[8613,8629],"text":"[speech]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useCallback, useRef } from 'react';\r\nimport { useSimpleSpeech } from '@/plugins/simple/SimpleSpeechPlugin';\r\n\r\n// Helper function to detect Korean text\r\nconst isKorean = (text: string): boolean => {\r\n  const koreanRegex = /[\\u3131-\\u318E\\uAC00-\\uD7A3]/;\r\n  return koreanRegex.test(text);\r\n};\r\n\r\nexport interface UseSpeechOptions {\r\n  apiBaseUrl?: string;\r\n  preferCloudSTT?: boolean;\r\n  language?: string;\r\n}\r\n\r\nexport interface STTResult {\r\n  transcript: string;\r\n  confidence: number;\r\n  isFinal: boolean;\r\n}\r\n\r\nexport interface SpeechState {\r\n  isRecording: boolean;\r\n  isProcessing: boolean;\r\n  error: string | null;\r\n  lastResult: STTResult | null;\r\n}\r\n\r\nexport const useSpeech = (options: UseSpeechOptions = {}) => {\r\n  const [state, setState] = useState<SpeechState>({\r\n    isRecording: false,\r\n    isProcessing: false,\r\n    error: null,\r\n    lastResult: null,\r\n  });\r\n\r\n  // Use simplified speech plugin\r\n  const speech = useSimpleSpeech();\r\n  const activeRecognitionRef = useRef<AbortController | null>(null);\r\n  const activeTTSRef = useRef<AbortController | null>(null);\r\n\r\n  // Check if speech services are available\r\n  const isSTTAvailable = !speech.isLoading && !speech.error;\r\n  const isTTSAvailable = !speech.isLoading && !speech.error;\r\n\r\n  // Start recording and transcription\r\n  const startRecording = useCallback(async (phraseHints: string[] = []) => {\r\n    if (speech.isLoading || speech.error) {\r\n      setState(prev => ({\r\n        ...prev,\r\n        error: speech.error || 'Speech plugin not ready'\r\n      }));\r\n      return;\r\n    }\r\n\r\n    setState(prev => ({ \r\n      ...prev, \r\n      isRecording: true, \r\n      error: null,\r\n      lastResult: null \r\n    }));\r\n\r\n    // Cancel any existing recognition\r\n    if (activeRecognitionRef.current) {\r\n      activeRecognitionRef.current.abort();\r\n    }\r\n    activeRecognitionRef.current = new AbortController();\r\n  }, [speech.isLoading, speech.error]);\r\n\r\n  // Stop recording and get transcription\r\n  const stopRecording = useCallback(async (phraseHints: string[] = []): Promise<STTResult | null> => {\r\n    if (speech.isLoading || speech.error) {\r\n      setState(prev => ({\r\n        ...prev,\r\n        isRecording: false,\r\n        error: speech.error || 'Speech plugin not ready'\r\n      }));\r\n      return null;\r\n    }\r\n\r\n    try {\r\n      setState(prev => ({ \r\n        ...prev, \r\n        isRecording: false, \r\n        isProcessing: true,\r\n        error: null \r\n      }));\r\n\r\n      const result = await speech.recognizeSpeech({\r\n        language: options.language || 'en-US',\r\n        maxDuration: 30000,\r\n        signal: activeRecognitionRef.current?.signal\r\n      });\r\n\r\n      if (result.success && result.transcript) {\r\n        const sttResult: STTResult = {\r\n          transcript: result.transcript,\r\n          confidence: result.confidence || 0.9,\r\n          isFinal: true\r\n        };\r\n\r\n        setState(prev => ({\r\n          ...prev,\r\n          isProcessing: false,\r\n          lastResult: sttResult,\r\n        }));\r\n\r\n        return sttResult;\r\n      } else {\r\n        setState(prev => ({\r\n          ...prev,\r\n          isProcessing: false,\r\n          error: 'ìŒì„±ì´ ì¸ì‹ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤',\r\n        }));\r\n        return null;\r\n      }\r\n\r\n    } catch (error) {\r\n      const errorMessage = error instanceof Error ? error.message : 'ìŒì„± ì¸ì‹ ì‹¤íŒ¨';\r\n      setState(prev => ({\r\n        ...prev,\r\n        isProcessing: false,\r\n        error: errorMessage,\r\n      }));\r\n      return null;\r\n    } finally {\r\n      activeRecognitionRef.current = null;\r\n    }\r\n  }, [speech.isLoading, speech.error, speech.recognizeSpeech, options.language]);\r\n\r\n  // Text-to-Speech with language detection\r\n  const speak = useCallback(async (text: string, voiceOptions: {\r\n    rate?: number;\r\n    pitch?: number;\r\n    volume?: number;\r\n    lang?: string;\r\n  } = {}) => {\r\n    if (speech.isLoading || speech.error) {\r\n      setState(prev => ({\r\n        ...prev,\r\n        error: speech.error || 'Speech plugin not ready'\r\n      }));\r\n      return;\r\n    }\r\n\r\n    try {\r\n      // Cancel any existing TTS\r\n      if (activeTTSRef.current) {\r\n        activeTTSRef.current.abort();\r\n      }\r\n      activeTTSRef.current = new AbortController();\r\n\r\n      // Auto-detect language if not specified\r\n      const detectedLang = voiceOptions.lang || \r\n        (isKorean(text) ? 'ko-KR' : options.language || 'en-US');\r\n\r\n      const success = await speech.speakText(text, {\r\n        language: detectedLang,\r\n        rate: voiceOptions.rate || (detectedLang === 'ko-KR' ? 0.8 : 0.9),\r\n        signal: activeTTSRef.current.signal\r\n      });\r\n\r\n      if (!success) {\r\n        setState(prev => ({\r\n          ...prev,\r\n          error: speech.error || 'ìŒì„± ì¬ìƒ ì‹¤íŒ¨',\r\n        }));\r\n      }\r\n\r\n    } catch (error) {\r\n      setState(prev => ({\r\n        ...prev,\r\n        error: error instanceof Error ? error.message : 'ìŒì„± ì¬ìƒ ì‹¤íŒ¨',\r\n      }));\r\n    } finally {\r\n      activeTTSRef.current = null;\r\n    }\r\n  }, [speech.isLoading, speech.error, speech.speakText, speech.error, options.language]);\r\n\r\n  // Play beep sound with control\r\n  const playBeep = useCallback(async (frequency: number = 800, duration: number = 500) => {\r\n    if (speech.isLoading || speech.error) {\r\n      // Fallback: create a brief pause\r\n      return new Promise<void>(resolve => setTimeout(resolve, 300));\r\n    }\r\n\r\n    try {\r\n      const success = await speech.playBeep();\r\n      if (!success) {\r\n        // Fallback: create a brief pause\r\n        return new Promise<void>(resolve => setTimeout(resolve, 300));\r\n      }\r\n    } catch (error) {\r\n      console.warn('Beep sound failed:', error);\r\n      // Fallback: create a brief pause\r\n      return new Promise<void>(resolve => setTimeout(resolve, 300));\r\n    }\r\n  }, [speech.isLoading, speech.error, speech.playBeep]);\r\n\r\n  // Stop beep sound immediately\r\n  const stopBeep = useCallback(() => {\r\n    // Simple plugin system handles stopping internally\r\n    speech.stopAll();\r\n  }, [speech.stopAll]);\r\n\r\n  // Auto-flow for speaking mode with better error handling\r\n  const startAutoFlow = useCallback(async (koreanText: string, onReadyForSpeech?: () => void) => {\r\n    if (speech.isLoading || speech.error) {\r\n      const error = new Error(speech.error || 'Speech plugin not ready');\r\n      setState(prev => ({ ...prev, error: error.message }));\r\n      throw error;\r\n    }\r\n\r\n    try {\r\n      setState(prev => ({ ...prev, error: null }));\r\n      \r\n      // Step 1: Play Korean TTS with timeout protection\r\n      const ttsPromise = speak(koreanText, { lang: 'ko-KR' });\r\n      const timeoutPromise = new Promise<void>((_, reject) => \r\n        setTimeout(() => reject(new Error('TTS ì‹œê°„ ì´ˆê³¼')), 10000)\r\n      );\r\n      \r\n      await Promise.race([ttsPromise, timeoutPromise]);\r\n      \r\n      // Small delay to ensure TTS is completely finished\r\n      await new Promise(resolve => setTimeout(resolve, 200));\r\n      \r\n      // Step 2: Play beep sound\r\n      await playBeep();\r\n      \r\n      // Small delay after beep\r\n      await new Promise(resolve => setTimeout(resolve, 300));\r\n      \r\n      // Step 3: Callback to indicate ready for speech\r\n      if (onReadyForSpeech) {\r\n        onReadyForSpeech();\r\n      }\r\n      \r\n    } catch (error) {\r\n      setState(prev => ({\r\n        ...prev,\r\n        error: error instanceof Error ? error.message : 'ìë™ í”Œë¡œìš° ì‹¤í–‰ ì‹¤íŒ¨',\r\n      }));\r\n      throw error; // Re-throw to allow component to handle state reset\r\n    }\r\n  }, [speech.isLoading, speech.error, speak, playBeep]);\r\n\r\n  // TTS control methods (simplified - the simple plugin system handles these internally)\r\n  const pauseTTS = useCallback(() => {\r\n    // Simple plugin doesn't expose pause/resume, so we stop instead\r\n    speech.stopAll();\r\n  }, [speech.stopAll]);\r\n\r\n  const resumeTTS = useCallback(() => {\r\n    // Resume not directly supported in simple plugin\r\n    console.warn('Resume TTS not supported in simple plugin system');\r\n  }, []);\r\n\r\n  const isTTSPaused = useCallback(() => {\r\n    // Simple plugin doesn't track paused state\r\n    return false;\r\n  }, []);\r\n\r\n  const isTTSSpeaking = useCallback(() => {\r\n    return speech.isProcessing;\r\n  }, [speech.isProcessing]);\r\n\r\n  // Stop all speech activities\r\n  const stopAll = useCallback(() => {\r\n    speech.stopAll();\r\n    \r\n    // Cancel active operations\r\n    if (activeRecognitionRef.current) {\r\n      activeRecognitionRef.current.abort();\r\n      activeRecognitionRef.current = null;\r\n    }\r\n    if (activeTTSRef.current) {\r\n      activeTTSRef.current.abort();\r\n      activeTTSRef.current = null;\r\n    }\r\n\r\n    setState(prev => ({\r\n      ...prev,\r\n      isRecording: false,\r\n      isProcessing: false,\r\n    }));\r\n  }, [speech.stopAll]);\r\n\r\n  // Clear error\r\n  const clearError = useCallback(() => {\r\n    setState(prev => ({ ...prev, error: null }));\r\n  }, []);\r\n\r\n  // Get available TTS voices (not directly supported in simple plugin)\r\n  const getVoices = useCallback(() => {\r\n    return [];\r\n  }, []);\r\n\r\n  return {\r\n    // State\r\n    ...state,\r\n    \r\n    // Capabilities\r\n    isSTTAvailable,\r\n    isTTSAvailable,\r\n    \r\n    // Actions\r\n    startRecording,\r\n    stopRecording,\r\n    speak,\r\n    playBeep,\r\n    stopBeep,\r\n    startAutoFlow,\r\n    stopAll,\r\n    clearError,\r\n    getVoices,\r\n    \r\n    // TTS Control\r\n    pauseTTS,\r\n    resumeTTS,\r\n    isTTSPaused,\r\n    isTTSSpeaking,\r\n  };\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\hooks\\useSpeechRecognition.ts","messages":[{"ruleId":"no-undef","severity":1,"message":"'PermissionState' is not defined.","line":89,"column":44,"nodeType":"Identifier","messageId":"undef","endLine":89,"endColumn":59},{"ruleId":"no-undef","severity":1,"message":"'PermissionState' is not defined.","line":264,"column":67,"nodeType":"Identifier","messageId":"undef","endLine":264,"endColumn":82},{"ruleId":"no-undef","severity":1,"message":"'PermissionName' is not defined.","line":266,"column":80,"nodeType":"Identifier","messageId":"undef","endLine":266,"endColumn":94},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'setupEventHandlers'. Either include it or remove the dependency array.","line":364,"column":6,"nodeType":"ArrayExpression","endLine":364,"endColumn":114,"suggestions":[{"desc":"Update the dependencies array to be: [getBrowserSupport, setError, continuous, interimResults, language, maxAlternatives, setupEventHandlers, updateState, debugMode]","fix":{"range":[9817,9925],"text":"[getBrowserSupport, setError, continuous, interimResults, language, maxAlternatives, setupEventHandlers, updateState, debugMode]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has missing dependencies: 'endAudioLatency', 'maxAlternatives', 'measureAudioLatency', 'resetSilenceTimer', 'restartListening', and 'startSilenceTimer'. Either include them or remove the dependency array.","line":534,"column":6,"nodeType":"ArrayExpression","endLine":538,"endColumn":4,"suggestions":[{"desc":"Update the dependencies array to be: [measureAudioLatency, updateState, debugMode, onStart, language, continuous, state.totalRecognitionTime, autoRestart, maxRestarts, onEnd, restartDelay, restartListening, maxAlternatives, minConfidence, endAudioLatency, onResult, resetSilenceTimer, setError, onSpeechStart, startSilenceTimer, onSpeechEnd, onSoundStart, onSoundEnd]","fix":{"range":[15161,15402],"text":"[measureAudioLatency, updateState, debugMode, onStart, language, continuous, state.totalRecognitionTime, autoRestart, maxRestarts, onEnd, restartDelay, restartListening, maxAlternatives, minConfidence, endAudioLatency, onResult, resetSilenceTimer, setError, onSpeechStart, startSilenceTimer, onSpeechEnd, onSoundStart, onSoundEnd]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'stopListening'. Either include it or remove the dependency array.","line":560,"column":6,"nodeType":"ArrayExpression","endLine":560,"endColumn":52,"suggestions":[{"desc":"Update the dependencies array to be: [resetSilenceTimer, silenceTimeout, debugMode, stopListening]","fix":{"range":[15946,15992],"text":"[resetSilenceTimer, silenceTimeout, debugMode, stopListening]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'endAudioLatency'. Either include it or remove the dependency array.","line":648,"column":6,"nodeType":"ArrayExpression","endLine":648,"endColumn":36,"suggestions":[{"desc":"Update the dependencies array to be: [resetSilenceTimer, debugMode, endAudioLatency]","fix":{"range":[18342,18372],"text":"[resetSilenceTimer, debugMode, endAudioLatency]"}}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":754,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":754,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * @fileoverview ìŒì„± ì¸ì‹ Hook - ì „ë¬¸ì ì¸ ì—ëŸ¬ ì²˜ë¦¬ ë° ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ í¬í•¨\r\n * @description Web Speech APIë¥¼ ì‚¬ìš©í•œ ìŒì„± ì¸ì‹ ê¸°ëŠ¥ì„ ê´€ë¦¬í•˜ëŠ” ì»¤ìŠ¤í…€ Hook\r\n * @author DaSiStart Team\r\n * @version 2.0.0\r\n */\r\n\r\nimport { useState, useCallback, useRef, useEffect } from 'react';\r\nimport { \r\n  handleSpeechError,\r\n  handleError,\r\n  ErrorType,\r\n  LogCategory,\r\n  logInfo,\r\n  logError,\r\n  logWarn,\r\n  speechLogger,\r\n  type StructuredError\r\n} from '../utils/index.ts';\r\nimport { usePerformanceMonitoring } from './usePerformanceMonitoring';\r\n\r\n// ====== íƒ€ì… ì •ì˜ ======\r\n\r\nexport interface SpeechRecognitionState {\r\n  // ì¸ì‹ ìƒíƒœ\r\n  isListening: boolean;\r\n  isSupported: boolean;\r\n  isInitialized: boolean;\r\n  \r\n  // ê²°ê³¼\r\n  transcript: string;\r\n  interimTranscript: string;\r\n  finalTranscript: string;\r\n  confidence: number;\r\n  \r\n  // ì—ëŸ¬ ë° ì„±ëŠ¥\r\n  error: StructuredError | null;\r\n  lastRecognitionTime: number;\r\n  \r\n  // í†µê³„\r\n  recognitionCount: number;\r\n  averageConfidence: number;\r\n  totalRecognitionTime: number;\r\n}\r\n\r\nexport interface SpeechRecognitionOptions {\r\n  // ê¸°ë³¸ ì„¤ì •\r\n  continuous?: boolean;\r\n  interimResults?: boolean;\r\n  language?: string;\r\n  maxAlternatives?: number;\r\n  \r\n  // ì„±ëŠ¥ ì„¤ì •\r\n  autoRestart?: boolean;\r\n  restartDelay?: number;\r\n  maxRestarts?: number;\r\n  \r\n  // í•„í„°ë§ ì„¤ì •\r\n  minConfidence?: number;\r\n  enableNoiseReduction?: boolean;\r\n  silenceTimeout?: number;\r\n  \r\n  // ì½œë°± í•¨ìˆ˜ë“¤\r\n  onStart?: () => void;\r\n  onEnd?: () => void;\r\n  onResult?: (transcript: string, isFinal: boolean, confidence: number) => void;\r\n  onError?: (error: StructuredError) => void;\r\n  onSpeechStart?: () => void;\r\n  onSpeechEnd?: () => void;\r\n  onSoundStart?: () => void;\r\n  onSoundEnd?: () => void;\r\n  \r\n  // ë””ë²„ê·¸\r\n  debugMode?: boolean;\r\n}\r\n\r\nexport interface SpeechRecognitionActions {\r\n  // ê¸°ë³¸ ì•¡ì…˜\r\n  startListening: () => Promise<boolean>;\r\n  stopListening: () => void;\r\n  restartListening: () => Promise<boolean>;\r\n  \r\n  // ìƒíƒœ ê´€ë¦¬\r\n  resetTranscript: () => void;\r\n  clearError: () => void;\r\n  \r\n  // ê¶Œí•œ ë° ì„¤ì •\r\n  requestMicrophonePermission: () => Promise<boolean>;\r\n  checkMicrophonePermission: () => Promise<PermissionState>;\r\n  \r\n  // ìœ í‹¸ë¦¬í‹°\r\n  getBrowserSupport: () => BrowserSupportInfo;\r\n  getRecognitionStatistics: () => RecognitionStatistics;\r\n  exportRecognitionData: () => any;\r\n}\r\n\r\nexport interface BrowserSupportInfo {\r\n  isSupported: boolean;\r\n  isChrome: boolean;\r\n  isEdge: boolean;\r\n  isSafari: boolean;\r\n  isFirefox: boolean;\r\n  isMobile: boolean;\r\n  recommendation: string;\r\n  supportedFeatures: string[];\r\n  limitations: string[];\r\n}\r\n\r\nexport interface RecognitionStatistics {\r\n  totalRecognitions: number;\r\n  averageConfidence: number;\r\n  averageRecognitionTime: number;\r\n  successRate: number;\r\n  errorCount: number;\r\n  lastRecognitionTime: number;\r\n  totalListeningTime: number;\r\n}\r\n\r\nexport interface SpeechRecognitionHookResult extends SpeechRecognitionState, SpeechRecognitionActions {\r\n  // ê³„ì‚°ëœ ê°’ë“¤\r\n  fullTranscript: string;\r\n  hasTranscript: boolean;\r\n  isSpeaking: boolean;\r\n  isProcessing: boolean;\r\n  canStart: boolean;\r\n  \r\n  // ì„¤ì • ì •ë³´\r\n  config: Required<SpeechRecognitionOptions>;\r\n}\r\n\r\n// ====== ë©”ì¸ Hook ======\r\n\r\nexport const useSpeechRecognition = (options: SpeechRecognitionOptions = {}): SpeechRecognitionHookResult => {\r\n  const {\r\n    continuous = true,\r\n    interimResults = true,\r\n    language = 'ko-KR',\r\n    maxAlternatives = 3,\r\n    autoRestart = true,\r\n    restartDelay = 1000,\r\n    maxRestarts = 5,\r\n    minConfidence = 0.3,\r\n    enableNoiseReduction = true,\r\n    silenceTimeout = 5000,\r\n    onStart,\r\n    onEnd,\r\n    onResult,\r\n    onError,\r\n    onSpeechStart,\r\n    onSpeechEnd,\r\n    onSoundStart,\r\n    onSoundEnd,\r\n    debugMode = process.env.NODE_ENV === 'development'\r\n  } = options;\r\n\r\n  // âœ… CLAUDE.local ì¤€ìˆ˜: í”ŒëŸ¬ê·¸ì¸ ê¸°ë°˜ ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§\r\n  const { measureRender, measureAudioLatency, endAudioLatency } = usePerformanceMonitoring('useSpeechRecognition');\r\n\r\n  // ====== ìƒíƒœ ê´€ë¦¬ ======\r\n\r\n  const [state, setState] = useState<SpeechRecognitionState>({\r\n    isListening: false,\r\n    isSupported: false,\r\n    isInitialized: false,\r\n    transcript: '',\r\n    interimTranscript: '',\r\n    finalTranscript: '',\r\n    confidence: 0,\r\n    error: null,\r\n    lastRecognitionTime: 0,\r\n    recognitionCount: 0,\r\n    averageConfidence: 0,\r\n    totalRecognitionTime: 0\r\n  });\r\n\r\n  // ====== Refs ======\r\n\r\n  const recognitionRef = useRef<any>(null);\r\n  const isManualStop = useRef(false);\r\n  const restartCount = useRef(0);\r\n  const recognitionStartTime = useRef<number>(0);\r\n  const confidenceScores = useRef<number[]>([]);\r\n  const recognitionTimes = useRef<number[]>([]);\r\n  const silenceTimer = useRef<NodeJS.Timeout | null>(null);\r\n  const measurementId = useRef<string | null>(null);\r\n\r\n  // ====== ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ ======\r\n\r\n  const updateState = useCallback((updates: Partial<SpeechRecognitionState>) => {\r\n    setState(prev => ({ ...prev, ...updates }));\r\n  }, []);\r\n\r\n  const setError = useCallback((error: StructuredError | null) => {\r\n    updateState({ error });\r\n    \r\n    if (error) {\r\n      logError(LogCategory.SPEECH, error.message, error.originalError, {\r\n        component: 'useSpeechRecognition',\r\n        action: error.context?.action || 'unknown'\r\n      });\r\n      onError?.(error);\r\n    }\r\n  }, [updateState, onError]);\r\n\r\n  const clearError = useCallback(() => {\r\n    setError(null);\r\n  }, [setError]);\r\n\r\n  // ====== ë¸Œë¼ìš°ì € í˜¸í™˜ì„± ì²´í¬ ======\r\n\r\n  const getBrowserSupport = useCallback((): BrowserSupportInfo => {\r\n    const userAgent = navigator.userAgent;\r\n    const isChrome = /Chrome/.test(userAgent) && !/Edg/.test(userAgent);\r\n    const isEdge = /Edg/.test(userAgent);\r\n    const isSafari = /Safari/.test(userAgent) && !/Chrome/.test(userAgent);\r\n    const isFirefox = /Firefox/.test(userAgent);\r\n    const isMobile = /Mobile|Android|iOS/.test(userAgent);\r\n    \r\n    const isSupported = 'webkitSpeechRecognition' in window || 'SpeechRecognition' in window;\r\n    \r\n    const supportedFeatures: string[] = [];\r\n    const limitations: string[] = [];\r\n    \r\n    if (isSupported) {\r\n      supportedFeatures.push('ìŒì„± ì¸ì‹');\r\n      if (continuous) supportedFeatures.push('ì—°ì† ì¸ì‹');\r\n      if (interimResults) supportedFeatures.push('ì‹¤ì‹œê°„ ê²°ê³¼');\r\n    }\r\n    \r\n    if (!isSupported) {\r\n      limitations.push('ìŒì„± ì¸ì‹ ë¯¸ì§€ì›');\r\n    }\r\n    if (isSafari) {\r\n      limitations.push('Safariì—ì„œ ì œí•œì  ì§€ì›');\r\n    }\r\n    if (isMobile && !isChrome) {\r\n      limitations.push('ëª¨ë°”ì¼ì—ì„œ ì œí•œì  ì§€ì›');\r\n    }\r\n    \r\n    let recommendation = '';\r\n    if (!isSupported) {\r\n      recommendation = 'Chrome ë˜ëŠ” Edge ë¸Œë¼ìš°ì €ë¥¼ ì‚¬ìš©í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.';\r\n    } else if (isSafari || isFirefox) {\r\n      recommendation = 'ìµœì ì˜ ì„±ëŠ¥ì„ ìœ„í•´ Chrome ë¸Œë¼ìš°ì €ë¥¼ ê¶Œì¥í•©ë‹ˆë‹¤.';\r\n    } else {\r\n      recommendation = 'ì§€ì›ë˜ëŠ” ë¸Œë¼ìš°ì €ì…ë‹ˆë‹¤.';\r\n    }\r\n\r\n    return {\r\n      isSupported,\r\n      isChrome,\r\n      isEdge,\r\n      isSafari,\r\n      isFirefox,\r\n      isMobile,\r\n      recommendation,\r\n      supportedFeatures,\r\n      limitations\r\n    };\r\n  }, [continuous, interimResults]);\r\n\r\n  // ====== ê¶Œí•œ ê´€ë¦¬ ======\r\n\r\n  const checkMicrophonePermission = useCallback(async (): Promise<PermissionState> => {\r\n    try {\r\n      const result = await navigator.permissions.query({ name: 'microphone' as PermissionName });\r\n      return result.state;\r\n    } catch (error) {\r\n      logWarn(LogCategory.SPEECH, 'ë§ˆì´í¬ ê¶Œí•œ ìƒíƒœ í™•ì¸ ì‹¤íŒ¨', error);\r\n      return 'prompt';\r\n    }\r\n  }, []);\r\n\r\n  const requestMicrophonePermission = useCallback(async (): Promise<boolean> => {\r\n    try {\r\n      const stream = await navigator.mediaDevices.getUserMedia({ \r\n        audio: {\r\n          echoCancellation: enableNoiseReduction,\r\n          noiseSuppression: enableNoiseReduction,\r\n          autoGainControl: enableNoiseReduction\r\n        }\r\n      });\r\n      \r\n      // ê¶Œí•œ í™•ì¸ í›„ ìŠ¤íŠ¸ë¦¼ ì •ë¦¬\r\n      stream.getTracks().forEach(track => track.stop());\r\n      \r\n      speechLogger.start({ \r\n        language, \r\n        continuous, \r\n        interimResults,\r\n        enableNoiseReduction\r\n      });\r\n\r\n      return true;\r\n    } catch (error: any) {\r\n      const structuredError = handleSpeechError(error, {\r\n        component: 'useSpeechRecognition',\r\n        action: 'requestMicrophonePermission'\r\n      });\r\n      \r\n      setError(structuredError);\r\n      return false;\r\n    }\r\n  }, [enableNoiseReduction, language, continuous, interimResults, setError]);\r\n\r\n  // ====== ìŒì„± ì¸ì‹ ì´ˆê¸°í™” ======\r\n\r\n  const initializeRecognition = useCallback(() => {\r\n    const browserSupport = getBrowserSupport();\r\n    \r\n    if (!browserSupport.isSupported) {\r\n      const error = handleError(\r\n        ErrorType.SPEECH_NOT_SUPPORTED,\r\n        'ì´ ë¸Œë¼ìš°ì €ì—ì„œëŠ” ìŒì„± ì¸ì‹ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.',\r\n        { \r\n          component: 'useSpeechRecognition', \r\n          action: 'initialize',\r\n          additionalData: browserSupport\r\n        }\r\n      );\r\n      setError(error);\r\n      return false;\r\n    }\r\n\r\n    try {\r\n      const SpeechRecognition = (window as any).SpeechRecognition || (window as any).webkitSpeechRecognition;\r\n      \r\n      recognitionRef.current = new SpeechRecognition();\r\n      \r\n      // ê¸°ë³¸ ì„¤ì •\r\n      recognitionRef.current.continuous = continuous;\r\n      recognitionRef.current.interimResults = interimResults;\r\n      recognitionRef.current.lang = language;\r\n      recognitionRef.current.maxAlternatives = maxAlternatives;\r\n\r\n      // ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì„¤ì •\r\n      setupEventHandlers();\r\n      \r\n      updateState({ \r\n        isSupported: true, \r\n        isInitialized: true,\r\n        error: null\r\n      });\r\n\r\n      if (debugMode) {\r\n        logInfo(LogCategory.SPEECH, 'ìŒì„± ì¸ì‹ ì´ˆê¸°í™” ì™„ë£Œ', {\r\n          continuous,\r\n          interimResults,\r\n          language,\r\n          maxAlternatives\r\n        });\r\n      }\r\n\r\n      return true;\r\n    } catch (error: any) {\r\n      const structuredError = handleError(\r\n        ErrorType.SPEECH_SERVICE_ERROR,\r\n        error,\r\n        { component: 'useSpeechRecognition', action: 'initialize' }\r\n      );\r\n      setError(structuredError);\r\n      return false;\r\n    }\r\n  }, [getBrowserSupport, continuous, interimResults, language, maxAlternatives, debugMode, updateState, setError]);\r\n\r\n  // ====== ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì„¤ì • ======\r\n\r\n  const setupEventHandlers = useCallback(() => {\r\n    if (!recognitionRef.current) return;\r\n\r\n    recognitionRef.current.onstart = async () => {\r\n      recognitionStartTime.current = Date.now();\r\n      \r\n      // âœ… CLAUDE.local ì¤€ìˆ˜: í”ŒëŸ¬ê·¸ì¸ì„ í†µí•œ ìŒì„± ì¸ì‹ ì§€ì—° ì¸¡ì • ì‹œì‘\r\n      measurementId.current = await measureAudioLatency();\r\n      \r\n      updateState({ \r\n        isListening: true, \r\n        error: null,\r\n        lastRecognitionTime: Date.now()\r\n      });\r\n      \r\n      if (debugMode) {\r\n        speechLogger.start({ language, continuous });\r\n      }\r\n      \r\n      onStart?.();\r\n    };\r\n\r\n    recognitionRef.current.onend = () => {\r\n      const recognitionTime = Date.now() - recognitionStartTime.current;\r\n      recognitionTimes.current.push(recognitionTime);\r\n      \r\n      updateState({ \r\n        isListening: false,\r\n        totalRecognitionTime: state.totalRecognitionTime + recognitionTime\r\n      });\r\n      \r\n      // ìë™ ì¬ì‹œì‘ ì²˜ë¦¬\r\n      if (!isManualStop.current && autoRestart && restartCount.current < maxRestarts) {\r\n        setTimeout(() => {\r\n          if (!isManualStop.current && recognitionRef.current) {\r\n            restartListening();\r\n          }\r\n        }, restartDelay);\r\n      } else if (restartCount.current >= maxRestarts) {\r\n        logWarn(LogCategory.SPEECH, 'ìµœëŒ€ ì¬ì‹œì‘ íšŸìˆ˜ ë„ë‹¬', {\r\n          restartCount: restartCount.current,\r\n          maxRestarts\r\n        });\r\n      }\r\n      \r\n      onEnd?.();\r\n    };\r\n\r\n    recognitionRef.current.onresult = (event: any) => {\r\n      let finalTranscript = '';\r\n      let interimTranscript = '';\r\n      let maxConfidence = 0;\r\n      const alternatives: Array<{ text: string; confidence: number }> = [];\r\n\r\n      // ê²°ê³¼ ì²˜ë¦¬\r\n      for (let i = event.resultIndex; i < event.results.length; i++) {\r\n        const result = event.results[i];\r\n        \r\n        // ëª¨ë“  ëŒ€ì•ˆ ìˆ˜ì§‘\r\n        for (let j = 0; j < result.length && j < maxAlternatives; j++) {\r\n          const alternative = result[j];\r\n          alternatives.push({\r\n            text: alternative.transcript,\r\n            confidence: alternative.confidence || 0\r\n          });\r\n        }\r\n        \r\n        const transcript = result[0].transcript;\r\n        const confidence = result[0].confidence || 0;\r\n\r\n        if (result.isFinal) {\r\n          // ìµœì†Œ ì‹ ë¢°ë„ í•„í„°ë§\r\n          if (confidence >= minConfidence) {\r\n            finalTranscript += transcript;\r\n            maxConfidence = Math.max(maxConfidence, confidence);\r\n            confidenceScores.current.push(confidence);\r\n            \r\n            // âœ… CLAUDE.local ì¤€ìˆ˜: í”ŒëŸ¬ê·¸ì¸ì„ í†µí•œ ìŒì„± ì¸ì‹ ì§€ì—° ì¸¡ì • ì¢…ë£Œ\r\n            if (measurementId.current) {\r\n              await endAudioLatency(measurementId.current, transcript);\r\n              measurementId.current = null;\r\n            }\r\n            \r\n            speechLogger.result(transcript, confidence);\r\n          } else if (debugMode) {\r\n            logWarn(LogCategory.SPEECH, 'ë‚®ì€ ì‹ ë¢°ë„ë¡œ ê²°ê³¼ ë¬´ì‹œ', {\r\n              transcript,\r\n              confidence,\r\n              minConfidence\r\n            });\r\n          }\r\n        } else {\r\n          interimTranscript += transcript;\r\n        }\r\n      }\r\n\r\n      // ìƒíƒœ ì—…ë°ì´íŠ¸\r\n      if (finalTranscript || interimTranscript) {\r\n        updateState(prev => ({\r\n          transcript: prev.transcript + finalTranscript,\r\n          interimTranscript,\r\n          finalTranscript: prev.finalTranscript + finalTranscript,\r\n          confidence: maxConfidence,\r\n          recognitionCount: finalTranscript ? prev.recognitionCount + 1 : prev.recognitionCount,\r\n          averageConfidence: confidenceScores.current.length > 0 \r\n            ? confidenceScores.current.reduce((sum, conf) => sum + conf, 0) / confidenceScores.current.length \r\n            : 0\r\n        }));\r\n\r\n        // ì½œë°± í˜¸ì¶œ\r\n        if (finalTranscript) {\r\n          onResult?.(finalTranscript, true, maxConfidence);\r\n          resetSilenceTimer();\r\n        } else if (interimTranscript) {\r\n          onResult?.(interimTranscript, false, 0);\r\n          resetSilenceTimer();\r\n        }\r\n      }\r\n    };\r\n\r\n    recognitionRef.current.onerror = (event: any) => {\r\n      const structuredError = handleSpeechError(event, {\r\n        component: 'useSpeechRecognition',\r\n        action: 'recognition',\r\n        additionalData: {\r\n          restartCount: restartCount.current,\r\n          language,\r\n          continuous\r\n        }\r\n      });\r\n      \r\n      setError(structuredError);\r\n      \r\n      // íŠ¹ì • ì—ëŸ¬ì— ëŒ€í•œ ìë™ ë³µêµ¬ ì‹œë„\r\n      if (event.error === 'no-speech' && autoRestart && restartCount.current < maxRestarts) {\r\n        setTimeout(() => {\r\n          if (!isManualStop.current) {\r\n            restartListening();\r\n          }\r\n        }, restartDelay);\r\n      }\r\n    };\r\n\r\n    recognitionRef.current.onnomatch = () => {\r\n      if (debugMode) {\r\n        logWarn(LogCategory.SPEECH, 'ìŒì„± ì¸ì‹ ë§¤ì¹˜ ì—†ìŒ');\r\n      }\r\n    };\r\n\r\n    recognitionRef.current.onspeechstart = () => {\r\n      resetSilenceTimer();\r\n      onSpeechStart?.();\r\n    };\r\n\r\n    recognitionRef.current.onspeechend = () => {\r\n      startSilenceTimer();\r\n      onSpeechEnd?.();\r\n    };\r\n\r\n    recognitionRef.current.onsoundstart = () => {\r\n      onSoundStart?.();\r\n    };\r\n\r\n    recognitionRef.current.onsoundend = () => {\r\n      onSoundEnd?.();\r\n    };\r\n  }, [\r\n    language, continuous, autoRestart, maxRestarts, restartDelay, minConfidence, \r\n    debugMode, updateState, setError, onStart, onEnd, onResult, onSpeechStart, \r\n    onSpeechEnd, onSoundStart, onSoundEnd, state.totalRecognitionTime\r\n  ]);\r\n\r\n  // ====== ì¹¨ë¬µ íƒ€ì´ë¨¸ ê´€ë¦¬ ======\r\n\r\n  const resetSilenceTimer = useCallback(() => {\r\n    if (silenceTimer.current) {\r\n      clearTimeout(silenceTimer.current);\r\n      silenceTimer.current = null;\r\n    }\r\n  }, []);\r\n\r\n  const startSilenceTimer = useCallback(() => {\r\n    resetSilenceTimer();\r\n    \r\n    if (silenceTimeout > 0) {\r\n      silenceTimer.current = setTimeout(() => {\r\n        if (debugMode) {\r\n          logInfo(LogCategory.SPEECH, 'ì¹¨ë¬µ íƒ€ì„ì•„ì›ƒìœ¼ë¡œ ì¸í•œ ì¸ì‹ ì¤‘ì§€');\r\n        }\r\n        stopListening();\r\n      }, silenceTimeout);\r\n    }\r\n  }, [resetSilenceTimer, silenceTimeout, debugMode]);\r\n\r\n  // ====== ì£¼ìš” ì•¡ì…˜ í•¨ìˆ˜ë“¤ ======\r\n\r\n  const startListening = useCallback(async (): Promise<boolean> => {\r\n    const endRenderMeasure = measureRender(1, 'startListening');\r\n    \r\n    try {\r\n      if (!state.isInitialized && !initializeRecognition()) {\r\n        return false;\r\n      }\r\n\r\n      if (!recognitionRef.current || !state.isSupported) {\r\n        const error = handleError(\r\n          ErrorType.SPEECH_NOT_SUPPORTED,\r\n          'ìŒì„± ì¸ì‹ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.',\r\n          { component: 'useSpeechRecognition', action: 'startListening' }\r\n        );\r\n        setError(error);\r\n        return false;\r\n      }\r\n\r\n      if (state.isListening) {\r\n        if (debugMode) {\r\n          logInfo(LogCategory.SPEECH, 'ì´ë¯¸ ìŒì„± ì¸ì‹ì´ ì‹¤í–‰ ì¤‘ì…ë‹ˆë‹¤.');\r\n        }\r\n        return true;\r\n      }\r\n\r\n      // ë§ˆì´í¬ ê¶Œí•œ í™•ì¸\r\n      const hasPermission = await requestMicrophonePermission();\r\n      if (!hasPermission) {\r\n        return false;\r\n      }\r\n\r\n      isManualStop.current = false;\r\n      restartCount.current = 0;\r\n      clearError();\r\n\r\n      recognitionRef.current.start();\r\n      \r\n      if (debugMode) {\r\n        logInfo(LogCategory.SPEECH, 'ìŒì„± ì¸ì‹ ì‹œì‘', {\r\n          language,\r\n          continuous,\r\n          interimResults\r\n        });\r\n      }\r\n\r\n      return true;\r\n    } catch (error: any) {\r\n      const structuredError = handleSpeechError(error, {\r\n        component: 'useSpeechRecognition',\r\n        action: 'startListening'\r\n      });\r\n      \r\n      setError(structuredError);\r\n      return false;\r\n    } finally {\r\n      endRenderMeasure();\r\n    }\r\n  }, [\r\n    state.isInitialized, state.isSupported, state.isListening, initializeRecognition,\r\n    requestMicrophonePermission, clearError, setError, debugMode, language,\r\n    continuous, interimResults, measureRender\r\n  ]);\r\n\r\n  const stopListening = useCallback(() => {\r\n    if (!recognitionRef.current) return;\r\n\r\n    try {\r\n      isManualStop.current = true;\r\n      resetSilenceTimer();\r\n      \r\n      // âœ… CLAUDE.local ì¤€ìˆ˜: í”ŒëŸ¬ê·¸ì¸ì„ í†µí•œ ì¸¡ì • ì •ë¦¬\r\n      if (measurementId.current) {\r\n        await endAudioLatency(measurementId.current);\r\n        measurementId.current = null;\r\n      }\r\n\r\n      recognitionRef.current.stop();\r\n      \r\n      if (debugMode) {\r\n        logInfo(LogCategory.SPEECH, 'ìŒì„± ì¸ì‹ ì¤‘ì§€');\r\n      }\r\n    } catch (error: any) {\r\n      logWarn(LogCategory.SPEECH, 'ìŒì„± ì¸ì‹ ì¤‘ì§€ ì‹¤íŒ¨', error);\r\n    }\r\n  }, [resetSilenceTimer, debugMode]);\r\n\r\n  const restartListening = useCallback(async (): Promise<boolean> => {\r\n    if (restartCount.current >= maxRestarts) {\r\n      const error = handleError(\r\n        ErrorType.SPEECH_SERVICE_ERROR,\r\n        'ìµœëŒ€ ì¬ì‹œì‘ íšŸìˆ˜ë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤.',\r\n        { \r\n          component: 'useSpeechRecognition', \r\n          action: 'restartListening',\r\n          additionalData: { restartCount: restartCount.current, maxRestarts }\r\n        }\r\n      );\r\n      setError(error);\r\n      return false;\r\n    }\r\n\r\n    stopListening();\r\n    \r\n    // ì§§ì€ ì§€ì—° í›„ ì¬ì‹œì‘\r\n    await new Promise(resolve => setTimeout(resolve, restartDelay));\r\n    \r\n    restartCount.current++;\r\n    \r\n    if (debugMode) {\r\n      logInfo(LogCategory.SPEECH, 'ìŒì„± ì¸ì‹ ì¬ì‹œì‘', {\r\n        restartCount: restartCount.current,\r\n        maxRestarts\r\n      });\r\n    }\r\n\r\n    return startListening();\r\n  }, [maxRestarts, stopListening, restartDelay, startListening, setError, debugMode]);\r\n\r\n  const resetTranscript = useCallback(() => {\r\n    updateState({\r\n      transcript: '',\r\n      interimTranscript: '',\r\n      finalTranscript: '',\r\n      confidence: 0\r\n    });\r\n    \r\n    if (debugMode) {\r\n      logInfo(LogCategory.SPEECH, 'ìŒì„± ì¸ì‹ ê²°ê³¼ ì´ˆê¸°í™”');\r\n    }\r\n  }, [updateState, debugMode]);\r\n\r\n  // ====== í†µê³„ ë° ìœ í‹¸ë¦¬í‹° ======\r\n\r\n  const getRecognitionStatistics = useCallback((): RecognitionStatistics => {\r\n    const successRate = state.recognitionCount > 0 \r\n      ? (confidenceScores.current.filter(score => score >= minConfidence).length / state.recognitionCount) * 100 \r\n      : 0;\r\n    \r\n    const averageRecognitionTime = recognitionTimes.current.length > 0\r\n      ? recognitionTimes.current.reduce((sum, time) => sum + time, 0) / recognitionTimes.current.length\r\n      : 0;\r\n\r\n    return {\r\n      totalRecognitions: state.recognitionCount,\r\n      averageConfidence: state.averageConfidence,\r\n      averageRecognitionTime,\r\n      successRate,\r\n      errorCount: state.error ? 1 : 0,\r\n      lastRecognitionTime: state.lastRecognitionTime,\r\n      totalListeningTime: state.totalRecognitionTime\r\n    };\r\n  }, [state.recognitionCount, state.averageConfidence, state.error, state.lastRecognitionTime, state.totalRecognitionTime, minConfidence]);\r\n\r\n  const exportRecognitionData = useCallback(() => {\r\n    return {\r\n      state,\r\n      statistics: getRecognitionStatistics(),\r\n      browserSupport: getBrowserSupport(),\r\n      confidenceHistory: confidenceScores.current,\r\n      recognitionTimeHistory: recognitionTimes.current,\r\n      config: {\r\n        continuous,\r\n        interimResults,\r\n        language,\r\n        maxAlternatives,\r\n        autoRestart,\r\n        restartDelay,\r\n        maxRestarts,\r\n        minConfidence,\r\n        enableNoiseReduction,\r\n        silenceTimeout\r\n      },\r\n      exportTime: new Date().toISOString()\r\n    };\r\n  }, [\r\n    state, getRecognitionStatistics, getBrowserSupport,\r\n    continuous, interimResults, language, maxAlternatives,\r\n    autoRestart, restartDelay, maxRestarts, minConfidence,\r\n    enableNoiseReduction, silenceTimeout\r\n  ]);\r\n\r\n  // ====== ì´ˆê¸°í™” Effect ======\r\n\r\n  useEffect(() => {\r\n    initializeRecognition();\r\n    \r\n    return () => {\r\n      if (recognitionRef.current) {\r\n        try {\r\n          recognitionRef.current.stop();\r\n        } catch (error) {\r\n          // ì •ë¦¬ ì¤‘ ì—ëŸ¬ëŠ” ë¬´ì‹œ\r\n        }\r\n      }\r\n      resetSilenceTimer();\r\n    };\r\n  }, [initializeRecognition, resetSilenceTimer]);\r\n\r\n  // ====== ê³„ì‚°ëœ ê°’ë“¤ ======\r\n\r\n  const fullTranscript = state.transcript + state.interimTranscript;\r\n  const hasTranscript = fullTranscript.trim().length > 0;\r\n  const isSpeaking = state.interimTranscript.length > 0;\r\n  const isProcessing = state.isListening && !isSpeaking;\r\n  const canStart = state.isSupported && !state.isListening && !state.error;\r\n\r\n  const config: Required<SpeechRecognitionOptions> = {\r\n    continuous,\r\n    interimResults,\r\n    language,\r\n    maxAlternatives,\r\n    autoRestart,\r\n    restartDelay,\r\n    maxRestarts,\r\n    minConfidence,\r\n    enableNoiseReduction,\r\n    silenceTimeout,\r\n    onStart: onStart || (() => {}),\r\n    onEnd: onEnd || (() => {}),\r\n    onResult: onResult || (() => {}),\r\n    onError: onError || (() => {}),\r\n    onSpeechStart: onSpeechStart || (() => {}),\r\n    onSpeechEnd: onSpeechEnd || (() => {}),\r\n    onSoundStart: onSoundStart || (() => {}),\r\n    onSoundEnd: onSoundEnd || (() => {}),\r\n    debugMode\r\n  };\r\n\r\n  // ====== ë°˜í™˜ ê°’ ======\r\n\r\n  return {\r\n    // ìƒíƒœ\r\n    ...state,\r\n    \r\n    // ê³„ì‚°ëœ ê°’ë“¤\r\n    fullTranscript,\r\n    hasTranscript,\r\n    isSpeaking,\r\n    isProcessing,\r\n    canStart,\r\n    \r\n    // ì„¤ì •\r\n    config,\r\n    \r\n    // ì•¡ì…˜ë“¤\r\n    startListening,\r\n    stopListening,\r\n    restartListening,\r\n    resetTranscript,\r\n    clearError,\r\n    requestMicrophonePermission,\r\n    checkMicrophonePermission,\r\n    getBrowserSupport,\r\n    getRecognitionStatistics,\r\n    exportRecognitionData\r\n  };\r\n};\r\n\r\nexport default useSpeechRecognition;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\hooks\\useSpeechRecognitionSimple.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\hooks\\useSpeedTraining.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SpeedTrainingEvent' is defined but never used. Allowed unused vars must match /^_/u.","line":14,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":14,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'DifficultyMode' is defined but never used. Allowed unused vars must match /^_/u.","line":20,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":20,"endColumn":17},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The ref value 'eventHandlersRef.current' will likely have changed by the time this effect cleanup function runs. If this ref points to a node rendered by React, copy 'eventHandlersRef.current' to a variable inside the effect, and use that variable in the cleanup function.","line":94,"column":26,"nodeType":"Identifier","endLine":94,"endColumn":33},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'getSessionProgress'. Either include it or remove the dependency array.","line":240,"column":6,"nodeType":"ArrayExpression","endLine":240,"endColumn":56,"suggestions":[{"desc":"Update the dependencies array to be: [state.plugin, state.currentSession, safeSetState, getSessionProgress]","fix":{"range":[7150,7200],"text":"[state.plugin, state.currentSession, safeSetState, getSessionProgress]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Speed Training Hook\r\n * @description SpeedTrainingPluginì„ React ì»´í¬ë„ŒíŠ¸ì—ì„œ ì‰½ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” Hook\r\n * CLAUDE.local ê·œì¹™ ì¤€ìˆ˜: í”ŒëŸ¬ê·¸ì¸ ìš°ì„  ì•„í‚¤í…ì²˜ + React Hook íŒ¨í„´\r\n */\r\n\r\nimport { useState, useEffect, useCallback, useRef } from 'react';\r\nimport { getSpeedTrainingPlugin } from '@/plugins/PluginManager';\r\nimport { useAppStore } from '@/store/useAppStore';\r\nimport {\r\n  ISpeedTrainingPlugin,\r\n  SpeedSessionOptions,\r\n  SpeedTrainingResults,\r\n  SpeedTrainingEvent,\r\n  SpeedTrainingEventHandler\r\n} from '@/plugins/speed/ISpeedTrainingPlugin';\r\nimport {\r\n  SpeedSession,\r\n  SpeedResult,\r\n  DifficultyMode\r\n} from '@/services/speedDifficultyModes';\r\n\r\n// Hook ìƒíƒœ íƒ€ì…\r\nexport interface UseSpeedTrainingState {\r\n  plugin: ISpeedTrainingPlugin | null;\r\n  isPluginLoading: boolean;\r\n  isPluginReady: boolean;\r\n  pluginError: string | null;\r\n  currentSession: SpeedSession | null;\r\n  sessionProgress: {\r\n    currentQuestionIndex: number;\r\n    totalQuestions: number;\r\n    correctAnswers: number;\r\n    timeElapsed: number;\r\n    estimatedTimeRemaining: number;\r\n  } | null;\r\n  isSessionActive: boolean;\r\n  isProcessingAnswer: boolean;\r\n}\r\n\r\n// Hook ì•¡ì…˜ íƒ€ì…\r\nexport interface UseSpeedTrainingActions {\r\n  initializePlugin: () => Promise<boolean>;\r\n  createSession: (options: SpeedSessionOptions) => Promise<SpeedSession | null>;\r\n  processAnswer: (questionId: string, userAnswer: string, responseTime: number) => Promise<SpeedResult | null>;\r\n  completeSession: () => Promise<SpeedTrainingResults | null>;\r\n  getSessionProgress: () => Promise<void>;\r\n  getPerformanceStats: () => Promise<any>;\r\n  getRecommendedSettings: () => Promise<any>;\r\n  resetSession: () => void;\r\n  addEventListener: (handler: SpeedTrainingEventHandler) => void;\r\n  removeEventListener: (handler: SpeedTrainingEventHandler) => void;\r\n}\r\n\r\n// Hook ë°˜í™˜ íƒ€ì…\r\nexport type UseSpeedTrainingReturn = UseSpeedTrainingState & UseSpeedTrainingActions;\r\n\r\n// Default state\r\nconst DEFAULT_STATE: UseSpeedTrainingState = {\r\n  plugin: null,\r\n  isPluginLoading: false,\r\n  isPluginReady: false,\r\n  pluginError: null,\r\n  currentSession: null,\r\n  sessionProgress: null,\r\n  isSessionActive: false,\r\n  isProcessingAnswer: false\r\n};\r\n\r\n/**\r\n * Speed Training Hook\r\n * @param autoInitialize ìë™ìœ¼ë¡œ í”ŒëŸ¬ê·¸ì¸ ì´ˆê¸°í™” ì—¬ë¶€ (ê¸°ë³¸ê°’: true)\r\n */\r\nexport const useSpeedTraining = (autoInitialize: boolean = true): UseSpeedTrainingReturn => {\r\n  // State\r\n  const [state, setState] = useState<UseSpeedTrainingState>(DEFAULT_STATE);\r\n  \r\n  // Auth state\r\n  const { user } = useAppStore();\r\n  \r\n  // Refs for cleanup\r\n  const eventHandlersRef = useRef<Set<SpeedTrainingEventHandler>>(new Set());\r\n  const isMountedRef = useRef(true);\r\n\r\n  // Cleanup on unmount\r\n  useEffect(() => {\r\n    return () => {\r\n      isMountedRef.current = false;\r\n      // Remove all event listeners\r\n      if (state.plugin) {\r\n        eventHandlersRef.current.forEach(handler => {\r\n          state.plugin!.offSessionEvent(handler);\r\n        });\r\n        eventHandlersRef.current.clear();\r\n      }\r\n    };\r\n  }, [state.plugin]);\r\n\r\n  // Safe state update (prevent updates after unmount)\r\n  const safeSetState = useCallback((updater: Partial<UseSpeedTrainingState>) => {\r\n    if (isMountedRef.current) {\r\n      setState(prev => ({ ...prev, ...updater }));\r\n    }\r\n  }, []);\r\n\r\n  // Plugin ì´ˆê¸°í™”\r\n  const initializePlugin = useCallback(async (): Promise<boolean> => {\r\n    if (state.plugin && state.isPluginReady) {\r\n      return true;\r\n    }\r\n\r\n    safeSetState({ \r\n      isPluginLoading: true, \r\n      pluginError: null \r\n    });\r\n\r\n    try {\r\n      console.log('ğŸš€ Initializing Speed Training Plugin...');\r\n      \r\n      const pluginResult = await getSpeedTrainingPlugin();\r\n      if (!pluginResult.success) {\r\n        throw pluginResult.error;\r\n      }\r\n\r\n      const plugin = pluginResult.data;\r\n      \r\n      safeSetState({\r\n        plugin,\r\n        isPluginLoading: false,\r\n        isPluginReady: true,\r\n        pluginError: null\r\n      });\r\n\r\n      console.log('âœ… Speed Training Plugin initialized successfully');\r\n      return true;\r\n    } catch (error) {\r\n      const errorMessage = error instanceof Error ? error.message : 'Failed to initialize plugin';\r\n      console.error('âŒ Speed Training Plugin initialization failed:', error);\r\n      \r\n      safeSetState({\r\n        plugin: null,\r\n        isPluginLoading: false,\r\n        isPluginReady: false,\r\n        pluginError: errorMessage\r\n      });\r\n      \r\n      return false;\r\n    }\r\n  }, [state.plugin, state.isPluginReady, safeSetState]);\r\n\r\n  // Auto-initialization\r\n  useEffect(() => {\r\n    if (autoInitialize && !state.plugin && !state.isPluginLoading) {\r\n      initializePlugin();\r\n    }\r\n  }, [autoInitialize, state.plugin, state.isPluginLoading, initializePlugin]);\r\n\r\n  // ì„¸ì…˜ ìƒì„±\r\n  const createSession = useCallback(async (options: SpeedSessionOptions): Promise<SpeedSession | null> => {\r\n    if (!state.plugin || !state.isPluginReady) {\r\n      console.warn('âš ï¸ Speed Training Plugin not ready');\r\n      return null;\r\n    }\r\n\r\n    try {\r\n      console.log('ğŸ¯ Creating speed training session...', options);\r\n      \r\n      const sessionResult = await state.plugin.createSession(options);\r\n      if (!sessionResult.success) {\r\n        throw sessionResult.error;\r\n      }\r\n\r\n      const session = sessionResult.data;\r\n      \r\n      safeSetState({\r\n        currentSession: session,\r\n        isSessionActive: true,\r\n        sessionProgress: {\r\n          currentQuestionIndex: 0,\r\n          totalQuestions: session.questions.length,\r\n          correctAnswers: 0,\r\n          timeElapsed: 0,\r\n          estimatedTimeRemaining: session.questions.length * 5000 // ê¸°ë³¸ 5ì´ˆ ì¶”ì •\r\n        }\r\n      });\r\n\r\n      console.log('âœ… Speed training session created:', session.sessionId);\r\n      return session;\r\n    } catch (error) {\r\n      console.error('âŒ Failed to create speed training session:', error);\r\n      return null;\r\n    }\r\n  }, [state.plugin, state.isPluginReady, safeSetState]);\r\n\r\n  // ë‹µë³€ ì²˜ë¦¬\r\n  const processAnswer = useCallback(async (\r\n    questionId: string,\r\n    userAnswer: string,\r\n    responseTime: number\r\n  ): Promise<SpeedResult | null> => {\r\n    if (!state.plugin || !state.currentSession) {\r\n      console.warn('âš ï¸ No active session or plugin not ready');\r\n      return null;\r\n    }\r\n\r\n    safeSetState({ isProcessingAnswer: true });\r\n\r\n    try {\r\n      console.log('ğŸ“ Processing answer...', { questionId, userAnswer, responseTime });\r\n      \r\n      const resultData = await state.plugin.processAnswer(\r\n        state.currentSession.sessionId,\r\n        questionId,\r\n        userAnswer,\r\n        responseTime\r\n      );\r\n\r\n      if (!resultData.success) {\r\n        throw resultData.error;\r\n      }\r\n\r\n      const result = resultData.data;\r\n      \r\n      // Update session progress\r\n      await getSessionProgress();\r\n\r\n      safeSetState({ isProcessingAnswer: false });\r\n      \r\n      console.log('âœ… Answer processed:', { \r\n        isCorrect: result.isCorrect,\r\n        bonusPoints: result.bonusPoints \r\n      });\r\n      \r\n      return result;\r\n    } catch (error) {\r\n      console.error('âŒ Failed to process answer:', error);\r\n      safeSetState({ isProcessingAnswer: false });\r\n      return null;\r\n    }\r\n  }, [state.plugin, state.currentSession, safeSetState]);\r\n\r\n  // ì„¸ì…˜ ì™„ë£Œ\r\n  const completeSession = useCallback(async (): Promise<SpeedTrainingResults | null> => {\r\n    if (!state.plugin || !state.currentSession) {\r\n      console.warn('âš ï¸ No active session or plugin not ready');\r\n      return null;\r\n    }\r\n\r\n    try {\r\n      console.log('ğŸ Completing speed training session...');\r\n      \r\n      const resultsData = await state.plugin.completeSession(state.currentSession.sessionId);\r\n      if (!resultsData.success) {\r\n        throw resultsData.error;\r\n      }\r\n\r\n      const results = resultsData.data;\r\n      \r\n      safeSetState({\r\n        isSessionActive: false,\r\n        currentSession: null,\r\n        sessionProgress: null\r\n      });\r\n\r\n      console.log('âœ… Speed training session completed:', {\r\n        totalScore: results.totalScore,\r\n        accuracy: results.accuracy,\r\n        bonusPoints: results.bonusPoints\r\n      });\r\n      \r\n      return results;\r\n    } catch (error) {\r\n      console.error('âŒ Failed to complete session:', error);\r\n      return null;\r\n    }\r\n  }, [state.plugin, state.currentSession, safeSetState]);\r\n\r\n  // ì§„í–‰ ìƒí™© ì¡°íšŒ\r\n  const getSessionProgress = useCallback(async (): Promise<void> => {\r\n    if (!state.plugin || !state.currentSession) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const progressResult = await state.plugin.getSessionProgress(state.currentSession.sessionId);\r\n      if (progressResult.success) {\r\n        safeSetState({\r\n          sessionProgress: progressResult.data\r\n        });\r\n      }\r\n    } catch (error) {\r\n      console.error('âŒ Failed to get session progress:', error);\r\n    }\r\n  }, [state.plugin, state.currentSession, safeSetState]);\r\n\r\n  // ì„±ëŠ¥ í†µê³„ ì¡°íšŒ\r\n  const getPerformanceStats = useCallback(async () => {\r\n    if (!state.plugin) {\r\n      return null;\r\n    }\r\n\r\n    try {\r\n      const userId = user.id || 'anonymous';\r\n      const statsResult = await state.plugin.getPerformanceStats(userId);\r\n      return statsResult.success ? statsResult.data : null;\r\n    } catch (error) {\r\n      console.error('âŒ Failed to get performance stats:', error);\r\n      return null;\r\n    }\r\n  }, [state.plugin, user.id]);\r\n\r\n  // ì¶”ì²œ ì„¤ì • ì¡°íšŒ\r\n  const getRecommendedSettings = useCallback(async () => {\r\n    if (!state.plugin) {\r\n      return null;\r\n    }\r\n\r\n    try {\r\n      const userId = user.id || 'anonymous';\r\n      const settingsResult = await state.plugin.getRecommendedSettings(userId);\r\n      return settingsResult.success ? settingsResult.data : null;\r\n    } catch (error) {\r\n      console.error('âŒ Failed to get recommended settings:', error);\r\n      return null;\r\n    }\r\n  }, [state.plugin, user.id]);\r\n\r\n  // ì„¸ì…˜ ë¦¬ì…‹\r\n  const resetSession = useCallback(() => {\r\n    safeSetState({\r\n      currentSession: null,\r\n      sessionProgress: null,\r\n      isSessionActive: false,\r\n      isProcessingAnswer: false\r\n    });\r\n  }, [safeSetState]);\r\n\r\n  // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€\r\n  const addEventListener = useCallback((handler: SpeedTrainingEventHandler) => {\r\n    if (state.plugin) {\r\n      state.plugin.onSessionEvent(handler);\r\n      eventHandlersRef.current.add(handler);\r\n    }\r\n  }, [state.plugin]);\r\n\r\n  // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì œê±°\r\n  const removeEventListener = useCallback((handler: SpeedTrainingEventHandler) => {\r\n    if (state.plugin) {\r\n      state.plugin.offSessionEvent(handler);\r\n      eventHandlersRef.current.delete(handler);\r\n    }\r\n  }, [state.plugin]);\r\n\r\n  return {\r\n    // State\r\n    ...state,\r\n    \r\n    // Actions\r\n    initializePlugin,\r\n    createSession,\r\n    processAnswer,\r\n    completeSession,\r\n    getSessionProgress,\r\n    getPerformanceStats,\r\n    getRecommendedSettings,\r\n    resetSession,\r\n    addEventListener,\r\n    removeEventListener\r\n  };\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\hooks\\useStageData.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\hooks\\useStatistics.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\hooks\\useTheme.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\hooks\\useThemedStyles.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useMemo has an unnecessary dependency: 'personalTheme'. Either exclude it or remove the dependency array.","line":115,"column":6,"nodeType":"ArrayExpression","endLine":115,"endColumn":32,"suggestions":[{"desc":"Update the dependencies array to be: [themeMode]","fix":{"range":[3516,3542],"text":"[themeMode]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useMemo has an unnecessary dependency: 'personalTheme'. Either exclude it or remove the dependency array.","line":144,"column":6,"nodeType":"ArrayExpression","endLine":144,"endColumn":32,"suggestions":[{"desc":"Update the dependencies array to be: [themeMode]","fix":{"range":[4469,4495],"text":"[themeMode]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * í…Œë§ˆ ê¸°ë°˜ ìŠ¤íƒ€ì¼ì„ ì œê³µí•˜ëŠ” Hook\r\n * ê¹€ëŒ€ìˆ˜ë‹˜ì˜ ê°œì¸ ë§ì¶¤ ìƒ‰ìƒê³¼ ê¸°ë³¸ ê¹”ë”í•œ í…Œë§ˆ ì‚¬ì´ë¥¼ ì „í™˜\r\n */\r\n\r\nimport { useMemo } from 'react';\r\nimport { useTheme } from '@/store/useAppStore';\r\n\r\nexport interface ThemedStyles {\r\n  // Background Colors\r\n  bgPrimary: string;\r\n  bgSecondary: string;\r\n  bgAccent: string;\r\n  bgBase: string;\r\n  \r\n  // Text Colors  \r\n  textPrimary: string;\r\n  textSecondary: string;\r\n  textAccent: string;\r\n  \r\n  // Border Colors\r\n  borderPrimary: string;\r\n  borderSecondary: string;\r\n  borderAccent: string;\r\n  \r\n  // Button Styles\r\n  primaryButton: string;\r\n  secondaryButton: string;\r\n  accentButton: string;\r\n  \r\n  // Hover Effects\r\n  hoverPrimary: string;\r\n  hoverSecondary: string;\r\n  hoverAccent: string;\r\n  \r\n  // Progress & Status\r\n  progressBar: string;\r\n  successColor: string;\r\n  warningColor: string;\r\n}\r\n\r\nexport const useThemedStyles = (): ThemedStyles => {\r\n  const { themeMode, personalTheme } = useTheme();\r\n  \r\n  const styles = useMemo(() => {\r\n    if (themeMode === 'personal') {\r\n      // ë¯¸ì • í…Œë§ˆ (ê¸°ë³¸ í…Œë§ˆì™€ ë™ì¼í•œ ê¹”ë”í•œ íšŒìƒ‰)\r\n      return {\r\n        // Background Colors\r\n        bgPrimary: '#f9fafb',      // ê¹”ë”í•œ íšŒìƒ‰ ë°°ê²½\r\n        bgSecondary: '#ffffff',    // í°ìƒ‰\r\n        bgAccent: '#6b7280',       // ì¤‘ê°„ íšŒìƒ‰\r\n        bgBase: '#f9fafb',         // ì—°í•œ íšŒìƒ‰ (ìŠ¤í”¼í‚¹ í™”ë©´ê³¼ ë™ì¼)\r\n        \r\n        // Text Colors\r\n        textPrimary: '#374151',    // ì§™ì€ íšŒìƒ‰\r\n        textSecondary: '#6b7280',  // ì¤‘ê°„ íšŒìƒ‰\r\n        textAccent: '#4b5563',     // ì–´ë‘ìš´ íšŒìƒ‰\r\n        \r\n        // Border Colors\r\n        borderPrimary: '#e5e7eb',  // ì—°í•œ íšŒìƒ‰ í…Œë‘ë¦¬\r\n        borderSecondary: '#d1d5db', // ì¤‘ê°„ íšŒìƒ‰ í…Œë‘ë¦¬\r\n        borderAccent: '#9ca3af',   // ì§™ì€ íšŒìƒ‰ í…Œë‘ë¦¬\r\n        \r\n        // Button Styles\r\n        primaryButton: 'bg-gray-600 hover:bg-gray-700 text-white',\r\n        secondaryButton: 'bg-white hover:bg-gray-50 border border-gray-300 text-gray-700',\r\n        accentButton: 'bg-blue-500 hover:bg-blue-600 text-white',\r\n        \r\n        // Hover Effects\r\n        hoverPrimary: 'hover:border-gray-400',\r\n        hoverSecondary: 'hover:border-blue-400',\r\n        hoverAccent: 'hover:border-gray-500',\r\n        \r\n        // Progress & Status\r\n        progressBar: '#6b7280',    // íšŒìƒ‰\r\n        successColor: '#10b981',   // ì´ˆë¡\r\n        warningColor: '#f59e0b',   // ì£¼í™©\r\n      };\r\n    } else {\r\n      // ê¸°ë³¸ ê¹”ë”í•œ í…Œë§ˆ (ìŠ¤í”¼í‚¹ í™”ë©´ ìŠ¤íƒ€ì¼)\r\n      return {\r\n        // Background Colors\r\n        bgPrimary: '#f9fafb',      // ê¹”ë”í•œ íšŒìƒ‰ ë°°ê²½\r\n        bgSecondary: '#ffffff',    // í°ìƒ‰\r\n        bgAccent: '#6b7280',       // ì¤‘ê°„ íšŒìƒ‰\r\n        bgBase: '#f9fafb',         // ì—°í•œ íšŒìƒ‰ (ìŠ¤í”¼í‚¹ í™”ë©´ê³¼ ë™ì¼)\r\n        \r\n        // Text Colors\r\n        textPrimary: '#374151',    // ì§™ì€ íšŒìƒ‰\r\n        textSecondary: '#6b7280',  // ì¤‘ê°„ íšŒìƒ‰\r\n        textAccent: '#4b5563',     // ì–´ë‘ìš´ íšŒìƒ‰\r\n        \r\n        // Border Colors\r\n        borderPrimary: '#e5e7eb',  // ì—°í•œ íšŒìƒ‰ í…Œë‘ë¦¬\r\n        borderSecondary: '#d1d5db', // ì¤‘ê°„ íšŒìƒ‰ í…Œë‘ë¦¬\r\n        borderAccent: '#9ca3af',   // ì§™ì€ íšŒìƒ‰ í…Œë‘ë¦¬\r\n        \r\n        // Button Styles\r\n        primaryButton: 'bg-gray-600 hover:bg-gray-700 text-white',\r\n        secondaryButton: 'bg-white hover:bg-gray-50 border border-gray-300 text-gray-700',\r\n        accentButton: 'bg-blue-500 hover:bg-blue-600 text-white',\r\n        \r\n        // Hover Effects\r\n        hoverPrimary: 'hover:border-gray-400',\r\n        hoverSecondary: 'hover:border-blue-400',\r\n        hoverAccent: 'hover:border-gray-500',\r\n        \r\n        // Progress & Status\r\n        progressBar: '#6b7280',    // íšŒìƒ‰\r\n        successColor: '#10b981',   // ì´ˆë¡\r\n        warningColor: '#f59e0b',   // ì£¼í™©\r\n      };\r\n    }\r\n  }, [themeMode, personalTheme]);\r\n  \r\n  return styles;\r\n};\r\n\r\n// ì¸ë¼ì¸ ìŠ¤íƒ€ì¼ìš© í—¬í¼\r\nexport const useThemedInlineStyles = () => {\r\n  const { themeMode, personalTheme } = useTheme();\r\n  \r\n  return useMemo(() => {\r\n    if (themeMode === 'personal') {\r\n      return {\r\n        primary: '#6b7280',        // íšŒìƒ‰ (ê¸°ë³¸ í…Œë§ˆì™€ ë™ì¼)\r\n        secondary: '#ffffff',      // í°ìƒ‰ (ê¸°ë³¸ í…Œë§ˆì™€ ë™ì¼)\r\n        accent: '#4b5563',         // ì–´ë‘ìš´ íšŒìƒ‰ (ê¸°ë³¸ í…Œë§ˆì™€ ë™ì¼)\r\n        base: '#f9fafb',          // ì—°í•œ íšŒìƒ‰ ë°°ê²½ (ê¸°ë³¸ í…Œë§ˆì™€ ë™ì¼)\r\n        text: '#374151',          // ì§™ì€ íšŒìƒ‰ í…ìŠ¤íŠ¸\r\n        border: '#e5e7eb',        // ì—°í•œ íšŒìƒ‰ í…Œë‘ë¦¬ (ê¸°ë³¸ í…Œë§ˆì™€ ë™ì¼)\r\n      };\r\n    } else {\r\n      return {\r\n        primary: '#6b7280',        // íšŒìƒ‰ (ê¹”ë”í•œ ìŠ¤í”¼í‚¹ í™”ë©´ ìŠ¤íƒ€ì¼)\r\n        secondary: '#ffffff',      // í°ìƒ‰\r\n        accent: '#4b5563',         // ì–´ë‘ìš´ íšŒìƒ‰\r\n        base: '#f9fafb',          // ì—°í•œ íšŒìƒ‰ ë°°ê²½ (ìŠ¤í”¼í‚¹ í™”ë©´ê³¼ ë™ì¼)\r\n        text: '#374151',          // ì§™ì€ íšŒìƒ‰ í…ìŠ¤íŠ¸\r\n        border: '#e5e7eb',        // ì—°í•œ íšŒìƒ‰ í…Œë‘ë¦¬\r\n      };\r\n    }\r\n  }, [themeMode, personalTheme]);\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\hooks\\useVocabulary.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\hooks\\useVoiceGuidance.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ISpeechProcessingService' is defined but never used. Allowed unused vars must match /^_/u.","line":2,"column":33,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":57},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'serviceContainer'. Either include it or remove the dependency array.","line":153,"column":6,"nodeType":"ArrayExpression","endLine":153,"endColumn":44,"suggestions":[{"desc":"Update the dependencies array to be: [isSupported, serviceContainer, settings.enabled, settings.language, settings.pitch, settings.rate, settings.systemVoice, settings.volume, speechService]","fix":{"range":[5510,5548],"text":"[isSupported, serviceContainer, settings.enabled, settings.language, settings.pitch, settings.rate, settings.systemVoice, settings.volume, speechService]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'serviceContainer'. Either include it or remove the dependency array.","line":181,"column":6,"nodeType":"ArrayExpression","endLine":181,"endColumn":34,"suggestions":[{"desc":"Update the dependencies array to be: [isSupported, serviceContainer, speechService]","fix":{"range":[6521,6549],"text":"[isSupported, serviceContainer, speechService]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useCallback, useEffect, useMemo } from 'react';\r\nimport { ServiceContainer, type ISpeechProcessingService } from '@/container/ServiceContainer';\r\n\r\ninterface VoiceGuidanceSettings {\r\n  enabled: boolean;\r\n  systemVoice: boolean;\r\n  volume: number;\r\n  rate: number;\r\n  pitch: number;\r\n  language: string;\r\n}\r\n\r\ninterface VoiceGuidanceHook {\r\n  settings: VoiceGuidanceSettings;\r\n  isSupported: boolean;\r\n  isSpeaking: boolean;\r\n  speak: (text: string, type?: 'system' | 'content') => void;\r\n  stop: () => void;\r\n  pause: () => void;\r\n  resume: () => void;\r\n  updateSettings: (newSettings: Partial<VoiceGuidanceSettings>) => void;\r\n}\r\n\r\ninterface VoiceGuidanceOptions {\r\n  serviceContainer?: ServiceContainer;\r\n}\r\n\r\nexport const useVoiceGuidance = (options: VoiceGuidanceOptions = {}): VoiceGuidanceHook => {\r\n  const [settings, setSettings] = useState<VoiceGuidanceSettings>(() => {\r\n    const saved = localStorage.getItem('voiceGuidanceSettings');\r\n    return saved ? JSON.parse(saved) : {\r\n      enabled: false,\r\n      systemVoice: true,\r\n      volume: 0.8,\r\n      rate: 1.0,\r\n      pitch: 1.0,\r\n      language: 'en-US'\r\n    };\r\n  });\r\n\r\n  const [isSpeaking, setIsSpeaking] = useState(false);\r\n  \r\n  // ğŸ”§ ì˜ì¡´ì„± ì£¼ì…: ServiceContainerë¥¼ í†µí•´ SpeechPlugin íšë“\r\n  const serviceContainer = useMemo(() => {\r\n    return options.serviceContainer || ServiceContainer.getInstance();\r\n  }, [options.serviceContainer]);\r\n\r\n  // ğŸ”§ ì˜ì¡´ì„± ì£¼ì…: ServiceContainerë¥¼ í†µí•´ SpeechProcessingService íšë“\r\n  const speechService = useMemo(() => {\r\n    try {\r\n      return serviceContainer.getSpeechProcessingService();\r\n    } catch (error) {\r\n      console.error('[useVoiceGuidance] Failed to get speech service:', error);\r\n      return null;\r\n    }\r\n  }, [serviceContainer]);\r\n\r\n  const isSupported = typeof window !== 'undefined' && 'speechSynthesis' in window;\r\n\r\n  useEffect(() => {\r\n    localStorage.setItem('voiceGuidanceSettings', JSON.stringify(settings));\r\n  }, [settings]);\r\n\r\n  // ğŸ”§ í”ŒëŸ¬ê·¸ì¸ ì´ë²¤íŠ¸ ì‹œìŠ¤í…œ ì‚¬ìš©\r\n  useEffect(() => {\r\n    if (!isSupported || !speechService) return;\r\n\r\n    const handleSpeechStart = () => setIsSpeaking(true);\r\n    const handleSpeechEnd = () => setIsSpeaking(false);\r\n\r\n    // speechService ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡ (í”ŒëŸ¬ê·¸ì¸ ê¸°ë°˜)\r\n    try {\r\n      // speechServiceê°€ ì´ë²¤íŠ¸ ì‹œìŠ¤í…œì„ ì§€ì›í•˜ëŠ” ê²½ìš° ì‚¬ìš©\r\n      if (typeof speechService.on === 'function') {\r\n        speechService.on('speechStart', handleSpeechStart);\r\n        speechService.on('speechEnd', handleSpeechEnd);\r\n\r\n        return () => {\r\n          if (typeof speechService.off === 'function') {\r\n            speechService.off('speechStart', handleSpeechStart);\r\n            speechService.off('speechEnd', handleSpeechEnd);\r\n          }\r\n        };\r\n      } else {\r\n        // speechServiceê°€ ì´ë²¤íŠ¸ ì‹œìŠ¤í…œì„ ì§€ì›í•˜ì§€ ì•ŠëŠ” ê²½ìš° pollingìœ¼ë¡œ ìƒíƒœ í™•ì¸\r\n        const interval = setInterval(() => {\r\n          const wasSpeaking = isSpeaking;\r\n          const currentlySpeaking = speechService?.isProcessing?.() || false;\r\n          if (wasSpeaking !== currentlySpeaking) {\r\n            setIsSpeaking(currentlySpeaking);\r\n          }\r\n        }, 100);\r\n\r\n        return () => clearInterval(interval);\r\n      }\r\n    } catch (error) {\r\n      console.warn('[useVoiceGuidance] Event listener setup failed, using polling fallback:', error);\r\n\r\n      // ìµœì¢… fallback: pollingìœ¼ë¡œ ìƒíƒœ í™•ì¸\r\n      const interval = setInterval(() => {\r\n        const wasSpeaking = isSpeaking;\r\n        const currentlySpeaking = speechService?.isProcessing?.() || false;\r\n        if (wasSpeaking !== currentlySpeaking) {\r\n          setIsSpeaking(currentlySpeaking);\r\n        }\r\n      }, 100);\r\n\r\n      return () => clearInterval(interval);\r\n    }\r\n  }, [isSupported, speechService, isSpeaking]);\r\n\r\n  const speak = useCallback(async (text: string, type: 'system' | 'content' = 'system') => {\r\n    if (!isSupported || !settings.enabled || !speechService) return;\r\n    \r\n    // ì‹œìŠ¤í…œ ìŒì„±ê³¼ ì½˜í…ì¸  ìŒì„± êµ¬ë¶„\r\n    if (type === 'system' && !settings.systemVoice) return;\r\n\r\n    try {\r\n      // ğŸ”§ Direct Web API ì œê±°: speechService.speakAnswer ì‚¬ìš©\r\n      const speechOptions = {\r\n        language: settings.language,\r\n        rate: type === 'system' ? settings.rate * 1.2 : settings.rate,\r\n        volume: type === 'system' ? Math.min(settings.volume, 0.6) : settings.volume,\r\n        pitch: type === 'system' ? settings.pitch * 0.9 : settings.pitch\r\n      };\r\n\r\n      // speechServiceì˜ speakAnswer ë©”ì„œë“œ ì‚¬ìš© (TTS ê¸°ëŠ¥)\r\n      await speechService.speakAnswer(text, speechOptions);\r\n    } catch (error) {\r\n      console.error('[useVoiceGuidance] Speech service error:', error);\r\n      \r\n      // ğŸ”§ í”ŒëŸ¬ê·¸ì¸ fallback: AdvancedSpeechPlugin ë˜ëŠ” ê¸°ë³¸ í”ŒëŸ¬ê·¸ì¸ ì‚¬ìš©\r\n      try {\r\n        // ServiceContainerì˜ AdvancedSpeechPlugin ì‹œë„\r\n        const advancedPlugin = serviceContainer.getAdvancedSpeechPlugin();\r\n        if (advancedPlugin) {\r\n          await advancedPlugin.speakText(text, {\r\n            language: settings.language,\r\n            rate: type === 'system' ? settings.rate * 1.2 : settings.rate,\r\n            volume: type === 'system' ? Math.min(settings.volume, 0.6) : settings.volume,\r\n            pitch: type === 'system' ? settings.pitch * 0.9 : settings.pitch\r\n          });\r\n          return;\r\n        }\r\n      } catch (pluginError) {\r\n        console.warn('[useVoiceGuidance] Advanced speech plugin fallback failed:', pluginError);\r\n      }\r\n\r\n      // ğŸš« Direct Web API í˜¸ì¶œ ì™„ì „ ì œê±° - í”ŒëŸ¬ê·¸ì¸ë§Œ ì‚¬ìš©\r\n      console.error('[useVoiceGuidance] All speech plugins failed, unable to speak text');\r\n      throw new Error('Speech plugins not available');\r\n    }\r\n  }, [isSupported, settings, speechService]);\r\n\r\n  const stop = useCallback(() => {\r\n    if (!isSupported || !speechService) return;\r\n\r\n    try {\r\n      // ğŸ”§ Direct Web API ì œê±°: speechService.stopAllSpeech ì‚¬ìš©\r\n      speechService.stopAllSpeech();\r\n      setIsSpeaking(false);\r\n    } catch (error) {\r\n      console.error('[useVoiceGuidance] Stop speech error:', error);\r\n      \r\n      // ğŸ”§ í”ŒëŸ¬ê·¸ì¸ fallback: AdvancedSpeechPlugin ë˜ëŠ” ê¸°ë³¸ í”ŒëŸ¬ê·¸ì¸ ì‚¬ìš©\r\n      try {\r\n        const advancedPlugin = serviceContainer.getAdvancedSpeechPlugin();\r\n        if (advancedPlugin && typeof advancedPlugin.stopAll === 'function') {\r\n          advancedPlugin.stopAll();\r\n          setIsSpeaking(false);\r\n          return;\r\n        }\r\n      } catch (pluginError) {\r\n        console.warn('[useVoiceGuidance] Advanced speech plugin stop failed:', pluginError);\r\n      }\r\n\r\n      // ğŸš« Direct Web API í˜¸ì¶œ ì™„ì „ ì œê±°\r\n      console.error('[useVoiceGuidance] All speech plugins failed, unable to stop speech');\r\n      setIsSpeaking(false);\r\n    }\r\n  }, [isSupported, speechService]);\r\n\r\n  const pause = useCallback(() => {\r\n    if (!isSupported || !speechService) return;\r\n\r\n    try {\r\n      // ğŸ”§ Direct Web API ì œê±°: speechService.pauseSpeech ì‚¬ìš©\r\n      speechService.pauseSpeech();\r\n    } catch (error) {\r\n      console.error('[useVoiceGuidance] Pause speech error:', error);\r\n      \r\n      // ğŸš« Direct Web API í˜¸ì¶œ ì™„ì „ ì œê±°\r\n      console.error('[useVoiceGuidance] Speech pause not supported by current plugin system');\r\n    }\r\n  }, [isSupported, speechService]);\r\n\r\n  const resume = useCallback(() => {\r\n    if (!isSupported || !speechService) return;\r\n\r\n    try {\r\n      // ğŸ”§ Direct Web API ì œê±°: speechService.resumeSpeech ì‚¬ìš©\r\n      speechService.resumeSpeech();\r\n    } catch (error) {\r\n      console.error('[useVoiceGuidance] Resume speech error:', error);\r\n      \r\n      // ğŸš« Direct Web API í˜¸ì¶œ ì™„ì „ ì œê±°\r\n      console.error('[useVoiceGuidance] Speech resume not supported by current plugin system');\r\n    }\r\n  }, [isSupported, speechService]);\r\n\r\n  const updateSettings = useCallback((newSettings: Partial<VoiceGuidanceSettings>) => {\r\n    setSettings(prev => ({ ...prev, ...newSettings }));\r\n  }, []);\r\n\r\n  return {\r\n    settings,\r\n    isSupported,\r\n    isSpeaking,\r\n    speak,\r\n    stop,\r\n    pause,\r\n    resume,\r\n    updateSettings\r\n  };\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\i18n\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\index.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\lib\\api.ts","messages":[{"ruleId":"no-undef","severity":1,"message":"'RequestInit' is not defined.","line":15,"column":14,"nodeType":"Identifier","messageId":"undef","endLine":15,"endColumn":25}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// API utilities for DASI English backend\r\nimport type { FeedbackResponse, DrillCard, StudySession, ApiResponse } from '@/types';\r\n\r\nconst API_BASE_URL = import.meta.env.VITE_API_BASE_URL || 'http://localhost:8081';\r\n\r\nclass ApiClient {\r\n  private baseUrl: string;\r\n\r\n  constructor(baseUrl: string) {\r\n    this.baseUrl = baseUrl;\r\n  }\r\n\r\n  private async request<T>(\r\n    endpoint: string, \r\n    options: RequestInit = {}\r\n  ): Promise<ApiResponse<T>> {\r\n    try {\r\n      const url = `${this.baseUrl}${endpoint}`;\r\n      const response = await fetch(url, {\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          ...options.headers,\r\n        },\r\n        ...options,\r\n      });\r\n\r\n      const data = await response.json();\r\n      \r\n      if (!response.ok) {\r\n        return {\r\n          success: false,\r\n          error: data.error || `HTTP ${response.status}`,\r\n        };\r\n      }\r\n\r\n      return {\r\n        success: true,\r\n        data,\r\n      };\r\n    } catch (error) {\r\n      return {\r\n        success: false,\r\n        error: error instanceof Error ? error.message : 'Network error',\r\n      };\r\n    }\r\n  }\r\n\r\n  // Health check\r\n  async health(): Promise<ApiResponse> {\r\n    return this.request('/health');\r\n  }\r\n\r\n  // Get drill cards for a specific level and stage\r\n  async getCards(level: number, stage: number | 'ALL'): Promise<ApiResponse<{\r\n    level: number;\r\n    stage: number | 'ALL';\r\n    cards: DrillCard[];\r\n    totalCards: number;\r\n    mode?: 'ALL';\r\n  }>> {\r\n    return this.request(`/cards?level=${level}&stage=${stage}`);\r\n  }\r\n\r\n  // Get all cards for a level (ALL mode)\r\n  async getAllLevelCards(level: number): Promise<ApiResponse<{\r\n    level: number;\r\n    mode: 'ALL';\r\n    cards: DrillCard[];\r\n    totalCards: number;\r\n    shuffled: boolean;\r\n  }>> {\r\n    return this.request(`/cards/all?level=${level}`);\r\n  }\r\n\r\n  // Get feedback from AI for user's answer\r\n  async getFeedback(params: {\r\n    front_ko: string;\r\n    sttText: string;\r\n    target_en: string;\r\n  }): Promise<ApiResponse<FeedbackResponse>> {\r\n    return this.request('/feedback', {\r\n      method: 'POST',\r\n      body: JSON.stringify(params),\r\n    });\r\n  }\r\n\r\n  // Session management\r\n  async startSession(params: {\r\n    userId: string;\r\n    level: number;\r\n    stage: number;\r\n    cardIds: string[];\r\n  }): Promise<ApiResponse<{ sessionId: string }>> {\r\n    return this.request('/session/start', {\r\n      method: 'POST',\r\n      body: JSON.stringify(params),\r\n    });\r\n  }\r\n\r\n  async submitAnswer(params: {\r\n    sessionId: string;\r\n    cardId: string;\r\n    userAnswer: string;\r\n    isCorrect: boolean;\r\n    score: number;\r\n    timeSpent: number;\r\n  }): Promise<ApiResponse<{ progress: any }>> {\r\n    return this.request('/session/submit', {\r\n      method: 'POST',\r\n      body: JSON.stringify(params),\r\n    });\r\n  }\r\n\r\n  async finishSession(sessionId: string): Promise<ApiResponse<{\r\n    summary: {\r\n      totalCards: number;\r\n      correctAnswers: number;\r\n      accuracy: number;\r\n      averageScore: number;\r\n      totalTime: number;\r\n      averageTimePerCard: number;\r\n    }\r\n  }>> {\r\n    return this.request('/session/finish', {\r\n      method: 'POST',\r\n      body: JSON.stringify({ sessionId }),\r\n    });\r\n  }\r\n\r\n  // STT service (if using cloud STT)\r\n  async transcribeAudio(params: {\r\n    audioBase64: string;\r\n    languageCode?: string;\r\n    phraseHints?: string[];\r\n  }): Promise<ApiResponse<{\r\n    transcript: string;\r\n    confidence: number | null;\r\n  }>> {\r\n    return this.request('/stt', {\r\n      method: 'POST',\r\n      body: JSON.stringify(params),\r\n    });\r\n  }\r\n\r\n  // Review API - Random review cards\r\n  async getRandomReview(params: {\r\n    userId?: string;\r\n    count?: number;\r\n    levels?: number[];\r\n  }): Promise<ApiResponse<{\r\n    cards: DrillCard[];\r\n    totalCards: number;\r\n    sourceLevels: number[];\r\n    type: string;\r\n  }>> {\r\n    const searchParams = new URLSearchParams();\r\n    if (params.userId) searchParams.append('userId', params.userId);\r\n    if (params.count) searchParams.append('count', params.count.toString());\r\n    if (params.levels && params.levels.length > 0) {\r\n      searchParams.append('levels', params.levels.join(','));\r\n    }\r\n\r\n    return this.request(`/review/random?${searchParams.toString()}`);\r\n  }\r\n\r\n  // Review API - Retry incorrect answers\r\n  async getRetryReview(params: {\r\n    userId: string;\r\n    sessionId?: string;\r\n  }): Promise<ApiResponse<{\r\n    cards: DrillCard[];\r\n    totalCards: number;\r\n    type: string;\r\n  }>> {\r\n    const searchParams = new URLSearchParams();\r\n    searchParams.append('userId', params.userId);\r\n    if (params.sessionId) searchParams.append('sessionId', params.sessionId);\r\n\r\n    return this.request(`/review/retry?${searchParams.toString()}`);\r\n  }\r\n}\r\n\r\n// Create and export API client instance\r\nexport const api = new ApiClient(API_BASE_URL);\r\n\r\n// Export types for convenience\r\nexport type { ApiResponse, FeedbackResponse, DrillCard, StudySession };","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\lib\\audioV2\\AudioSession.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\lib\\audioV2\\AudioSessionFactory.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'_error' is defined but never used.","line":124,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":124,"endColumn":20}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { AudioSession } from './AudioSession';\nimport type { AudioConfig, SessionCallbacks } from './types';\n\nexport class AudioSessionFactory {\n  private static levelConfigs: Record<number, Partial<AudioConfig>> = {\n    1: {\n      thinkTime: 3,\n      recordTime: 10,\n      promptDelay: 1000,\n      beepDuration: 300,\n      enableVAD: false,\n      vadThreshold: 0.1,\n      preRollTime: 500,\n      graceLateTime: 1000\n    },\n    2: {\n      thinkTime: 3,\n      recordTime: 12,\n      promptDelay: 800,\n      beepDuration: 250,\n      enableVAD: true,\n      vadThreshold: 0.15,\n      preRollTime: 400,\n      graceLateTime: 800\n    },\n    3: {\n      thinkTime: 2,\n      recordTime: 15,\n      promptDelay: 600,\n      beepDuration: 200,\n      enableVAD: true,\n      vadThreshold: 0.2,\n      preRollTime: 300,\n      graceLateTime: 600\n    },\n    4: {\n      thinkTime: 2,\n      recordTime: 20,\n      promptDelay: 500,\n      beepDuration: 150,\n      enableVAD: true,\n      vadThreshold: 0.25,\n      preRollTime: 200,\n      graceLateTime: 400\n    },\n    5: {\n      thinkTime: 1,\n      recordTime: 25,\n      promptDelay: 300,\n      beepDuration: 100,\n      enableVAD: true,\n      vadThreshold: 0.3,\n      preRollTime: 150,\n      graceLateTime: 300\n    },\n    6: {\n      thinkTime: 1,\n      recordTime: 30,\n      promptDelay: 200,\n      beepDuration: 100,\n      enableVAD: true,\n      vadThreshold: 0.35,\n      preRollTime: 100,\n      graceLateTime: 200\n    }\n  };\n\n  static async create(level: number, callbacks: SessionCallbacks = {}): Promise<AudioSession> {\n    // Validate browser compatibility\n    await this.checkBrowserCompatibility();\n\n    // Get level-specific configuration\n    const levelConfig = this.levelConfigs[level] || this.levelConfigs[1];\n    \n    const config: AudioConfig = {\n      level,\n      ...levelConfig\n    } as AudioConfig;\n\n    // Generate unique session ID\n    const sessionId = `session_${level}_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n\n    return new AudioSession(sessionId, config, callbacks);\n  }\n\n  private static async checkBrowserCompatibility(): Promise<void> {\n    const issues: string[] = [];\n\n    // Check MediaRecorder\n    if (!window.MediaRecorder) {\n      issues.push('MediaRecorder API not supported');\n    }\n\n    // Check getUserMedia\n    if (!navigator.mediaDevices?.getUserMedia) {\n      issues.push('getUserMedia API not supported');\n    }\n\n    // Check Speech Recognition\n    const SpeechRecognition = (window as any).SpeechRecognition || (window as any).webkitSpeechRecognition;\n    if (!SpeechRecognition) {\n      issues.push('Speech Recognition API not supported');\n    }\n\n    // Check Speech Synthesis\n    if (!window.speechSynthesis) {\n      issues.push('Speech Synthesis API not supported');\n    }\n\n    // Check Web Audio API\n    const AudioContext = window.AudioContext || (window as any).webkitAudioContext;\n    if (!AudioContext) {\n      issues.push('Web Audio API not supported');\n    }\n\n    if (issues.length > 0) {\n      throw new Error(`Browser compatibility issues: ${issues.join(', ')}`);\n    }\n\n    // Test microphone access\n    try {\n      const stream = await navigator.mediaDevices.getUserMedia({ audio: true });\n      stream.getTracks().forEach(track => track.stop());\n    } catch (_error) {\n      throw new Error('Microphone access denied or not available');\n    }\n  }\n\n  static getSupportedLevels(): number[] {\n    return Object.keys(this.levelConfigs).map(Number).sort((a, b) => a - b);\n  }\n\n  static getLevelConfig(level: number): Partial<AudioConfig> {\n    return { ...this.levelConfigs[level] } || { ...this.levelConfigs[1] };\n  }\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\lib\\audioV2\\modules\\ASRClient.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\lib\\audioV2\\modules\\BeepPlayer.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'_error' is defined but never used.","line":12,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":20}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"export class BeepPlayer {\n  private audioContext: AudioContext | null = null;\n  private currentOscillator: OscillatorNode | null = null;\n  private isInitialized: boolean = false;\n\n  async initialize(): Promise<void> {\n    if (this.isInitialized) return;\n\n    try {\n      this.audioContext = new (window.AudioContext || (window as any).webkitAudioContext)();\n      this.isInitialized = true;\n    } catch (_error) {\n      throw new Error('Failed to initialize audio context for beep player');\n    }\n  }\n\n  async playBeep(frequency: number = 800, duration: number = 200): Promise<void> {\n    if (!this.isInitialized) {\n      await this.initialize();\n    }\n\n    if (!this.audioContext) {\n      throw new Error('Audio context not available');\n    }\n\n    return new Promise((resolve) => {\n      const oscillator = this.audioContext!.createOscillator();\n      const gainNode = this.audioContext!.createGain();\n\n      this.currentOscillator = oscillator;\n\n      oscillator.connect(gainNode);\n      gainNode.connect(this.audioContext!.destination);\n\n      oscillator.frequency.setValueAtTime(frequency, this.audioContext!.currentTime);\n      gainNode.gain.setValueAtTime(0.3, this.audioContext!.currentTime);\n\n      oscillator.start();\n      oscillator.stop(this.audioContext!.currentTime + duration / 1000);\n\n      oscillator.onended = () => {\n        this.currentOscillator = null;\n        resolve();\n      };\n    });\n  }\n\n  stop(): void {\n    if (this.currentOscillator) {\n      this.currentOscillator.stop();\n      this.currentOscillator = null;\n    }\n  }\n\n  cleanup(): void {\n    this.stop();\n    if (this.audioContext) {\n      this.audioContext.close();\n      this.audioContext = null;\n    }\n    this.isInitialized = false;\n  }\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\lib\\audioV2\\modules\\Recorder.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\lib\\audioV2\\modules\\StageClock.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\lib\\audioV2\\modules\\TTSPlayer.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\lib\\audioV2\\types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\lib\\firebase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\pages\\AchievementsPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AchievementData' is defined but never used. Allowed unused vars must match /^_/u.","line":3,"column":64,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":79},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'user' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":117,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":117,"endColumn":13}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useLocalStorage, STORAGE_KEYS, type Achievement, type AchievementData } from '@/hooks/useLocalStorage';\r\nimport { useUser } from '@/store/useAppStore';\r\n\r\n// ê¸°ë³¸ ì—…ì  ì •ì˜\r\nconst AVAILABLE_ACHIEVEMENTS: Achievement[] = [\r\n  // í•™ìŠµ ì—…ì  (ğŸ“š)\r\n  {\r\n    id: 'first_lesson',\r\n    title: 'ì²« ê±¸ìŒ',\r\n    description: 'ì²« ë²ˆì§¸ ë ˆìŠ¨ ì™„ë£Œ',\r\n    type: 'learning',\r\n    icon: 'ğŸŒ±',\r\n    badge: 'ğŸ“š',\r\n    target: 1,\r\n    current: 0\r\n  },\r\n  {\r\n    id: 'complete_level_1',\r\n    title: 'ê¸°ì´ˆ ë§ˆìŠ¤í„°',\r\n    description: 'Level 1 ì™„ì „ ì •ë³µ',\r\n    type: 'learning',\r\n    icon: 'ğŸ“',\r\n    badge: 'ğŸ“š',\r\n    target: 1,\r\n    current: 0\r\n  },\r\n  {\r\n    id: 'study_streak_7',\r\n    title: 'ì¼ì£¼ì¼ ì—°ì†',\r\n    description: '7ì¼ ì—°ì† í•™ìŠµ',\r\n    type: 'learning',\r\n    icon: 'ğŸ”¥',\r\n    badge: 'ğŸ“š',\r\n    target: 7,\r\n    current: 0\r\n  },\r\n  {\r\n    id: 'study_streak_30',\r\n    title: 'í•œ ë‹¬ ì—°ì†',\r\n    description: '30ì¼ ì—°ì† í•™ìŠµ',\r\n    type: 'learning',\r\n    icon: 'ğŸ’¯',\r\n    badge: 'ğŸ“š',\r\n    target: 30,\r\n    current: 0\r\n  },\r\n  {\r\n    id: 'complete_100_questions',\r\n    title: 'ë°±ë¬¸ë°±ë‹µ',\r\n    description: '100ë¬¸ì œ í•´ê²°',\r\n    type: 'learning',\r\n    icon: 'ğŸ’¯',\r\n    badge: 'ğŸ“š',\r\n    target: 100,\r\n    current: 0\r\n  },\r\n  \r\n  // ì„±ê³¼ ì—…ì  (ğŸ¯)\r\n  {\r\n    id: 'accuracy_90',\r\n    title: 'ì •í™•í•œ ë°œìŒ',\r\n    description: '90% ì´ìƒ ì •í™•ë„ ë‹¬ì„±',\r\n    type: 'performance',\r\n    icon: 'ğŸ¯',\r\n    badge: 'ğŸ¯',\r\n    target: 90,\r\n    current: 0\r\n  },\r\n  {\r\n    id: 'speed_master',\r\n    title: 'ìŠ¤í”¼ë“œ ë§ˆìŠ¤í„°',\r\n    description: 'í‰ê·  ì‘ë‹µì‹œê°„ 2ì´ˆ ì´í•˜',\r\n    type: 'performance',\r\n    icon: 'âš¡',\r\n    badge: 'ğŸ¯',\r\n    target: 2,\r\n    current: 0\r\n  },\r\n  {\r\n    id: 'perfect_session',\r\n    title: 'ì™„ë²½í•œ ì„¸ì…˜',\r\n    description: 'í•œ ì„¸ì…˜ì—ì„œ 100% ì •ë‹µ',\r\n    type: 'performance',\r\n    icon: 'â­',\r\n    badge: 'ğŸ¯',\r\n    target: 1,\r\n    current: 0\r\n  },\r\n  \r\n  // ë§ˆì¼ìŠ¤í†¤ ì—…ì  (ğŸ†)\r\n  {\r\n    id: 'reach_level_5',\r\n    title: 'ì¤‘ê¸‰ì',\r\n    description: 'Level 5 ë‹¬ì„±',\r\n    type: 'milestone',\r\n    icon: 'ğŸ…',\r\n    badge: 'ğŸ†',\r\n    target: 5,\r\n    current: 0\r\n  },\r\n  {\r\n    id: 'reach_level_10',\r\n    title: 'ê³ ê¸‰ì',\r\n    description: 'Level 10 ë‹¬ì„±',\r\n    type: 'milestone',\r\n    icon: 'ğŸ‘‘',\r\n    badge: 'ğŸ†',\r\n    target: 10,\r\n    current: 0\r\n  }\r\n];\r\n\r\nexport const AchievementsPage: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const user = useUser();\r\n  const { value: achievementData, updateValue } = useLocalStorage(STORAGE_KEYS.ACHIEVEMENTS);\r\n\r\n  // ì—…ì  ë‹¬ì„± ìƒíƒœ ê³„ì‚°\r\n  const getAchievementStatus = (achievement: Achievement) => {\r\n    const isUnlocked = achievementData.unlockedAchievements.includes(achievement.id);\r\n    const progress = achievementData.achievementProgress[achievement.id];\r\n    const isNew = achievementData.newBadges.includes(achievement.id);\r\n    \r\n    return {\r\n      isUnlocked,\r\n      isNew,\r\n      progress: progress ? Math.min(100, (progress.current / progress.target) * 100) : 0,\r\n      current: progress?.current || 0,\r\n      target: progress?.target || achievement.target || 0\r\n    };\r\n  };\r\n\r\n  // ìƒˆ ë°°ì§€ í™•ì¸ ì²˜ë¦¬\r\n  const markBadgeAsSeen = (achievementId: string) => {\r\n    updateValue(prev => ({\r\n      ...prev,\r\n      newBadges: prev.newBadges.filter(id => id !== achievementId)\r\n    }));\r\n  };\r\n\r\n  // ì¹´í…Œê³ ë¦¬ë³„ ì—…ì  ë¶„ë¥˜\r\n  const achievementsByType = {\r\n    learning: AVAILABLE_ACHIEVEMENTS.filter(a => a.type === 'learning'),\r\n    performance: AVAILABLE_ACHIEVEMENTS.filter(a => a.type === 'performance'),\r\n    milestone: AVAILABLE_ACHIEVEMENTS.filter(a => a.type === 'milestone')\r\n  };\r\n\r\n  // ì „ì²´ í†µê³„ ê³„ì‚°\r\n  const totalAchievements = AVAILABLE_ACHIEVEMENTS.length;\r\n  const unlockedCount = achievementData.unlockedAchievements.length;\r\n  const completionRate = Math.round((unlockedCount / totalAchievements) * 100);\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50\">\r\n      {/* Header */}\r\n      <div className=\"bg-white shadow-sm border-b\">\r\n        <div className=\"max-w-4xl mx-auto px-4 py-4\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div className=\"flex items-center gap-4\">\r\n              <button\r\n                onClick={() => navigate('/')}\r\n                className=\"p-2 hover:bg-gray-100 rounded-lg transition-colors\"\r\n              >\r\n                <svg className=\"w-6 h-6 text-gray-600 dark:text-gray-300\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 19l-7-7 7-7\" />\r\n                </svg>\r\n              </button>\r\n              <div>\r\n                <h1 className=\"text-2xl font-bold text-gray-800 dark:text-white\">ğŸ† ì—…ì Â·ë°°ì§€</h1>\r\n                <p className=\"text-sm text-gray-600 dark:text-gray-300\">í•™ìŠµ ì„±ì·¨ë„ì™€ ì—…ì  í™•ì¸</p>\r\n              </div>\r\n            </div>\r\n            <div className=\"text-right\">\r\n              <div className=\"text-2xl font-bold text-orange-600\">{unlockedCount}/{totalAchievements}</div>\r\n              <div className=\"text-xs text-gray-500\">ë‹¬ì„±ë¥  {completionRate}%</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Achievements Content */}\r\n      <div className=\"max-w-4xl mx-auto px-4 py-8\">\r\n        <div className=\"space-y-8\">\r\n\r\n          {/* ì§„í–‰ë¥  í‘œì‹œ */}\r\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg transition-colors duration-300 shadow p-6\">\r\n            <h2 className=\"text-lg font-semibold text-gray-800 dark:text-white mb-4\">ì „ì²´ ì§„í–‰ë¥ </h2>\r\n            <div className=\"w-full bg-gray-200 rounded-full h-3 mb-2\">\r\n              <div \r\n                className=\"bg-orange-500 h-3 rounded-full transition-all duration-500\"\r\n                style={{ width: `${completionRate}%` }}\r\n              ></div>\r\n            </div>\r\n            <div className=\"flex justify-between text-sm text-gray-600 dark:text-gray-300\">\r\n              <span>ë‹¬ì„±í•œ ì—…ì : {unlockedCount}ê°œ</span>\r\n              <span>{completionRate}% ì™„ë£Œ</span>\r\n            </div>\r\n          </div>\r\n\r\n          {/* í•™ìŠµ ì—…ì  */}\r\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg transition-colors duration-300 shadow p-6\">\r\n            <h2 className=\"text-lg font-semibold text-gray-800 dark:text-white mb-6 flex items-center\">\r\n              <span className=\"text-2xl mr-3\">ğŸ“š</span>\r\n              í•™ìŠµ ì—…ì \r\n            </h2>\r\n            <div className=\"grid md:grid-cols-2 gap-4\">\r\n              {achievementsByType.learning.map(achievement => {\r\n                const status = getAchievementStatus(achievement);\r\n                return (\r\n                  <div\r\n                    key={achievement.id}\r\n                    className={`relative p-4 border-2 rounded-lg transition-all ${\r\n                      status.isUnlocked\r\n                        ? 'border-green-200 bg-green-50'\r\n                        : 'border-gray-200 bg-gray-50'\r\n                    }`}\r\n                    onClick={() => status.isNew && markBadgeAsSeen(achievement.id)}\r\n                  >\r\n                    {status.isNew && (\r\n                      <div className=\"absolute -top-2 -right-2 bg-red-500 text-white text-xs px-2 py-1 rounded-full animate-pulse\">\r\n                        NEW!\r\n                      </div>\r\n                    )}\r\n                    <div className=\"flex items-center gap-3\">\r\n                      <div className={`text-2xl ${status.isUnlocked ? '' : 'grayscale opacity-50'}`}>\r\n                        {achievement.icon}\r\n                      </div>\r\n                      <div className=\"flex-1\">\r\n                        <div className={`font-medium ${status.isUnlocked ? 'text-green-800' : 'text-gray-600 dark:text-gray-300'}`}>\r\n                          {achievement.title}\r\n                        </div>\r\n                        <div className=\"text-sm text-gray-500\">{achievement.description}</div>\r\n                        {!status.isUnlocked && status.progress > 0 && (\r\n                          <div className=\"mt-2\">\r\n                            <div className=\"w-full bg-gray-200 rounded-full h-2\">\r\n                              <div \r\n                                className=\"bg-blue-500 h-2 rounded-full transition-all duration-300\"\r\n                                style={{ width: `${status.progress}%` }}\r\n                              ></div>\r\n                            </div>\r\n                            <div className=\"text-xs text-gray-500 mt-1\">\r\n                              {status.current}/{status.target}\r\n                            </div>\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                      {status.isUnlocked && (\r\n                        <div className=\"text-green-600\">\r\n                          <svg className=\"w-6 h-6\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                            <path fillRule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clipRule=\"evenodd\" />\r\n                          </svg>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                );\r\n              })}\r\n            </div>\r\n          </div>\r\n\r\n          {/* ì„±ê³¼ ì—…ì  */}\r\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg transition-colors duration-300 shadow p-6\">\r\n            <h2 className=\"text-lg font-semibold text-gray-800 dark:text-white mb-6 flex items-center\">\r\n              <span className=\"text-2xl mr-3\">ğŸ¯</span>\r\n              ì„±ê³¼ ì—…ì \r\n            </h2>\r\n            <div className=\"grid md:grid-cols-2 gap-4\">\r\n              {achievementsByType.performance.map(achievement => {\r\n                const status = getAchievementStatus(achievement);\r\n                return (\r\n                  <div\r\n                    key={achievement.id}\r\n                    className={`relative p-4 border-2 rounded-lg transition-all ${\r\n                      status.isUnlocked\r\n                        ? 'border-blue-200 bg-blue-50'\r\n                        : 'border-gray-200 bg-gray-50'\r\n                    }`}\r\n                    onClick={() => status.isNew && markBadgeAsSeen(achievement.id)}\r\n                  >\r\n                    {status.isNew && (\r\n                      <div className=\"absolute -top-2 -right-2 bg-red-500 text-white text-xs px-2 py-1 rounded-full animate-pulse\">\r\n                        NEW!\r\n                      </div>\r\n                    )}\r\n                    <div className=\"flex items-center gap-3\">\r\n                      <div className={`text-2xl ${status.isUnlocked ? '' : 'grayscale opacity-50'}`}>\r\n                        {achievement.icon}\r\n                      </div>\r\n                      <div className=\"flex-1\">\r\n                        <div className={`font-medium ${status.isUnlocked ? 'text-blue-800' : 'text-gray-600 dark:text-gray-300'}`}>\r\n                          {achievement.title}\r\n                        </div>\r\n                        <div className=\"text-sm text-gray-500\">{achievement.description}</div>\r\n                        {!status.isUnlocked && status.progress > 0 && (\r\n                          <div className=\"mt-2\">\r\n                            <div className=\"w-full bg-gray-200 rounded-full h-2\">\r\n                              <div \r\n                                className=\"bg-blue-500 h-2 rounded-full transition-all duration-300\"\r\n                                style={{ width: `${status.progress}%` }}\r\n                              ></div>\r\n                            </div>\r\n                            <div className=\"text-xs text-gray-500 mt-1\">\r\n                              {status.current}/{status.target}\r\n                            </div>\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                      {status.isUnlocked && (\r\n                        <div className=\"text-blue-600\">\r\n                          <svg className=\"w-6 h-6\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                            <path fillRule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clipRule=\"evenodd\" />\r\n                          </svg>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                );\r\n              })}\r\n            </div>\r\n          </div>\r\n\r\n          {/* ë§ˆì¼ìŠ¤í†¤ ì—…ì  */}\r\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg transition-colors duration-300 shadow p-6\">\r\n            <h2 className=\"text-lg font-semibold text-gray-800 dark:text-white mb-6 flex items-center\">\r\n              <span className=\"text-2xl mr-3\">ğŸ†</span>\r\n              ë§ˆì¼ìŠ¤í†¤ ì—…ì \r\n            </h2>\r\n            <div className=\"grid md:grid-cols-2 gap-4\">\r\n              {achievementsByType.milestone.map(achievement => {\r\n                const status = getAchievementStatus(achievement);\r\n                return (\r\n                  <div\r\n                    key={achievement.id}\r\n                    className={`relative p-4 border-2 rounded-lg transition-all ${\r\n                      status.isUnlocked\r\n                        ? 'border-yellow-200 bg-yellow-50'\r\n                        : 'border-gray-200 bg-gray-50'\r\n                    }`}\r\n                    onClick={() => status.isNew && markBadgeAsSeen(achievement.id)}\r\n                  >\r\n                    {status.isNew && (\r\n                      <div className=\"absolute -top-2 -right-2 bg-red-500 text-white text-xs px-2 py-1 rounded-full animate-pulse\">\r\n                        NEW!\r\n                      </div>\r\n                    )}\r\n                    <div className=\"flex items-center gap-3\">\r\n                      <div className={`text-2xl ${status.isUnlocked ? '' : 'grayscale opacity-50'}`}>\r\n                        {achievement.icon}\r\n                      </div>\r\n                      <div className=\"flex-1\">\r\n                        <div className={`font-medium ${status.isUnlocked ? 'text-yellow-800' : 'text-gray-600 dark:text-gray-300'}`}>\r\n                          {achievement.title}\r\n                        </div>\r\n                        <div className=\"text-sm text-gray-500\">{achievement.description}</div>\r\n                        {!status.isUnlocked && status.progress > 0 && (\r\n                          <div className=\"mt-2\">\r\n                            <div className=\"w-full bg-gray-200 rounded-full h-2\">\r\n                              <div \r\n                                className=\"bg-yellow-500 h-2 rounded-full transition-all duration-300\"\r\n                                style={{ width: `${status.progress}%` }}\r\n                              ></div>\r\n                            </div>\r\n                            <div className=\"text-xs text-gray-500 mt-1\">\r\n                              Level {status.current}/{status.target}\r\n                            </div>\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                      {status.isUnlocked && (\r\n                        <div className=\"text-yellow-600\">\r\n                          <svg className=\"w-6 h-6\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                            <path fillRule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clipRule=\"evenodd\" />\r\n                          </svg>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                );\r\n              })}\r\n            </div>\r\n          </div>\r\n\r\n          {/* ì•ˆë‚´ ë©”ì‹œì§€ */}\r\n          <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\r\n            <h3 className=\"font-semibold text-blue-800 mb-2\">ğŸ’¡ ì—…ì  ë‹¬ì„± ë°©ë²•</h3>\r\n            <ul className=\"text-sm text-blue-700 space-y-1\">\r\n              <li>â€¢ ê¾¸ì¤€íˆ í•™ìŠµí•˜ë©´ ìë™ìœ¼ë¡œ ì—…ì ì´ ë‹¬ì„±ë©ë‹ˆë‹¤</li>\r\n              <li>â€¢ ìƒˆë¡œìš´ ë°°ì§€ëŠ” ë¹¨ê°„ìƒ‰ NEW! í‘œì‹œë¡œ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤</li>\r\n              <li>â€¢ ì§„í–‰ ì¤‘ì¸ ì—…ì ì€ ì§„í–‰ë¥ ì´ í‘œì‹œë©ë‹ˆë‹¤</li>\r\n              <li>â€¢ ë‹¬ì„±í•œ ì—…ì ì€ ë…¹ìƒ‰/íŒŒë€ìƒ‰/ë…¸ë€ìƒ‰ìœ¼ë¡œ í‘œì‹œë©ë‹ˆë‹¤</li>\r\n            </ul>\r\n          </div>\r\n\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AchievementsPage;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\pages\\AdaptivePackPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useSRSEngine' is defined but never used. Allowed unused vars must match /^_/u.","line":5,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":22},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SpeechRecorder' is defined but never used. Allowed unused vars must match /^_/u.","line":8,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'clearError' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":20,"column":33,"nodeType":null,"messageId":"unusedVar","endLine":20,"endColumn":43},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadData'. Either include it or remove the dependency array.","line":53,"column":6,"nodeType":"ArrayExpression","endLine":53,"endColumn":15,"suggestions":[{"desc":"Update the dependencies array to be: [loadData, user.id]","fix":{"range":[2322,2331],"text":"[loadData, user.id]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'finishPack'. Either include it or remove the dependency array.","line":67,"column":6,"nodeType":"ArrayExpression","endLine":67,"endColumn":45,"suggestions":[{"desc":"Update the dependencies array to be: [currentPack, currentIndex, isStudying, finishPack]","fix":{"range":[2723,2762],"text":"[currentPack, currentIndex, isStudying, finishPack]"}}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":82,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":82,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":110,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":110,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'responseTime' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":144,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":144,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'quality' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":179,"column":16,"nodeType":null,"messageId":"unusedVar","endLine":179,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":198,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":198,"endColumn":19},{"ruleId":"no-undef","severity":1,"message":"'nextCard' is not defined.","line":320,"column":25,"nodeType":"Identifier","messageId":"undef","endLine":320,"endColumn":33}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":11,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useUser, useAppStore, useLearningMode } from '@/store/useAppStore';\r\nimport { adaptivePackService, type AdaptivePack, type LearningAnalytics, type AdaptivePackCard } from '@/services/adaptivePackService';\r\nimport { useSRSEngine } from '@/hooks/useSRSEngine';\r\nimport { WritingModeInput } from '@/components/WritingModeInput';\r\nimport { WritingModeFeedback } from '@/components/WritingModeFeedback';\r\nimport { SpeechRecorder } from '@/components/SpeechRecorder';\r\nimport { AutoSpeakingFlowV2 } from '@/components/AutoSpeakingFlowV2';\r\nimport { FeedbackPanel } from '@/components/FeedbackPanel';\r\nimport { useSpeech } from '@/hooks/useSpeech';\r\nimport { api } from '@/lib/api';\r\nimport type { FeedbackResponse } from '@/types';\r\nimport type { WritingFeedback } from '@/services/writingMode';\r\n\r\nexport const AdaptivePackPage: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const user = useUser();\r\n  const learningMode = useLearningMode();\r\n  const { setLoading, setError, clearError } = useAppStore();\r\n\r\n  // Analytics & Packs\r\n  const [analytics, setAnalytics] = useState<LearningAnalytics | null>(null);\r\n  const [savedPacks, setSavedPacks] = useState<AdaptivePack[]>([]);\r\n  const [currentPack, setCurrentPack] = useState<AdaptivePack | null>(null);\r\n  \r\n  // Study Session\r\n  const [currentIndex, setCurrentIndex] = useState(0);\r\n  const [currentCard, setCurrentCard] = useState<AdaptivePackCard | null>(null);\r\n  const [isStudying, setIsStudying] = useState(false);\r\n  \r\n  // Feedback\r\n  const [speechFeedback, setSpeechFeedback] = useState<FeedbackResponse | null>(null);\r\n  const [writingFeedback, setWritingFeedback] = useState<WritingFeedback | null>(null);\r\n  const [cardStartTime, setCardStartTime] = useState<number>(0);\r\n\r\n  // UI States\r\n  const [showPackGenerator, setShowPackGenerator] = useState(false);\r\n  const [generationOptions, setGenerationOptions] = useState({\r\n    algorithm: 'standard' as 'standard' | 'intensive' | 'review_focused',\r\n    targetSize: 15\r\n  });\r\n\r\n  const speech = useSpeech({\r\n    apiBaseUrl: import.meta.env.VITE_API_BASE_URL,\r\n    preferCloudSTT: false,\r\n    language: 'en-US',\r\n  });\r\n\r\n  // Load data on mount\r\n  useEffect(() => {\r\n    loadData();\r\n  }, [user.id]);\r\n\r\n  // Set current card when pack/index changes\r\n  useEffect(() => {\r\n    if (currentPack && isStudying) {\r\n      if (currentIndex < currentPack.cards.length) {\r\n        setCurrentCard(currentPack.cards[currentIndex]);\r\n        setCardStartTime(Date.now());\r\n        setSpeechFeedback(null);\r\n        setWritingFeedback(null);\r\n      } else {\r\n        finishPack();\r\n      }\r\n    }\r\n  }, [currentPack, currentIndex, isStudying]);\r\n\r\n  const loadData = async () => {\r\n    if (!user.id) return;\r\n\r\n    setLoading(true);\r\n    try {\r\n      // Load analytics and saved packs\r\n      const [analyticsData, packsData] = await Promise.all([\r\n        adaptivePackService.analyzeLearningData(user.id),\r\n        adaptivePackService.getSavedAdaptivePacks(user.id)\r\n      ]);\r\n      \r\n      setAnalytics(analyticsData);\r\n      setSavedPacks(packsData);\r\n    } catch (error) {\r\n      setError('ë°ì´í„° ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const generateNewPack = async () => {\r\n    if (!user.id) return;\r\n\r\n    setLoading(true);\r\n    try {\r\n      const newPack = await adaptivePackService.generateAdaptivePack(\r\n        user.id,\r\n        generationOptions.targetSize,\r\n        generationOptions.algorithm\r\n      );\r\n      \r\n      setSavedPacks([newPack, ...savedPacks]);\r\n      setShowPackGenerator(false);\r\n      setError(''); // Clear any previous errors\r\n      \r\n      // Optionally start the new pack immediately\r\n      if (newPack.cards.length > 0) {\r\n        setCurrentPack(newPack);\r\n        setCurrentIndex(0);\r\n        setIsStudying(true);\r\n      }\r\n    } catch (error) {\r\n      setError('í•™ìŠµíŒ© ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const startPack = (pack: AdaptivePack) => {\r\n    setCurrentPack(pack);\r\n    setCurrentIndex(0);\r\n    setIsStudying(true);\r\n  };\r\n\r\n  const handleSpeechResult = async (transcript: string, confidence: number) => {\r\n    if (!currentCard) return;\r\n\r\n    await processAnswer(transcript, confidence, true);\r\n  };\r\n\r\n  const handleWritingSubmit = async (userInput: string, feedback: WritingFeedback) => {\r\n    if (!currentCard) return;\r\n\r\n    setWritingFeedback(feedback);\r\n    await processAnswer(userInput, feedback.score / 100, false, feedback);\r\n  };\r\n\r\n  const processAnswer = async (\r\n    userAnswer: string,\r\n    confidence: number,\r\n    isSpeaking: boolean,\r\n    writingFeedback?: WritingFeedback\r\n  ) => {\r\n    if (!currentCard) return;\r\n\r\n    const responseTime = (Date.now() - cardStartTime) / 1000;\r\n    setLoading(true);\r\n\r\n    try {\r\n      let isCorrect = false;\r\n      let score = 0;\r\n\r\n      if (isSpeaking) {\r\n        // Speaking mode - use feedback API\r\n        const feedbackResponse = await api.getFeedback({\r\n          front_ko: currentCard.cardData.front_ko,\r\n          sttText: userAnswer,\r\n          target_en: currentCard.cardData.target_en,\r\n        });\r\n\r\n        if (feedbackResponse.success && feedbackResponse.data) {\r\n          setSpeechFeedback(feedbackResponse.data);\r\n          isCorrect = feedbackResponse.data.correct;\r\n          score = feedbackResponse.data.score;\r\n        }\r\n      } else {\r\n        // Writing mode - already processed\r\n        isCorrect = writingFeedback?.isCorrect || false;\r\n        score = writingFeedback?.score || 0;\r\n      }\r\n\r\n      // Update SRS system\r\n      if (currentCard.srsInfo) {\r\n        let quality: 0 | 1 | 2 | 3 | 4 | 5 = 3;\r\n        \r\n        if (!isCorrect) {\r\n          quality = confidence > 0.7 ? 2 : confidence > 0.4 ? 1 : 0;\r\n        } else {\r\n          if (score >= 90) quality = 5;\r\n          else if (score >= 80) quality = 4;\r\n          else quality = 3;\r\n        }\r\n\r\n        // TODO: Migrate to new SRS Engine system\r\n        // const srsEngine = useSRSEngine();\r\n        // await srsEngine.updateCard(currentCard.cardId, {\r\n        //   quality,\r\n        //   responseTime,\r\n        //   isCorrect\r\n        // });\r\n      }\r\n\r\n      // Play TTS if available and answer was incorrect\r\n      if (speech.isTTSAvailable && !isCorrect) {\r\n        setTimeout(() => {\r\n          speech.speak(currentCard!.cardData.target_en);\r\n        }, 1500);\r\n      }\r\n\r\n    } catch (error) {\r\n      setError('ë‹µë³€ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleNextCard = () => {\r\n    setCurrentIndex(currentIndex + 1);\r\n  };\r\n\r\n  const finishPack = () => {\r\n    setIsStudying(false);\r\n    setCurrentPack(null);\r\n    setCurrentCard(null);\r\n    loadData(); // Refresh analytics\r\n    \r\n    navigate('/', {\r\n      state: {\r\n        message: `Adaptive Pack ì™„ë£Œ! ${currentPack?.cards.length}ê°œ ì¹´ë“œë¥¼ í•™ìŠµí–ˆìŠµë‹ˆë‹¤.`\r\n      }\r\n    });\r\n  };\r\n\r\n  const hasAnswer = speechFeedback || writingFeedback;\r\n\r\n  if (isStudying && currentCard) {\r\n    // Study Session UI\r\n    return (\r\n      <div className=\"min-h-screen bg-gray-50\">\r\n        {/* Header */}\r\n        <div className=\"bg-white shadow-sm border-b\">\r\n          <div className=\"max-w-2xl mx-auto px-4 py-3\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <button\r\n                onClick={() => setIsStudying(false)}\r\n                className=\"text-gray-600 hover:text-gray-800\"\r\n              >\r\n                â† ë’¤ë¡œ\r\n              </button>\r\n              <div className=\"text-center\">\r\n                <h1 className=\"text-lg font-semibold\">\r\n                  {currentPack?.title}\r\n                </h1>\r\n                <div className=\"text-sm text-gray-500\">\r\n                  {currentCard.reason === 'wrong_answer' ? 'ğŸ”´ ì˜¤ë‹µ ë³µìŠµ' :\r\n                   currentCard.reason === 'forgetting_curve' ? 'ğŸ“… ë§ê°ê³¡ì„ ' :\r\n                   currentCard.reason === 'weakness_pattern' ? 'ğŸ¯ ì•½ì  ë³´ê°•' :\r\n                   'ğŸ”¥ ë‚œì´ë„ ì¡°ì ˆ'}\r\n                </div>\r\n              </div>\r\n              <div className=\"text-sm text-gray-500\">\r\n                {currentIndex + 1}/{currentPack?.totalCards}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Progress Bar */}\r\n        <div className=\"bg-white border-b\">\r\n          <div className=\"max-w-2xl mx-auto px-4 py-2\">\r\n            <div className=\"bg-gray-200 rounded-full h-2\">\r\n              <div \r\n                className=\"bg-gradient-to-r from-purple-500 to-pink-500 h-2 rounded-full transition-all duration-300\"\r\n                style={{ \r\n                  width: `${((currentIndex + 1) / (currentPack?.totalCards || 1)) * 100}%`\r\n                }}\r\n              />\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Main Content */}\r\n        <div className=\"max-w-2xl mx-auto px-4 py-8\">\r\n          {/* Korean Prompt Card */}\r\n          <div className=\"bg-white rounded-lg shadow-lg p-8 mb-8\">\r\n            <div className=\"text-center\">\r\n              <div className=\"flex items-center justify-center mb-2\">\r\n                <span className=\"text-sm font-medium text-gray-500\">í•œêµ­ì–´ë¥¼ ì˜ì–´ë¡œ</span>\r\n                <span className=\"ml-3 text-xs px-2 py-1 rounded-full bg-purple-100 text-purple-700\">\r\n                  {currentCard.reasonDetail}\r\n                </span>\r\n              </div>\r\n              <p className=\"text-2xl font-bold text-gray-800 mb-6\">\r\n                {currentCard.cardData.front_ko}\r\n              </p>\r\n              \r\n              {/* Expected Answer (shown after feedback) */}\r\n              {hasAnswer && (\r\n                <div className=\"text-sm text-gray-600 bg-gray-50 rounded p-3\">\r\n                  <span className=\"font-medium\">ì •ë‹µ: </span>\r\n                  {currentCard.cardData.target_en}\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Input Section */}\r\n          <div className=\"bg-white rounded-lg shadow-lg p-8 mb-8\">\r\n            <div className=\"text-center\">\r\n              {learningMode.mode === 'writing' ? (\r\n                <WritingModeInput\r\n                  question={{\r\n                    id: currentCard.cardData.id,\r\n                    front_ko: currentCard.cardData.front_ko,\r\n                    target_en: currentCard.cardData.target_en,\r\n                    level: user.level,\r\n                    stage: user.stage,\r\n                    difficulty: currentCard.expectedDifficulty\r\n                  }}\r\n                  onSubmit={handleWritingSubmit}\r\n                  disabled={!!writingFeedback}\r\n                />\r\n              ) : (\r\n                <AutoSpeakingFlowV2\r\n                  currentCard={currentCard.cardData}\r\n                  onSpeechResult={handleSpeechResult}\r\n                  onTimeout={() => {\r\n                    // AutoSpeakingFlowV2ì—ì„œ ì´ë¯¸ ì •ë‹µì„ ì¬ìƒí•˜ë¯€ë¡œ ë°”ë¡œ ë‹¤ìŒ ì¹´ë“œë¡œ\r\n                    console.log('[AdaptivePackPage] Timeout - proceeding to next card');\r\n                    setTimeout(() => {\r\n                      if (currentCard) {\r\n                        nextCard();\r\n                      }\r\n                    }, 100);\r\n                  }}\r\n                  isActive={!speechFeedback}\r\n                  recordingDuration={10}\r\n                />\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Feedback Section */}\r\n          {writingFeedback && (\r\n            <WritingModeFeedback\r\n              feedback={writingFeedback}\r\n              targetAnswer={currentCard.cardData.target_en}\r\n              onPlayAnswer={() => speech.speak(currentCard.cardData.target_en)}\r\n              canPlayAnswer={speech.isTTSAvailable}\r\n            />\r\n          )}\r\n\r\n          {speechFeedback && (\r\n            <FeedbackPanel\r\n              feedback={speechFeedback}\r\n              onPlayAnswer={() => speech.speak(currentCard.cardData.target_en)}\r\n              canPlayAnswer={speech.isTTSAvailable}\r\n            />\r\n          )}\r\n\r\n          {/* Navigation */}\r\n          <div className=\"flex justify-between items-center mt-6\">\r\n            <div className=\"flex space-x-2\">\r\n              {hasAnswer && (\r\n                <button\r\n                  onClick={() => speech.speak(currentCard.cardData.target_en)}\r\n                  disabled={!speech.isTTSAvailable}\r\n                  className=\"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 disabled:bg-gray-300 text-sm\"\r\n                >\r\n                  ğŸ”Š ì •ë‹µ ë“£ê¸°\r\n                </button>\r\n              )}\r\n            </div>\r\n\r\n            {currentIndex < (currentPack?.totalCards || 0) - 1 ? (\r\n              <button\r\n                onClick={handleNextCard}\r\n                disabled={!hasAnswer}\r\n                className=\"px-6 py-3 bg-green-500 text-white rounded-lg disabled:bg-gray-300 disabled:cursor-not-allowed hover:bg-green-600 transition-colors\"\r\n              >\r\n                ë‹¤ìŒ ì¹´ë“œ â†’\r\n              </button>\r\n            ) : (\r\n              <button\r\n                onClick={finishPack}\r\n                disabled={!hasAnswer}\r\n                className=\"px-6 py-3 bg-purple-500 text-white rounded-lg disabled:bg-gray-300 disabled:cursor-not-allowed hover:bg-purple-600 transition-colors\"\r\n              >\r\n                íŒ© ì™„ë£Œ\r\n              </button>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Main Page UI\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-purple-50 to-pink-100 p-4\">\r\n      <div className=\"max-w-6xl mx-auto\">\r\n        {/* Header */}\r\n        <div className=\"text-center mb-8\">\r\n          <button\r\n            onClick={() => navigate('/')}\r\n            className=\"text-gray-600 hover:text-gray-800 mb-4\"\r\n          >\r\n            â† ë’¤ë¡œ\r\n          </button>\r\n          <h1 className=\"text-4xl font-bold text-gray-800 mb-2\">\r\n            ğŸ¯ ê°œì¸ ë§ì¶¤íŒ© (Adaptive)\r\n          </h1>\r\n          <p className=\"text-gray-600 text-lg\">\r\n            AIê°€ ë¶„ì„í•œ ì˜¤ë‹µ + ë§ê°ê³¡ì„  + ì•½ì  íŒ¨í„´ ì™„ì „ ìë™í™”\r\n          </p>\r\n        </div>\r\n\r\n        <div className=\"grid lg:grid-cols-3 gap-6\">\r\n          {/* Analytics Panel */}\r\n          <div className=\"lg:col-span-1\">\r\n            <div className=\"bg-white rounded-2xl shadow-xl p-6 mb-6\">\r\n              <h2 className=\"text-2xl font-bold text-gray-800 mb-4\">\r\n                ğŸ“Š í•™ìŠµ ë¶„ì„\r\n              </h2>\r\n              \r\n              {analytics ? (\r\n                <div className=\"space-y-4\">\r\n                  <div className=\"bg-blue-50 rounded-lg p-4\">\r\n                    <div className=\"text-2xl font-bold text-blue-600\">{analytics.correctRate}%</div>\r\n                    <div className=\"text-sm text-gray-600\">ì „ì²´ ì •ë‹µë¥ </div>\r\n                  </div>\r\n                  \r\n                  <div className=\"bg-green-50 rounded-lg p-4\">\r\n                    <div className=\"text-2xl font-bold text-green-600\">{analytics.totalAnswered}</div>\r\n                    <div className=\"text-sm text-gray-600\">ì´ í•™ìŠµ ì¹´ë“œ</div>\r\n                  </div>\r\n                  \r\n                  <div className=\"bg-purple-50 rounded-lg p-4\">\r\n                    <div className=\"text-2xl font-bold text-purple-600\">{analytics.averageResponseTime}s</div>\r\n                    <div className=\"text-sm text-gray-600\">í‰ê·  ì‘ë‹µ ì‹œê°„</div>\r\n                  </div>\r\n\r\n                  <div className=\"bg-orange-50 rounded-lg p-4\">\r\n                    <div className=\"text-2xl font-bold text-orange-600\">{analytics.identifiedWeaknesses.length}</div>\r\n                    <div className=\"text-sm text-gray-600\">ì‹ë³„ëœ ì•½ì </div>\r\n                  </div>\r\n                </div>\r\n              ) : (\r\n                <div className=\"text-center py-8 text-gray-500\">\r\n                  <p>ë¶„ì„ ë°ì´í„° ë¡œë”© ì¤‘...</p>\r\n                </div>\r\n              )}\r\n\r\n              <button\r\n                onClick={() => setShowPackGenerator(true)}\r\n                className=\"w-full mt-6 bg-gradient-to-r from-purple-600 to-pink-600 text-white py-3 rounded-xl hover:from-purple-700 hover:to-pink-700 transition-all duration-200 font-medium\"\r\n              >\r\n                ğŸš€ ìƒˆ Adaptive Pack ìƒì„±\r\n              </button>\r\n            </div>\r\n\r\n            {/* Learning Insights */}\r\n            {analytics && analytics.identifiedWeaknesses.length > 0 && (\r\n              <div className=\"bg-white rounded-2xl shadow-xl p-6\">\r\n                <h3 className=\"text-lg font-bold text-gray-800 mb-4\">ğŸ” ì•½ì  ë¶„ì„</h3>\r\n                <div className=\"space-y-3\">\r\n                  {analytics.identifiedWeaknesses.map((weakness, index) => (\r\n                    <div key={index} className=\"border-l-4 border-orange-500 bg-orange-50 p-3 rounded-r-lg\">\r\n                      <div className=\"flex items-center justify-between mb-1\">\r\n                        <span className=\"font-medium text-sm\">{weakness.pattern}</span>\r\n                        <span className=\"text-xs bg-orange-200 text-orange-800 px-2 py-1 rounded-full\">\r\n                          Level {weakness.level}\r\n                        </span>\r\n                      </div>\r\n                      <p className=\"text-xs text-gray-600\">{weakness.description}</p>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Saved Packs */}\r\n          <div className=\"lg:col-span-2\">\r\n            <div className=\"bg-white rounded-2xl shadow-xl p-6\">\r\n              <div className=\"flex items-center justify-between mb-6\">\r\n                <h2 className=\"text-2xl font-bold text-gray-800\">ğŸ“¦ ìƒì„±ëœ Adaptive Pack</h2>\r\n                <span className=\"text-sm text-gray-500\">{savedPacks.length}ê°œ</span>\r\n              </div>\r\n\r\n              {savedPacks.length === 0 ? (\r\n                <div className=\"text-center py-16\">\r\n                  <div className=\"text-6xl mb-4\">ğŸ¤–</div>\r\n                  <p className=\"text-xl font-medium text-gray-700 mb-2\">ì•„ì§ Adaptive Packì´ ì—†ìŠµë‹ˆë‹¤</p>\r\n                  <p className=\"text-gray-500 mb-6\">AIê°€ ì˜¤ë‹µ, ë§ê°ê³¡ì„ , ì•½ì  íŒ¨í„´ì„ ë¶„ì„í•´ì„œ ë§ì¶¤í˜• í•™ìŠµíŒ©ì„ ë§Œë“¤ì–´ë“œë¦½ë‹ˆë‹¤</p>\r\n                  <button\r\n                    onClick={() => setShowPackGenerator(true)}\r\n                    className=\"bg-gradient-to-r from-purple-600 to-pink-600 text-white px-6 py-3 rounded-xl hover:from-purple-700 hover:to-pink-700 transition-all duration-200 font-medium\"\r\n                  >\r\n                    ì²« ë²ˆì§¸ Adaptive Pack ìƒì„±\r\n                  </button>\r\n                </div>\r\n              ) : (\r\n                <div className=\"grid md:grid-cols-2 gap-4\">\r\n                  {savedPacks.map((pack) => (\r\n                    <div\r\n                      key={pack.id}\r\n                      className=\"border rounded-xl p-4 hover:shadow-lg transition-shadow cursor-pointer bg-gradient-to-br from-white to-purple-50\"\r\n                      onClick={() => startPack(pack)}\r\n                    >\r\n                      <div className=\"flex items-start justify-between mb-3\">\r\n                        <h3 className=\"font-bold text-gray-800 text-lg leading-tight\">\r\n                          {pack.title}\r\n                        </h3>\r\n                        <span className=\"px-2 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-700\">\r\n                          {pack.algorithm}\r\n                        </span>\r\n                      </div>\r\n                      \r\n                      <p className=\"text-sm text-gray-600 mb-3\">{pack.description}</p>\r\n                      \r\n                      <div className=\"flex items-center justify-between text-sm text-gray-500 mb-3\">\r\n                        <span>ğŸ“ {pack.totalCards}ì¹´ë“œ</span>\r\n                        <span>â±ï¸ ~{pack.estimatedTime}ë¶„</span>\r\n                      </div>\r\n\r\n                      {/* Pack Composition */}\r\n                      <div className=\"flex flex-wrap gap-1 mb-3\">\r\n                        {pack.cards.filter(c => c.reason === 'wrong_answer').length > 0 && (\r\n                          <span className=\"text-xs bg-red-100 text-red-700 px-2 py-1 rounded-full\">\r\n                            ğŸ”´ ì˜¤ë‹µ {pack.cards.filter(c => c.reason === 'wrong_answer').length}\r\n                          </span>\r\n                        )}\r\n                        {pack.cards.filter(c => c.reason === 'forgetting_curve').length > 0 && (\r\n                          <span className=\"text-xs bg-orange-100 text-orange-700 px-2 py-1 rounded-full\">\r\n                            ğŸ“… ë§ê° {pack.cards.filter(c => c.reason === 'forgetting_curve').length}\r\n                          </span>\r\n                        )}\r\n                        {pack.cards.filter(c => c.reason === 'weakness_pattern').length > 0 && (\r\n                          <span className=\"text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded-full\">\r\n                            ğŸ¯ ì•½ì  {pack.cards.filter(c => c.reason === 'weakness_pattern').length}\r\n                          </span>\r\n                        )}\r\n                      </div>\r\n\r\n                      {/* Learning Objectives */}\r\n                      <div className=\"text-xs text-gray-600\">\r\n                        <strong>ëª©í‘œ:</strong> {pack.learningObjectives.slice(0, 2).join(', ')}\r\n                        {pack.learningObjectives.length > 2 && '...'}\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Pack Generator Modal */}\r\n        {showPackGenerator && (\r\n          <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\">\r\n            <div className=\"bg-white rounded-2xl shadow-2xl max-w-lg w-full\">\r\n              <div className=\"p-6\">\r\n                <div className=\"flex items-center justify-between mb-6\">\r\n                  <h3 className=\"text-2xl font-bold text-gray-800\">ğŸš€ Adaptive Pack ìƒì„±</h3>\r\n                  <button\r\n                    onClick={() => setShowPackGenerator(false)}\r\n                    className=\"text-gray-400 hover:text-gray-600 text-2xl\"\r\n                  >\r\n                    Ã—\r\n                  </button>\r\n                </div>\r\n\r\n                <div className=\"space-y-4 mb-6\">\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-2\">ì•Œê³ ë¦¬ì¦˜</label>\r\n                    <select\r\n                      value={generationOptions.algorithm}\r\n                      onChange={(e) => setGenerationOptions({\r\n                        ...generationOptions, \r\n                        algorithm: e.target.value as any\r\n                      })}\r\n                      className=\"w-full p-3 border border-gray-300 rounded-lg\"\r\n                    >\r\n                      <option value=\"standard\">í‘œì¤€ (ê· í˜•ì¡íŒ í•™ìŠµ)</option>\r\n                      <option value=\"intensive\">ì§‘ì¤‘ (ì˜¤ë‹µ ìœ„ì£¼)</option>\r\n                      <option value=\"review_focused\">ë³µìŠµ ì¤‘ì‹¬ (ë§ê°ê³¡ì„  ìš°ì„ )</option>\r\n                    </select>\r\n                  </div>\r\n                  \r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-2\">ì¹´ë“œ ìˆ˜</label>\r\n                    <select\r\n                      value={generationOptions.targetSize}\r\n                      onChange={(e) => setGenerationOptions({\r\n                        ...generationOptions, \r\n                        targetSize: parseInt(e.target.value)\r\n                      })}\r\n                      className=\"w-full p-3 border border-gray-300 rounded-lg\"\r\n                    >\r\n                      <option value={10}>10ê°œ (ë¹ ë¥¸ í•™ìŠµ)</option>\r\n                      <option value={15}>15ê°œ (í‘œì¤€)</option>\r\n                      <option value={20}>20ê°œ (ì‹¬í™”)</option>\r\n                      <option value={30}>30ê°œ (ì§‘ì¤‘)</option>\r\n                    </select>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6\">\r\n                  <h4 className=\"font-semibold text-blue-900 mb-2\">ğŸ¤– AI ë¶„ì„ ê¸°ë°˜</h4>\r\n                  <ul className=\"text-sm text-blue-800 space-y-1\">\r\n                    <li>â€¢ ì˜¤ë‹µë¥ ê³¼ ë§ê°ê³¡ì„  ë°ì´í„° ì¢…í•© ë¶„ì„</li>\r\n                    <li>â€¢ ê°œì¸ë³„ ì•½ì  íŒ¨í„´ ìë™ ì‹ë³„</li>\r\n                    <li>â€¢ ìµœì  í•™ìŠµ ìˆœì„œì™€ ë‚œì´ë„ ì¡°ì •</li>\r\n                    <li>â€¢ SuperMemo SM-2 ì•Œê³ ë¦¬ì¦˜ ì ìš©</li>\r\n                  </ul>\r\n                </div>\r\n\r\n                <div className=\"flex gap-3\">\r\n                  <button\r\n                    onClick={() => setShowPackGenerator(false)}\r\n                    className=\"flex-1 py-3 px-4 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 font-medium\"\r\n                  >\r\n                    ì·¨ì†Œ\r\n                  </button>\r\n                  <button\r\n                    onClick={generateNewPack}\r\n                    disabled={!analytics || analytics.totalAnswered < 5}\r\n                    className=\"flex-1 py-3 px-4 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-xl hover:from-purple-700 hover:to-pink-700 disabled:opacity-50 disabled:cursor-not-allowed font-medium\"\r\n                  >\r\n                    ìƒì„±í•˜ê¸°\r\n                  </button>\r\n                </div>\r\n                \r\n                {(!analytics || analytics.totalAnswered < 5) && (\r\n                  <p className=\"text-xs text-gray-500 mt-2 text-center\">\r\n                    ìµœì†Œ 5ê°œ ì´ìƒì˜ ì¹´ë“œë¥¼ í•™ìŠµí•œ í›„ ìƒì„± ê°€ëŠ¥í•©ë‹ˆë‹¤\r\n                  </p>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\pages\\AllModePage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useMemo' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":38,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":45},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useCallback' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":47,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":58},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useSRSEngine' is defined but never used. Allowed unused vars must match /^_/u.","line":6,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":22},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SpeechRecorder' is defined but never used. Allowed unused vars must match /^_/u.","line":10,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":24},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadSRSStats'. Either include it or remove the dependency array.","line":63,"column":6,"nodeType":"ArrayExpression","endLine":63,"endColumn":15,"suggestions":[{"desc":"Update the dependencies array to be: [loadSRSStats, user.id]","fix":{"range":[2788,2797],"text":"[loadSRSStats, user.id]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadCurrentCard'. Either include it or remove the dependency array.","line":70,"column":6,"nodeType":"ArrayExpression","endLine":70,"endColumn":52,"suggestions":[{"desc":"Update the dependencies array to be: [reviewSession, currentIndex, isSessionActive, loadCurrentCard]","fix":{"range":[2962,3008],"text":"[reviewSession, currentIndex, isSessionActive, loadCurrentCard]"}}]},{"ruleId":"no-undef","severity":1,"message":"'stats' is not defined.","line":78,"column":19,"nodeType":"Identifier","messageId":"undef","endLine":78,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":106,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":106,"endColumn":19},{"ruleId":"no-undef","severity":1,"message":"'srsService' is not defined.","line":122,"column":25,"nodeType":"Identifier","messageId":"undef","endLine":122,"endColumn":35},{"ruleId":"no-undef","severity":1,"message":"'srsService' is not defined.","line":125,"column":35,"nodeType":"Identifier","messageId":"undef","endLine":125,"endColumn":45},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":145,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":145,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":183,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":183,"endColumn":19},{"ruleId":"no-undef","severity":1,"message":"'srsService' is not defined.","line":276,"column":11,"nodeType":"Identifier","messageId":"undef","endLine":276,"endColumn":21},{"ruleId":"no-undef","severity":1,"message":"'nextCard' is not defined.","line":498,"column":25,"nodeType":"Identifier","messageId":"undef","endLine":498,"endColumn":33}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":14,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useMemo, useCallback } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useUser, useAppStore, useLearningMode } from '@/store/useAppStore';\r\n// import { srsService, type SRSCard, type SRSReviewSession } from '@/services/srsService';\r\n// TODO: Migrate to new SRS Engine system - useSRSEngine hook from @/hooks/useSRSEngine\r\nimport { useSRSEngine } from '@/hooks/useSRSEngine';\r\nimport type { ReviewCard } from '@/services/srs/SRSEngine';\r\nimport { WritingModeInput } from '@/components/WritingModeInput';\r\nimport { WritingModeFeedback } from '@/components/WritingModeFeedback';\r\nimport { SpeechRecorder } from '@/components/SpeechRecorder';\r\nimport { AutoSpeakingFlowV2 } from '@/components/AutoSpeakingFlowV2';\r\nimport { FeedbackPanel } from '@/components/FeedbackPanel';\r\nimport { useSpeech } from '@/hooks/useSpeech';\r\nimport { api } from '@/lib/api';\r\nimport { getServiceContainer } from '@/container/ServiceContainer';\r\nimport type { IScoreCalculationService } from '@/container/ServiceContainer';\r\nimport type { DrillCard, FeedbackResponse } from '@/types';\r\nimport type { WritingFeedback } from '@/services/writingMode';\r\n\r\nexport const AllModePage: React.FC = React.memo(() => {\r\n  const navigate = useNavigate();\r\n  const user = useUser();\r\n  const learningMode = useLearningMode();\r\n  const { setLoading, setError, clearError } = useAppStore();\r\n\r\n  // SRS ê´€ë ¨ ìƒíƒœ\r\n  // const [reviewSession, setReviewSession] = useState<SRSReviewSession | null>(null);\r\n  // const [currentSRSCard, setCurrentSRSCard] = useState<SRSCard | null>(null);\r\n  const [reviewSession, setReviewSession] = useState<any | null>(null);\r\n  const [currentSRSCard, setCurrentSRSCard] = useState<ReviewCard | null>(null);\r\n  const [currentCardData, setCurrentCardData] = useState<DrillCard | null>(null);\r\n  const [currentIndex, setCurrentIndex] = useState(0);\r\n\r\n  // í”¼ë“œë°± ìƒíƒœ\r\n  const [speechFeedback, setSpeechFeedback] = useState<FeedbackResponse | null>(null);\r\n  const [writingFeedback, setWritingFeedback] = useState<WritingFeedback | null>(null);\r\n\r\n  // SRS í†µê³„\r\n  const [srsStats, setSrsStats] = useState({\r\n    totalCards: 0,\r\n    dueToday: 0,\r\n    averageEaseFactor: 2.5,\r\n    accuracyRate: 0,\r\n    streakDays: 0\r\n  });\r\n\r\n  const [cardStartTime, setCardStartTime] = useState<number>(0);\r\n  const [isSessionActive, setIsSessionActive] = useState(false);\r\n\r\n  // ì„œë¹„ìŠ¤ ì»¨í…Œì´ë„ˆì—ì„œ ì˜ì¡´ì„± ì£¼ì…\r\n  const serviceContainer = getServiceContainer();\r\n  const scoreCalculator: IScoreCalculationService = serviceContainer.getScoreCalculationService();\r\n  \r\n  const speech = useSpeech({\r\n    apiBaseUrl: import.meta.env.VITE_API_BASE_URL,\r\n    preferCloudSTT: false,\r\n    language: 'en-US',\r\n  });\r\n\r\n  // SRS í†µê³„ ë¡œë“œ\r\n  useEffect(() => {\r\n    loadSRSStats();\r\n  }, [user.id]);\r\n\r\n  // ë³µìŠµ ì„¸ì…˜ ì‹œì‘\r\n  useEffect(() => {\r\n    if (isSessionActive && reviewSession && reviewSession.reviewCards.length > 0) {\r\n      loadCurrentCard();\r\n    }\r\n  }, [reviewSession, currentIndex, isSessionActive]);\r\n\r\n  const loadSRSStats = async () => {\r\n    if (!user.id) return;\r\n    \r\n    try {\r\n      // const stats = await srsService.getSRSStats(user.id);\r\n      // TODO: Migrate to new SRS Engine system\r\n      setSrsStats(stats);\r\n    } catch (error) {\r\n      console.error('SRS í†µê³„ ë¡œë“œ ì‹¤íŒ¨:', error);\r\n    }\r\n  };\r\n\r\n  const loadCurrentCard = async () => {\r\n    if (!reviewSession || currentIndex >= reviewSession.reviewCards.length) return;\r\n\r\n    const srsCard = reviewSession.reviewCards[currentIndex];\r\n    setCurrentSRSCard(srsCard);\r\n\r\n    try {\r\n      // ì‹¤ì œ ì¹´ë“œ ë°ì´í„° ë¡œë“œ (ë ˆë²¨/ìŠ¤í…Œì´ì§€ì—ì„œ)\r\n      const response = await api.getCards(srsCard.level, srsCard.stage);\r\n      \r\n      if (response.success && response.data) {\r\n        // cardIdë¡œ íŠ¹ì • ì¹´ë“œ ì°¾ê¸°\r\n        const foundCard = response.data.cards.find(card => card.id === srsCard.cardId);\r\n        if (foundCard) {\r\n          setCurrentCardData(foundCard);\r\n          setCardStartTime(Date.now());\r\n        } else {\r\n          setError('ì¹´ë“œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');\r\n        }\r\n      } else {\r\n        setError(response.error || 'ì¹´ë“œë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');\r\n      }\r\n    } catch (error) {\r\n      setError('ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤');\r\n    }\r\n  };\r\n\r\n  const startReviewSession = async (mode: 'due' | 'random') => {\r\n    if (!user.id) return;\r\n\r\n    setLoading(true);\r\n    clearError();\r\n\r\n    try {\r\n      let session: any; // TODO: Use new SRS Engine types\r\n      \r\n      if (mode === 'due') {\r\n        // ë³µìŠµì´ í•„ìš”í•œ ì¹´ë“œë“¤\r\n        session = await srsService.startReviewSession(user.id, 20);\r\n      } else {\r\n        // ê°€ì¤‘ì¹˜ ëœë¤ ì„ íƒ\r\n        const randomCards = await srsService.getWeightedRandomCards(user.id, 20);\r\n        session = {\r\n          sessionId: `random_${Date.now()}`,\r\n          userId: user.id,\r\n          reviewCards: randomCards,\r\n          startTime: new Date(),\r\n          totalCards: randomCards.length,\r\n          completedCards: 0,\r\n          accuracyRate: 0\r\n        };\r\n      }\r\n\r\n      if (session.reviewCards.length === 0) {\r\n        setError('ë³µìŠµí•  ì¹´ë“œê°€ ì—†ìŠµë‹ˆë‹¤');\r\n        return;\r\n      }\r\n\r\n      setReviewSession(session);\r\n      setCurrentIndex(0);\r\n      setIsSessionActive(true);\r\n    } catch (error) {\r\n      setError('ì„¸ì…˜ ì‹œì‘ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleSpeechResult = async (transcript: string, confidence: number) => {\r\n    if (!currentCardData || !currentSRSCard) return;\r\n\r\n    await processAnswer(transcript, confidence, true);\r\n  };\r\n\r\n  const handleWritingSubmit = async (userInput: string, feedback: WritingFeedback) => {\r\n    if (!currentCardData || !currentSRSCard) return;\r\n\r\n    setWritingFeedback(feedback);\r\n    await processAnswer(userInput, feedback.score / 100, false, feedback);\r\n  };\r\n\r\n  const processAnswer = async (\r\n    userAnswer: string, \r\n    confidence: number, \r\n    isSpeaking: boolean,\r\n    writingFeedback?: WritingFeedback\r\n  ) => {\r\n    if (!validateAnswerProcessing()) return;\r\n\r\n    const responseTime = calculateResponseTime();\r\n    setLoading(true);\r\n\r\n    try {\r\n      const evaluationResult = await evaluateUserAnswer(userAnswer, isSpeaking, writingFeedback);\r\n      \r\n      if (evaluationResult) {\r\n        await updateSRSRecord(evaluationResult, responseTime);\r\n      }\r\n\r\n    } catch (error) {\r\n      handleAnswerProcessingError();\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  /**\r\n   * ë‹µë³€ ì²˜ë¦¬ ì „ ê²€ì¦\r\n   */\r\n  const validateAnswerProcessing = (): boolean => {\r\n    return !!(currentCardData && currentSRSCard);\r\n  };\r\n\r\n  /**\r\n   * ì‘ë‹µ ì‹œê°„ ê³„ì‚°\r\n   */\r\n  const calculateResponseTime = (): number => {\r\n    return (Date.now() - cardStartTime) / 1000;\r\n  };\r\n\r\n  /**\r\n   * ì‚¬ìš©ì ë‹µë³€ í‰ê°€\r\n   */\r\n  const evaluateUserAnswer = async (\r\n    userAnswer: string,\r\n    isSpeaking: boolean,\r\n    writingFeedback?: WritingFeedback\r\n  ): Promise<{ isCorrect: boolean; score: number; confidence: number; responseTime: number } | null> => {\r\n    let isCorrect = false;\r\n    let score = 0;\r\n    const responseTime = calculateResponseTime();\r\n\r\n    if (isSpeaking) {\r\n      const speakingResult = await evaluateSpeakingAnswer(userAnswer);\r\n      if (!speakingResult) return null;\r\n      \r\n      isCorrect = speakingResult.isCorrect;\r\n      score = speakingResult.score;\r\n    } else {\r\n      const writingResult = evaluateWritingAnswer(writingFeedback);\r\n      isCorrect = writingResult.isCorrect;\r\n      score = writingResult.score;\r\n    }\r\n\r\n    return { isCorrect, score, confidence: Math.max(0.6, score / 100), responseTime };\r\n  };\r\n\r\n  /**\r\n   * ë§í•˜ê¸° ë‹µë³€ í‰ê°€\r\n   */\r\n  const evaluateSpeakingAnswer = async (userAnswer: string): Promise<{ isCorrect: boolean; score: number } | null> => {\r\n    if (!currentCardData) return null;\r\n\r\n    const feedbackResponse = await api.getFeedback({\r\n      front_ko: currentCardData.front_ko,\r\n      sttText: userAnswer,\r\n      target_en: currentCardData.target_en,\r\n    });\r\n\r\n    if (feedbackResponse.success && feedbackResponse.data) {\r\n      setSpeechFeedback(feedbackResponse.data);\r\n      return {\r\n        isCorrect: feedbackResponse.data.correct,\r\n        score: feedbackResponse.data.score\r\n      };\r\n    }\r\n\r\n    return null;\r\n  };\r\n\r\n  /**\r\n   * ì“°ê¸° ë‹µë³€ í‰ê°€\r\n   */\r\n  const evaluateWritingAnswer = (writingFeedback?: WritingFeedback): { isCorrect: boolean; score: number } => {\r\n    return {\r\n      isCorrect: writingFeedback?.isCorrect || false,\r\n      score: writingFeedback?.score || 0\r\n    };\r\n  };\r\n\r\n  /**\r\n   * SRS ë ˆì½”ë“œ ì—…ë°ì´íŠ¸\r\n   */\r\n  const updateSRSRecord = async (\r\n    evaluationResult: { isCorrect: boolean; score: number; confidence: number; responseTime: number }\r\n  ): Promise<void> => {\r\n    if (!currentSRSCard) return;\r\n\r\n    const qualityResult = calculateLearningQuality(evaluationResult);\r\n    \r\n    console.log('[AllModePage] Quality calculation result:', qualityResult);\r\n\r\n    await srsService.updateCardAfterReview(user.id, currentSRSCard.cardId, {\r\n      quality: qualityResult.quality,\r\n      responseTime: evaluationResult.responseTime,\r\n      isCorrect: evaluationResult.isCorrect\r\n    });\r\n  };\r\n\r\n  /**\r\n   * í•™ìŠµ í’ˆì§ˆ ì ìˆ˜ ê³„ì‚°\r\n   */\r\n  const calculateLearningQuality = (evaluationResult: { isCorrect: boolean; score: number; confidence: number; responseTime: number }) => {\r\n    return scoreCalculator.calculateQuality({\r\n      isCorrect: evaluationResult.isCorrect,\r\n      confidence: evaluationResult.confidence,\r\n      score: evaluationResult.score,\r\n      responseTime: evaluationResult.responseTime\r\n    });\r\n  };\r\n\r\n  /**\r\n   * ë‹µë³€ ì²˜ë¦¬ ì—ëŸ¬ ì²˜ë¦¬\r\n   */\r\n  const handleAnswerProcessingError = (): void => {\r\n    setError('ë‹µë³€ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤');\r\n  };\r\n\r\n  const handleNextCard = () => {\r\n    const nextIndex = currentIndex + 1;\r\n    \r\n    if (nextIndex < reviewSession!.reviewCards.length) {\r\n      setCurrentIndex(nextIndex);\r\n      setSpeechFeedback(null);\r\n      setWritingFeedback(null);\r\n    } else {\r\n      finishSession();\r\n    }\r\n  };\r\n\r\n  const finishSession = async () => {\r\n    // ì„¸ì…˜ ì™„ë£Œ ì²˜ë¦¬\r\n    await loadSRSStats(); // í†µê³„ ì—…ë°ì´íŠ¸\r\n    navigate('/', { \r\n      state: { \r\n        message: `ALL ëª¨ë“œ ì™„ë£Œ! ${reviewSession?.totalCards}ê°œ ì¹´ë“œë¥¼ ë³µìŠµí–ˆìŠµë‹ˆë‹¤.`\r\n      }\r\n    });\r\n  };\r\n\r\n  const hasAnswer = speechFeedback || writingFeedback;\r\n\r\n  if (!isSessionActive) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gradient-to-br from-purple-50 to-indigo-100 p-4\">\r\n        <div className=\"max-w-2xl mx-auto\">\r\n          {/* Header */}\r\n          <div className=\"bg-white rounded-lg shadow-lg p-6 mb-6\">\r\n            <div className=\"flex items-center justify-between mb-4\">\r\n              <button\r\n                onClick={() => navigate('/')}\r\n                className=\"text-gray-600 hover:text-gray-800\"\r\n              >\r\n                â† ë’¤ë¡œ\r\n              </button>\r\n              <h1 className=\"text-2xl font-bold text-center\">\r\n                ğŸ”„ ALL ëª¨ë“œ (ë§ê°ê³¡ì„  ë³µìŠµ)\r\n              </h1>\r\n              <div className=\"w-8\"></div>\r\n            </div>\r\n            \r\n            <p className=\"text-gray-600 text-center\">\r\n              SRS ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ ìµœì í™”ëœ ë³µìŠµ ì‹œìŠ¤í…œ\r\n            </p>\r\n          </div>\r\n\r\n          {/* SRS í†µê³„ */}\r\n          <div className=\"bg-white rounded-lg shadow-lg p-6 mb-6\">\r\n            <h2 className=\"text-xl font-bold mb-4\">ğŸ“Š ë³µìŠµ í˜„í™©</h2>\r\n            \r\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\r\n              <div className=\"bg-blue-50 rounded-lg p-4 text-center\">\r\n                <div className=\"text-2xl font-bold text-blue-600\">{srsStats.totalCards}</div>\r\n                <div className=\"text-sm text-gray-600\">ì „ì²´ ì¹´ë“œ</div>\r\n              </div>\r\n              \r\n              <div className=\"bg-red-50 rounded-lg p-4 text-center\">\r\n                <div className=\"text-2xl font-bold text-red-600\">{srsStats.dueToday}</div>\r\n                <div className=\"text-sm text-gray-600\">ì˜¤ëŠ˜ ë³µìŠµ</div>\r\n              </div>\r\n              \r\n              <div className=\"bg-green-50 rounded-lg p-4 text-center\">\r\n                <div className=\"text-2xl font-bold text-green-600\">{srsStats.accuracyRate}%</div>\r\n                <div className=\"text-sm text-gray-600\">ì •ë‹µë¥ </div>\r\n              </div>\r\n              \r\n              <div className=\"bg-purple-50 rounded-lg p-4 text-center\">\r\n                <div className=\"text-2xl font-bold text-purple-600\">{srsStats.averageEaseFactor}</div>\r\n                <div className=\"text-sm text-gray-600\">í‰ê·  ë‚œì´ë„</div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* í•™ìŠµ ëª¨ë“œ ì„ íƒ */}\r\n          <div className=\"space-y-4\">\r\n            <button\r\n              onClick={() => startReviewSession('due')}\r\n              disabled={srsStats.dueToday === 0}\r\n              className=\"w-full bg-gradient-to-r from-red-500 to-orange-500 hover:from-red-600 hover:to-orange-600 disabled:from-gray-300 disabled:to-gray-400 text-white font-bold py-4 px-6 rounded-lg transition-all duration-200\"\r\n            >\r\n              ğŸ“… ì˜¤ëŠ˜ ë³µìŠµí•  ì¹´ë“œ ({srsStats.dueToday}ê°œ)\r\n            </button>\r\n\r\n            <button\r\n              onClick={() => startReviewSession('random')}\r\n              disabled={srsStats.totalCards === 0}\r\n              className=\"w-full bg-gradient-to-r from-purple-500 to-indigo-500 hover:from-purple-600 hover:to-indigo-600 disabled:from-gray-300 disabled:to-gray-400 text-white font-bold py-4 px-6 rounded-lg transition-all duration-200\"\r\n            >\r\n              ğŸ² ê°€ì¤‘ì¹˜ ëœë¤ ë³µìŠµ (20ê°œ)\r\n            </button>\r\n\r\n            <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\r\n              <h3 className=\"font-semibold text-blue-900 mb-2\">ğŸ’¡ ALL ëª¨ë“œ íŠ¹ì§•</h3>\r\n              <ul className=\"text-sm text-blue-800 space-y-1\">\r\n                <li>â€¢ <strong>ë§ê°ê³¡ì„  ê¸°ë°˜:</strong> SuperMemo SM-2 ì•Œê³ ë¦¬ì¦˜ ì‚¬ìš©</li>\r\n                <li>â€¢ <strong>ê°œì¸ ë§ì¶¤:</strong> í‹€ë¦° ë¬¸ì œëŠ” ë” ìì£¼, ë§íŒ ë¬¸ì œëŠ” ê°„ê²© ì¦ê°€</li>\r\n                <li>â€¢ <strong>ê°€ì¤‘ì¹˜ ì‹œìŠ¤í…œ:</strong> ì˜¤ë‹µë¥ ê³¼ ë§ˆì§€ë§‰ í•™ìŠµì¼ì„ ê³ ë ¤í•œ ì„ íƒ</li>\r\n                <li>â€¢ <strong>ëª¨ë“œ ì—°ë™:</strong> {learningMode.mode === 'writing' ? 'âœï¸ Writing' : 'ğŸ¤ Speaking'} ëª¨ë“œë¡œ í•™ìŠµ</li>\r\n              </ul>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // í•™ìŠµ ì„¸ì…˜ ì¤‘ì¸ ê²½ìš°\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50\">\r\n      {/* Header */}\r\n      <div className=\"bg-white shadow-sm border-b\">\r\n        <div className=\"max-w-2xl mx-auto px-4 py-3\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <button\r\n              onClick={() => navigate('/')}\r\n              className=\"text-gray-600 hover:text-gray-800\"\r\n            >\r\n              â† ë’¤ë¡œ\r\n            </button>\r\n            <div className=\"text-center\">\r\n              <h1 className=\"text-lg font-semibold\">\r\n                ALL ëª¨ë“œ ë³µìŠµ\r\n              </h1>\r\n              <div className=\"text-sm text-gray-500\">\r\n                Level {currentSRSCard?.level}.{currentSRSCard?.stage}\r\n              </div>\r\n            </div>\r\n            <div className=\"text-sm text-gray-500\">\r\n              {currentIndex + 1}/{reviewSession?.totalCards}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Progress Bar */}\r\n      <div className=\"bg-white border-b\">\r\n        <div className=\"max-w-2xl mx-auto px-4 py-2\">\r\n          <div className=\"bg-gray-200 rounded-full h-2\">\r\n            <div \r\n              className=\"bg-purple-500 h-2 rounded-full transition-all duration-300\"\r\n              style={{ \r\n                width: `${((currentIndex + 1) / (reviewSession?.totalCards || 1)) * 100}%`\r\n              }}\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Main Content */}\r\n      {currentCardData && (\r\n        <div className=\"max-w-2xl mx-auto px-4 py-8\">\r\n          {/* Korean Prompt Card */}\r\n          <div className=\"bg-white rounded-lg shadow-lg p-8 mb-8\">\r\n            <div className=\"text-center\">\r\n              <h2 className=\"text-sm font-medium text-gray-500 mb-2\">í•œêµ­ì–´ë¥¼ ì˜ì–´ë¡œ</h2>\r\n              <p className=\"text-2xl font-bold text-gray-800 mb-6\">\r\n                {currentCardData.front_ko}\r\n              </p>\r\n              \r\n              {/* Expected Answer (shown after feedback) */}\r\n              {hasAnswer && (\r\n                <div className=\"text-sm text-gray-600 bg-gray-50 rounded p-3\">\r\n                  <span className=\"font-medium\">ì •ë‹µ: </span>\r\n                  {currentCardData.target_en}\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Input Section */}\r\n          <div className=\"bg-white rounded-lg shadow-lg p-8 mb-8\">\r\n            <div className=\"text-center\">\r\n              {learningMode.mode === 'writing' ? (\r\n                <WritingModeInput\r\n                  question={{\r\n                    id: currentCardData.id,\r\n                    front_ko: currentCardData.front_ko,\r\n                    target_en: currentCardData.target_en,\r\n                    level: currentSRSCard?.level || 1,\r\n                    stage: currentSRSCard?.stage || 1,\r\n                    difficulty: currentSRSCard?.difficulty || 'medium'\r\n                  }}\r\n                  onSubmit={handleWritingSubmit}\r\n                  disabled={!!writingFeedback}\r\n                />\r\n              ) : (\r\n                <AutoSpeakingFlowV2\r\n                  currentCard={currentCardData}\r\n                  onSpeechResult={handleSpeechResult}\r\n                  onTimeout={() => {\r\n                    // AutoSpeakingFlowV2ì—ì„œ ì´ë¯¸ ì •ë‹µì„ ì¬ìƒí•˜ë¯€ë¡œ ë°”ë¡œ ë‹¤ìŒ ì¹´ë“œë¡œ\r\n                    console.log('[AllModePage] Timeout - proceeding to next card');\r\n                    setTimeout(() => {\r\n                      if (currentSRSCard) {\r\n                        nextCard();\r\n                      }\r\n                    }, 100);\r\n                  }}\r\n                  isActive={!speechFeedback}\r\n                  recordingDuration={10}\r\n                />\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Feedback Section */}\r\n          {writingFeedback && (\r\n            <WritingModeFeedback\r\n              feedback={writingFeedback}\r\n              targetAnswer={currentCardData.target_en}\r\n              onPlayAnswer={() => speech.speak(currentCardData.target_en)}\r\n              canPlayAnswer={speech.isTTSAvailable}\r\n            />\r\n          )}\r\n\r\n          {speechFeedback && (\r\n            <FeedbackPanel\r\n              feedback={speechFeedback}\r\n              onPlayAnswer={() => speech.speak(currentCardData.target_en)}\r\n              canPlayAnswer={speech.isTTSAvailable}\r\n            />\r\n          )}\r\n\r\n          {/* Navigation */}\r\n          <div className=\"flex justify-between items-center mt-6\">\r\n            <div className=\"flex space-x-2\">\r\n              {hasAnswer && (\r\n                <button\r\n                  onClick={() => speech.speak(currentCardData.target_en)}\r\n                  disabled={!speech.isTTSAvailable}\r\n                  className=\"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 disabled:bg-gray-300 text-sm\"\r\n                >\r\n                  ğŸ”Š ì •ë‹µ ë“£ê¸°\r\n                </button>\r\n              )}\r\n            </div>\r\n\r\n            {currentIndex < (reviewSession?.totalCards || 0) - 1 ? (\r\n              <button\r\n                onClick={handleNextCard}\r\n                disabled={!hasAnswer}\r\n                className=\"px-6 py-3 bg-green-500 text-white rounded-lg disabled:bg-gray-300 disabled:cursor-not-allowed hover:bg-green-600 transition-colors\"\r\n              >\r\n                ë‹¤ìŒ ì¹´ë“œ â†’\r\n              </button>\r\n            ) : (\r\n              <button\r\n                onClick={finishSession}\r\n                disabled={!hasAnswer}\r\n                className=\"px-6 py-3 bg-purple-500 text-white rounded-lg disabled:bg-gray-300 disabled:cursor-not-allowed hover:bg-purple-600 transition-colors\"\r\n              >\r\n                ë³µìŠµ ì™„ë£Œ\r\n              </button>\r\n            )}\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n});","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\pages\\AudioV2TestPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\pages\\CurriculumLintPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\pages\\CurriculumTestPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\pages\\DashboardHome.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useAppStore' is defined but never used. Allowed unused vars must match /^_/u.","line":3,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'themeMode' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":17,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":17,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setThemeMode' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":17,"column":22,"nodeType":null,"messageId":"unusedVar","endLine":17,"endColumn":34},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'metrics' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":29,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":29,"endColumn":12},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'levelProgress' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":30,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":30,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'refreshStats' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":34,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":34,"endColumn":26},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'level' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":696,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":696,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'stageData' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":698,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":698,"endColumn":20}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect, useState, useCallback, useMemo, memo } from 'react';\nimport { useNavigate, useSearchParams } from 'react-router-dom';\nimport { useAppStore, useUser, useTheme, useSpeakingStage, useStageProgress } from '@/store/useAppStore';\nimport { useStatistics } from '@/hooks/useStatistics';\nimport { useThemedInlineStyles } from '@/hooks/useThemedStyles';\n\nexport const DashboardHome: React.FC = memo(() => {\n  const navigate = useNavigate();\n  const [searchParams] = useSearchParams();\n  const [isDeveloperMode, setIsDeveloperMode] = useState(false);\n  const [currentViewLevel, setCurrentViewLevel] = useState<number | null>(null);\n  const [selectedStage, setSelectedStage] = useState<number | string | null>(null);\n  const [currentView, setCurrentView] = useState<'levels' | 'stage' | 'review' | 'stats' | 'curve' | 'situational'>('levels');\n  const [currentTab, setCurrentTab] = useState<'pattern' | 'situational'>('pattern');\n  \n  // Theme System\n  const { themeMode, setThemeMode } = useTheme();\n  const inlineStyles = useThemedInlineStyles();\n  \n  // Speaking Stage System (3ë‹¨ê³„ ì„ íƒ)\n  const { stage: speakingStage, setSpeakingStage } = useSpeakingStage();\n  \n  // Stage Progress System (3ë‹¨ê³„ ì§„í–‰ë¥  ê´€ë¦¬)\n  const { getStageProgress } = useStageProgress();\n\n  // ì‚¬ìš©ì ìƒíƒœ ë° í†µê³„ Hook\n  const user = useUser();\n  const { \n    metrics, \n    levelProgress, \n    formattedMetrics, \n    isLoading: statsLoading, \n    error: statsError,\n    refresh: refreshStats \n  } = useStatistics({ \n    userId: user.id,\n    enabled: !!user.id,\n    refreshInterval: 5 * 60 * 1000 // 5ë¶„ë§ˆë‹¤ ìë™ ìƒˆë¡œê³ ì¹¨\n  });\n\n  // URL íŒŒë¼ë¯¸í„° í™•ì¸í•˜ì—¬ ë°”ë¡œ ìŠ¤í…Œì´ì§€ ë·° ì—´ê¸°\n  useEffect(() => {\n    const levelParam = searchParams.get('level');\n    const viewParam = searchParams.get('view');\n    \n    if (levelParam && viewParam === 'stage') {\n      const level = parseInt(levelParam);\n      if (level >= 1 && level <= 10) {\n        showStageView(level);\n      }\n    }\n  }, [searchParams]);\n\n  // Memoize level data to prevent recalculation\n  const levelData = useMemo(() => [\n    {\n      level: 1,\n      title: \"êµ¬ì¡° íŒ¨í„´ ì¤‘ì‹¬ (19 ìŠ¤í…Œì´ì§€)\",\n      description: \"ì˜ì–´ ë¬¸ì¥ì˜ ê¸°ë³¸ ë¼ˆëŒ€ë¥¼ ë‹¨ê³„ë³„ë¡œ ìŠµë“\",\n      verbs: [\"Beë™ì‚¬\", \"ì¼ë°˜ë™ì‚¬\", \"ë¶€ì •ë¬¸\", \"ì˜ë¬¸ë¬¸\", \"ê¸°ì´ˆí™•ì¥\"],\n      targetAccuracy: 80,\n      targetSpeed: 3.0,\n      stages: 19,\n      stageVerbs: {\n        1: [\"Beë™ì‚¬ í˜„ì¬\"], 2: [\"Beë™ì‚¬ ê³¼ê±°\"], 3: [\"Beë™ì‚¬ ë¯¸ë˜\"],\n        4: [\"ì¼ë°˜ë™ì‚¬ í˜„ì¬\"], 5: [\"ì¼ë°˜ë™ì‚¬ ê³¼ê±°\"], 6: [\"ì¼ë°˜ë™ì‚¬ ë¯¸ë˜\"],\n        7: [\"Beë™ì‚¬ ë¶€ì •\"], 8: [\"ì¼ë°˜ë™ì‚¬ ë¶€ì •\"],\n        9: [\"Beë™ì‚¬ ì˜ë¬¸ë¬¸\"], 10: [\"ì¼ë°˜ë™ì‚¬ ì˜ë¬¸ë¬¸\"], 11: [\"Wh- ì§ˆë¬¸\"],\n        12: [\"There is/are\"], 13: [\"I like\"], 14: [\"I have\"], 15: [\"I want to\"],\n        16: [\"at/in/on ì „ì¹˜ì‚¬\"], 17: [\"a/an/the ê´€ì‚¬\"], 18: [\"This/That\"], 19: [\"Please/Can you\"]\n      }\n    },\n    {\n      level: 2,\n      title: \"ê¸°ë³¸ ë¬¸ë²• íŒ¨í„´\",\n      description: \"beë™ì‚¬, ì¼ë°˜ë™ì‚¬, ì¡°ë™ì‚¬ì˜ ê¸°ë³¸ íŒ¨í„´ ìŠµë“\",\n      verbs: [\"beë™ì‚¬\", \"ì¼ë°˜ë™ì‚¬\", \"ì¡°ë™ì‚¬\", \"í˜„ì¬ì§„í–‰í˜•\", \"ê³¼ê±°í˜•\", \"ë¯¸ë˜í˜•\"],\n      targetAccuracy: 80,\n      targetSpeed: 2.5,\n      stages: 20,\n      stageVerbs: {\n        1: [\"beë™ì‚¬ í˜„ì¬í˜• (ê¸ì •ë¬¸)\"], 2: [\"beë™ì‚¬ í˜„ì¬í˜• (ë¶€ì •ë¬¸)\"], 3: [\"beë™ì‚¬ í˜„ì¬í˜• (ì˜ë¬¸ë¬¸)\"],\n        4: [\"ì¼ë°˜ë™ì‚¬ í˜„ì¬í˜• (ê¸ì •ë¬¸)\"], 5: [\"ì¼ë°˜ë™ì‚¬ í˜„ì¬í˜• (ë¶€ì •ë¬¸)\"], 6: [\"ì¼ë°˜ë™ì‚¬ í˜„ì¬í˜• (ì˜ë¬¸ë¬¸)\"],\n        7: [\"í˜„ì¬ì§„í–‰í˜• (ê¸ì •ë¬¸)\"], 8: [\"í˜„ì¬ì§„í–‰í˜• (ë¶€ì •ë¬¸)\"], 9: [\"í˜„ì¬ì§„í–‰í˜• (ì˜ë¬¸ë¬¸)\"],\n        10: [\"can ì¡°ë™ì‚¬ (ê¸ì •ë¬¸)\"], 11: [\"can ì¡°ë™ì‚¬ (ë¶€ì •ë¬¸)\"], 12: [\"can ì¡°ë™ì‚¬ (ì˜ë¬¸ë¬¸)\"],\n        13: [\"ê³¼ê±°í˜• (ê¸ì •ë¬¸)\"], 14: [\"ê³¼ê±°í˜• (ë¶€ì •ë¬¸)\"], 15: [\"ê³¼ê±°í˜• (ì˜ë¬¸ë¬¸)\"],\n        16: [\"will ë¯¸ë˜í˜• (ê¸ì •ë¬¸)\"], 17: [\"will ë¯¸ë˜í˜• (ë¶€ì •ë¬¸)\"], 18: [\"will ë¯¸ë˜í˜• (ì˜ë¬¸ë¬¸)\"],\n        19: [\"have to ì˜ë¬´í˜•\"], 20: [\"ì¢…í•© ë³µìŠµ ë° ë¹„êµê¸‰\"]\n      }\n    },\n    {\n      level: 3,\n      title: \"ì‹œì œÂ·íƒœÂ·ë…¼ë¦¬ í™•ì¥ íŒ¨í„´\",\n      description: \"ë³µí•© ì‹œì œ, ì¡°ë™ì‚¬, ê´€ê³„ì ˆ, ë…¼ë¦¬ ì—°ê²°ì˜ ê³ ê¸‰ ë¬¸ë²• íŒ¨í„´\",\n      verbs: [\"ë¯¸ë˜í˜•ì‹¬í™”\", \"í˜„ì¬ì™„ë£Œ\", \"ê³¼ê±°ì™„ë£Œ\", \"ìˆ˜ë™íƒœ\", \"ì¡°ë™ì‚¬í™•ì¥\", \"ì¡°ê±´ë¬¸\", \"ê°€ì •ë²•\"],\n      targetAccuracy: 85,\n      targetSpeed: 2.0,\n      stages: 30,\n      stageVerbs: {\n        1: [\"ë¯¸ë˜í˜• ì‹¬í™” (will vs be going to)\"], 2: [\"í˜„ì¬ì™„ë£Œ ê²½í—˜Â·ì™„ë£Œ ìš©ë²•\"],\n        3: [\"í˜„ì¬ì™„ë£Œ ê²°ê³¼Â·ê³„ì† + ì‹œê°„í‘œí˜„\"], 4: [\"ê³¼ê±°ì™„ë£ŒÂ·ê³¼ê±°ì™„ë£Œì§„í–‰í˜•\"],\n        5: [\"ìˆ˜ë™íƒœ ê¸°ë³¸ (be + p.p.)\"], 6: [\"ìˆ˜ë™íƒœ ì‹¬í™” (ì¡°ë™ì‚¬ + ìˆ˜ë™íƒœ)\"],\n        7: [\"ì¡°ë™ì‚¬ í™•ì¥ 1 (would, could, might)\"], 8: [\"ì¡°ë™ì‚¬ í™•ì¥ 2 (should have, could have)\"],\n        9: [\"ì¡°ê±´ë¬¸ ê¸°ë³¸ (1í˜•ì‹, 2í˜•ì‹)\"], 10: [\"ê°€ì •ë²• ê³¼ê±° (If I were you)\"],\n        11: [\"ê°€ì •ë²• ê³¼ê±°ì™„ë£Œ (If I had known)\"]\n      }\n    },\n    {\n      level: 4,\n      title: \"ê±°ë˜ ë™ì‚¬\",\n      description: \"ì§„í–‰í˜•/ë¶€ì •/ì˜ë¬¸ í˜¼í•© + 1ì´ˆ ë„ì „ ì¼ë¶€\",\n      verbs: [\"buy\", \"sell\", \"use\", \"try\", \"find\"],\n      targetAccuracy: 85,\n      targetSpeed: 2.0,\n      stages: 32,\n      stageVerbs: {\n        1: [\"buy\"], 2: [\"sell\"], 3: [\"use\"], 4: [\"try\"], 5: [\"find\"],\n        6: [\"buy\", \"sell\"], 7: [\"use\", \"try\"], 8: [\"find\", \"buy\"], 9: [\"sell\", \"use\"], 10: [\"buy\", \"sell\", \"use\", \"try\", \"find\"]\n      }\n    },\n    {\n      level: 5,\n      title: \"ì†Œí†µ ë™ì‚¬\",\n      description: \"3ì¸ì¹­ ë‹¨ìˆ˜/ê³¼ê±° í˜¼í•© íŒ¨í„´\",\n      verbs: [\"give\", \"tell\", \"show\", \"meet\", \"help\"],\n      targetAccuracy: 88,\n      targetSpeed: 1.5,\n      stages: 30,\n      stageVerbs: {\n        1: [\"give\"], 2: [\"tell\"], 3: [\"show\"], 4: [\"meet\"], 5: [\"help\"],\n        6: [\"give\", \"tell\"], 7: [\"show\", \"meet\"], 8: [\"help\", \"give\"], 9: [\"tell\", \"show\"], 10: [\"give\", \"tell\", \"show\", \"meet\", \"help\"]\n      }\n    },\n    {\n      level: 6,\n      title: \"í–‰ë™ ë™ì‚¬\",\n      description: \"ì‹œì œ ì „í™˜ ì†ë„ ì¦ê°€\",\n      verbs: [\"come\", \"leave\", \"start\", \"finish\", \"plan\"],\n      targetAccuracy: 88,\n      targetSpeed: 1.5,\n      stages: 44,\n      stageVerbs: {\n        1: [\"come\"], 2: [\"leave\"], 3: [\"start\"], 4: [\"finish\"], 5: [\"plan\"],\n        6: [\"come\", \"leave\"], 7: [\"start\", \"finish\"], 8: [\"plan\", \"come\"], 9: [\"leave\", \"start\"], 10: [\"come\", \"leave\", \"start\", \"finish\", \"plan\"]\n      }\n    },\n    {\n      level: 7,\n      title: \"ì„ íƒ ë™ì‚¬\",\n      description: \"ì´ìœ /ì˜ê²¬ ì—°ê²° íŒ¨í„´\",\n      verbs: [\"choose\", \"decide\", \"prefer\", \"expect\", \"suppose\"],\n      targetAccuracy: 90,\n      targetSpeed: 1.2,\n      stages: 42,\n      stageVerbs: {\n        1: [\"choose\"], 2: [\"decide\"], 3: [\"prefer\"], 4: [\"expect\"], 5: [\"suppose\"],\n        6: [\"choose\", \"decide\"], 7: [\"prefer\", \"expect\"], 8: [\"suppose\", \"choose\"], 9: [\"decide\", \"prefer\"], 10: [\"choose\", \"decide\", \"prefer\", \"expect\", \"suppose\"]\n      }\n    },\n    {\n      level: 8,\n      title: \"í—ˆìš© ë™ì‚¬\",\n      description: \"let/make, toë¶€ì •ì‚¬ íŒ¨í„´ í™•ì¥\",\n      verbs: [\"keep\", \"let\", \"allow\", \"suggest\", \"recommend\"],\n      targetAccuracy: 90,\n      targetSpeed: 1.2,\n      stages: 50,\n      stageVerbs: {\n        1: [\"keep\"], 2: [\"let\"], 3: [\"allow\"], 4: [\"suggest\"], 5: [\"recommend\"],\n        6: [\"keep\", \"let\"], 7: [\"allow\", \"suggest\"], 8: [\"recommend\", \"keep\"], 9: [\"let\", \"allow\"], 10: [\"keep\", \"let\", \"allow\", \"suggest\", \"recommend\"]\n      }\n    },\n    {\n      level: 9,\n      title: \"ì „ë¬¸ ë™ì‚¬\",\n      description: \"ì¶”ìƒ/ì—…ë¬´í˜• ë‹¨ì–´ í˜¼ì…\",\n      verbs: [\"improve\", \"reduce\", \"compare\", \"analyze\", \"design\"],\n      targetAccuracy: 92,\n      targetSpeed: 1.0,\n      stages: 48,\n      stageVerbs: {\n        1: [\"improve\"], 2: [\"reduce\"], 3: [\"compare\"], 4: [\"analyze\"], 5: [\"design\"],\n        6: [\"improve\", \"reduce\"], 7: [\"compare\", \"analyze\"], 8: [\"design\", \"improve\"], 9: [\"reduce\", \"compare\"], 10: [\"improve\", \"reduce\", \"compare\", \"analyze\", \"design\"]\n      }\n    },\n    {\n      level: 10,\n      title: \"ê³ ê¸‰ ë™ì‚¬\",\n      description: \"ê³ ë‚œë„ ì¡°í•© íŒ¨í„´\",\n      verbs: [\"coordinate\", \"negotiate\", \"prioritize\", \"implement\", \"evaluate\"],\n      targetAccuracy: 95,\n      targetSpeed: 1.0,\n      stages: 50,\n      stageVerbs: {\n        1: [\"coordinate\"], 2: [\"negotiate\"], 3: [\"prioritize\"], 4: [\"implement\"], 5: [\"evaluate\"],\n        6: [\"coordinate\", \"negotiate\"], 7: [\"prioritize\", \"implement\"], 8: [\"evaluate\", \"coordinate\"], 9: [\"negotiate\", \"prioritize\"], 10: [\"coordinate\", \"negotiate\", \"prioritize\", \"implement\", \"evaluate\"]\n      }\n    }\n  ], []);\n\n  // ìƒí™©í•™ìŠµ 6ê·¸ë£¹ ë°ì´í„°\n  const situationalData = [\n    {\n      group: 1,\n      title: \"Customer Excellence\",\n      subtitle: \"ê³ ê° ì„œë¹„ìŠ¤ ì™„ì„±\",\n      stages: \"A5-S17~S20\",\n      difficulty: 2,\n      description: \"ê³ ê°ê³¼ì˜ ì„œë¹„ìŠ¤ ì™„ë£Œ ë° ê´€ê³„ ìœ ì§€\",\n      scenarios: [\"ì„œë¹„ìŠ¤ ë¬¸ì˜ ì‘ë‹µ\", \"ë¬¸ì œ í•´ê²° ì œì•ˆ\", \"ì„œë¹„ìŠ¤ í’ˆì§ˆ í™•ì¸\", \"ì„œë¹„ìŠ¤ ì¢…ë£Œ ë° ê´€ê³„ ìœ ì§€\"],\n      completed: false,\n      progress: 0\n    },\n    {\n      group: 2,\n      title: \"Professional Communication\",\n      subtitle: \"ì „ë¬¸ ì†Œí†µ ëŠ¥ë ¥\",\n      stages: \"A4-S13~S16\",\n      difficulty: 3,\n      description: \"ì´ë©”ì¼, ë³´ê³ ì„œ, ì—…ë¬´ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜\",\n      scenarios: [\"ì´ë©”ì¼ ê°ì‚¬ ë° í™•ì¸\", \"ë³´ê³ ì„œ ì‘ì„± ë° ê²€í† \", \"ë³´ê³ ì„œ ê¶Œê³ ì‚¬í•­ ë° ì‹¤í–‰ê³„íš\", \"ë¬¸ì„œ ìŠ¹ì¸ ë° í”¼ë“œë°±\"],\n      completed: false,\n      progress: 0\n    },\n    {\n      group: 3,\n      title: \"Meeting Leadership\",\n      subtitle: \"íšŒì˜ ì§„í–‰ ë¦¬ë”ì‹­\",\n      stages: \"A1-S01~S04\",\n      difficulty: 3,\n      description: \"íšŒì˜ ì£¼ë„ ë° íš¨ê³¼ì  ì§„í–‰\",\n      scenarios: [\"íšŒì˜ ì‹œì‘ ë° ëª©ì  ì„¤ëª…\", \"ì•ˆê±´ ì œì‹œ ë° ë…¼ì˜ ìœ ë„\", \"ì˜ê²¬ ì¡°ìœ¨ ë° í•©ì˜ ë„ì¶œ\", \"íšŒì˜ ì •ë¦¬ ë° í›„ì† ì¡°ì¹˜\"],\n      completed: false,\n      progress: 0\n    },\n    {\n      group: 4,\n      title: \"Presentation Mastery\",\n      subtitle: \"ë°œí‘œ ì™„ì„±ë„\",\n      stages: \"A2-S05~S08\",\n      difficulty: 3,\n      description: \"íš¨ê³¼ì ì¸ í”„ë ˆì  í…Œì´ì…˜ ë° ì„¤ë“\",\n      scenarios: [\"ë°œí‘œ ì‹œì‘ ë° ê°œìš” ì†Œê°œ\", \"í•µì‹¬ ë‚´ìš© ì „ë‹¬\", \"ì§ˆì˜ì‘ë‹µ ë° í† ë¡ \", \"ë°œí‘œ ë§ˆë¬´ë¦¬ ë° ê°ì‚¬\"],\n      completed: false,\n      progress: 0\n    },\n    {\n      group: 5,\n      title: \"Strategic Negotiation\",\n      subtitle: \"ì „ëµì  í˜‘ìƒ\",\n      stages: \"A3-S09~S12\",\n      difficulty: 4,\n      description: \"ë¹„ì¦ˆë‹ˆìŠ¤ í˜‘ìƒ ë° ê±°ë˜ ì„±ì‚¬\",\n      scenarios: [\"í˜‘ìƒ ì‹œì‘ ë° ì¡°ê±´ ì œì‹œ\", \"ìƒí˜¸ ì´ìµ íƒìƒ‰\", \"ì–‘ë³´ ë° ëŒ€ì•ˆ ëª¨ìƒ‰\", \"í™•ì • ë° ê±°ë˜ ë§ˆë¬´ë¦¬\"],\n      completed: false,\n      progress: 0\n    },\n    {\n      group: 6,\n      title: \"Team Leadership\",\n      subtitle: \"íŒ€ ë¦¬ë”ì‹­\",\n      stages: \"A6-S21~S24\",\n      difficulty: 4,\n      description: \"íŒ€ ê´€ë¦¬ ë° í”„ë¡œì íŠ¸ ë¦¬ë”ì‹­\",\n      scenarios: [\"íŒ€ ë™ê¸°ë¶€ì—¬ ë° ëª©í‘œ ì„¤ì •\", \"ì„±ê³¼ í”¼ë“œë°± ë° ì½”ì¹­\", \"ê°ˆë“± í•´ê²° ë° íŒ€ ì¡°ìœ¨\", \"í”„ë¡œì íŠ¸ ì™„ë£Œ ë° ì„±ê³¼ ê³µìœ \"],\n      completed: false,\n      progress: 0\n    }\n  ];\n\n  // Level 5 í•™ìˆ ì—°êµ¬ 6ê·¸ë£¹ ë°ì´í„°\n  const level5SituationalData = [\n    {\n      group: 1,\n      title: \"Research Foundation\",\n      subtitle: \"ì—°êµ¬ ê¸°ì´ˆ ì„¤ì •\",\n      stages: \"A1-S01~S04\",\n      difficulty: 3,\n      description: \"ì—°êµ¬ ëª©ì , ê°€ì„¤, ì´ë¡ ì  ê·¼ê±° ì„¤ì •\",\n      scenarios: [\"ì—°êµ¬ ëª©ì  ë° ê°€ì„¤ ì œì‹œ\", \"ì´ë¡ ì  ê·¼ê±° ìˆ˜ë¦½\", \"ì—°êµ¬ ë””ìì¸ ì„¤ì •\", \"ì„ í–‰ì—°êµ¬ ê²€í† \"],\n      completed: false,\n      progress: 0\n    },\n    {\n      group: 2,\n      title: \"Academic Presentation\",\n      subtitle: \"í•™ìˆ  ë°œí‘œ ë§ˆìŠ¤í„°ë¦¬\",\n      stages: \"A2-S05~S08\",\n      difficulty: 3,\n      description: \"í•™ìˆ  ë°œí‘œ ë° ë…¼ë¬¸ ë°œí‘œ ê¸°ë²•\",\n      scenarios: [\"í•™ìˆ  ë°œí‘œ ë„ì… ë° êµ¬ì¡°í™”\", \"ì—°êµ¬ ê²°ê³¼ ì œì‹œ\", \"ë…¼ì˜ ë° í† ë¡  ì§„í–‰\", \"ë°œí‘œ ë§ˆë¬´ë¦¬ ë° Q&A\"],\n      completed: false,\n      progress: 0\n    },\n    {\n      group: 3,\n      title: \"Research Methodology\",\n      subtitle: \"ì—°êµ¬ë°©ë²•ë¡  ì „ë¬¸ì„±\",\n      stages: \"A3-S09~S12\",\n      difficulty: 4,\n      description: \"ì—°êµ¬ë°©ë²•, ë°ì´í„° ë¶„ì„ ë° í•´ì„\",\n      scenarios: [\"ì—°êµ¬ë°©ë²• ì„ íƒ ë° ì„¤ëª…\", \"ë°ì´í„° ìˆ˜ì§‘ ë° ë¶„ì„\", \"ê²°ê³¼ í•´ì„ ë° ë…¼ì˜\", \"ì—°êµ¬ì˜ í•œê³„ ì¸ì •\"],\n      completed: false,\n      progress: 0\n    },\n    {\n      group: 4,\n      title: \"Interdisciplinary Research\",\n      subtitle: \"í•™ì œê°„ ì—°êµ¬ í˜‘ë ¥\",\n      stages: \"A4-S13~S16\",\n      difficulty: 4,\n      description: \"ë‹¤í•™ì œ ì—°êµ¬ ë° í˜‘ë ¥ í”„ë¡œì íŠ¸\",\n      scenarios: [\"í•™ì œê°„ ì—°êµ¬ í˜‘ë ¥\", \"í†µí•© ë°©ë²•ë¡  ê°œë°œ\", \"ê³µë™ì—°êµ¬ í”„ë¡œì íŠ¸\", \"ì—°êµ¬ì„±ê³¼ ê³µìœ \"],\n      completed: false,\n      progress: 0\n    },\n    {\n      group: 5,\n      title: \"Publication & Peer Review\",\n      subtitle: \"ë…¼ë¬¸ ì¶œíŒ ë° ì‹¬ì‚¬\",\n      stages: \"A5-S17~S20\",\n      difficulty: 4,\n      description: \"í•™ìˆ ì§€ ë°œí‘œ ë° ë™ë£Œì‹¬ì‚¬ ê³¼ì •\",\n      scenarios: [\"ë…¼ë¬¸ ì‘ì„± ë° ì œì¶œ\", \"ë™ë£Œì‹¬ì‚¬ ëŒ€ì‘\", \"ìˆ˜ì • ë° ì¬ì œì¶œ\", \"í•™ìˆ ì  ê¸°ì—¬ë„ í‰ê°€\"],\n      completed: false,\n      progress: 0\n    },\n    {\n      group: 6,\n      title: \"Academic Leadership\",\n      subtitle: \"í•™ìˆ  ë¦¬ë”ì‹­\",\n      stages: \"A6-S21~S24\",\n      difficulty: 5,\n      description: \"ì—°êµ¬íŒ€ ë¦¬ë”ì‹­ ë° í•™ìˆ ê³„ ê¸°ì—¬\",\n      scenarios: [\"ì—°êµ¬íŒ€ ë¦¬ë”ì‹­\", \"í•™ìˆ  ë„¤íŠ¸ì›Œí‚¹\", \"ì—°êµ¬ë¹„ íšë“ ë° ê´€ë¦¬\", \"í•™ê³„ ê¸°ì—¬ ë° ì˜í–¥ë ¥\"],\n      completed: false,\n      progress: 0\n    }\n  ];\n\n  // Level 6 ì „ë¬¸ë¶„ì•¼ 4ê·¸ë£¹ ë°ì´í„°\n  const level6SituationalData = [\n    {\n      group: 1,\n      title: \"Legal Excellence\",\n      subtitle: \"ë²•ë¥  ì „ë¬¸ì„±\",\n      stages: \"D1-S01~S03\",\n      difficulty: 5,\n      description: \"ë²•ë¥  ê³„ì•½ì„œ ì‘ì„± ë° ë²•ë¥  ìë¬¸\",\n      scenarios: [\"ë²•ë¥  ê³„ì•½ì„œ ì‘ì„± ë° ê²€í† \", \"ë²•ë¥  ìë¬¸ ë° ìƒë‹´\", \"ë²•ì  ë¶„ìŸ í•´ê²°\"],\n      completed: false,\n      progress: 0\n    },\n    {\n      group: 2,\n      title: \"Medical Professional\",\n      subtitle: \"ì˜ë£Œ ì „ë¬¸ì„±\",\n      stages: \"D2-S04~S06\",\n      difficulty: 5,\n      description: \"ì˜ë£Œ ì§„ë£Œ ë° í™˜ì ì»¤ë®¤ë‹ˆì¼€ì´ì…˜\",\n      scenarios: [\"í™˜ì ì§„ë£Œ ë° ìƒë‹´\", \"ì˜ë£Œì§„ ì†Œí†µ\", \"ì§„ë‹¨ ë° ì¹˜ë£Œ ê³„íš\"],\n      completed: false,\n      progress: 0\n    },\n    {\n      group: 3,\n      title: \"Technical Engineering\",\n      subtitle: \"ê¸°ìˆ  ì—”ì§€ë‹ˆì–´ë§\",\n      stages: \"D3-S07~S09\",\n      difficulty: 5,\n      description: \"ê¸°ìˆ  ì„¤ê³„ ë° ì—”ì§€ë‹ˆì–´ë§ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜\",\n      scenarios: [\"ê¸°ìˆ  ì„¤ê³„ ë° ê°œë°œ\", \"ì—”ì§€ë‹ˆì–´ë§ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜\", \"í’ˆì§ˆ ë³´ì¦ ë° ìµœì í™”\"],\n      completed: false,\n      progress: 0\n    },\n    {\n      group: 4,\n      title: \"Financial Expertise\",\n      subtitle: \"ê¸ˆìœµ ì „ë¬¸ì„±\",\n      stages: \"D4-S10~S12\",\n      difficulty: 5,\n      description: \"ê¸ˆìœµ ë¶„ì„ ë° íˆ¬ì ìë¬¸\",\n      scenarios: [\"ê¸ˆìœµ ìƒí’ˆ ì„¤ê³„\", \"íˆ¬ì ìë¬¸ ë° ìœ„í—˜ê´€ë¦¬\", \"ê¸ˆìœµì‹œì¥ ë¶„ì„\"],\n      completed: false,\n      progress: 0\n    }\n  ];\n\n  // ì‚¬ìš©ì ì§„í–‰ ìƒí™© (ì„ì‹œ ë°ì´í„°)\n  const [userProgress] = useState({\n    currentLevel: 1,\n    levels: [\n      { \n        level: 1, \n        completed: false, \n        progress: 0, \n        bestAccuracy: 0, \n        attempts: 0,\n        stages: Array.from({length: 19}, (_, i) => ({ \n          stage: i + 1, \n          completed: false, \n          accuracy: 0, \n          attempts: 0 \n        }))\n      },\n      { \n        level: 2, \n        completed: false, \n        progress: 0,  // Level 1 ì™„ë£Œ ì „ê¹Œì§€ 0%\n        bestAccuracy: 0, \n        attempts: 0,\n        stages: [\n          { stage: 1, completed: false, accuracy: 0, attempts: 0 },\n          { stage: 2, completed: false, accuracy: 0, attempts: 0 },\n          { stage: 3, completed: false, accuracy: 0, attempts: 0 },\n          { stage: 4, completed: false, accuracy: 0, attempts: 0 },\n          ...Array.from({length: 16}, (_, i) => ({ \n            stage: i + 5, \n            completed: false, \n            accuracy: 0, \n            attempts: 0 \n          }))\n        ]\n      },\n      ...Array.from({length: 8}, (_, i) => ({\n        level: i + 3,\n        completed: false,\n        progress: 0,\n        bestAccuracy: 0,\n        attempts: 0,\n        stages: Array.from({length: levelData[i + 2]?.stages || 10}, (_, j) => ({\n          stage: j + 1,\n          completed: false,\n          accuracy: 0,\n          attempts: 0\n        }))\n      }))\n    ]\n  });\n\n  // ëª¨ë“œ í† ê¸€ ê¸°ëŠ¥\n  const toggleDeveloperMode = useCallback(() => {\n    setIsDeveloperMode(!isDeveloperMode);\n    console.log(isDeveloperMode ? 'ğŸ‘¤ ì¼ë°˜ ëª¨ë“œ í™œì„±í™”' : 'ğŸ”§ ê°œë°œì ëª¨ë“œ í™œì„±í™”');\n  }, [isDeveloperMode]);\n\n  // ë ˆë²¨ ì¹´ë“œ ìƒì„± í•¨ìˆ˜\n  const createLevelCards = useCallback(() => {\n    return levelData.map(level => {\n      const userLevelData = userProgress.levels.find(l => l.level === level.level) || \n                          { level: level.level, completed: false, progress: 0, bestAccuracy: 0, attempts: 0 };\n      \n      const isUnlocked = isDeveloperMode || level.level === 1 || \n                       (userProgress.levels.find(l => l.level === level.level - 1)?.completed);\n      const isCompleted = userLevelData.completed;\n      \n      let icon = 'ğŸ”’';\n      if (isCompleted) icon = 'ğŸ†';\n      else if (isUnlocked) icon = 'â­';\n      \n      return (\n        <div\n          key={level.level}\n          className={`level-card ${isCompleted ? 'completed' : (isUnlocked ? 'unlocked' : 'locked')}`}\n          onClick={isUnlocked ? () => showStageView(level.level) : undefined}\n          style={{\n            background: '#ffffff',\n            borderRadius: '15px',\n            padding: '25px',\n            cursor: isUnlocked ? 'pointer' : 'not-allowed',\n            transition: 'all 0.3s ease',\n            border: isCompleted ? '3px solid #f59e0b' : (isUnlocked ? '3px solid #10b981' : '3px solid transparent'),\n            position: 'relative',\n            opacity: isUnlocked ? 1 : 0.6\n          }}\n          onMouseEnter={(e) => {\n            if (isUnlocked) {\n              e.currentTarget.style.transform = 'translateY(-5px)';\n              e.currentTarget.style.boxShadow = '0 10px 30px rgba(0,0,0,0.15)';\n            }\n          }}\n          onMouseLeave={(e) => {\n            if (isUnlocked) {\n              e.currentTarget.style.transform = 'translateY(0)';\n              e.currentTarget.style.boxShadow = 'none';\n            }\n          }}\n        >\n          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '15px' }}>\n            <div style={{ fontSize: '1.5em', fontWeight: 'bold', color: '#1f2937' }}>Level {level.level}</div>\n            <div style={{ fontSize: '2em' }}>{icon}</div>\n          </div>\n          <div style={{ background: '#e5e7eb', borderRadius: '10px', height: '8px', marginBottom: '15px', overflow: 'hidden' }}>\n            <div style={{ \n              background: 'linear-gradient(90deg, #10b981, #059669)', \n              height: '100%', \n              borderRadius: '10px', \n              transition: 'width 0.5s ease',\n              width: `${userLevelData.progress}%`\n            }}></div>\n          </div>\n          <div style={{ display: 'flex', justifyContent: 'space-between', fontSize: '0.9em', color: '#64748b' }}>\n            <span>ì§„í–‰ë¥ : {userLevelData.progress}%</span>\n            <span>ìµœê³ : {userLevelData.bestAccuracy}%</span>\n          </div>\n          <h3 style={{ margin: '10px 0 5px 0', color: '#1f2937' }}>{level.title}</h3>\n          <div style={{ fontSize: '0.9em', color: '#64748b', marginTop: '10px' }}>{level.description}</div>\n          <div style={{ fontSize: '0.9em', color: '#64748b', marginTop: '10px' }}>\n            <strong>ë™ì‚¬:</strong> {level.verbs.join(', ')}\n          </div>\n          <div style={{ fontSize: '0.9em', color: '#64748b' }}>\n            <strong>ëª©í‘œ:</strong> ì •í™•ë„ {level.targetAccuracy}%\n          </div>\n        </div>\n      );\n    });\n  }, [userProgress.levels, isDeveloperMode, levelData]);\n\n  // ìŠ¤í…Œì´ì§€ ë·° í‘œì‹œ\n  const showStageView = (levelNum: number) => {\n    setCurrentViewLevel(levelNum);\n    setCurrentView('stage');\n  };\n\n  // ìŠ¤í…Œì´ì§€ ìŠ¤í… ìƒì„± (ì‹¤ì œ ì§„í–‰ë¥  ë°ì´í„° ì‚¬ìš©)\n\n  const createStageSteps = (level: any) => {\n    const userLevelData = userProgress.levels.find(l => l.level === level.level);\n    const userStages = userLevelData?.stages || [];\n    \n    const steps = [];\n    \n    for (let i = 1; i <= level.stages; i++) {\n      const stageData = userStages.find(s => s.stage === i);\n      const stageProgress = getStageProgress(level.level, i); // [1ë‹¨ê³„, 2ë‹¨ê³„, 3ë‹¨ê³„] ì™„ë£Œ ì—¬ë¶€ - ì‹¤ì œ ë°ì´í„° ì‚¬ìš©\n      const completedSteps = stageProgress.filter(Boolean).length; // ì™„ë£Œëœ ë‹¨ê³„ ìˆ˜\n      const progressPercentage = (completedSteps / 3) * 100; // ì§„í–‰ë¥ \n      \n      let stepClass = 'step';\n      let title = '';\n      \n      if (stageData?.completed) {\n        stepClass += ' completed';\n        title = `ì™„ë£Œë¨ - ì •í™•ë„: ${stageData.accuracy}%, ì‹œë„: ${stageData.attempts}ë²ˆ`;\n      } else if (isDeveloperMode || i === 1 || (userStages.find(s => s.stage === i - 1)?.completed)) {\n        if (stageData && stageData.attempts > 0) {\n          stepClass += ' current';\n          title = `ì§„í–‰ì¤‘ - ìµœê³ : ${stageData.accuracy}%, ì‹œë„: ${stageData.attempts}ë²ˆ`;\n        } else {\n          stepClass += ' current';\n          title = 'ì‹œì‘ ê°€ëŠ¥';\n        }\n      } else {\n        stepClass += ' locked';\n        title = 'ì ê¸ˆë¨ - ì´ì „ ìŠ¤í…Œì´ì§€ë¥¼ ì™„ë£Œí•˜ì„¸ìš”';\n      }\n      \n      steps.push(\n        <div\n          key={i}\n          style={{\n            display: 'flex',\n            flexDirection: 'column',\n            alignItems: 'center',\n            gap: '8px'\n          }}\n        >\n          {/* ìŠ¤í…Œì´ì§€ ì› */}\n          <div\n            className={stepClass}\n            title={title}\n            onClick={() => !stepClass.includes('locked') && selectStage(level.level, i)}\n            style={{\n              width: '50px',\n              height: '50px',\n              borderRadius: '50%',\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              fontWeight: 'bold',\n              cursor: stepClass.includes('locked') ? 'not-allowed' : 'pointer',\n              transition: 'all 0.3s',\n              fontSize: '14px',\n              background: stepClass.includes('completed') ? '#10b981' : \n                         stepClass.includes('current') ? '#3b82f6' : '#e5e7eb',\n              color: stepClass.includes('locked') ? '#9ca3af' : 'white',\n              animation: stepClass.includes('current') ? 'pulse 2s infinite' : 'none',\n              border: selectedStage === i ? '3px solid #f59e0b' : '2px solid transparent',\n              boxShadow: selectedStage === i ? '0 0 0 2px rgba(245, 158, 11, 0.3)' : 'none'\n            }}\n          >\n            {i}\n          </div>\n          \n          {/* 3ë‹¨ê³„ ì§„í–‰ë¥  í‘œì‹œ */}\n          <div style={{\n            display: 'flex',\n            flexDirection: 'column',\n            alignItems: 'center',\n            gap: '4px',\n            width: '60px'\n          }}>\n            {/* ì§„í–‰ë¥  ë°” */}\n            <div style={{\n              width: '100%',\n              height: '4px',\n              backgroundColor: '#e5e7eb',\n              borderRadius: '2px',\n              overflow: 'hidden'\n            }}>\n              <div style={{\n                width: `${progressPercentage}%`,\n                height: '100%',\n                backgroundColor: progressPercentage === 100 ? '#10b981' : progressPercentage > 0 ? '#3b82f6' : '#e5e7eb',\n                borderRadius: '2px',\n                transition: 'width 0.3s ease'\n              }}></div>\n            </div>\n            \n            {/* 3ë‹¨ê³„ ì  í‘œì‹œ */}\n            <div style={{\n              display: 'flex',\n              gap: '3px',\n              alignItems: 'center'\n            }}>\n              {stageProgress.map((completed, stepIndex) => (\n                <div\n                  key={stepIndex}\n                  style={{\n                    width: '6px',\n                    height: '6px',\n                    borderRadius: '50%',\n                    backgroundColor: completed ? '#10b981' : '#d1d5db',\n                    transition: 'background-color 0.3s ease'\n                  }}\n                  title={`${stepIndex + 1}ë‹¨ê³„ ${completed ? 'ì™„ë£Œ' : 'ë¯¸ì™„ë£Œ'}`}\n                />\n              ))}\n            </div>\n            \n            {/* ì§„í–‰ë¥  í…ìŠ¤íŠ¸ */}\n            <div style={{\n              fontSize: '10px',\n              color: '#6b7280',\n              textAlign: 'center'\n            }}>\n              {completedSteps}/3\n            </div>\n          </div>\n        </div>\n      );\n    }\n    \n    // ALL ë²„íŠ¼ ì¶”ê°€\n    const allStagesCompleted = userStages.length === level.stages && userStages.every(stage => stage.completed);\n    const isAllUnlocked = isDeveloperMode || allStagesCompleted;\n    \n    steps.push(\n      <div\n        key=\"ALL\"\n        className={`step all-step ${!isAllUnlocked ? 'locked' : ''}`}\n        title={isAllUnlocked ? 'ë ˆë²¨ ì „ì²´ ë™ì‚¬ í†µí•© í›ˆë ¨' : 'ì ê¸ˆë¨ - ëª¨ë“  ìŠ¤í…Œì´ì§€ë¥¼ ì™„ë£Œí•˜ì„¸ìš”'}\n        onClick={isAllUnlocked ? () => selectAllStage(level.level) : undefined}\n        style={{\n          width: '60px',\n          height: '60px',\n          borderRadius: '50%',\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          fontWeight: 'bold',\n          fontSize: '12px',\n          cursor: isAllUnlocked ? 'pointer' : 'not-allowed',\n          background: isAllUnlocked ? 'linear-gradient(135deg, #f59e0b, #d97706)' : '#e5e7eb',\n          color: isAllUnlocked ? 'white' : '#9ca3af',\n          border: selectedStage === 'ALL' ? '3px solid #ef4444' : '2px solid transparent',\n          boxShadow: selectedStage === 'ALL' ? '0 0 0 2px rgba(239, 68, 68, 0.3)' : 'none'\n        }}\n      >\n        ALL\n      </div>\n    );\n    \n    return steps;\n  };\n\n  // ìŠ¤í…Œì´ì§€ ì„ íƒ\n  const selectStage = (levelNum: number, stageNum: number) => {\n    console.log(`Selected Level ${levelNum}, Stage ${stageNum}`);\n    if (selectedStage === stageNum) {\n      setSelectedStage(null); // ê°™ì€ ìŠ¤í…Œì´ì§€ í´ë¦­ì‹œ ì„ íƒ í•´ì œ\n    } else {\n      setSelectedStage(stageNum);\n    }\n    \n    const level = levelData.find(l => l.level === levelNum);\n    const userLevelData = userProgress.levels.find(l => l.level === levelNum);\n    const stageData = userLevelData?.stages?.find(s => s.stage === stageNum);\n  };\n\n  // ALL ìŠ¤í…Œì´ì§€ ì„ íƒ\n  const selectAllStage = (levelNum: number) => {\n    const level = levelData.find(l => l.level === levelNum);\n    const userLevelData = userProgress.levels.find(l => l.level === levelNum);\n    const userStages = userLevelData?.stages || [];\n    \n    const allStagesCompleted = userStages.length === level!.stages && userStages.every(stage => stage.completed);\n    \n    if (!isDeveloperMode && !allStagesCompleted) {\n      alert('ëª¨ë“  ìŠ¤í…Œì´ì§€ë¥¼ ì™„ë£Œí•´ì•¼ ALL ëª¨ë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!');\n      return;\n    }\n    \n    console.log(`Selected Level ${levelNum}, ALL Stages`);\n    if (selectedStage === 'ALL') {\n      setSelectedStage(null); // ê°™ì€ ALL í´ë¦­ì‹œ ì„ íƒ í•´ì œ\n    } else {\n      setSelectedStage('ALL');\n    }\n  };\n\n  // ìŠ¤í…Œì´ì§€ ì‹œì‘\n  const startStage = () => {\n    if (currentViewLevel && selectedStage) {\n      const level = levelData.find(l => l.level === currentViewLevel);\n      \n      let stageVerbs;\n      if (selectedStage === 'ALL') {\n        stageVerbs = level!.verbs;\n      } else {\n        stageVerbs = level?.stageVerbs?.[selectedStage as number] || level?.verbs || [];\n      }\n      \n      // pattern-trainingìœ¼ë¡œ ì´ë™\n      const params = new URLSearchParams({\n        level: currentViewLevel.toString(),\n        stage: selectedStage.toString(),\n        verbs: stageVerbs.join(','),\n        targetAccuracy: level!.targetAccuracy.toString(),\n        developerMode: isDeveloperMode ? 'true' : 'false'\n      });\n      \n      navigate(`/pattern-training?${params.toString()}`);\n    } else {\n      alert('ë¨¼ì € ìŠ¤í…Œì´ì§€ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”!');\n    }\n  };\n\n  const currentLevel = currentViewLevel ? levelData.find(l => l.level === currentViewLevel) : null;\n\n  return (\n    <div className=\"font-sans bg-gray-50 dark:bg-gray-900 min-h-screen p-5 transition-colors duration-300\">\n      <div className=\"max-w-6xl mx-auto bg-white dark:bg-gray-800 rounded-3xl shadow-xl overflow-hidden border border-gray-200 dark:border-gray-700 transition-colors duration-300\">\n        {/* í—¤ë” */}\n        <div style={{\n          background: inlineStyles.secondary,\n          color: inlineStyles.text,\n          padding: '30px',\n          textAlign: 'center',\n          position: 'relative',\n          borderBottom: `1px solid ${inlineStyles.border}`\n        }}>\n          {/* í™ˆ ë²„íŠ¼ */}\n          <button\n            onClick={() => navigate('/')}\n            style={{\n              position: 'absolute',\n              top: '20px',\n              left: '20px',\n              background: 'rgba(255,255,255,0.2)',\n              border: '1px solid rgba(255,255,255,0.3)',\n              color: 'white',\n              padding: '8px 15px',\n              borderRadius: '25px',\n              cursor: 'pointer',\n              fontSize: '14px',\n              fontWeight: 'bold',\n              backdropFilter: 'blur(10px)',\n              transition: 'all 0.3s'\n            }}\n            onMouseEnter={(e) => {\n              e.currentTarget.style.background = 'rgba(255,255,255,0.3)';\n            }}\n            onMouseLeave={(e) => {\n              e.currentTarget.style.background = 'rgba(255,255,255,0.2)';\n            }}\n          >\n            ğŸ  í™ˆ\n          </button>\n          {/* ëª¨ë“œ í† ê¸€ */}\n          <div style={{\n            position: 'absolute',\n            top: '20px',\n            right: '20px',\n            display: 'flex',\n            alignItems: 'center',\n            gap: '12px',\n            background: 'rgba(255,255,255,0.2)',\n            border: '1px solid rgba(255,255,255,0.3)',\n            borderRadius: '25px',\n            padding: '8px 15px',\n            backdropFilter: 'blur(10px)'\n          }}>\n            <span style={{\n              color: 'white',\n              fontSize: '14px',\n              fontWeight: isDeveloperMode ? '500' : 'bold',\n              opacity: isDeveloperMode ? 0.8 : 1\n            }}>ì¼ë°˜</span>\n            <div\n              onClick={toggleDeveloperMode}\n              style={{\n                position: 'relative',\n                width: '50px',\n                height: '24px',\n                background: isDeveloperMode ? '#10b981' : 'rgba(255,255,255,0.3)',\n                borderRadius: '12px',\n                cursor: 'pointer',\n                transition: 'background 0.3s'\n              }}\n            >\n              <div style={{\n                position: 'absolute',\n                top: '2px',\n                left: isDeveloperMode ? '28px' : '2px',\n                width: '20px',\n                height: '20px',\n                background: 'white',\n                borderRadius: '50%',\n                transition: 'left 0.3s',\n                boxShadow: '0 2px 4px rgba(0,0,0,0.2)'\n              }}></div>\n            </div>\n            <span style={{\n              color: 'white',\n              fontSize: '14px',\n              fontWeight: isDeveloperMode ? 'bold' : '500',\n              opacity: isDeveloperMode ? 1 : 0.8\n            }}>ê°œë°œì</span>\n            {isDeveloperMode && (\n              <div style={{\n                position: 'absolute',\n                top: '-5px',\n                right: '-5px',\n                background: '#ef4444',\n                color: 'white',\n                fontSize: '10px',\n                padding: '2px 6px',\n                borderRadius: '10px',\n                fontWeight: 'bold'\n              }}>DEV</div>\n            )}\n          </div>\n\n          <h1 style={{ fontSize: '2.5em', marginBottom: '10px' }}>ğŸ¯ DASI English</h1>\n          <p style={{ fontSize: '1.2em', opacity: 0.9 }}>Do you vs Are you ì™„ì „ ì •ë³µ - 10ë ˆë²¨ ì‹œìŠ¤í…œ</p>\n          \n          {/* íƒ­ ë²„íŠ¼ */}\n          <div style={{\n            display: 'flex',\n            justifyContent: 'center',\n            gap: '10px',\n            marginTop: '25px'\n          }}>\n            <button\n              onClick={() => {\n                setCurrentTab('pattern');\n                setCurrentView('levels');\n              }}\n              style={{\n                background: currentTab === 'pattern' ? 'rgba(255,255,255,0.3)' : 'rgba(255,255,255,0.1)',\n                border: '1px solid rgba(255,255,255,0.3)',\n                color: 'white',\n                padding: '12px 24px',\n                borderRadius: '25px',\n                cursor: 'pointer',\n                fontSize: '16px',\n                fontWeight: 'bold',\n                backdropFilter: 'blur(10px)',\n                transition: 'all 0.3s'\n              }}\n            >\n              ğŸ“– íŒ¨í„´í•™ìŠµ\n            </button>\n            <button\n              onClick={() => {\n                setCurrentTab('situational');\n                setCurrentView('situational');\n              }}\n              style={{\n                background: currentTab === 'situational' ? 'rgba(255,255,255,0.3)' : 'rgba(255,255,255,0.1)',\n                border: '1px solid rgba(255,255,255,0.3)',\n                color: 'white',\n                padding: '12px 24px',\n                borderRadius: '25px',\n                cursor: 'pointer',\n                fontSize: '16px',\n                fontWeight: 'bold',\n                backdropFilter: 'blur(10px)',\n                transition: 'all 0.3s'\n              }}\n            >\n              ğŸ’¼ ìƒí™©í•™ìŠµ\n            </button>\n          </div>\n          \n          <div style={{\n            display: 'flex',\n            justifyContent: 'center',\n            gap: '30px',\n            marginTop: '20px'\n          }}>\n            <div style={{ textAlign: 'center' }}>\n              <div style={{ fontSize: '2em', fontWeight: 'bold' }}>\n                {statsLoading ? '...' : (formattedMetrics?.currentLevelText || user.level || '1')}\n              </div>\n              <div style={{ fontSize: '0.9em', opacity: 0.8 }}>í˜„ì¬ ë ˆë²¨</div>\n            </div>\n            <div style={{ textAlign: 'center' }}>\n              <div style={{ fontSize: '2em', fontWeight: 'bold', color: statsError ? '#ef4444' : 'inherit' }}>\n                {statsLoading ? '...' : (formattedMetrics?.overallProgressText || '0%')}\n              </div>\n              <div style={{ fontSize: '0.9em', opacity: 0.8 }}>ì „ì²´ ì§„í–‰ë¥ </div>\n            </div>\n            <div style={{ textAlign: 'center' }}>\n              <div style={{ fontSize: '2em', fontWeight: 'bold', color: statsError ? '#ef4444' : 'inherit' }}>\n                {statsLoading ? '...' : (formattedMetrics?.averageAccuracyText || '0%')}\n              </div>\n              <div style={{ fontSize: '0.9em', opacity: 0.8 }}>í‰ê·  ì •í™•ë„</div>\n            </div>\n            <div style={{ textAlign: 'center' }}>\n              <div style={{ fontSize: '2em', fontWeight: 'bold', color: statsError ? '#ef4444' : 'inherit' }}>\n                {statsLoading ? '...' : (formattedMetrics?.incorrectCountText || '0')}\n              </div>\n              <div style={{ fontSize: '0.9em', opacity: 0.8 }}>í‹€ë¦° ë¬¸ì œ</div>\n            </div>\n            <div style={{ textAlign: 'center' }}>\n              <div style={{ fontSize: '2em', fontWeight: 'bold' }}>0</div>\n              <div style={{ fontSize: '0.9em', opacity: 0.8 }}>ë³µìŠµ ëŒ€ê¸°</div>\n            </div>\n          </div>\n        </div>\n\n        {/* íŒ¨í„´í•™ìŠµ - ë ˆë²¨ ì„ íƒ í™”ë©´ */}\n        {currentView === 'levels' && currentTab === 'pattern' && (\n          <div style={{ padding: '30px' }}>\n            <div style={{\n              display: 'grid',\n              gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))',\n              gap: '20px'\n            }}>\n              {createLevelCards()}\n            </div>\n          </div>\n        )}\n\n        {/* ìƒí™©í•™ìŠµ í™”ë©´ */}\n        {currentView === 'situational' && (\n          <div style={{ padding: '30px' }}>\n            {/* Level 4 ë¹„ì¦ˆë‹ˆìŠ¤ */}\n            <div style={{ marginBottom: '50px' }}>\n              <h2 style={{ color: '#1f2937', fontSize: '1.8em', marginBottom: '20px', textAlign: 'center' }}>\n                ğŸ’¼ Level 4: Business Mastery\n              </h2>\n              <div style={{\n                display: 'grid',\n                gridTemplateColumns: 'repeat(auto-fit, minmax(350px, 1fr))',\n                gap: '20px'\n              }}>\n                {situationalData.map(group => {\n                  const isCompleted = group.completed;\n                  const difficultyStars = 'â­'.repeat(group.difficulty);\n                  \n                  return (\n                    <div\n                      key={group.group}\n                      className={`situational-card ${isCompleted ? 'completed' : 'available'}`}\n                      onClick={() => navigate(`/situational-training?level=4&group=${group.group}&title=${encodeURIComponent(group.title)}`)}\n                      style={{\n                        background: '#ffffff',\n                        borderRadius: '15px',\n                        padding: '25px',\n                        cursor: 'pointer',\n                        transition: 'all 0.3s ease',\n                        border: isCompleted ? '3px solid #f59e0b' : '3px solid #10b981',\n                        position: 'relative',\n                        opacity: 1\n                      }}\n                      onMouseEnter={(e) => {\n                        e.currentTarget.style.transform = 'translateY(-5px)';\n                        e.currentTarget.style.boxShadow = '0 10px 30px rgba(0,0,0,0.15)';\n                      }}\n                      onMouseLeave={(e) => {\n                        e.currentTarget.style.transform = 'translateY(0)';\n                        e.currentTarget.style.boxShadow = 'none';\n                      }}\n                    >\n                      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '15px' }}>\n                        <div style={{ fontSize: '1.3em', fontWeight: 'bold', color: '#1f2937' }}>Group {group.group}</div>\n                        <div style={{ fontSize: '1.5em' }}>{difficultyStars}</div>\n                      </div>\n                      <div style={{ background: '#e5e7eb', borderRadius: '10px', height: '8px', marginBottom: '15px', overflow: 'hidden' }}>\n                        <div style={{ \n                          background: 'linear-gradient(90deg, #10b981, #059669)', \n                          height: '100%', \n                          borderRadius: '10px', \n                          transition: 'width 0.5s ease',\n                          width: `${group.progress}%`\n                        }}></div>\n                      </div>\n                      <div style={{ display: 'flex', justifyContent: 'space-between', fontSize: '0.9em', color: '#64748b' }}>\n                        <span>ì§„í–‰ë¥ : {group.progress}%</span>\n                        <span>{group.stages}</span>\n                      </div>\n                      <h3 style={{ margin: '10px 0 5px 0', color: '#1f2937' }}>{group.title}</h3>\n                      <div style={{ fontSize: '1em', color: '#4338ca', fontWeight: '600', marginBottom: '8px' }}>{group.subtitle}</div>\n                      <div style={{ fontSize: '0.9em', color: '#64748b', marginBottom: '15px' }}>{group.description}</div>\n                      <div style={{ \n                        background: '#f1f5f9', \n                        borderRadius: '8px', \n                        padding: '12px', \n                        fontSize: '0.8em', \n                        color: '#475569' \n                      }}>\n                        <strong>ì£¼ìš” ìƒí™©:</strong>\n                        <ul style={{ margin: '5px 0 0 15px', lineHeight: '1.4' }}>\n                          {group.scenarios.map((scenario, idx) => (\n                            <li key={idx}>{scenario}</li>\n                          ))}\n                        </ul>\n                      </div>\n                    </div>\n                  );\n                })}\n              </div>\n            </div>\n            \n            {/* Level 5 í•™ìˆ ì—°êµ¬ */}\n            <div style={{ marginBottom: '50px' }}>\n              <h2 style={{ color: '#1f2937', fontSize: '1.8em', marginBottom: '20px', textAlign: 'center' }}>\n                ğŸ“ Level 5: Academic Research Excellence\n              </h2>\n              <div style={{\n                display: 'grid',\n                gridTemplateColumns: 'repeat(auto-fit, minmax(350px, 1fr))',\n                gap: '20px'\n              }}>\n                {level5SituationalData.map(group => {\n                  const isCompleted = group.completed;\n                  const difficultyStars = 'â­'.repeat(group.difficulty);\n                  \n                  return (\n                    <div\n                      key={group.group}\n                      className={`situational-card ${isCompleted ? 'completed' : 'available'}`}\n                      onClick={() => navigate(`/situational-training?level=5&group=${group.group}&title=${encodeURIComponent(group.title)}`)}\n                      style={{\n                        background: '#ffffff',\n                        borderRadius: '15px',\n                        padding: '25px',\n                        cursor: 'pointer',\n                        transition: 'all 0.3s ease',\n                        border: isCompleted ? '3px solid #f59e0b' : '3px solid #0ea5e9',\n                        position: 'relative',\n                        opacity: 1\n                      }}\n                      onMouseEnter={(e) => {\n                        e.currentTarget.style.transform = 'translateY(-5px)';\n                        e.currentTarget.style.boxShadow = '0 10px 30px rgba(0,0,0,0.15)';\n                      }}\n                      onMouseLeave={(e) => {\n                        e.currentTarget.style.transform = 'translateY(0)';\n                        e.currentTarget.style.boxShadow = 'none';\n                      }}\n                    >\n                      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '15px' }}>\n                        <div style={{ fontSize: '1.3em', fontWeight: 'bold', color: '#1f2937' }}>Group {group.group}</div>\n                        <div style={{ fontSize: '1.5em' }}>{difficultyStars}</div>\n                      </div>\n                      <div style={{ background: '#e5e7eb', borderRadius: '10px', height: '8px', marginBottom: '15px', overflow: 'hidden' }}>\n                        <div style={{ \n                          background: 'linear-gradient(90deg, #0ea5e9, #0284c7)', \n                          height: '100%', \n                          borderRadius: '10px', \n                          transition: 'width 0.5s ease',\n                          width: `${group.progress}%`\n                        }}></div>\n                      </div>\n                      <div style={{ display: 'flex', justifyContent: 'space-between', fontSize: '0.9em', color: '#64748b' }}>\n                        <span>ì§„í–‰ë¥ : {group.progress}%</span>\n                        <span>{group.stages}</span>\n                      </div>\n                      <h3 style={{ margin: '10px 0 5px 0', color: '#1f2937' }}>{group.title}</h3>\n                      <div style={{ fontSize: '1em', color: '#0c4a6e', fontWeight: '600', marginBottom: '8px' }}>{group.subtitle}</div>\n                      <div style={{ fontSize: '0.9em', color: '#64748b', marginBottom: '15px' }}>{group.description}</div>\n                      <div style={{ \n                        background: '#f0f9ff', \n                        borderRadius: '8px', \n                        padding: '12px', \n                        fontSize: '0.8em', \n                        color: '#0c4a6e' \n                      }}>\n                        <strong>ì£¼ìš” ìƒí™©:</strong>\n                        <ul style={{ margin: '5px 0 0 15px', lineHeight: '1.4' }}>\n                          {group.scenarios.map((scenario, idx) => (\n                            <li key={idx}>{scenario}</li>\n                          ))}\n                        </ul>\n                      </div>\n                    </div>\n                  );\n                })}\n              </div>\n            </div>\n            \n            {/* Level 6 ì „ë¬¸ë¶„ì•¼ */}\n            <div>\n              <h2 style={{ color: '#1f2937', fontSize: '1.8em', marginBottom: '20px', textAlign: 'center' }}>\n                ğŸ¯ Level 6: Professional Domain Expertise\n              </h2>\n              <div style={{\n                display: 'grid',\n                gridTemplateColumns: 'repeat(auto-fit, minmax(350px, 1fr))',\n                gap: '20px'\n              }}>\n                {level6SituationalData.map(group => {\n                  const isCompleted = group.completed;\n                  const difficultyStars = 'â­'.repeat(group.difficulty);\n                  \n                  return (\n                    <div\n                      key={group.group}\n                      className={`situational-card ${isCompleted ? 'completed' : 'available'}`}\n                      onClick={() => navigate(`/situational-training?level=6&group=${group.group}&title=${encodeURIComponent(group.title)}`)}\n                      style={{\n                        background: '#ffffff',\n                        borderRadius: '15px',\n                        padding: '25px',\n                        cursor: 'pointer',\n                        transition: 'all 0.3s ease',\n                        border: isCompleted ? '3px solid #f59e0b' : '3px solid #c084fc',\n                        position: 'relative',\n                        opacity: 1\n                      }}\n                      onMouseEnter={(e) => {\n                        e.currentTarget.style.transform = 'translateY(-5px)';\n                        e.currentTarget.style.boxShadow = '0 10px 30px rgba(0,0,0,0.15)';\n                      }}\n                      onMouseLeave={(e) => {\n                        e.currentTarget.style.transform = 'translateY(0)';\n                        e.currentTarget.style.boxShadow = 'none';\n                      }}\n                    >\n                      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '15px' }}>\n                        <div style={{ fontSize: '1.3em', fontWeight: 'bold', color: '#1f2937' }}>Group {group.group}</div>\n                        <div style={{ fontSize: '1.5em' }}>{difficultyStars}</div>\n                      </div>\n                      <div style={{ background: '#e5e7eb', borderRadius: '10px', height: '8px', marginBottom: '15px', overflow: 'hidden' }}>\n                        <div style={{ \n                          background: 'linear-gradient(90deg, #c084fc, #a855f7)', \n                          height: '100%', \n                          borderRadius: '10px', \n                          transition: 'width 0.5s ease',\n                          width: `${group.progress}%`\n                        }}></div>\n                      </div>\n                      <div style={{ display: 'flex', justifyContent: 'space-between', fontSize: '0.9em', color: '#64748b' }}>\n                        <span>ì§„í–‰ë¥ : {group.progress}%</span>\n                        <span>{group.stages}</span>\n                      </div>\n                      <h3 style={{ margin: '10px 0 5px 0', color: '#1f2937' }}>{group.title}</h3>\n                      <div style={{ fontSize: '1em', color: '#7c2d92', fontWeight: '600', marginBottom: '8px' }}>{group.subtitle}</div>\n                      <div style={{ fontSize: '0.9em', color: '#64748b', marginBottom: '15px' }}>{group.description}</div>\n                      <div style={{ \n                        background: '#fdf4ff', \n                        borderRadius: '8px', \n                        padding: '12px', \n                        fontSize: '0.8em', \n                        color: '#7c2d92' \n                      }}>\n                        <strong>ì£¼ìš” ìƒí™©:</strong>\n                        <ul style={{ margin: '5px 0 0 15px', lineHeight: '1.4' }}>\n                          {group.scenarios.map((scenario, idx) => (\n                            <li key={idx}>{scenario}</li>\n                          ))}\n                        </ul>\n                      </div>\n                    </div>\n                  );\n                })}\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* íŒ¨í„´í•™ìŠµ - ìŠ¤í…Œì´ì§€ ìƒì„¸ í™”ë©´ */}\n        {currentView === 'stage' && currentLevel && (\n          <div style={{ padding: '30px' }}>\n            <div style={{\n              display: 'flex',\n              justifyContent: 'space-between',\n              alignItems: 'center',\n              marginBottom: '30px',\n              paddingBottom: '20px',\n              borderBottom: '2px solid #e5e7eb'\n            }}>\n              <button\n                onClick={() => setCurrentView('levels')}\n                style={{\n                  background: '#6b7280',\n                  color: 'white',\n                  border: 'none',\n                  padding: '10px 20px',\n                  borderRadius: '8px',\n                  cursor: 'pointer',\n                  fontSize: '16px',\n                  display: 'flex',\n                  alignItems: 'center',\n                  gap: '8px'\n                }}\n              >\n                â† ë ˆë²¨ ì„ íƒìœ¼ë¡œ\n              </button>\n              <div style={{ fontSize: '2em', color: '#1f2937' }}>\n                Level {currentLevel.level} - {currentLevel.title}\n              </div>\n              <div></div>\n            </div>\n\n            <div style={{\n              display: 'grid',\n              gridTemplateColumns: currentLevel.level === 2 ? 'repeat(10, 1fr)' : \n                                 currentLevel.level === 3 ? 'repeat(10, 1fr)' : 'repeat(auto-fit, minmax(60px, 1fr))',\n              justifyItems: 'center',\n              alignItems: 'center',\n              gap: '15px',\n              margin: '30px 0',\n              padding: '30px 20px',\n              background: '#f8fafc',\n              borderRadius: '15px',\n              maxWidth: currentLevel.level === 2 ? '800px' : currentLevel.level === 3 ? '900px' : '100%',\n              marginLeft: 'auto',\n              marginRight: 'auto'\n            }}>\n              {createStageSteps(currentLevel)}\n            </div>\n\n            <div style={{\n              display: 'grid',\n              gridTemplateColumns: 'repeat(auto-fit, minmax(250px, 1fr))',\n              gap: '20px',\n              margin: '30px 0'\n            }}>\n              <div style={{\n                background: '#f8fafc',\n                padding: '20px',\n                borderRadius: '10px',\n                borderLeft: '4px solid #3b82f6'\n              }}>\n                <h3 style={{ color: '#1f2937', marginBottom: '10px' }}>ğŸ¯ í•™ìŠµ ë™ì‚¬</h3>\n                <p style={{ color: '#64748b' }}>{currentLevel.verbs.join(', ')}</p>\n              </div>\n              <div style={{\n                background: '#f8fafc',\n                padding: '20px',\n                borderRadius: '10px',\n                borderLeft: '4px solid #3b82f6'\n              }}>\n                <h3 style={{ color: '#1f2937', marginBottom: '10px' }}>ğŸ“ í•™ìŠµ íŒ¨í„´</h3>\n                <p style={{ color: '#64748b' }}>I go, I don't go, Do you go?<br/>I'm going, I'm not going, Are you going?</p>\n              </div>\n              <div style={{\n                background: '#f8fafc',\n                padding: '20px',\n                borderRadius: '10px',\n                borderLeft: '4px solid #3b82f6'\n              }}>\n                <h3 style={{ color: '#1f2937', marginBottom: '10px' }}>ğŸ¯ ëª©í‘œ</h3>\n                <p style={{ color: '#64748b' }}>ì •í™•ë„ {currentLevel.targetAccuracy}% ì´ìƒ</p>\n              </div>\n              <div style={{\n                background: '#f8fafc',\n                padding: '20px',\n                borderRadius: '10px',\n                borderLeft: '4px solid #3b82f6'\n              }}>\n                <h3 style={{ color: '#1f2937', marginBottom: '10px' }}>ğŸ“Š í˜„ì¬ ì„±ê³¼</h3>\n                <p style={{ color: '#64748b' }}>ì •í™•ë„: 0%<br/>ìµœê³  ê¸°ë¡: 0%<br/>ì‹œë„ íšŸìˆ˜: 0</p>\n              </div>\n            </div>\n\n            {/* 3ë‹¨ê³„ ì„ íƒ ë²„íŠ¼ */}\n            <div style={{\n              marginTop: '30px',\n              marginBottom: '20px'\n            }}>\n              <div style={{\n                textAlign: 'center',\n                marginBottom: '15px'\n              }}>\n                <h3 style={{ color: '#1f2937', marginBottom: '5px', fontSize: '18px' }}>í•™ìŠµ ë‹¨ê³„ ì„ íƒ</h3>\n                <p style={{ color: '#64748b', fontSize: '14px' }}>ì†ë„ì— ë”°ë¼ ë‹¨ê³„ë¥¼ ì„ íƒí•˜ì„¸ìš”</p>\n              </div>\n              \n              <div style={{\n                display: 'grid',\n                gridTemplateColumns: 'repeat(3, 1fr)',\n                gap: '15px',\n                maxWidth: '400px',\n                margin: '0 auto'\n              }}>\n                <button\n                  onClick={() => setSpeakingStage(1)}\n                  style={{\n                    padding: '15px',\n                    border: speakingStage === 1 ? '2px solid #10b981' : '2px solid #d1d5db',\n                    borderRadius: '10px',\n                    background: speakingStage === 1 ? '#f0fdf4' : '#ffffff',\n                    color: speakingStage === 1 ? '#065f46' : '#374151',\n                    cursor: 'pointer',\n                    transition: 'all 0.2s ease',\n                    textAlign: 'center'\n                  }}\n                  onMouseEnter={(e) => {\n                    if (speakingStage !== 1) {\n                      e.currentTarget.style.borderColor = '#10b981';\n                      e.currentTarget.style.background = '#f0fdf4';\n                    }\n                  }}\n                  onMouseLeave={(e) => {\n                    if (speakingStage !== 1) {\n                      e.currentTarget.style.borderColor = '#d1d5db';\n                      e.currentTarget.style.background = '#ffffff';\n                    }\n                  }}\n                >\n                  <div style={{ fontSize: '18px', fontWeight: 'bold', marginBottom: '4px' }}>1ë‹¨ê³„</div>\n                  <div style={{ fontSize: '12px', color: '#6b7280' }}>3ì´ˆ ì‘ë‹µ</div>\n                </button>\n                \n                <button\n                  onClick={() => setSpeakingStage(2)}\n                  style={{\n                    padding: '15px',\n                    border: speakingStage === 2 ? '2px solid #3b82f6' : '2px solid #d1d5db',\n                    borderRadius: '10px',\n                    background: speakingStage === 2 ? '#eff6ff' : '#ffffff',\n                    color: speakingStage === 2 ? '#1e40af' : '#374151',\n                    cursor: 'pointer',\n                    transition: 'all 0.2s ease',\n                    textAlign: 'center'\n                  }}\n                  onMouseEnter={(e) => {\n                    if (speakingStage !== 2) {\n                      e.currentTarget.style.borderColor = '#3b82f6';\n                      e.currentTarget.style.background = '#eff6ff';\n                    }\n                  }}\n                  onMouseLeave={(e) => {\n                    if (speakingStage !== 2) {\n                      e.currentTarget.style.borderColor = '#d1d5db';\n                      e.currentTarget.style.background = '#ffffff';\n                    }\n                  }}\n                >\n                  <div style={{ fontSize: '18px', fontWeight: 'bold', marginBottom: '4px' }}>2ë‹¨ê³„</div>\n                  <div style={{ fontSize: '12px', color: '#6b7280' }}>2ì´ˆ ì‘ë‹µ</div>\n                </button>\n                \n                <button\n                  onClick={() => setSpeakingStage(3)}\n                  style={{\n                    padding: '15px',\n                    border: speakingStage === 3 ? '2px solid #8b5cf6' : '2px solid #d1d5db',\n                    borderRadius: '10px',\n                    background: speakingStage === 3 ? '#f3f4f6' : '#ffffff',\n                    color: speakingStage === 3 ? '#5b21b6' : '#374151',\n                    cursor: 'pointer',\n                    transition: 'all 0.2s ease',\n                    textAlign: 'center'\n                  }}\n                  onMouseEnter={(e) => {\n                    if (speakingStage !== 3) {\n                      e.currentTarget.style.borderColor = '#8b5cf6';\n                      e.currentTarget.style.background = '#f3f4f6';\n                    }\n                  }}\n                  onMouseLeave={(e) => {\n                    if (speakingStage !== 3) {\n                      e.currentTarget.style.borderColor = '#d1d5db';\n                      e.currentTarget.style.background = '#ffffff';\n                    }\n                  }}\n                >\n                  <div style={{ fontSize: '18px', fontWeight: 'bold', marginBottom: '4px' }}>3ë‹¨ê³„</div>\n                  <div style={{ fontSize: '12px', color: '#6b7280' }}>1ì´ˆ ì‘ë‹µ</div>\n                </button>\n              </div>\n              \n              <div style={{\n                textAlign: 'center',\n                marginTop: '10px'\n              }}>\n                <p style={{ fontSize: '12px', color: '#6b7280' }}>\n                  í˜„ì¬ ì„ íƒ: <span style={{ fontWeight: '600', color: '#374151' }}>\n                    {speakingStage}ë‹¨ê³„ ({speakingStage === 1 ? '3ì´ˆ' : speakingStage === 2 ? '2ì´ˆ' : '1ì´ˆ'} ì‘ë‹µ)\n                  </span>\n                </p>\n              </div>\n            </div>\n\n            <div style={{\n              display: 'flex',\n              justifyContent: 'center',\n              gap: '20px',\n              marginTop: '20px'\n            }}>\n              <button\n                onClick={startStage}\n                style={{\n                  padding: '15px 30px',\n                  border: 'none',\n                  borderRadius: '10px',\n                  fontSize: '18px',\n                  fontWeight: 'bold',\n                  cursor: 'pointer',\n                  transition: 'all 0.3s',\n                  color: 'white',\n                  background: 'linear-gradient(135deg, #10b981, #059669)'\n                }}\n                onMouseEnter={(e) => {\n                  e.currentTarget.style.transform = 'translateY(-2px)';\n                  e.currentTarget.style.boxShadow = '0 5px 15px rgba(0,0,0,0.3)';\n                }}\n                onMouseLeave={(e) => {\n                  e.currentTarget.style.transform = 'translateY(0)';\n                  e.currentTarget.style.boxShadow = 'none';\n                }}\n              >\n                ğŸš€ ìŠ¤í…Œì´ì§€ ì‹œì‘\n              </button>\n              <button\n                onClick={() => alert('ìƒì„¸ í†µê³„ í™”ë©´ì„ í‘œì‹œí•©ë‹ˆë‹¤.')}\n                style={{\n                  padding: '15px 30px',\n                  border: 'none',\n                  borderRadius: '10px',\n                  fontSize: '18px',\n                  fontWeight: 'bold',\n                  cursor: 'pointer',\n                  transition: 'all 0.3s',\n                  color: 'white',\n                  background: 'linear-gradient(135deg, #3b82f6, #1d4ed8)'\n                }}\n                onMouseEnter={(e) => {\n                  e.currentTarget.style.transform = 'translateY(-2px)';\n                  e.currentTarget.style.boxShadow = '0 5px 15px rgba(0,0,0,0.3)';\n                }}\n                onMouseLeave={(e) => {\n                  e.currentTarget.style.transform = 'translateY(0)';\n                  e.currentTarget.style.boxShadow = 'none';\n                }}\n              >\n                ğŸ“Š ìƒì„¸ í†µê³„\n              </button>\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* CSS ì• ë‹ˆë©”ì´ì…˜ */}\n      <style dangerouslySetInnerHTML={{\n        __html: `\n          @keyframes pulse {\n            0%, 100% { transform: scale(1); }\n            50% { transform: scale(1.1); }\n          }\n        `\n      }} />\n    </div>\n  );\n});\n\nexport default DashboardHome;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\pages\\Home.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\pages\\HomePage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useState' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":17,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'LearningMode' is defined but never used. Allowed unused vars must match /^_/u.","line":3,"column":91,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":103},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'handleLevelSelect' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":46,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":46,"endColumn":26}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useUser, useAppStore, useLearningMode, useSpeakingStage, useStageSelection, type LearningMode } from '@/store/useAppStore';\r\nimport { StageSelectionModal } from '@/components/StageSelectionModal';\r\nimport { SpeakingStageSelector } from '@/components/SpeakingStageSelector';\r\n\r\nexport const HomePage: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const user = useUser();\r\n  const learningMode = useLearningMode();\r\n  const speakingStage = useSpeakingStage();\r\n  const { setUserLevel, setUserStage, setLearningMode } = useAppStore();\r\n  const { setSelectedLevel, setStageModalOpen } = useStageSelection();\r\n\r\n  const handleStartStudy = () => {\r\n    // ver2 ë™ì‚¬êµ° ë ˆì´ë¸” ë§¤í•‘ (level-system.htmlê³¼ 100% ì¼ì¹˜)\r\n    const verbsByLevel: Record<number, string> = {\r\n      1: 'Beë™ì‚¬, ì¼ë°˜ë™ì‚¬, ë¶€ì •ë¬¸, ì˜ë¬¸ë¬¸, ê¸°ì´ˆí™•ì¥',\r\n      2: 'beë™ì‚¬, ì¼ë°˜ë™ì‚¬, ì¡°ë™ì‚¬, í˜„ì¬ì§„í–‰í˜•, ê³¼ê±°í˜•, ë¯¸ë˜í˜•',\r\n      3: 'ë¯¸ë˜í˜•ì‹¬í™”, í˜„ì¬ì™„ë£Œ, ê³¼ê±°ì™„ë£Œ, ìˆ˜ë™íƒœ, ì¡°ë™ì‚¬í™•ì¥, ì¡°ê±´ë¬¸, ê°€ì •ë²•',\r\n      4: 'buy, sell, use, try, find',\r\n      5: 'give, tell, show, meet, help',\r\n      6: 'come, leave, start, finish, plan',\r\n      7: 'choose, decide, prefer, expect, suppose',\r\n      8: 'keep, let, allow, suggest, recommend',\r\n      9: 'improve, reduce, compare, analyze, design',\r\n      10: 'coordinate, negotiate, prioritize, implement, evaluate'\r\n    };\r\n\r\n    // Navigate to pattern training with current level and stage\r\n    const params = new URLSearchParams();\r\n    params.set('level', user.level.toString());\r\n    params.set('stage', user.stage.toString());\r\n    params.set(\r\n      'verbs',\r\n      verbsByLevel[user.level] \r\n        || availableLevels.find(l => l.level === user.level)?.title \r\n        || 'General'\r\n    );\r\n    params.set('targetAccuracy', '80');\r\n    params.set('developerMode', 'false');\r\n    \r\n    window.location.href = `/pattern-training?${params.toString()}`;\r\n  };\r\n\r\n  const handleLevelSelect = (level: number, stage: number = 1) => {\r\n    setUserLevel(level);\r\n    setUserStage(stage);\r\n  };\r\n\r\n  const handleLevelClick = (level: number) => {\r\n    setSelectedLevel(level);\r\n    setStageModalOpen(true);\r\n  };\r\n\r\n  // ì™„ì„±ëœ ë ˆë²¨ë“¤ê³¼ ì‚¬ìš© ê°€ëŠ¥í•œ ìŠ¤í…Œì´ì§€ ì •ë³´\r\n  const availableLevels = [\r\n    { \r\n      level: 1, \r\n      title: 'ê¸°ì´ˆ í‘œí˜„', \r\n      description: 'A1 ì˜ì–´ ê¸°ì´ˆ íŒ¨í„´', \r\n      stages: 19, \r\n      completed: true,\r\n      color: 'bg-emerald-500'\r\n    },\r\n    { \r\n      level: 2, \r\n      title: 'ê¸°ë³¸ íŒ¨í„´', \r\n      description: 'A2-B1 ê¸°ì´ˆ ë¬¸ë²•', \r\n      stages: 20, \r\n      completed: true,\r\n      color: 'bg-green-500'\r\n    },\r\n    { \r\n      level: 3, \r\n      title: 'ê³ ê¸‰ ë¬¸ë²•', \r\n      description: 'B1-B2 ë³µë¬¸ êµ¬ì¡°', \r\n      stages: 28, \r\n      completed: true,\r\n      color: 'bg-blue-500'\r\n    },\r\n    { \r\n      level: 4, \r\n      title: 'ê³ ê¸‰ í‘œí˜„', \r\n      description: 'B2-C1 ì‹¤ë¬´ ì˜ì–´', \r\n      stages: 29, \r\n      completed: true,\r\n      color: 'bg-purple-500'\r\n    },\r\n    { \r\n      level: 5, \r\n      title: 'ê³ ê¸‰ ë¹„ì¦ˆë‹ˆìŠ¤', \r\n      description: 'C1-C2 ë¹„ì¦ˆë‹ˆìŠ¤ ì˜ì–´', \r\n      stages: 29, \r\n      completed: true,\r\n      color: 'bg-indigo-500'\r\n    },\r\n    { \r\n      level: 6, \r\n      title: 'ë„ë©”ì¸ ì „ë¬¸ì„±', \r\n      description: 'C2 ì „ë¬¸ ë¶„ì•¼ ì˜ì–´', \r\n      stages: 34, \r\n      completed: true,\r\n      color: 'bg-orange-500'\r\n    },\r\n    { \r\n      level: 7, \r\n      title: 'ë¹„ì¦ˆë‹ˆìŠ¤ ì˜ì–´', \r\n      description: 'C2 ê³ ê¸‰ ë¹„ì¦ˆë‹ˆìŠ¤', \r\n      stages: 42, \r\n      completed: true,\r\n      color: 'bg-red-500'\r\n    },\r\n    { \r\n      level: 8, \r\n      title: 'ê³ ê¸‰ ë‹´í™”', \r\n      description: 'C2+ ê³ ê¸‰ í‘œí˜„', \r\n      stages: 46, \r\n      completed: true,\r\n      color: 'bg-pink-500'\r\n    },\r\n    { \r\n      level: 9, \r\n      title: 'ì „ë¬¸ê°€ ë‹´í™”', \r\n      description: 'Expert ì „ë¬¸ê°€ ìˆ˜ì¤€', \r\n      stages: 52, \r\n      completed: true,\r\n      color: 'bg-violet-500'\r\n    },\r\n    { \r\n      level: 10, \r\n      title: 'ì›ì–´ë¯¼ ìˆ˜ì¤€', \r\n      description: 'Native ì›ì–´ë¯¼ ìˆ˜ì¤€', \r\n      stages: 52, \r\n      completed: true,\r\n      color: 'bg-slate-600'\r\n    }\r\n  ];\r\n\r\n  const getLevelTitle = (level: number) => {\r\n    const found = availableLevels.find(l => l.level === level);\r\n    return found ? found.title : `Level ${level}`;\r\n  };\r\n\r\n  const getProgressPercentage = () => {\r\n    // Calculate progress based on available levels\r\n    const totalStages = availableLevels.slice(0, user.level - 1).reduce((acc, level) => acc + level.stages, 0) + user.stage;\r\n    const maxStages = availableLevels.reduce((acc, level) => acc + level.stages, 0);\r\n    return Math.round((totalStages / maxStages) * 100);\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4\">\r\n      <div className=\"max-w-4xl w-full bg-white rounded-lg shadow-lg p-8\">\r\n        {/* Header */}\r\n        <div className=\"text-center mb-8\">\r\n          <h1 className=\"text-4xl font-bold text-gray-800 mb-2\">\r\n            ğŸ¯ DASI English\r\n          </h1>\r\n          <p className=\"text-gray-600\">ë‹¤ì‹œ ì˜ì–´ - í•œêµ­ì¸ íŠ¹í™” AI ì˜ì–´ í•™ìŠµ</p>\r\n        </div>\r\n\r\n        {/* Learning Mode Selection */}\r\n        <div className=\"bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg p-6 text-white mb-6\">\r\n          <div className=\"text-center mb-6\">\r\n            <h2 className=\"text-xl font-bold mb-3\">ğŸ¯ í•™ìŠµ ëª¨ë“œ ì„ íƒ</h2>\r\n            <p className=\"text-sm opacity-90\">ëª¨ë“  í•™ìŠµì— ì ìš©ë˜ëŠ” ì…ë ¥ ë°©ì‹ì„ ì„ íƒí•˜ì„¸ìš”</p>\r\n            \r\n            {/* í˜„ì¬ ì„ íƒëœ ëª¨ë“œ í‘œì‹œ */}\r\n            <div className=\"mt-4 px-4 py-2 bg-white bg-opacity-20 rounded-lg inline-block\">\r\n              <div className=\"text-sm font-medium\">\r\n                í˜„ì¬ ì„ íƒ: {learningMode === 'writing' ? 'âœï¸ Writing ëª¨ë“œ' : 'ğŸ¤ Speaking ëª¨ë“œ'}\r\n              </div>\r\n            </div>\r\n          </div>\r\n          \r\n          <div className=\"grid grid-cols-2 gap-4\">\r\n            <button\r\n              onClick={() => setLearningMode('writing')}\r\n              className={`p-6 rounded-lg transition-all duration-300 border-2 ${\r\n                learningMode === 'writing'\r\n                  ? 'bg-white text-purple-600 shadow-xl transform scale-105 border-white'\r\n                  : 'bg-white bg-opacity-10 hover:bg-opacity-20 border-white border-opacity-30 hover:border-opacity-50'\r\n              }`}\r\n            >\r\n              <div className=\"text-3xl mb-3\">âœï¸</div>\r\n              <div className={`font-bold text-base mb-2 ${\r\n                learningMode === 'writing' ? 'text-purple-600' : 'text-white'\r\n              }`}>\r\n                Writing ëª¨ë“œ\r\n              </div>\r\n              <div className={`text-sm ${\r\n                learningMode === 'writing' ? 'text-purple-500' : 'text-white opacity-80'\r\n              }`}>\r\n                í‚¤ë³´ë“œ ì…ë ¥, ë¬¸ë²• ì²´í¬\r\n              </div>\r\n              {learningMode === 'writing' && (\r\n                <div className=\"mt-3 text-purple-600 font-bold text-sm\">\r\n                  âœ“ ì„ íƒë¨\r\n                </div>\r\n              )}\r\n            </button>\r\n            \r\n            <button\r\n              onClick={() => setLearningMode('speaking')}\r\n              className={`p-6 rounded-lg transition-all duration-300 border-2 ${\r\n                learningMode === 'speaking'\r\n                  ? 'bg-white text-purple-600 shadow-xl transform scale-105 border-white'\r\n                  : 'bg-white bg-opacity-10 hover:bg-opacity-20 border-white border-opacity-30 hover:border-opacity-50'\r\n              }`}\r\n            >\r\n              <div className=\"text-3xl mb-3\">ğŸ¤</div>\r\n              <div className={`font-bold text-base mb-2 ${\r\n                learningMode === 'speaking' ? 'text-purple-600' : 'text-white'\r\n              }`}>\r\n                Speaking ëª¨ë“œ\r\n              </div>\r\n              <div className={`text-sm ${\r\n                learningMode === 'speaking' ? 'text-purple-500' : 'text-white opacity-80'\r\n              }`}>\r\n                ìŒì„± ì…ë ¥, ë°œìŒ ì²´í¬\r\n              </div>\r\n              {learningMode === 'speaking' && (\r\n                <div className=\"mt-3 text-purple-600 font-bold text-sm\">\r\n                  âœ“ ì„ íƒë¨\r\n                </div>\r\n              )}\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Current Level Display */}\r\n        <div className=\"bg-gradient-to-r from-blue-500 to-indigo-600 rounded-lg p-6 text-white mb-6\">\r\n          <div className=\"flex items-center justify-between mb-4\">\r\n            <div>\r\n              <h2 className=\"text-sm font-medium opacity-90\">í˜„ì¬ ë ˆë²¨</h2>\r\n              <h3 className=\"text-2xl font-bold\">\r\n                Level {user.level} - {getLevelTitle(user.level)}\r\n              </h3>\r\n            </div>\r\n            <div className=\"text-right\">\r\n              <div className=\"text-sm opacity-90\">ìŠ¤í…Œì´ì§€</div>\r\n              <div className=\"text-xl font-bold\">\r\n                {user.stage === 'ALL' ? 'ALL' : `${user.stage}/${availableLevels.find(l => l.level === user.level)?.stages || 10}`}\r\n              </div>\r\n            </div>\r\n          </div>\r\n          \r\n          {/* Progress Bar */}\r\n          <div className=\"bg-white bg-opacity-20 rounded-full h-2 mb-2\">\r\n            <div \r\n              className=\"bg-white rounded-full h-2 transition-all duration-500\"\r\n              style={{ \r\n                width: user.stage === 'ALL' \r\n                  ? '100%' \r\n                  : `${(user.stage / (availableLevels.find(l => l.level === user.level)?.stages || 10)) * 100}%` \r\n              }}\r\n            />\r\n          </div>\r\n          <div className=\"text-xs opacity-90 flex items-center justify-center space-x-2\">\r\n            <span>ì „ì²´ ì§„í–‰ë„: {getProgressPercentage()}%</span>\r\n            <span>â€¢</span>\r\n            <div className={`px-2 py-1 rounded text-xs font-medium ${\r\n              learningMode === 'writing' \r\n                ? 'bg-blue-500 text-white' \r\n                : 'bg-green-500 text-white'\r\n            }`}>\r\n              {learningMode === 'writing' ? 'âœï¸ Writing' : 'ğŸ¤ Speaking'} ëª¨ë“œ\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Speaking Stage Selector - Only show in Speaking mode */}\r\n        {learningMode === 'speaking' && (\r\n          <SpeakingStageSelector\r\n            currentStage={speakingStage.stage}\r\n            onStageChange={speakingStage.setSpeakingStage}\r\n          />\r\n        )}\r\n\r\n        {/* ë©”ì¸ í•™ìŠµ ì„¹ì…˜ 3ê°œë¡œ ë¶„ë¦¬ */}\r\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\">\r\n          {/* ë©”ì¸ í•™ìŠµ ì„¹ì…˜ */}\r\n          <div className=\"bg-white rounded-lg shadow-lg border border-gray-200\">\r\n            <div className=\"bg-gradient-to-r from-blue-500 to-indigo-600 text-white p-4 rounded-t-lg\">\r\n              <h2 className=\"text-lg font-bold\">ë©”ì¸ í•™ìŠµ</h2>\r\n              <p className=\"text-sm opacity-90\">ì£¼ìš” í•™ìŠµ ê¸°ëŠ¥</p>\r\n            </div>\r\n            <div className=\"p-4 space-y-3\">\r\n              <button\r\n                onClick={handleStartStudy}\r\n                className=\"w-full bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 text-white font-bold py-3 px-4 rounded-lg transition-all duration-200\"\r\n              >\r\n                ğŸ¯ Level {user.level}{user.stage === 'ALL' ? ' ALL ëª¨ë“œ' : ` Stage ${user.stage}`} í•™ìŠµ ì‹œì‘\r\n              </button>\r\n              \r\n              <button\r\n                onClick={() => navigate('/all-mode')}\r\n                className=\"w-full bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white font-bold py-3 px-4 rounded-lg transition-all duration-200\"\r\n              >\r\n                ğŸ”„ ALL ëª¨ë“œ\r\n                <div className=\"text-xs opacity-90 mt-1\">ë§ê°ê³¡ì„  ë³µìŠµ</div>\r\n              </button>\r\n              \r\n              <button\r\n                onClick={() => navigate('/personalized')}\r\n                className=\"w-full bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white font-bold py-3 px-4 rounded-lg transition-all duration-200\"\r\n              >\r\n                ğŸ¤– ë§ì¶¤íŒ©\r\n                <div className=\"text-xs opacity-90 mt-1\">AI ìë™ìƒì„±</div>\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n          {/* í•™ìŠµ ê´€ë¦¬ ì„¹ì…˜ */}\r\n          <div className=\"bg-white rounded-lg shadow-lg border border-gray-200\">\r\n            <div className=\"bg-gradient-to-r from-green-500 to-teal-600 text-white p-4 rounded-t-lg\">\r\n              <h2 className=\"text-lg font-bold\">í•™ìŠµ ê´€ë¦¬</h2>\r\n              <p className=\"text-sm opacity-90\">ì§„ë„ ë° ì„±ê³¼ ê´€ë¦¬</p>\r\n            </div>\r\n            <div className=\"p-4 space-y-3\">\r\n              <button\r\n                onClick={() => navigate('/progress')}\r\n                className=\"w-full bg-indigo-500 hover:bg-indigo-600 text-white font-medium py-3 px-4 rounded-lg transition-colors duration-200\"\r\n              >\r\n                ğŸ“Š ì§„ë„ ê´€ë¦¬\r\n              </button>\r\n              \r\n              {/* ë ˆë²¨ ì„ íƒì */}\r\n              <div className=\"bg-gray-50 rounded-lg p-3\">\r\n                <h3 className=\"font-medium text-gray-800 mb-2 text-sm\">ğŸ“š ë ˆë²¨ ì„ íƒ</h3>\r\n                <div className=\"grid grid-cols-5 gap-1\">\r\n                  {availableLevels.slice(0, 10).map((levelInfo) => (\r\n                    <button\r\n                      key={levelInfo.level}\r\n                      onClick={() => handleLevelClick(levelInfo.level)}\r\n                      className={`p-2 rounded text-xs font-bold transition-all duration-200 ${\r\n                        user.level === levelInfo.level\r\n                          ? `${levelInfo.color} text-white shadow-md`\r\n                          : 'bg-white border border-gray-200 hover:border-gray-300 text-gray-700'\r\n                      }`}\r\n                      title={`Level ${levelInfo.level}: ${levelInfo.title}`}\r\n                    >\r\n                      {levelInfo.level}\r\n                    </button>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* ë³´ì¡° í•™ìŠµ ì„¹ì…˜ */}\r\n          <div className=\"bg-white rounded-lg shadow-lg border border-gray-200\">\r\n            <div className=\"bg-gradient-to-r from-purple-500 to-pink-600 text-white p-4 rounded-t-lg\">\r\n              <h2 className=\"text-lg font-bold\">ë³´ì¡° í•™ìŠµ</h2>\r\n              <p className=\"text-sm opacity-90\">ì¶”ê°€ ê¸°ëŠ¥ ë° ë„êµ¬</p>\r\n            </div>\r\n            <div className=\"p-4 space-y-3\">\r\n              <button\r\n                onClick={() => navigate('/scenario')}\r\n                className=\"w-full bg-teal-500 hover:bg-teal-600 text-white font-medium py-3 px-4 rounded-lg transition-colors duration-200\"\r\n              >\r\n                ğŸ­ ì‹œë‚˜ë¦¬ì˜¤ ëŒ€í™”\r\n              </button>\r\n              \r\n              <button\r\n                onClick={() => alert('ì¤€ë¹„ì¤‘ì…ë‹ˆë‹¤.')}\r\n                className=\"w-full relative bg-gray-400 text-white font-medium py-3 px-4 rounded-lg cursor-not-allowed\"\r\n                disabled\r\n              >\r\n                ğŸ“‹ í•™ìŠµ ê³„íš\r\n                <span className=\"absolute top-1 right-2 bg-yellow-500 text-black text-xs px-2 py-0.5 rounded-full font-bold\">ì¤€ë¹„ì¤‘</span>\r\n              </button>\r\n              \r\n              <button\r\n                onClick={() => alert('ì¤€ë¹„ì¤‘ì…ë‹ˆë‹¤.')}\r\n                className=\"w-full relative bg-gray-400 text-white font-medium py-3 px-4 rounded-lg cursor-not-allowed\"\r\n                disabled\r\n              >\r\n                ğŸ“„ ì„±ê³¼ ë¶„ì„\r\n                <span className=\"absolute top-1 right-2 bg-yellow-500 text-black text-xs px-2 py-0.5 rounded-full font-bold\">ì¤€ë¹„ì¤‘</span>\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* 4-tile í†µê³„ ë¯¸ë¦¬ë³´ê¸° */}\r\n        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8\">\r\n          <div className=\"bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg p-4 text-center\">\r\n            <div className=\"text-2xl font-bold\">{user.level}</div>\r\n            <div className=\"text-sm opacity-90\">í˜„ì¬ ë ˆë²¨</div>\r\n          </div>\r\n          <div className=\"bg-gradient-to-r from-green-500 to-green-600 text-white rounded-lg p-4 text-center\">\r\n            <div className=\"text-2xl font-bold\">{user.stage}</div>\r\n            <div className=\"text-sm opacity-90\">í˜„ì¬ ìŠ¤í…Œì´ì§€</div>\r\n          </div>\r\n          <div className=\"bg-gradient-to-r from-purple-500 to-purple-600 text-white rounded-lg p-4 text-center\">\r\n            <div className=\"text-2xl font-bold\">{getProgressPercentage()}%</div>\r\n            <div className=\"text-sm opacity-90\">ì „ì²´ ì§„ë„</div>\r\n          </div>\r\n          <div className=\"bg-gradient-to-r from-orange-500 to-orange-600 text-white rounded-lg p-4 text-center\">\r\n            <div className=\"text-2xl font-bold\">{learningMode === 'writing' ? 'âœï¸' : 'ğŸ¤'}</div>\r\n            <div className=\"text-sm opacity-90\">{learningMode === 'writing' ? 'Writing' : 'Speaking'} ëª¨ë“œ</div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Development Tools */}\r\n        <div className=\"mt-6 pt-4 border-t border-gray-200\">\r\n          <details className=\"group\">\r\n            <summary className=\"cursor-pointer text-sm text-gray-500 hover:text-gray-700 transition-colors\">\r\n              ğŸ”§ ê°œë°œ ë„êµ¬\r\n            </summary>\r\n            <div className=\"mt-3 grid grid-cols-2 gap-2 text-xs\">\r\n              <button \r\n                onClick={() => navigate('/curriculum-test')}\r\n                className=\"text-purple-600 hover:text-purple-800 transition-colors p-2 bg-purple-50 rounded\"\r\n              >\r\n                ğŸ§ª ì»¤ë¦¬í˜ëŸ¼ í…ŒìŠ¤íŠ¸\r\n              </button>\r\n              <button \r\n                onClick={() => navigate('/curriculum-lint')}\r\n                className=\"text-indigo-600 hover:text-indigo-800 transition-colors p-2 bg-indigo-50 rounded\"\r\n              >\r\n                ğŸ“‹ ì½˜í…ì¸  ë¦°íŠ¸\r\n              </button>\r\n              <button \r\n                onClick={() => navigate('/audio-test')}\r\n                className=\"text-red-600 hover:text-red-800 transition-colors p-2 bg-red-50 rounded\"\r\n              >\r\n                ğŸµ AudioV2 í…ŒìŠ¤íŠ¸\r\n              </button>\r\n              <button \r\n                onClick={() => navigate('/settings')}\r\n                className=\"text-gray-600 hover:text-gray-800 transition-colors p-2 bg-gray-50 rounded\"\r\n              >\r\n                âš™ï¸ ì„¤ì •\r\n              </button>\r\n            </div>\r\n          </details>\r\n        </div>\r\n\r\n        {/* Stage Selection Modal */}\r\n        <StageSelectionModal availableLevels={availableLevels} />\r\n      </div>\r\n    </div>\r\n  );\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\pages\\ImitationPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setAudioUrl' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":13,"column":20,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":31},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setCurrentSentence' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":14,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":14,"endColumn":45},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setFeedback' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":15,"column":20,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":31}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Imitation Page - ëª¨ë°© í•™ìŠµ í˜ì´ì§€\r\n */\r\n\r\nimport React, { useState, useRef } from 'react';\r\n\r\ninterface ImitationPageProps {\r\n  // TODO: Props íƒ€ì… ì •ì˜ ì¶”ê°€\r\n}\r\n\r\nconst ImitationPage: React.FC<ImitationPageProps> = () => {\r\n  const [isRecording, setIsRecording] = useState(false);\r\n  const [audioUrl, setAudioUrl] = useState<string>('');\r\n  const [currentSentence, setCurrentSentence] = useState('Hello, how are you?');\r\n  const [feedback, setFeedback] = useState<string>('');\r\n  const audioRef = useRef<HTMLAudioElement>(null);\r\n\r\n  const startRecording = async () => {\r\n    setIsRecording(true);\r\n    // TODO: ì‹¤ì œ ë…¹ìŒ ë¡œì§ êµ¬í˜„ (ê¸°ì¡´ AudioRecorder ì»´í¬ë„ŒíŠ¸ í™œìš©)\r\n  };\r\n\r\n  const stopRecording = async () => {\r\n    setIsRecording(false);\r\n    // TODO: ë…¹ìŒ ì¤‘ë‹¨ ë° ë¶„ì„ ë¡œì§ êµ¬í˜„\r\n  };\r\n\r\n  const playTargetAudio = () => {\r\n    // TODO: TTSë¥¼ í†µí•œ ëª©í‘œ ë¬¸ì¥ ì¬ìƒ\r\n    console.log('Playing target sentence:', currentSentence);\r\n  };\r\n\r\n  return (\r\n    <div className=\"imitation-page\">\r\n      <div className=\"container mx-auto px-4 py-6\">\r\n        <h1 className=\"text-2xl font-bold mb-6\">ëª¨ë°© í•™ìŠµ</h1>\r\n        \r\n        {/* ëª©í‘œ ë¬¸ì¥ ì„¹ì…˜ */}\r\n        <div className=\"target-sentence-section bg-white rounded-lg shadow-md p-6 mb-6\">\r\n          <h2 className=\"text-xl font-semibold mb-4\">ëª©í‘œ ë¬¸ì¥</h2>\r\n          <div className=\"sentence-display bg-blue-50 rounded-lg p-4 mb-4\">\r\n            <p className=\"text-lg text-blue-800 font-medium\">{currentSentence}</p>\r\n          </div>\r\n          \r\n          <div className=\"audio-controls mb-4\">\r\n            <button \r\n              onClick={playTargetAudio}\r\n              className=\"bg-green-500 text-white px-4 py-2 rounded-md hover:bg-green-600 transition-colors mr-3\"\r\n            >\r\n              ğŸ”Š ëª©í‘œ ë°œìŒ ë“£ê¸°\r\n            </button>\r\n            <button className=\"bg-gray-500 text-white px-4 py-2 rounded-md hover:bg-gray-600 transition-colors\">\r\n              ëŠë¦¬ê²Œ ì¬ìƒ\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* ë…¹ìŒ ì„¹ì…˜ */}\r\n        <div className=\"recording-section bg-white rounded-lg shadow-md p-6 mb-6\">\r\n          <h2 className=\"text-xl font-semibold mb-4\">ë°œìŒ ì—°ìŠµ</h2>\r\n          \r\n          <div className=\"recording-controls mb-4\">\r\n            {!isRecording ? (\r\n              <button \r\n                onClick={startRecording}\r\n                className=\"bg-red-500 text-white px-6 py-3 rounded-full hover:bg-red-600 transition-colors\"\r\n              >\r\n                ğŸ¤ ë…¹ìŒ ì‹œì‘\r\n              </button>\r\n            ) : (\r\n              <button \r\n                onClick={stopRecording}\r\n                className=\"bg-gray-500 text-white px-6 py-3 rounded-full hover:bg-gray-600 transition-colors\"\r\n              >\r\n                â¹ï¸ ë…¹ìŒ ì¤‘ë‹¨\r\n              </button>\r\n            )}\r\n          </div>\r\n\r\n          {isRecording && (\r\n            <div className=\"recording-indicator\">\r\n              <div className=\"flex items-center justify-center\">\r\n                <div className=\"animate-pulse bg-red-500 rounded-full h-4 w-4 mr-2\"></div>\r\n                <span className=\"text-red-500 font-medium\">ë…¹ìŒ ì¤‘...</span>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {audioUrl && (\r\n            <div className=\"recorded-audio mt-4\">\r\n              <h3 className=\"font-medium mb-2\">ë…¹ìŒëœ ìŒì„±</h3>\r\n              <audio ref={audioRef} controls className=\"w-full\">\r\n                <source src={audioUrl} type=\"audio/webm\" />\r\n              </audio>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* í”¼ë“œë°± ì„¹ì…˜ */}\r\n        {feedback && (\r\n          <div className=\"feedback-section bg-white rounded-lg shadow-md p-6\">\r\n            <h2 className=\"text-xl font-semibold mb-4\">ë°œìŒ í”¼ë“œë°±</h2>\r\n            <div className=\"feedback-content bg-yellow-50 rounded-lg p-4\">\r\n              <p className=\"text-yellow-800\">{feedback}</p>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* ì§„í–‰ ìƒí™© */}\r\n        <div className=\"progress-section bg-white rounded-lg shadow-md p-6 mt-6\">\r\n          <h2 className=\"text-xl font-semibold mb-4\">í•™ìŠµ ì§„í–‰ ìƒí™©</h2>\r\n          <div className=\"progress-bar bg-gray-200 rounded-full h-2 mb-2\">\r\n            <div className=\"progress-fill bg-blue-500 h-2 rounded-full\" style={{ width: '35%' }}></div>\r\n          </div>\r\n          <p className=\"text-sm text-gray-600\">ì „ì²´ ì§„í–‰ë¥ : 35% (7/20 ë¬¸ì¥ ì™„ë£Œ)</p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ImitationPage;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\pages\\LandingHome.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isDark' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":11,"column":24,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":30},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'currentLevelProgress' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":124,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":124,"endColumn":31},{"ruleId":"no-undef","severity":1,"message":"'EventListener' is not defined.","line":169,"column":71,"nodeType":"Identifier","messageId":"undef","endLine":169,"endColumn":84},{"ruleId":"no-undef","severity":1,"message":"'EventListener' is not defined.","line":172,"column":76,"nodeType":"Identifier","messageId":"undef","endLine":172,"endColumn":89}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useUser, useStageSelection } from '@/store/useAppStore';\nimport { StageSelectionModal } from '@/components/StageSelectionModal';\nimport { useTheme } from '@/hooks/useTheme';\n\nexport const LandingHome: React.FC = () => {\n  const navigate = useNavigate();\n  const user = useUser();\n  const { setSelectedLevel, setStageModalOpen } = useStageSelection();\n  const { toggleTheme, isDark, getThemeIcon, getThemeLabel } = useTheme();\n\n  // ì™„ì„±ëœ ë ˆë²¨ë“¤ê³¼ ì‚¬ìš© ê°€ëŠ¥í•œ ìŠ¤í…Œì´ì§€ ì •ë³´\n  const availableLevels = [\n    { \n      level: 1, \n      title: 'ê¸°ì´ˆ í‘œí˜„', \n      description: 'A1 ì˜ì–´ ê¸°ì´ˆ íŒ¨í„´', \n      stages: 19, \n      completed: true,\n      color: 'bg-emerald-500'\n    },\n    { \n      level: 2, \n      title: 'ê¸°ë³¸ íŒ¨í„´', \n      description: 'A2-B1 ê¸°ì´ˆ ë¬¸ë²•', \n      stages: 20, \n      completed: true,\n      color: 'bg-green-500'\n    },\n    { \n      level: 3, \n      title: 'ê³ ê¸‰ ë¬¸ë²•', \n      description: 'B1-B2 ë³µë¬¸ êµ¬ì¡°', \n      stages: 28, \n      completed: true,\n      color: 'bg-blue-500'\n    },\n    { \n      level: 4, \n      title: 'ê³ ê¸‰ í‘œí˜„', \n      description: 'B2-C1 ì‹¤ë¬´ ì˜ì–´', \n      stages: 29, \n      completed: true,\n      color: 'bg-purple-500'\n    },\n    { \n      level: 5, \n      title: 'ê³ ê¸‰ ë¹„ì¦ˆë‹ˆìŠ¤', \n      description: 'C1-C2 ë¹„ì¦ˆë‹ˆìŠ¤ ì˜ì–´', \n      stages: 29, \n      completed: true,\n      color: 'bg-indigo-500'\n    },\n    { \n      level: 6, \n      title: 'ë„ë©”ì¸ ì „ë¬¸ì„±', \n      description: 'C2 ì „ë¬¸ ë¶„ì•¼ ì˜ì–´', \n      stages: 34, \n      completed: true,\n      color: 'bg-orange-500'\n    },\n    { \n      level: 7, \n      title: 'ë¹„ì¦ˆë‹ˆìŠ¤ ì˜ì–´', \n      description: 'C2 ê³ ê¸‰ ë¹„ì¦ˆë‹ˆìŠ¤', \n      stages: 42, \n      completed: true,\n      color: 'bg-red-500'\n    },\n    { \n      level: 8, \n      title: 'ê³ ê¸‰ ë‹´í™”', \n      description: 'C2+ ê³ ê¸‰ í‘œí˜„', \n      stages: 46, \n      completed: true,\n      color: 'bg-pink-500'\n    },\n    { \n      level: 9, \n      title: 'ì „ë¬¸ê°€ ë‹´í™”', \n      description: 'Expert ì „ë¬¸ê°€ ìˆ˜ì¤€', \n      stages: 52, \n      completed: true,\n      color: 'bg-violet-500'\n    },\n    { \n      level: 10, \n      title: 'ì›ì–´ë¯¼ ìˆ˜ì¤€', \n      description: 'Native ì›ì–´ë¯¼ ìˆ˜ì¤€', \n      stages: 52, \n      completed: true,\n      color: 'bg-slate-600'\n    }\n  ];\n\n  const showComingSoon = (feature: string) => {\n    alert(`ğŸš§ ${feature} ê¸°ëŠ¥ì€ í˜„ì¬ ê°œë°œ ì¤‘ì…ë‹ˆë‹¤.\\n\\nê³§ ë§Œë‚˜ë³´ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤! ğŸ˜Š`);\n  };\n\n  const handleSettings = () => {\n    navigate('/settings');\n  };\n\n  const handlePatternLearning = () => {\n    navigate('/dashboard');\n  };\n\n  const handleProgressManagement = () => {\n    navigate('/progress'); // ì§„ë„ê´€ë¦¬ í˜ì´ì§€ë¡œ ì´ë™\n  };\n\n  const handleAchievements = () => {\n    navigate('/achievements'); // ì—…ì  í˜ì´ì§€ë¡œ ì´ë™\n  };\n\n  const handleVocabulary = () => {\n    navigate('/vocabulary'); // ë‹¨ì–´ì¥ í˜ì´ì§€ë¡œ ì´ë™\n  };\n\n  // ë™ì  í†µê³„ ê³„ì‚°\n  const calculateStats = () => {\n    // í˜„ì¬ ë ˆë²¨ ì§„í–‰ë¥  ê³„ì‚°\n    const currentLevelProgress = user.stage === 'ALL' \n      ? 100 \n      : Math.round((user.stage / 19) * 100);\n    \n    // ì „ì²´ ì™„ì„±ëœ ìŠ¤í…Œì´ì§€ ìˆ˜ (Level 1-2 ì™„ì„± ê¸°ì¤€)\n    const completedStages = user.level === 1 \n      ? Math.max(0, user.stage - 1)\n      : (user.level - 1) * 19 + (user.stage === 'ALL' ? 19 : user.stage - 1);\n    \n    // ì—°ì† í•™ìŠµì¼ (ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì—ì„œ ê°€ì ¸ì˜¤ê±°ë‚˜ ê¸°ë³¸ê°’)\n    const getConsecutiveDays = () => {\n      try {\n        const lastStudyDate = localStorage.getItem('lastStudyDate');\n        const consecutiveDays = localStorage.getItem('consecutiveDays');\n        const today = new Date().toDateString();\n        \n        if (lastStudyDate === today) {\n          return parseInt(consecutiveDays || '1');\n        }\n        return 1; // ê¸°ë³¸ê°’\n      } catch {\n        return 1;\n      }\n    };\n    \n    return {\n      currentLevel: user.level,\n      stageProgress: user.stage === 'ALL' ? 'ALL' : `${user.stage}/19`,\n      completionRate: `${Math.min(100, Math.round((completedStages / 380) * 100))}%`, // Level 1-10 ì´ 380ê°œ ìŠ¤í…Œì´ì§€ ê¸°ì¤€\n      consecutiveDays: getConsecutiveDays()\n    };\n  };\n\n  const stats = calculateStats();\n\n  // ìŠ¤í…Œì´ì§€ ëª¨ë‹¬ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ\n  useEffect(() => {\n    // íŒ¨í„´ íŠ¸ë ˆì´ë‹ì—ì„œ ë’¤ë¡œê°€ê¸° ì‹œ ìŠ¤í…Œì´ì§€ ëª¨ë‹¬ ì—´ê¸°\n    const handleOpenStageModal = (event: CustomEvent) => {\n      const { level } = event.detail;\n      setSelectedLevel(level);\n      setStageModalOpen(true);\n    };\n\n    // ì»¤ìŠ¤í…€ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡\n    window.addEventListener('openStageModal', handleOpenStageModal as EventListener);\n    \n    return () => {\n      window.removeEventListener('openStageModal', handleOpenStageModal as EventListener);\n    };\n  }, [setSelectedLevel, setStageModalOpen]);\n\n  return (\n    <div className=\"min-h-screen p-5 bg-gray-50 dark:bg-gray-900 transition-colors duration-300\">\n      <div className=\"max-w-4xl mx-auto rounded-2xl shadow-lg overflow-hidden bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 transition-colors duration-300\">\n        {/* Header */}\n        <div className=\"p-10 text-center relative bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 text-gray-900 dark:text-white transition-colors duration-300\">\n          {/* Dark Mode Toggle Button */}\n          <button\n            onClick={toggleTheme}\n            className=\"absolute top-4 right-4 px-4 py-2 rounded-lg text-sm font-medium transition-all duration-300 hover:scale-105 bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-500\"\n            title={getThemeLabel()}\n            aria-label={getThemeLabel()}\n          >\n            {getThemeIcon()} {getThemeLabel()}\n          </button>\n          \n          <h1 className=\"text-5xl font-bold mb-3\">ğŸ¯ DASI English</h1>\n          <p className=\"text-xl opacity-90\">ë‹¤ì‹œ ì˜ì–´ - í•œêµ­ì¸ íŠ¹í™” AI ì˜ì–´ í•™ìŠµ</p>\n        </div>\n        \n        <div className=\"p-10 bg-white dark:bg-gray-800 transition-colors duration-300\">\n          {/* ë©”ì¸ í•™ìŠµ */}\n          <div className=\"mb-10\">\n            <h2 className=\"text-xl font-bold mb-5 pl-4 text-gray-900 dark:text-white border-l-4 border-blue-500 dark:border-blue-400\">\n              ë©”ì¸ í•™ìŠµ\n            </h2>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-5\">\n              <button\n                onClick={handlePatternLearning}\n                className=\"group relative rounded-2xl p-6 cursor-pointer transition-all duration-300 hover:transform hover:-translate-y-2 hover:shadow-xl text-left overflow-hidden bg-white dark:bg-gray-700 border-2 border-gray-200 dark:border-gray-600 hover:border-blue-500 dark:hover:border-blue-400\"\n              >\n                <div className=\"absolute top-0 left-0 right-0 h-1 bg-blue-500 dark:bg-blue-400 transform scale-x-0 group-hover:scale-x-100 transition-transform duration-300\"></div>\n                <div className=\"text-4xl mb-4\">ğŸ“š</div>\n                <div className=\"text-xl font-bold mb-3 text-gray-900 dark:text-white\">íŒ¨í„´ í•™ìŠµ (Lv1~10)</div>\n                <div className=\"leading-relaxed text-gray-600 dark:text-gray-300\">\n                  í•œêµ­ì¸ íŠ¹í™” 27ê°œ ë¬¸ë²• íŒ¨í„´ì„ 3ì´ˆâ†’1ì´ˆ ì†ë„ë¡œ ì™„ì „ ìë™í™”í•˜ëŠ” ì²´ê³„ì  í›ˆë ¨\n                </div>\n              </button>\n              \n              <button\n                onClick={() => showComingSoon('ëª¨ë°© í•™ìŠµ')}\n                className=\"group relative bg-white dark:bg-gray-700 border-2 border-gray-200 dark:border-gray-600 rounded-2xl p-6 cursor-pointer transition-all duration-300 hover:transform hover:-translate-y-2 hover:shadow-xl hover:border-blue-400 dark:hover:border-blue-400 text-left overflow-hidden opacity-70\"\n              >\n                <div className=\"absolute top-4 right-4 bg-gray-500 dark:bg-gray-600 text-white text-xs px-2 py-1 rounded-lg font-bold\">\n                  ì¤€ë¹„ì¤‘\n                </div>\n                <div className=\"absolute top-0 left-0 right-0 h-1 bg-blue-400 transform scale-x-0 group-hover:scale-x-100 transition-transform duration-300\"></div>\n                <div className=\"text-4xl mb-4\">ğŸ­</div>\n                <div className=\"text-xl font-bold mb-3 text-gray-800 dark:text-white\">ëª¨ë°© í•™ìŠµ (Lv1~10)</div>\n                <div className=\"text-gray-600 dark:text-gray-300 leading-relaxed\">\n                  ì›ì–´ë¯¼ ëŒ€í™”ë¥¼ ë“£ê³  ìì‹ ì˜ ë§ë¡œ ì¬êµ¬ì„±í•˜ëŠ” ìì—°ìŠ¤ëŸ¬ìš´ íšŒí™” í›ˆë ¨\n                </div>\n              </button>\n            </div>\n          </div>\n          \n          {/* í•™ìŠµ ê´€ë¦¬ */}\n          <div className=\"mb-10\">\n            <h2 className=\"text-xl font-bold text-gray-800 dark:text-white mb-5 border-l-4 border-gray-500 dark:border-gray-400 pl-4\">\n              í•™ìŠµ ê´€ë¦¬\n            </h2>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-5\">\n              <button\n                onClick={handleProgressManagement}\n                className=\"group relative bg-white dark:bg-gray-700 border-2 border-gray-200 dark:border-gray-600 rounded-2xl p-6 cursor-pointer transition-all duration-300 hover:transform hover:-translate-y-2 hover:shadow-xl hover:border-gray-400 dark:hover:border-gray-400 text-left overflow-hidden\"\n              >\n                <div className=\"absolute top-4 right-4 bg-green-500 text-white text-xs px-2 py-1 rounded-lg font-bold\">\n                  SRS í™œì„±\n                </div>\n                <div className=\"absolute top-0 left-0 right-0 h-1 bg-gray-400 transform scale-x-0 group-hover:scale-x-100 transition-transform duration-300\"></div>\n                <div className=\"text-4xl mb-4\">ğŸ“Š</div>\n                <div className=\"text-xl font-bold mb-3 text-gray-800 dark:text-white\">ì§„ë„ê´€ë¦¬</div>\n                <div className=\"text-gray-600 dark:text-gray-300 leading-relaxed\">\n                  ë§ê°ê³¡ì„  ê¸°ë°˜ ë³µìŠµ ì•Œë¦¼, í•™ìŠµ í˜„í™© ë° ë‹¤ìŒ ë‹¨ê³„ ì¶”ì²œ\n                </div>\n              </button>\n              \n              <button\n                onClick={handleAchievements}\n                className=\"group relative bg-white dark:bg-gray-700 border-2 border-gray-200 dark:border-gray-600 rounded-2xl p-6 cursor-pointer transition-all duration-300 hover:transform hover:-translate-y-2 hover:shadow-xl hover:border-gray-400 dark:hover:border-gray-400 text-left overflow-hidden\"\n              >\n                <div className=\"absolute top-4 right-4 bg-orange-500 text-white text-xs px-2 py-1 rounded-lg font-bold\">\n                  í™œì„±\n                </div>\n                <div className=\"absolute top-0 left-0 right-0 h-1 bg-gray-400 transform scale-x-0 group-hover:scale-x-100 transition-transform duration-300\"></div>\n                <div className=\"text-4xl mb-4\">ğŸ†</div>\n                <div className=\"text-xl font-bold mb-3 text-gray-800 dark:text-white\">ì—…ì Â·ë°°ì§€</div>\n                <div className=\"text-gray-600 dark:text-gray-300 leading-relaxed\">\n                  í•™ìŠµ ì„±ì·¨ë„ ë°°ì§€, ì—°ì† í•™ìŠµ ì—…ì , ë ˆë²¨ë³„ ë‹¬ì„± ê¸°ë¡ ë° ì§„í–‰ë¥  í™•ì¸\n                </div>\n              </button>\n            </div>\n          </div>\n          \n          {/* ë³´ì¡° í•™ìŠµ */}\n          <div className=\"mb-10\">\n            <h2 className=\"text-xl font-bold text-gray-800 dark:text-white mb-5 border-l-4 border-gray-600 dark:border-gray-500 pl-4\">\n              ë³´ì¡° í•™ìŠµ\n            </h2>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-5\">\n              <button\n                onClick={handleVocabulary}\n                className=\"group relative bg-white dark:bg-gray-700 border-2 border-gray-200 dark:border-gray-600 rounded-2xl p-6 cursor-pointer transition-all duration-300 hover:transform hover:-translate-y-2 hover:shadow-xl hover:border-gray-500 dark:hover:border-gray-400 text-left overflow-hidden\"\n              >\n                <div className=\"absolute top-4 right-4 bg-green-500 text-white text-xs px-2 py-1 rounded-lg font-bold\">\n                  í™œì„±\n                </div>\n                <div className=\"absolute top-0 left-0 right-0 h-1 bg-gray-500 transform scale-x-0 group-hover:scale-x-100 transition-transform duration-300\"></div>\n                <div className=\"text-4xl mb-4\">ğŸ“–</div>\n                <div className=\"text-xl font-bold mb-3 text-gray-800 dark:text-white\">ë‹¨ì–´ì¥</div>\n                <div className=\"text-gray-600 dark:text-gray-300 leading-relaxed\">\n                  íŒ¨í„´ í•™ìŠµ ê¸°ë°˜ ë‹¨ì–´ ì¶”ì¶œ, ë ˆë²¨ë³„ ë‹¨ì–´ ëª©ë¡, SRS ë³µìŠµ ì‹œìŠ¤í…œ\n                </div>\n              </button>\n              \n              <button\n                onClick={handleSettings}\n                className=\"group relative bg-white dark:bg-gray-700 border-2 border-gray-200 dark:border-gray-600 rounded-2xl p-6 cursor-pointer transition-all duration-300 hover:transform hover:-translate-y-2 hover:shadow-xl hover:border-gray-500 dark:hover:border-gray-400 text-left overflow-hidden\"\n              >\n                <div className=\"absolute top-4 right-4 bg-blue-500 text-white text-xs px-2 py-1 rounded-lg font-bold\">\n                  í™œì„±\n                </div>\n                <div className=\"absolute top-0 left-0 right-0 h-1 bg-gray-500 transform scale-x-0 group-hover:scale-x-100 transition-transform duration-300\"></div>\n                <div className=\"text-4xl mb-4\">âš™ï¸</div>\n                <div className=\"text-xl font-bold mb-3 text-gray-800 dark:text-white\">ì„¤ì •</div>\n                <div className=\"text-gray-600 dark:text-gray-300 leading-relaxed\">\n                  ìŒì„± ì„¤ì •, ì•Œë¦¼ ì„¤ì •, í•™ìŠµ í™˜ê²½ ê°œì¸í™” ë° ê³„ì • ê´€ë¦¬\n                </div>\n              </button>\n            </div>\n          </div>\n          \n          {/* í•™ìŠµ í˜„í™© ë° ì§„í–‰ë¥  í†µê³„ */}\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 p-5 bg-gray-50 dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600 transition-colors duration-300\">\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-blue-600 dark:text-blue-400\">Level {stats.currentLevel}</div>\n              <div className=\"text-xs text-gray-600 dark:text-gray-300 mt-1\">í˜„ì¬ ë ˆë²¨</div>\n            </div>\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-green-600 dark:text-green-400\">{stats.stageProgress}</div>\n              <div className=\"text-xs text-gray-600 dark:text-gray-300 mt-1\">ìŠ¤í…Œì´ì§€ ì§„í–‰ë¥ </div>\n            </div>\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-purple-600 dark:text-purple-400\">{stats.completionRate}</div>\n              <div className=\"text-xs text-gray-600 dark:text-gray-300 mt-1\">ì „ì²´ ì™„ì„±ë„</div>\n            </div>\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-orange-600 dark:text-orange-400\">{stats.consecutiveDays}ì¼</div>\n              <div className=\"text-xs text-gray-600 dark:text-gray-300 mt-1\">ì—°ì† í•™ìŠµ</div>\n            </div>\n          </div>\n        </div>\n\n        {/* Stage Selection Modal */}\n        <StageSelectionModal availableLevels={availableLevels} />\n      </div>\n    </div>\n  );\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\pages\\MigrationPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\pages\\PatternPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'currentPattern' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":24,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":24,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setCurrentPattern' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":24,"column":26,"nodeType":null,"messageId":"unusedVar","endLine":24,"endColumn":43}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Pattern Page - íŒ¨í„´ í•™ìŠµ í˜ì´ì§€\r\n */\r\n\r\nimport React, { useState, useEffect } from 'react';\r\n\r\ninterface PatternPageProps {\r\n  // TODO: Props íƒ€ì… ì •ì˜ ì¶”ê°€\r\n}\r\n\r\ninterface PatternData {\r\n  id: string;\r\n  title: string;\r\n  level: string;\r\n  patterns: Array<{\r\n    id: string;\r\n    pattern: string;\r\n    meaning: string;\r\n    examples: string[];\r\n  }>;\r\n}\r\n\r\nconst PatternPage: React.FC<PatternPageProps> = () => {\r\n  const [currentPattern, setCurrentPattern] = useState<PatternData | null>(null);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [selectedLevel, setSelectedLevel] = useState('1');\r\n\r\n  useEffect(() => {\r\n    // TODO: íŒ¨í„´ ë°ì´í„° ë¡œë“œ\r\n    setIsLoading(false);\r\n  }, [selectedLevel]);\r\n\r\n  return (\r\n    <div className=\"pattern-page\">\r\n      <div className=\"container mx-auto px-4 py-6\">\r\n        <h1 className=\"text-2xl font-bold mb-6\">íŒ¨í„´ í•™ìŠµ</h1>\r\n        \r\n        {/* ë ˆë²¨ ì„ íƒ */}\r\n        <div className=\"level-selector mb-6\">\r\n          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n            í•™ìŠµ ë ˆë²¨ ì„ íƒ\r\n          </label>\r\n          <select \r\n            value={selectedLevel}\r\n            onChange={(e) => setSelectedLevel(e.target.value)}\r\n            className=\"border border-gray-300 rounded-md px-3 py-2 bg-white\"\r\n          >\r\n            <option value=\"1\">Level 1 - ê¸°ë³¸ íŒ¨í„´</option>\r\n            <option value=\"2\">Level 2 - ê¸°ë³¸ ë¬¸ë²•</option>\r\n            <option value=\"3\">Level 3 - ê³ ê¸‰ ë¬¸ë²•</option>\r\n            <option value=\"4\">Level 4 - ë¹„ì¦ˆë‹ˆìŠ¤</option>\r\n            <option value=\"5\">Level 5 - í•™ìˆ </option>\r\n            <option value=\"6\">Level 6 - ì „ë¬¸</option>\r\n          </select>\r\n        </div>\r\n\r\n        {/* íŒ¨í„´ í•™ìŠµ ì˜ì—­ */}\r\n        <div className=\"pattern-learning-area bg-white rounded-lg shadow-md p-6\">\r\n          {isLoading ? (\r\n            <div className=\"text-center py-8\">\r\n              <p className=\"text-gray-600\">íŒ¨í„´ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>\r\n            </div>\r\n          ) : (\r\n            <div className=\"pattern-content\">\r\n              <h2 className=\"text-xl font-semibold mb-4\">\r\n                Level {selectedLevel} íŒ¨í„´ í•™ìŠµ\r\n              </h2>\r\n              \r\n              {/* TODO: PatternTrainingFlow ì»´í¬ë„ŒíŠ¸ í†µí•© */}\r\n              <div className=\"pattern-display mb-6\">\r\n                <div className=\"pattern-card bg-blue-50 rounded-lg p-4 mb-4\">\r\n                  <h3 className=\"font-medium text-blue-800 mb-2\">í˜„ì¬ íŒ¨í„´</h3>\r\n                  <p className=\"text-blue-600 text-lg mb-2\">I want to + ë™ì‚¬ì›í˜•</p>\r\n                  <p className=\"text-sm text-gray-600\">ì˜ë¯¸: ~í•˜ê³  ì‹¶ë‹¤</p>\r\n                </div>\r\n                \r\n                <div className=\"examples mb-4\">\r\n                  <h4 className=\"font-medium mb-2\">ì˜ˆë¬¸</h4>\r\n                  <ul className=\"space-y-2\">\r\n                    <li className=\"bg-gray-50 rounded px-3 py-2\">\r\n                      I want to learn English.\r\n                    </li>\r\n                    <li className=\"bg-gray-50 rounded px-3 py-2\">\r\n                      I want to go home.\r\n                    </li>\r\n                  </ul>\r\n                </div>\r\n                \r\n                <div className=\"practice-section\">\r\n                  <button className=\"bg-blue-500 text-white px-6 py-2 rounded-md hover:bg-blue-600 transition-colors\">\r\n                    íŒ¨í„´ ì—°ìŠµ ì‹œì‘\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PatternPage;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\pages\\PatternTestPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\pages\\PatternTrainingPage.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has an unnecessary dependency: 'handleAnswerEvaluation'. Either exclude it or remove the dependency array.","line":211,"column":8,"nodeType":"ArrayExpression","endLine":211,"endColumn":65,"suggestions":[{"desc":"Update the dependencies array to be: [levelNumber, moveToNextQuestion]","fix":{"range":[8215,8272],"text":"[levelNumber, moveToNextQuestion]"}}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'stageId' is defined but never used. Allowed unused args must match /^_/u.","line":240,"column":25,"nodeType":null,"messageId":"unusedVar","endLine":240,"endColumn":32},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'moveToNextQuestion'. Either include it or remove the dependency array.","line":246,"column":7,"nodeType":"ArrayExpression","endLine":246,"endColumn":102,"suggestions":[{"desc":"Update the dependencies array to be: [playBeepSound, startRecognition, moveToNextQuestion, updateStageProgress, levelNumber, stageNumber, speakingStage]","fix":{"range":[9519,9614],"text":"[playBeepSound, startRecognition, moveToNextQuestion, updateStageProgress, levelNumber, stageNumber, speakingStage]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * PatternTrainingPageV3 - ë¦¬íŒ©í† ë§ëœ íŒ¨í„´ í›ˆë ¨ í˜ì´ì§€\r\n * \r\n * ì£¼ìš” ê°œì„ ì‚¬í•­:\r\n * - ëª¨ë“ˆí™”ëœ ì»¤ìŠ¤í…€ í›…ìœ¼ë¡œ ë¡œì§ ë¶„ë¦¬\r\n * - ì¬ì‚¬ìš© ê°€ëŠ¥í•œ UI ì»´í¬ë„ŒíŠ¸ë¡œ ë¶„ë¦¬\r\n * - ì½”ë“œ ê¸¸ì´ 90% ë‹¨ì¶• (1,042ì¤„ â†’ ~150ì¤„)\r\n * - ìœ ì§€ë³´ìˆ˜ì„± ë° í…ŒìŠ¤íŠ¸ ìš©ì´ì„± í–¥ìƒ\r\n */\r\n\r\nimport React, { useState, useCallback, useRef, useEffect } from 'react';\r\nimport { useSearchParams } from 'react-router-dom';\r\nimport { usePatternTrainingManager, type PatternTrainingManagerConfig } from '@/hooks/usePatternTrainingManager';\r\nimport { useStageData, type Question } from '@/hooks/useStageData';\r\nimport { useAudioManager } from '@/hooks/useAudioManager';\r\nimport { useSimpleSpeechRecognition } from '@/hooks/useSimpleSpeechRecognition';\r\nimport { useSpeakingStage, useStageProgress } from '@/store/useAppStore';\r\nimport { evaluateAnswer } from '@/utils/answerNormalization';\r\nimport { getCountdownDuration, getStageName } from '@/utils/speakingStageUtils';\r\n\r\n// UI Components\r\nimport { LoadingOverlay } from '@/components/LoadingOverlay';\r\nimport { TrainingHeader } from '@/components/TrainingHeader';\r\nimport { QuestionCard } from '@/components/QuestionCard';\r\nimport { ControlPanel } from '@/components/ControlPanel';\r\n\r\ntype Phase = 'idle' | 'tts' | 'countdown' | 'recognition' | 'waiting';\r\ntype EvaluationType = 'correct' | 'incorrect';\r\n\r\nconst PatternTrainingPageV3: React.FC = () => {\r\n  // URL íŒŒë¼ë¯¸í„° ì¶”ì¶œ\r\n  const [searchParams] = useSearchParams();\r\n  const levelNumber = Math.max(1, parseInt(searchParams.get('level') || '1', 10));\r\n  const phaseNumber = Math.max(1, parseInt(searchParams.get('phase') || '1', 10));\r\n  const stageNumber = Math.max(1, parseInt(searchParams.get('stage') || '1', 10));\r\n  \r\n  // ìŠ¤í”¼í‚¹ ë‹¨ê³„ ìƒíƒœ ê°€ì ¸ì˜¤ê¸°\r\n  const { stage: speakingStage } = useSpeakingStage();\r\n  const { updateStageProgress } = useStageProgress();\r\n  \r\n  // ìŠ¤í”¼í‚¹ ë‹¨ê³„ë³„ ì„¤ì •ì€ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ ì‚¬ìš©\r\n\r\n  // URL íŒŒë¼ë¯¸í„° ê²€ì¦ ë¡œê¹…\r\n  useEffect(() => {\r\n    if (isNaN(levelNumber) || isNaN(phaseNumber) || isNaN(stageNumber)) {\r\n      console.warn('âš ï¸ ì˜ëª»ëœ URL íŒŒë¼ë¯¸í„°ê°€ ê°ì§€ë˜ì–´ ê¸°ë³¸ê°’ìœ¼ë¡œ ì„¤ì •ë¨');\r\n    }\r\n    console.log(`ğŸ”— URL íŒŒë¼ë¯¸í„° ë¡œë“œ: Level=${levelNumber}, Phase=${phaseNumber}, Stage=${stageNumber}`);\r\n    console.log(`â±ï¸ ìŠ¤í”¼í‚¹ ë‹¨ê³„: ${getStageName(speakingStage)}`);\r\n  }, [levelNumber, phaseNumber, stageNumber, speakingStage]);\r\n\r\n  // ìƒíƒœ ê´€ë¦¬\r\n  const [currentIndex, setCurrentIndex] = useState<number>(0);\r\n  const [isTraining, setIsTraining] = useState<boolean>(false);\r\n  const [isPaused, setIsPaused] = useState<boolean>(false);\r\n  const [currentPhase, setCurrentPhase] = useState<Phase>('idle');\r\n  const [countdownText, setCountdownText] = useState<string>('');\r\n  const [recognitionTimeText, setRecognitionTimeText] = useState<string>('');\r\n  const [showAnswer, setShowAnswer] = useState<boolean>(false);\r\n  const [answerEvaluation, setAnswerEvaluation] = useState<string>('');\r\n  const [evaluationType, setEvaluationType] = useState<EvaluationType>('correct');\r\n  const [recognitionResult, setRecognitionResult] = useState<string>('');\r\n  const [interimResult, setInterimResult] = useState<string>('');\r\n\r\n  // Refs for state consistency\r\n  const currentQuestionsRef = useRef<Question[]>([]);\r\n  const currentIndexRef = useRef<number>(0);\r\n  const pausedStateRef = useRef<{phase: Phase, remainingTime?: number} | null>(null);\r\n\r\n  // ì»¤ìŠ¤í…€ í›…ë“¤\r\n  const { currentQuestions, isLoading, loadingMessage, loadStageData } = useStageData({\r\n    levelNumber,\r\n    phaseNumber,\r\n    stageNumber\r\n  });\r\n\r\n  const { playKoreanTTS, playBeepSound, stopAllAudio } = useAudioManager();\r\n\r\n  // ë‹¤ìŒ ë¬¸ì œë¡œ ì´ë™\r\n  const moveToNextQuestion = useCallback(() => {\r\n    setCurrentIndex(prevIndex => {\r\n      const nextIndex = prevIndex + 1;\r\n      const questions = currentQuestionsRef.current;\r\n      \r\n      console.log(`ğŸ” [DEBUG] moveToNextQuestion: currentIndex=${prevIndex}, nextIndex=${nextIndex}, questions.length=${questions.length}`);\r\n      \r\n      if (nextIndex >= questions.length) {\r\n        // ëª¨ë“  ë¬¸ì œ ì™„ë£Œ\r\n        setIsTraining(false);\r\n        setCurrentPhase('idle');\r\n        manager.current.stopAllTimers();\r\n        \r\n        const stageId = `level-${levelNumber}-phase-${phaseNumber}-stage-${stageNumber}`;\r\n        manager.current.handleStageCompletion(stageId);\r\n        \r\n        return 0;\r\n      } else {\r\n        // ë‹¤ìŒ ë¬¸ì œë¡œ ì´ë™\r\n        setCurrentPhase('tts');\r\n        setAnswerEvaluation('');\r\n        setRecognitionResult('');\r\n        setInterimResult('');\r\n        setShowAnswer(false);\r\n        \r\n        // ë‹¤ìŒ ë¬¸ì œ TTS ì¬ìƒ\r\n        const nextQuestion = questions[nextIndex];\r\n        stopAllAudio(); // ê¸°ì¡´ ìŒì„± ì¤‘ë‹¨\r\n        setTimeout(async () => {\r\n          await playBeepSound('start');\r\n          playKoreanTTS(nextQuestion.ko).then(async () => {\r\n          setCurrentPhase('countdown');\r\n          await playBeepSound('countdown');\r\n          const countdownTime = getCountdownDuration(speakingStage);\r\n          manager.current.startCountdown(countdownTime);\r\n          });\r\n        }, 50);\r\n        \r\n        return nextIndex;\r\n      }\r\n    });\r\n  }, [levelNumber, phaseNumber, stageNumber, speakingStage, playKoreanTTS, playBeepSound, stopAllAudio]);\r\n\r\n  // stopRecognition ì°¸ì¡°ë¥¼ ì €ì¥í•  ref\r\n  const stopRecognitionRef = useRef<(() => void) | null>(null);\r\n\r\n  // ì‹¤ì‹œê°„ ì •ë‹µ íŒì • ì²˜ë¦¬ í•¨ìˆ˜\r\n  const handleAnswerEvaluation = useCallback((userAnswer: string, isRealtime = false) => {\r\n    const currentQuestions = currentQuestionsRef.current;\r\n    const currentIndex = currentIndexRef.current;\r\n    const currentQuestion = currentQuestions[currentIndex];\r\n    \r\n    if (!currentQuestion) {\r\n      console.warn('âŒ currentQuestionì´ ì—†ìŒ - currentIndex:', currentIndex, 'questions.length:', currentQuestions.length);\r\n      return false;\r\n    }\r\n\r\n    const correctAnswer = currentQuestion.en;\r\n    const evaluation = evaluateAnswer(userAnswer, correctAnswer, levelNumber, 'pattern');\r\n    \r\n    if (evaluation.isCorrect) {\r\n      console.log(`ğŸ¤ ${isRealtime ? 'ì‹¤ì‹œê°„' : 'ìµœì¢…'} ì •ë‹µ ì¸ì‹:`, userAnswer, '/ ì •ë‹µ:', correctAnswer);\r\n      \r\n      // ìŒì„±ì¸ì‹ íƒ€ì´ë¨¸ ì¦‰ì‹œ ì¤‘ì§€\r\n      manager.current.stopAllTimers();\r\n      if (stopRecognitionRef.current) {\r\n        stopRecognitionRef.current();\r\n      }\r\n      setRecognitionTimeText('');\r\n\r\n      setAnswerEvaluation('âœ… ì •ë‹µì…ë‹ˆë‹¤!');\r\n      setEvaluationType('correct');\r\n      setRecognitionResult(userAnswer);\r\n      // ì‹¤ì‹œê°„ ì •ë‹µ ì‹œ ì¦‰ì‹œ, ìµœì¢… ì •ë‹µ ì‹œ 1ì´ˆ í›„\r\n      setTimeout(moveToNextQuestion, isRealtime ? 500 : 1000);\r\n      return true;\r\n    }\r\n    \r\n    return false;\r\n  }, [levelNumber, moveToNextQuestion]);\r\n\r\n  const { startRecognition, stopRecognition } = useSimpleSpeechRecognition({\r\n    onInterimResult: useCallback((userAnswer: string, confidence: number) => {\r\n      // ì‹¤ì‹œê°„ ì¤‘ê°„ ê²°ê³¼ UI ì—…ë°ì´íŠ¸\r\n      setInterimResult(userAnswer);\r\n      \r\n      // ì‹¤ì‹œê°„ ì¤‘ê°„ ê²°ê³¼ë¡œ ì •ë‹µ íŒì • (ë†’ì€ ì‹ ë¢°ë„ì¼ ë•Œë§Œ)\r\n      if (confidence > 0.7) {\r\n        const wasCorrect = handleAnswerEvaluation(userAnswer, true);\r\n        if (wasCorrect) {\r\n          console.log('âš¡ ì‹¤ì‹œê°„ ì •ë‹µ ì²˜ë¦¬ë¡œ ì¦‰ì‹œ ì§„í–‰!');\r\n          setInterimResult(''); // ì •ë‹µ ì²˜ë¦¬ í›„ ì¤‘ê°„ ê²°ê³¼ í´ë¦¬ì–´\r\n        }\r\n      }\r\n    }, [handleAnswerEvaluation]),\r\n    \r\n    onResult: useCallback((userAnswer: string) => {\r\n      // ìµœì¢… ê²°ê³¼ ì²˜ë¦¬ (ì‹¤ì‹œê°„ìœ¼ë¡œ ì´ë¯¸ ì²˜ë¦¬ë˜ì§€ ì•Šì€ ê²½ìš°)\r\n      const currentQuestions = currentQuestionsRef.current;\r\n      const currentIndex = currentIndexRef.current;\r\n      const currentQuestion = currentQuestions[currentIndex];\r\n      \r\n      if (!currentQuestion) return;\r\n\r\n      const correctAnswer = currentQuestion.en;\r\n      console.log('ğŸ¤ ì‚¬ìš©ì ìµœì¢… ë‹µë³€:', userAnswer, '/ ì •ë‹µ:', correctAnswer);\r\n      \r\n      const evaluation = evaluateAnswer(userAnswer, correctAnswer, levelNumber, 'pattern');\r\n      \r\n      // ìŒì„±ì¸ì‹ íƒ€ì´ë¨¸ ì¦‰ì‹œ ì¤‘ì§€\r\n      manager.current.stopAllTimers();\r\n      if (stopRecognitionRef.current) {\r\n        stopRecognitionRef.current();\r\n      }\r\n      setRecognitionTimeText('');\r\n\r\n      if (evaluation.isCorrect) {\r\n        setAnswerEvaluation('âœ… ì •ë‹µì…ë‹ˆë‹¤!');\r\n        setEvaluationType('correct');\r\n        setRecognitionResult(userAnswer);\r\n        setTimeout(moveToNextQuestion, 1000);\r\n      } else {\r\n        setAnswerEvaluation(`âŒ í‹€ë ¸ìŠµë‹ˆë‹¤. ì •ë‹µ: ${correctAnswer}`);\r\n        setEvaluationType('incorrect');\r\n        setRecognitionResult(userAnswer);\r\n        setShowAnswer(true);\r\n        setTimeout(() => {\r\n          setShowAnswer(false);\r\n          moveToNextQuestion();\r\n        }, 2000);\r\n      }\r\n    }, [levelNumber, handleAnswerEvaluation, moveToNextQuestion])\r\n  });\r\n\r\n  // stopRecognition í•¨ìˆ˜ ì°¸ì¡°ë¥¼ refì— ì €ì¥\r\n  useEffect(() => {\r\n    stopRecognitionRef.current = stopRecognition;\r\n  }, [stopRecognition]);\r\n\r\n  // íŒ¨í„´ í›ˆë ¨ ë§¤ë‹ˆì € ì„¤ì •\r\n  const managerConfig: PatternTrainingManagerConfig = useCallback(() => ({\r\n    onCountdownTick: (remainingTime: number) => {\r\n      setCountdownText(remainingTime.toString());\r\n    },\r\n    onCountdownComplete: () => {\r\n      setCurrentPhase('recognition');\r\n      playBeepSound('recognition');\r\n      startRecognition();\r\n      // ìŒì„±ì¸ì‹ íƒ€ì´ë¨¸ ì‹œì‘ (10ì´ˆ ì œí•œ)\r\n      manager.current.startRecognition(10);\r\n    },\r\n    onRecognitionTick: (remainingTime: number) => {\r\n      setRecognitionTimeText(remainingTime.toString());\r\n    },\r\n    onRecognitionComplete: () => {\r\n      setCurrentPhase('waiting');\r\n      setRecognitionTimeText('');\r\n      // ìŒì„±ì¸ì‹ ì‹œê°„ ì´ˆê³¼ ì‹œ ìë™ìœ¼ë¡œ ë‹¤ìŒ ë¬¸ì œë¡œ\r\n      moveToNextQuestion();\r\n    },\r\n    onCompletionEvent: (stageId: string) => {\r\n      // í•´ë‹¹ ìŠ¤í”¼í‚¹ ë‹¨ê³„ë¥¼ ì™„ë£Œë¡œ í‘œì‹œ\r\n      updateStageProgress(levelNumber, stageNumber, speakingStage, true);\r\n      console.log(`âœ… ì§„í–‰ë¥  ì—…ë°ì´íŠ¸: Level ${levelNumber}, Stage ${stageNumber}, ${speakingStage}ë‹¨ê³„ ì™„ë£Œ`);\r\n      alert(`ğŸ‰ Stage ${stageNumber} (${speakingStage}ë‹¨ê³„) í›ˆë ¨ ì™„ë£Œ!\\n\\n${getStageName(speakingStage)}ë¥¼ ì„±ê³µí–ˆìŠµë‹ˆë‹¤!`);\r\n    }\r\n  }), [levelNumber, stageNumber, speakingStage, updateStageProgress, playBeepSound, startRecognition])();\r\n\r\n  const manager = useRef(usePatternTrainingManager(managerConfig));\r\n\r\n  // í˜„ì¬ ë¬¸ì œ ê³„ì‚°\r\n  const currentQuestion = currentQuestions[currentIndex] || { ko: '', en: '' };\r\n\r\n  // Refs ë™ê¸°í™”\r\n  useEffect(() => {\r\n    currentQuestionsRef.current = currentQuestions;\r\n  }, [currentQuestions]);\r\n\r\n  useEffect(() => {\r\n    currentIndexRef.current = currentIndex;\r\n  }, [currentIndex]);\r\n\r\n  // í›ˆë ¨ ì‹œì‘\r\n  const startTraining = useCallback(() => {\r\n    if (currentQuestions.length === 0) {\r\n      alert('ë¬¸ì œ ë°ì´í„°ë¥¼ ë¨¼ì € ë¡œë“œí•´ì£¼ì„¸ìš”!');\r\n      return;\r\n    }\r\n\r\n    setIsTraining(true);\r\n    setCurrentIndex(0);\r\n    setCurrentPhase('tts');\r\n    \r\n    // ì²« ë²ˆì§¸ ë¬¸ì œ ì‹œì‘\r\n    const firstQuestion = currentQuestions[0];\r\n    stopAllAudio(); // ê¸°ì¡´ ìŒì„± ì¤‘ë‹¨\r\n    setTimeout(async () => {\r\n      await playBeepSound('start');\r\n      playKoreanTTS(firstQuestion.ko).then(async () => {\r\n        setCurrentPhase('countdown');\r\n        await playBeepSound('countdown');\r\n        const countdownTime = getCountdownDuration(speakingStage);\r\n        manager.current.startCountdown(countdownTime);\r\n      });\r\n    }, 50);\r\n  }, [currentQuestions, speakingStage, playKoreanTTS, playBeepSound, stopAllAudio]);\r\n\r\n  // í›ˆë ¨ ì¼ì‹œì •ì§€\r\n  const pauseTraining = useCallback(() => {\r\n    if (!isTraining) return;\r\n    \r\n    setIsPaused(true);\r\n    pausedStateRef.current = { phase: currentPhase };\r\n    manager.current.pauseAllTimers();\r\n    if (stopRecognitionRef.current) {\r\n      stopRecognitionRef.current();\r\n    }\r\n  }, [isTraining, currentPhase]);\r\n\r\n  // í›ˆë ¨ ì¬ê°œ\r\n  const resumeTraining = useCallback(() => {\r\n    if (!isPaused || !pausedStateRef.current) return;\r\n    \r\n    setIsPaused(false);\r\n    const { phase } = pausedStateRef.current;\r\n    setCurrentPhase(phase);\r\n    manager.current.resumeAllTimers();\r\n    pausedStateRef.current = null;\r\n  }, [isPaused]);\r\n\r\n  // í›ˆë ¨ ì¤‘ì§€\r\n  const stopTraining = useCallback(() => {\r\n    setIsTraining(false);\r\n    setIsPaused(false);\r\n    setCurrentPhase('idle');\r\n    setCurrentIndex(0);\r\n    manager.current.stopAllTimers();\r\n    if (stopRecognitionRef.current) {\r\n      stopRecognitionRef.current();\r\n    }\r\n    pausedStateRef.current = null;\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 transition-colors duration-300\">\r\n      {/* ë¡œë”© ì˜¤ë²„ë ˆì´ */}\r\n      <LoadingOverlay isVisible={isLoading} message={loadingMessage} />\r\n\r\n      {/* í—¤ë” */}\r\n      <TrainingHeader\r\n        levelNumber={levelNumber}\r\n        phaseNumber={phaseNumber}\r\n        stageNumber={stageNumber}\r\n        currentIndex={currentIndex}\r\n        totalQuestions={currentQuestions.length}\r\n      />\r\n\r\n      {/* ë©”ì¸ ì½˜í…ì¸  */}\r\n      <div className=\"max-w-4xl mx-auto px-4 py-8\">\r\n        {/* ë¬¸ì œ ì¹´ë“œ */}\r\n        <QuestionCard\r\n          currentQuestion={currentQuestion}\r\n          currentPhase={currentPhase}\r\n          countdownText={countdownText}\r\n          recognitionTimeText={recognitionTimeText}\r\n          showAnswer={showAnswer}\r\n          answerEvaluation={answerEvaluation}\r\n          evaluationType={evaluationType}\r\n          recognitionResult={recognitionResult}\r\n          interimResult={interimResult}\r\n        />\r\n\r\n        {/* ì»¨íŠ¸ë¡¤ íŒ¨ë„ */}\r\n        <ControlPanel\r\n          isTraining={isTraining}\r\n          isPaused={isPaused}\r\n          currentPhase={currentPhase}\r\n          hasQuestions={currentQuestions.length > 0}\r\n          currentIndex={currentIndex}\r\n          totalQuestions={currentQuestions.length}\r\n          onStartTraining={startTraining}\r\n          onPauseTraining={pauseTraining}\r\n          onResumeTraining={resumeTraining}\r\n          onStopTraining={stopTraining}\r\n          onLoadData={loadStageData}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PatternTrainingPageV3;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\pages\\PersonalizedPacksPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\pages\\ProgressManagementPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'index' is defined but never used. Allowed unused args must match /^_/u.","line":101,"column":67,"nodeType":null,"messageId":"unusedVar","endLine":101,"endColumn":72}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport ProgressDashboard from '../components/ProgressDashboard';\r\n\r\nconst ProgressManagementPage: React.FC = () => {\r\n  const [activeTab, setActiveTab] = useState<'overview' | 'detailed' | 'analytics'>('detailed'); // ê¸°ë³¸ê°’ì„ detailedë¡œ\r\n  const navigate = useNavigate();\r\n  const userId = 'dev-user'; // ì‹¤ì œë¡œëŠ” auth contextì—ì„œ ê°€ì ¸ì˜´\r\n\r\n  const renderTabContent = () => {\r\n    switch (activeTab) {\r\n      case 'overview':\r\n        return <ProgressDashboard userId={userId} />;\r\n      \r\n      case 'detailed':\r\n        return (\r\n          <div className=\"max-w-6xl mx-auto p-6\">\r\n            <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white dark:text-white mb-6\">ğŸ“‹ ìƒì„¸ ì§„ë„ ë¶„ì„</h2>\r\n            \r\n            {/* ìŠ¤í…Œì´ì§€ë³„ ìƒì„¸ ë¶„ì„ */}\r\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8\">\r\n              {/* ì™„ë£Œìœ¨ ë¶„í¬ */}\r\n              <div className=\"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-6 transition-colors duration-300\">\r\n                <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white dark:text-white mb-4\">ğŸ“Š ì™„ë£Œìœ¨ ë¶„í¬</h3>\r\n                <div className=\"space-y-4\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <span className=\"text-sm text-gray-600 dark:text-gray-300\">90% ì´ìƒ (ë§ˆìŠ¤í„°)</span>\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <div className=\"w-24 bg-gray-200 rounded-full h-2\">\r\n                        <div className=\"bg-green-500 h-2 rounded-full\" style={{ width: '35%' }}></div>\r\n                      </div>\r\n                      <span className=\"text-sm font-medium text-green-600\">12ê°œ</span>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <span className=\"text-sm text-gray-600 dark:text-gray-300\">70-89% (ì™„ë£Œ)</span>\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <div className=\"w-24 bg-gray-200 rounded-full h-2\">\r\n                        <div className=\"bg-blue-500 h-2 rounded-full\" style={{ width: '45%' }}></div>\r\n                      </div>\r\n                      <span className=\"text-sm font-medium text-blue-600\">18ê°œ</span>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <span className=\"text-sm text-gray-600 dark:text-gray-300\">50-69% (ì§„í–‰ì¤‘)</span>\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <div className=\"w-24 bg-gray-200 rounded-full h-2\">\r\n                        <div className=\"bg-yellow-500 h-2 rounded-full\" style={{ width: '20%' }}></div>\r\n                      </div>\r\n                      <span className=\"text-sm font-medium text-yellow-600\">8ê°œ</span>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <span className=\"text-sm text-gray-600 dark:text-gray-300\">50% ë¯¸ë§Œ (ì‹œì‘)</span>\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <div className=\"w-24 bg-gray-200 rounded-full h-2\">\r\n                        <div className=\"bg-red-500 h-2 rounded-full\" style={{ width: '15%' }}></div>\r\n                      </div>\r\n                      <span className=\"text-sm font-medium text-red-600\">6ê°œ</span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* í•™ìŠµ íŒ¨í„´ */}\r\n              <div className=\"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg transition-colors duration-300 p-6\">\r\n                <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">â° í•™ìŠµ íŒ¨í„´</h3>\r\n                <div className=\"space-y-4\">\r\n                  <div>\r\n                    <div className=\"flex justify-between text-sm text-gray-600 dark:text-gray-300 mb-1\">\r\n                      <span>ê°€ì¥ í™œë°œí•œ ì‹œê°„</span>\r\n                      <span className=\"font-medium text-blue-600\">ì˜¤í›„ 7-9ì‹œ</span>\r\n                    </div>\r\n                  </div>\r\n                  <div>\r\n                    <div className=\"flex justify-between text-sm text-gray-600 dark:text-gray-300 mb-1\">\r\n                      <span>í‰ê·  ì„¸ì…˜ ì‹œê°„</span>\r\n                      <span className=\"font-medium text-green-600\">25ë¶„</span>\r\n                    </div>\r\n                  </div>\r\n                  <div>\r\n                    <div className=\"flex justify-between text-sm text-gray-600 dark:text-gray-300 mb-1\">\r\n                      <span>ì£¼ê°„ í•™ìŠµ ì¼ìˆ˜</span>\r\n                      <span className=\"font-medium text-purple-600\">5.2ì¼</span>\r\n                    </div>\r\n                  </div>\r\n                  <div>\r\n                    <div className=\"flex justify-between text-sm text-gray-600 dark:text-gray-300 mb-1\">\r\n                      <span>ì—°ì† í•™ìŠµ ê¸°ë¡</span>\r\n                      <span className=\"font-medium text-orange-600\">12ì¼</span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* ì›”ë³„ ì§„ë„ ê·¸ë˜í”„ */}\r\n            <div className=\"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg transition-colors duration-300 p-6\">\r\n              <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">ğŸ“ˆ ì›”ë³„ ì§„ë„ ë³€í™”</h3>\r\n              <div className=\"h-64 flex items-end justify-between gap-2\">\r\n                {['1ì›”', '2ì›”', '3ì›”', '4ì›”', '5ì›”', '6ì›”'].map((month, index) => {\r\n                  const height = Math.random() * 200 + 20;\r\n                  const completedStages = Math.floor(Math.random() * 15) + 5;\r\n                  return (\r\n                    <div key={month} className=\"flex-1 flex flex-col items-center\">\r\n                      <div className=\"w-full bg-gray-200 rounded-t\" style={{ height: '200px' }}>\r\n                        <div \r\n                          className=\"w-full bg-blue-500 rounded-t transition-all duration-500\"\r\n                          style={{ height: `${(height / 200) * 100}%`, marginTop: 'auto' }}\r\n                        ></div>\r\n                      </div>\r\n                      <div className=\"text-xs text-gray-600 dark:text-gray-300 mt-2\">{month}</div>\r\n                      <div className=\"text-xs font-medium text-blue-600\">{completedStages}ê°œ</div>\r\n                    </div>\r\n                  );\r\n                })}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        );\r\n      \r\n      case 'analytics':\r\n        return (\r\n          <div className=\"max-w-6xl mx-auto p-6\">\r\n            <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white mb-6\">ğŸ” ê³ ê¸‰ ë¶„ì„</h2>\r\n            \r\n            {/* ì‹¤ë ¥ ë³€í™” ì¶”ì´ */}\r\n            <div className=\"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg transition-colors duration-300 p-6 mb-8\">\r\n              <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">ğŸ“Š ì‹¤ë ¥ ë³€í™” ì¶”ì´</h3>\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                <div>\r\n                  <h4 className=\"font-medium text-gray-700 dark:text-gray-300 mb-3\">ì •í™•ë„ ë³€í™”</h4>\r\n                  <div className=\"space-y-3\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <span className=\"text-sm text-gray-600 dark:text-gray-300\">ì´ë²ˆ ì£¼</span>\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <span className=\"text-sm font-medium\">85%</span>\r\n                        <span className=\"text-xs text-green-600\">â†— +3%</span>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <span className=\"text-sm text-gray-600 dark:text-gray-300\">ì§€ë‚œ ì£¼</span>\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <span className=\"text-sm font-medium\">82%</span>\r\n                        <span className=\"text-xs text-green-600\">â†— +1%</span>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <span className=\"text-sm text-gray-600 dark:text-gray-300\">ì´ë²ˆ ë‹¬ í‰ê· </span>\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <span className=\"text-sm font-medium\">83%</span>\r\n                        <span className=\"text-xs text-green-600\">â†— +5%</span>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                \r\n                <div>\r\n                  <h4 className=\"font-medium text-gray-700 dark:text-gray-300 mb-3\">ì‘ë‹µ ì†ë„ ë³€í™”</h4>\r\n                  <div className=\"space-y-3\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <span className=\"text-sm text-gray-600 dark:text-gray-300\">ì´ë²ˆ ì£¼</span>\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <span className=\"text-sm font-medium\">4.2ì´ˆ</span>\r\n                        <span className=\"text-xs text-blue-600\">â†˜ -0.3ì´ˆ</span>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <span className=\"text-sm text-gray-600 dark:text-gray-300\">ì§€ë‚œ ì£¼</span>\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <span className=\"text-sm font-medium\">4.5ì´ˆ</span>\r\n                        <span className=\"text-xs text-blue-600\">â†˜ -0.2ì´ˆ</span>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <span className=\"text-sm text-gray-600 dark:text-gray-300\">ì´ë²ˆ ë‹¬ í‰ê· </span>\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <span className=\"text-sm font-medium\">4.7ì´ˆ</span>\r\n                        <span className=\"text-xs text-blue-600\">â†˜ -0.8ì´ˆ</span>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* í•™ìŠµ ê¶Œì¥ì‚¬í•­ */}\r\n            <div className=\"bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-lg p-6\">\r\n              <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">ğŸ’¡ ê°œì¸ ë§ì¶¤ í•™ìŠµ ê¶Œì¥ì‚¬í•­</h3>\r\n              <div className=\"space-y-4\">\r\n                <div className=\"flex items-start gap-3\">\r\n                  <span className=\"text-green-500 text-xl\">ğŸ¯</span>\r\n                  <div>\r\n                    <h4 className=\"font-medium text-gray-900 dark:text-white\">ì§‘ì¤‘ í•™ìŠµ ì˜ì—­</h4>\r\n                    <p className=\"text-sm text-gray-600 dark:text-gray-300\">\r\n                      Level 3ì˜ ê´€ê³„ëŒ€ëª…ì‚¬ì™€ Level 4ì˜ ë¹„ì¦ˆë‹ˆìŠ¤ í‘œí˜„ì—ì„œ ì •í™•ë„ê°€ ë‚®ìŠµë‹ˆë‹¤. \r\n                      ì´ ì˜ì—­ì„ ì§‘ì¤‘ì ìœ¼ë¡œ ë³µìŠµí•˜ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤.\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n                \r\n                <div className=\"flex items-start gap-3\">\r\n                  <span className=\"text-blue-500 text-xl\">â°</span>\r\n                  <div>\r\n                    <h4 className=\"font-medium text-gray-900 dark:text-white\">ìµœì  í•™ìŠµ ì‹œê°„</h4>\r\n                    <p className=\"text-sm text-gray-600 dark:text-gray-300\">\r\n                      ì˜¤í›„ 7-9ì‹œì— ê°€ì¥ ì¢‹ì€ ì„±ê³¼ë¥¼ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤. \r\n                      ì´ ì‹œê°„ëŒ€ì— ì–´ë ¤ìš´ ë‚´ìš©ì„ í•™ìŠµí•˜ì‹œë©´ ë” íš¨ê³¼ì ì…ë‹ˆë‹¤.\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n                \r\n                <div className=\"flex items-start gap-3\">\r\n                  <span className=\"text-purple-500 text-xl\">ğŸ“š</span>\r\n                  <div>\r\n                    <h4 className=\"font-medium text-gray-900 dark:text-white\">í•™ìŠµëŸ‰ ì¡°ì ˆ</h4>\r\n                    <p className=\"text-sm text-gray-600 dark:text-gray-300\">\r\n                      í˜„ì¬ ì¼ì¼ 25ë¶„ì”© í•™ìŠµí•˜ê³  ìˆìŠµë‹ˆë‹¤. \r\n                      ì¡°ê¸ˆ ë” ëŠ˜ë ¤ì„œ 30-35ë¶„ìœ¼ë¡œ í•˜ë©´ ë” ë¹ ë¥¸ ì§„ì „ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        );\r\n      \r\n      default:\r\n        return null;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900 transition-colors duration-300\">\r\n      {/* í—¤ë” */}\r\n      <div className=\"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 transition-colors duration-300\">\r\n        <div className=\"max-w-6xl mx-auto px-6 py-4\">\r\n          <div className=\"flex items-center gap-4 mb-4\">\r\n            <button\r\n              onClick={() => navigate('/')}\r\n              className=\"flex items-center gap-2 px-3 py-2 text-gray-600 dark:text-gray-300 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-lg transition-colors\"\r\n            >\r\n              <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M10 19l-7-7m0 0l7-7m-7 7h18\" />\r\n              </svg>\r\n              ë’¤ë¡œê°€ê¸°\r\n            </button>\r\n            <h1 className=\"text-2xl font-bold text-gray-900 dark:text-white dark:text-white\">ğŸ“Š ì§„ë„ ê´€ë¦¬</h1>\r\n          </div>\r\n          \r\n          {/* íƒ­ ë„¤ë¹„ê²Œì´ì…˜ */}\r\n          <div className=\"flex gap-1\">\r\n            {[\r\n              { key: 'overview', label: 'ì „ì²´ í˜„í™©', icon: 'ğŸ“‹' },\r\n              { key: 'detailed', label: 'ìƒì„¸ ë¶„ì„', icon: 'ğŸ“Š' },\r\n              { key: 'analytics', label: 'ê³ ê¸‰ ë¶„ì„', icon: 'ğŸ”' }\r\n            ].map(tab => (\r\n              <button\r\n                key={tab.key}\r\n                onClick={() => setActiveTab(tab.key as any)}\r\n                className={`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${\r\n                  activeTab === tab.key\r\n                    ? 'bg-blue-600 text-white'\r\n                    : 'text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:text-white hover:bg-gray-100'\r\n                }`}\r\n              >\r\n                {tab.icon} {tab.label}\r\n              </button>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* ì½˜í…ì¸  */}\r\n      {renderTabContent()}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ProgressManagementPage;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\pages\\ResultPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'user' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":23,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":23,"endColumn":13}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { useNavigate, useLocation } from 'react-router-dom';\r\nimport { useAppStore, useUser } from '@/store/useAppStore';\r\n\r\ninterface SessionSummary {\r\n  totalCards: number;\r\n  correctAnswers: number;\r\n  accuracy: number;\r\n  averageScore: number;\r\n  totalTime: number;\r\n  averageTimePerCard: number;\r\n}\r\n\r\ninterface LocationState {\r\n  summary: SessionSummary;\r\n  level: number;\r\n  stage: number;\r\n}\r\n\r\nexport const ResultPage: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  const user = useUser();\r\n  const { setUser } = useAppStore();\r\n  \r\n  const state = location.state as LocationState;\r\n  \r\n  if (!state || !state.summary) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <p className=\"text-gray-600 mb-4\">ê²°ê³¼ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</p>\r\n          <button\r\n            onClick={() => navigate('/')}\r\n            className=\"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600\"\r\n          >\r\n            í™ˆìœ¼ë¡œ ëŒì•„ê°€ê¸°\r\n          </button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const { summary, level, stage } = state;\r\n  \r\n  // Determine if user passed the stage (80% accuracy threshold)\r\n  const passed = summary.accuracy >= 80;\r\n  \r\n  // Calculate next level/stage\r\n  const getNextStage = () => {\r\n    if (passed) {\r\n      if (stage < 10) {\r\n        return { level, stage: stage + 1 };\r\n      } else if (level < 10) {\r\n        return { level: level + 1, stage: 1 };\r\n      } else {\r\n        return { level: 10, stage: 10 }; // Max level reached\r\n      }\r\n    }\r\n    return { level, stage }; // Stay at current stage if failed\r\n  };\r\n\r\n  const handleContinue = () => {\r\n    if (passed) {\r\n      const nextStage = getNextStage();\r\n      setUser({\r\n        level: nextStage.level,\r\n        stage: nextStage.stage,\r\n      });\r\n    }\r\n    navigate('/');\r\n  };\r\n\r\n  const handleRetry = () => {\r\n    navigate('/study');\r\n  };\r\n\r\n  const formatTime = (seconds: number) => {\r\n    const mins = Math.floor(seconds / 60);\r\n    const secs = seconds % 60;\r\n    if (mins > 0) {\r\n      return `${mins}ë¶„ ${secs}ì´ˆ`;\r\n    }\r\n    return `${secs}ì´ˆ`;\r\n  };\r\n\r\n  const getPerformanceLevel = (accuracy: number) => {\r\n    if (accuracy >= 95) return { level: 'ì™„ë²½!', color: 'text-green-600', emoji: 'ğŸŒŸ' };\r\n    if (accuracy >= 80) return { level: 'ìš°ìˆ˜', color: 'text-blue-600', emoji: 'ğŸ‰' };\r\n    if (accuracy >= 60) return { level: 'ë³´í†µ', color: 'text-yellow-600', emoji: 'ğŸ‘' };\r\n    return { level: 'ì¬ë„ì „', color: 'text-red-600', emoji: 'ğŸ’ª' };\r\n  };\r\n\r\n  const performance = getPerformanceLevel(summary.accuracy);\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4\">\r\n      <div className=\"max-w-lg w-full bg-white rounded-lg shadow-lg p-8\">\r\n        {/* Header */}\r\n        <div className=\"text-center mb-8\">\r\n          <div className=\"text-6xl mb-4\">{performance.emoji}</div>\r\n          <h1 className=\"text-3xl font-bold text-gray-800 mb-2\">\r\n            ì„¸ì…˜ ì™„ë£Œ\r\n          </h1>\r\n          <p className=\"text-gray-600\">\r\n            Level {level}.{stage} ê²°ê³¼\r\n          </p>\r\n        </div>\r\n\r\n        {/* Overall Performance */}\r\n        <div className={`text-center mb-8 p-6 rounded-lg ${\r\n          passed ? 'bg-green-50 border border-green-200' : 'bg-red-50 border border-red-200'\r\n        }`}>\r\n          <h2 className={`text-2xl font-bold mb-2 ${\r\n            passed ? 'text-green-800' : 'text-red-800'\r\n          }`}>\r\n            {passed ? 'ğŸ‰ í†µê³¼!' : 'ğŸ’ª ì¬ë„ì „!'}\r\n          </h2>\r\n          <p className={`text-lg ${performance.color}`}>\r\n            {performance.level}\r\n          </p>\r\n        </div>\r\n\r\n        {/* Detailed Stats */}\r\n        <div className=\"space-y-4 mb-8\">\r\n          <div className=\"flex items-center justify-between p-4 bg-gray-50 rounded-lg\">\r\n            <div className=\"flex items-center space-x-3\">\r\n              <span className=\"text-2xl\">ğŸ¯</span>\r\n              <span className=\"font-medium\">ì •í™•ë„</span>\r\n            </div>\r\n            <span className={`text-xl font-bold ${performance.color}`}>\r\n              {summary.accuracy}%\r\n            </span>\r\n          </div>\r\n\r\n          <div className=\"flex items-center justify-between p-4 bg-gray-50 rounded-lg\">\r\n            <div className=\"flex items-center space-x-3\">\r\n              <span className=\"text-2xl\">ğŸ“Š</span>\r\n              <span className=\"font-medium\">í‰ê·  ì ìˆ˜</span>\r\n            </div>\r\n            <span className=\"text-xl font-bold text-blue-600\">\r\n              {summary.averageScore}/100\r\n            </span>\r\n          </div>\r\n\r\n          <div className=\"flex items-center justify-between p-4 bg-gray-50 rounded-lg\">\r\n            <div className=\"flex items-center space-x-3\">\r\n              <span className=\"text-2xl\">âœ…</span>\r\n              <span className=\"font-medium\">ì •ë‹µ/ì „ì²´</span>\r\n            </div>\r\n            <span className=\"text-xl font-bold text-green-600\">\r\n              {summary.correctAnswers}/{summary.totalCards}\r\n            </span>\r\n          </div>\r\n\r\n          <div className=\"flex items-center justify-between p-4 bg-gray-50 rounded-lg\">\r\n            <div className=\"flex items-center space-x-3\">\r\n              <span className=\"text-2xl\">â±ï¸</span>\r\n              <span className=\"font-medium\">ì´ ì‹œê°„</span>\r\n            </div>\r\n            <span className=\"text-xl font-bold text-purple-600\">\r\n              {formatTime(summary.totalTime)}\r\n            </span>\r\n          </div>\r\n\r\n          <div className=\"flex items-center justify-between p-4 bg-gray-50 rounded-lg\">\r\n            <div className=\"flex items-center space-x-3\">\r\n              <span className=\"text-2xl\">ğŸš€</span>\r\n              <span className=\"font-medium\">ë¬¸ì œë‹¹ í‰ê· ì‹œê°„</span>\r\n            </div>\r\n            <span className=\"text-xl font-bold text-indigo-600\">\r\n              {summary.averageTimePerCard}ì´ˆ\r\n            </span>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Progress Message */}\r\n        {passed && (\r\n          <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6\">\r\n            <div className=\"text-center text-blue-800\">\r\n              {level === 10 && stage === 10 ? (\r\n                <p className=\"font-medium\">ğŸ† ëª¨ë“  ë ˆë²¨ì„ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤!</p>\r\n              ) : stage === 10 ? (\r\n                <p className=\"font-medium\">\r\n                  ğŸ‰ Level {level} ì™„ë£Œ! Level {level + 1}ìœ¼ë¡œ ì§„ê¸‰í•©ë‹ˆë‹¤\r\n                </p>\r\n              ) : (\r\n                <p className=\"font-medium\">\r\n                  ğŸ¯ Stage {stage + 1}ë¡œ ì§„í–‰í•©ë‹ˆë‹¤\r\n                </p>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {!passed && (\r\n          <div className=\"bg-orange-50 border border-orange-200 rounded-lg p-4 mb-6\">\r\n            <div className=\"text-center text-orange-800\">\r\n              <p className=\"font-medium\">\r\n                ğŸ’ª 80% ì´ìƒì˜ ì •í™•ë„ê°€ í•„ìš”í•©ë‹ˆë‹¤\r\n              </p>\r\n              <p className=\"text-sm mt-1\">\r\n                ë‹¤ì‹œ ë„ì „í•´ì„œ ì‹¤ë ¥ì„ í–¥ìƒì‹œì¼œë³´ì„¸ìš”!\r\n              </p>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Action Buttons */}\r\n        <div className=\"space-y-3\">\r\n          {passed ? (\r\n            <button\r\n              onClick={handleContinue}\r\n              className=\"w-full bg-green-500 hover:bg-green-600 text-white font-bold py-4 px-6 rounded-lg transition-colors duration-200 text-lg\"\r\n            >\r\n              {level === 10 && stage === 10 ? 'ğŸ† ì™„ë£Œ' : 'ğŸš€ ë‹¤ìŒ ë‹¨ê³„ë¡œ'}\r\n            </button>\r\n          ) : (\r\n            <button\r\n              onClick={handleRetry}\r\n              className=\"w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-4 px-6 rounded-lg transition-colors duration-200 text-lg\"\r\n            >\r\n              ğŸ’ª ë‹¤ì‹œ ë„ì „í•˜ê¸°\r\n            </button>\r\n          )}\r\n          \r\n          <button\r\n            onClick={() => navigate('/')}\r\n            className=\"w-full bg-gray-500 hover:bg-gray-600 text-white font-medium py-3 px-6 rounded-lg transition-colors duration-200\"\r\n          >\r\n            ğŸ  í™ˆìœ¼ë¡œ ëŒì•„ê°€ê¸°\r\n          </button>\r\n        </div>\r\n\r\n        {/* Tips */}\r\n        <div className=\"mt-8 pt-6 border-t border-gray-200\">\r\n          <h3 className=\"text-sm font-medium text-gray-700 mb-3\">ğŸ’¡ í•™ìŠµ íŒ</h3>\r\n          <ul className=\"text-xs text-gray-600 space-y-2\">\r\n            <li>â€¢ ì •í™•í•œ ë°œìŒë³´ë‹¤ëŠ” ìì—°ìŠ¤ëŸ¬ìš´ ì–µì–‘ì— ì§‘ì¤‘í•˜ì„¸ìš”</li>\r\n            <li>â€¢ í‹€ë¦° ë¬¸ì œëŠ” ì •ë‹µì„ ë“£ê³  ë”°ë¼ ë§í•´ë³´ì„¸ìš”</li>\r\n            <li>â€¢ ë§¤ì¼ ì¡°ê¸ˆì”©ì´ë¼ë„ ê¾¸ì¤€íˆ ì—°ìŠµí•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤</li>\r\n          </ul>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\pages\\ReviewPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'DrillCard' is defined but never used. Allowed unused vars must match /^_/u.","line":8,"column":15,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":24},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'resetStudyState'. Either include it or remove the dependency array.","line":44,"column":6,"nodeType":"ArrayExpression","endLine":44,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [resetStudyState]","fix":{"range":[1380,1382],"text":"[resetStudyState]"}}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":77,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":77,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":112,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":112,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'confidence' is defined but never used. Allowed unused args must match /^_/u.","line":119,"column":57,"nodeType":null,"messageId":"unusedVar","endLine":119,"endColumn":67},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'responseTime' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":122,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":122,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":150,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":150,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useAppStore, useUser, useStudy, useUI } from '@/store/useAppStore';\r\nimport { SpeechRecorder } from '@/components/SpeechRecorder';\r\nimport { FeedbackPanel } from '@/components/FeedbackPanel';\r\nimport { useSpeech } from '@/hooks/useSpeech';\r\nimport { api } from '@/lib/api';\r\nimport type { DrillCard } from '@/types';\r\n\r\nexport const ReviewPage: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const user = useUser();\r\n  const study = useStudy();\r\n  const ui = useUI();\r\n  \r\n  const {\r\n    setCurrentCard,\r\n    setCards,\r\n    setFeedback,\r\n    setCurrentSession,\r\n    resetStudyState,\r\n    setLoading,\r\n    setError,\r\n    clearError,\r\n  } = useAppStore();\r\n\r\n  const [reviewType, setReviewType] = useState<'random' | 'retry' | null>(null);\r\n  const [reviewCount, setReviewCount] = useState(15);\r\n  const [selectedLevels, setSelectedLevels] = useState<number[]>([2, 3, 4]);\r\n  const [cardStartTime, setCardStartTime] = useState<number>(0);\r\n  const [incorrectCards, setIncorrectCards] = useState<string[]>([]);\r\n\r\n  const speech = useSpeech({\r\n    apiBaseUrl: import.meta.env.VITE_API_BASE_URL,\r\n    preferCloudSTT: false,\r\n    language: 'en-US',\r\n  });\r\n\r\n  // Cleanup on unmount\r\n  useEffect(() => {\r\n    return () => {\r\n      resetStudyState();\r\n    };\r\n  }, []);\r\n\r\n  const startRandomReview = async () => {\r\n    setLoading(true);\r\n    clearError();\r\n    \r\n    try {\r\n      const response = await api.getRandomReview({\r\n        userId: user.id,\r\n        count: reviewCount,\r\n        levels: selectedLevels,\r\n      });\r\n      \r\n      if (response.success && response.data) {\r\n        setCards(response.data.cards);\r\n        if (response.data.cards.length > 0) {\r\n          setCurrentCard(response.data.cards[0], 0);\r\n          setCardStartTime(Date.now());\r\n          setReviewType('random');\r\n          \r\n          // Create session for review\r\n          setCurrentSession({\r\n            id: `review_${Date.now()}`,\r\n            userId: user.id,\r\n            level: 0, // Mixed levels\r\n            stage: 0, // Review mode\r\n            startedAt: new Date(),\r\n            items: [],\r\n          });\r\n        }\r\n      } else {\r\n        setError(response.error || 'ë³µìŠµ ì¹´ë“œë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');\r\n      }\r\n    } catch (error) {\r\n      setError('ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const startRetryReview = async () => {\r\n    setLoading(true);\r\n    clearError();\r\n    \r\n    try {\r\n      const response = await api.getRetryReview({\r\n        userId: user.id,\r\n      });\r\n      \r\n      if (response.success && response.data) {\r\n        setCards(response.data.cards);\r\n        if (response.data.cards.length > 0) {\r\n          setCurrentCard(response.data.cards[0], 0);\r\n          setCardStartTime(Date.now());\r\n          setReviewType('retry');\r\n          \r\n          setCurrentSession({\r\n            id: `retry_${Date.now()}`,\r\n            userId: user.id,\r\n            level: 0,\r\n            stage: 0,\r\n            startedAt: new Date(),\r\n            items: [],\r\n          });\r\n        }\r\n      } else {\r\n        setError(response.error || 'ì˜¤ë‹µ ë³µìŠµ ì¹´ë“œë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');\r\n      }\r\n    } catch (error) {\r\n      setError('ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleSpeechResult = async (transcript: string, confidence: number) => {\r\n    if (!study.currentCard || !study.currentSession) return;\r\n\r\n    const responseTime = Date.now() - cardStartTime;\r\n    setLoading(true);\r\n\r\n    try {\r\n      const feedbackResponse = await api.getFeedback({\r\n        front_ko: study.currentCard.front_ko,\r\n        sttText: transcript,\r\n        target_en: study.currentCard.target_en,\r\n      });\r\n\r\n      if (feedbackResponse.success && feedbackResponse.data) {\r\n        const feedback = feedbackResponse.data;\r\n        setFeedback(feedback);\r\n\r\n        // Track incorrect answers for retry mode\r\n        if (!feedback.correct) {\r\n          setIncorrectCards(prev => [...prev, study.currentCard!.id]);\r\n        }\r\n\r\n        // Play correct answer if TTS is available and answer was incorrect\r\n        if (speech.isTTSAvailable && !feedback.correct) {\r\n          setTimeout(() => {\r\n            speech.speak(study.currentCard!.target_en);\r\n          }, 1500);\r\n        }\r\n      } else {\r\n        setError(feedbackResponse.error || 'í”¼ë“œë°±ì„ ë°›ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');\r\n      }\r\n    } catch (error) {\r\n      setError('í”¼ë“œë°± ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleNextCard = () => {\r\n    const nextIndex = study.currentIndex + 1;\r\n    \r\n    if (nextIndex < study.cards.length) {\r\n      setCurrentCard(study.cards[nextIndex], nextIndex);\r\n      setCardStartTime(Date.now());\r\n      setFeedback(null);\r\n    } else {\r\n      finishReview();\r\n    }\r\n  };\r\n\r\n  const handlePreviousCard = () => {\r\n    const prevIndex = study.currentIndex - 1;\r\n    \r\n    if (prevIndex >= 0) {\r\n      setCurrentCard(study.cards[prevIndex], prevIndex);\r\n      setCardStartTime(Date.now());\r\n      setFeedback(null);\r\n    }\r\n  };\r\n\r\n  const finishReview = () => {\r\n    const correctCount = study.cards.length - incorrectCards.length;\r\n    const accuracy = Math.round((correctCount / study.cards.length) * 100);\r\n    \r\n    navigate('/result', { \r\n      state: { \r\n        summary: {\r\n          totalCards: study.cards.length,\r\n          correctAnswers: correctCount,\r\n          accuracy: accuracy,\r\n          reviewType: reviewType\r\n        }\r\n      }\r\n    });\r\n  };\r\n\r\n  const toggleLevel = (level: number) => {\r\n    setSelectedLevels(prev => \r\n      prev.includes(level) \r\n        ? prev.filter(l => l !== level)\r\n        : [...prev, level]\r\n    );\r\n  };\r\n\r\n  // Render setup screen\r\n  if (!reviewType || !study.currentCard) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gray-50 p-4\">\r\n        <div className=\"max-w-lg mx-auto\">\r\n          {/* Header */}\r\n          <div className=\"bg-white rounded-lg shadow-lg p-6 mb-6\">\r\n            <button\r\n              onClick={() => navigate('/')}\r\n              className=\"text-gray-600 hover:text-gray-800 mb-4\"\r\n            >\r\n              â† í™ˆìœ¼ë¡œ ëŒì•„ê°€ê¸°\r\n            </button>\r\n            <h1 className=\"text-2xl font-bold text-gray-800 mb-2\">ë³µìŠµ ëª¨ë“œ</h1>\r\n            <p className=\"text-gray-600\">ì™„ì„±ëœ ë ˆë²¨ì—ì„œ ëœë¤ ë³µìŠµí•˜ê¸°</p>\r\n          </div>\r\n\r\n          {/* Random Review Setup */}\r\n          <div className=\"bg-white rounded-lg shadow-lg p-6 mb-4\">\r\n            <h2 className=\"text-lg font-semibold text-gray-800 mb-4\">ğŸ”„ ëœë¤ ë³µìŠµ</h2>\r\n            \r\n            <div className=\"mb-4\">\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                ë³µìŠµí•  ë¬¸ì¥ ìˆ˜: {reviewCount}ê°œ\r\n              </label>\r\n              <input\r\n                type=\"range\"\r\n                min=\"5\"\r\n                max=\"30\"\r\n                value={reviewCount}\r\n                onChange={(e) => setReviewCount(parseInt(e.target.value))}\r\n                className=\"w-full\"\r\n              />\r\n              <div className=\"flex justify-between text-xs text-gray-500 mt-1\">\r\n                <span>5ê°œ</span>\r\n                <span>30ê°œ</span>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"mb-4\">\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                ë³µìŠµí•  ë ˆë²¨ ì„ íƒ\r\n              </label>\r\n              <div className=\"grid grid-cols-2 gap-2\">\r\n                {[2, 3, 4, 5].map((level) => (\r\n                  <button\r\n                    key={level}\r\n                    onClick={() => toggleLevel(level)}\r\n                    className={`p-3 rounded-lg border text-sm font-medium transition-colors ${\r\n                      selectedLevels.includes(level)\r\n                        ? 'bg-blue-500 text-white border-blue-500'\r\n                        : 'bg-gray-50 text-gray-700 border-gray-200 hover:bg-gray-100'\r\n                    }`}\r\n                  >\r\n                    Level {level}\r\n                  </button>\r\n                ))}\r\n              </div>\r\n            </div>\r\n\r\n            <button\r\n              onClick={startRandomReview}\r\n              disabled={selectedLevels.length === 0 || ui.isLoading}\r\n              className=\"w-full bg-orange-500 hover:bg-orange-600 disabled:bg-gray-300 text-white font-bold py-3 px-6 rounded-lg transition-colors duration-200\"\r\n            >\r\n              {ui.isLoading ? 'ë¡œë”© ì¤‘...' : 'ëœë¤ ë³µìŠµ ì‹œì‘'}\r\n            </button>\r\n          </div>\r\n\r\n          {/* Retry Review */}\r\n          <div className=\"bg-white rounded-lg shadow-lg p-6\">\r\n            <h2 className=\"text-lg font-semibold text-gray-800 mb-4\">ğŸ” ì˜¤ë‹µ ë³µìŠµ</h2>\r\n            <p className=\"text-gray-600 mb-4 text-sm\">\r\n              ìµœê·¼ í‹€ë¦° ë¬¸ì œë“¤ì„ ë‹¤ì‹œ ì—°ìŠµí•´ë³´ì„¸ìš”.\r\n            </p>\r\n            <button\r\n              onClick={startRetryReview}\r\n              disabled={ui.isLoading}\r\n              className=\"w-full bg-red-500 hover:bg-red-600 disabled:bg-gray-300 text-white font-bold py-3 px-6 rounded-lg transition-colors duration-200\"\r\n            >\r\n              {ui.isLoading ? 'ë¡œë”© ì¤‘...' : 'ì˜¤ë‹µ ë³µìŠµ ì‹œì‘'}\r\n            </button>\r\n          </div>\r\n\r\n          {ui.error && (\r\n            <div className=\"bg-red-50 border border-red-200 rounded-lg p-4 mt-4\">\r\n              <p className=\"text-red-600\">{ui.error}</p>\r\n              <button\r\n                onClick={clearError}\r\n                className=\"mt-2 text-red-500 hover:text-red-700 font-medium\"\r\n              >\r\n                ë‹¤ì‹œ ì‹œë„\r\n              </button>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Render study interface (same as StudyPage)\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50\">\r\n      {/* Header */}\r\n      <div className=\"bg-white shadow-sm border-b\">\r\n        <div className=\"max-w-2xl mx-auto px-4 py-3\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <button\r\n              onClick={() => navigate('/')}\r\n              className=\"text-gray-600 hover:text-gray-800\"\r\n            >\r\n              â† ë’¤ë¡œ\r\n            </button>\r\n            <div className=\"text-center\">\r\n              <h1 className=\"text-lg font-semibold\">\r\n                {reviewType === 'random' ? 'ğŸ”„ ëœë¤ ë³µìŠµ' : 'ğŸ” ì˜¤ë‹µ ë³µìŠµ'}\r\n              </h1>\r\n            </div>\r\n            <div className=\"text-sm text-gray-500\">\r\n              {study.currentIndex + 1}/{study.cards.length}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Progress Bar */}\r\n      <div className=\"bg-white border-b\">\r\n        <div className=\"max-w-2xl mx-auto px-4 py-2\">\r\n          <div className=\"bg-gray-200 rounded-full h-2\">\r\n            <div \r\n              className=\"bg-orange-500 h-2 rounded-full transition-all duration-300\"\r\n              style={{ \r\n                width: `${((study.currentIndex + 1) / study.cards.length) * 100}%`\r\n              }}\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Main Content */}\r\n      <div className=\"max-w-2xl mx-auto px-4 py-8\">\r\n        {/* Korean Prompt Card */}\r\n        <div className=\"bg-white rounded-lg shadow-lg p-8 mb-8\">\r\n          <div className=\"text-center\">\r\n            <h2 className=\"text-sm font-medium text-gray-500 mb-2\">í•œêµ­ì–´ë¥¼ ì˜ì–´ë¡œ</h2>\r\n            <p className=\"text-2xl font-bold text-gray-800 mb-6\">\r\n              {study.currentCard.front_ko}\r\n            </p>\r\n            \r\n            {/* Card Source Info */}\r\n            {(study.currentCard as any).level && (\r\n              <div className=\"text-xs text-gray-500 mb-4\">\r\n                Level {(study.currentCard as any).level} - {(study.currentCard as any).stageTitle}\r\n              </div>\r\n            )}\r\n            \r\n            {/* Expected Answer (shown after feedback) */}\r\n            {study.feedback && (\r\n              <div className=\"text-sm text-gray-600 bg-gray-50 rounded p-3\">\r\n                <span className=\"font-medium\">ì •ë‹µ: </span>\r\n                {study.currentCard.target_en}\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Speech Recorder */}\r\n        <div className=\"bg-white rounded-lg shadow-lg p-8 mb-8\">\r\n          <div className=\"text-center\">\r\n            <SpeechRecorder\r\n              onResult={handleSpeechResult}\r\n              onError={(error) => setError(error)}\r\n              phraseHints={[study.currentCard.target_en]}\r\n              disabled={ui.isLoading || !!study.feedback}\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        {/* Feedback Panel */}\r\n        {study.feedback && (\r\n          <FeedbackPanel\r\n            feedback={study.feedback}\r\n            onPlayAnswer={() => speech.speak(study.currentCard!.target_en)}\r\n            canPlayAnswer={speech.isTTSAvailable}\r\n          />\r\n        )}\r\n\r\n        {/* Navigation Controls */}\r\n        <div className=\"flex justify-between items-center\">\r\n          <button\r\n            onClick={handlePreviousCard}\r\n            disabled={study.currentIndex === 0}\r\n            className=\"px-6 py-3 bg-gray-500 text-white rounded-lg disabled:bg-gray-300 disabled:cursor-not-allowed hover:bg-gray-600 transition-colors\"\r\n          >\r\n            â† ì´ì „ ì¹´ë“œ\r\n          </button>\r\n\r\n          <div className=\"flex space-x-2\">\r\n            {study.feedback && (\r\n              <button\r\n                onClick={() => speech.speak(study.currentCard!.target_en)}\r\n                disabled={!speech.isTTSAvailable}\r\n                className=\"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 disabled:bg-gray-300 text-sm\"\r\n              >\r\n                ğŸ”Š ì •ë‹µ ë“£ê¸°\r\n              </button>\r\n            )}\r\n          </div>\r\n\r\n          {study.currentIndex < study.cards.length - 1 ? (\r\n            <button\r\n              onClick={handleNextCard}\r\n              disabled={!study.feedback}\r\n              className=\"px-6 py-3 bg-green-500 text-white rounded-lg disabled:bg-gray-300 disabled:cursor-not-allowed hover:bg-green-600 transition-colors\"\r\n            >\r\n              ë‹¤ìŒ ì¹´ë“œ â†’\r\n            </button>\r\n          ) : (\r\n            <button\r\n              onClick={finishReview}\r\n              disabled={!study.feedback}\r\n              className=\"px-6 py-3 bg-purple-500 text-white rounded-lg disabled:bg-gray-300 disabled:cursor-not-allowed hover:bg-purple-600 transition-colors\"\r\n            >\r\n              ë³µìŠµ ì™„ë£Œ\r\n            </button>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\pages\\ScenarioDialoguePage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'currentTurn' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":19,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":19,"endColumn":21}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useRef } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { \r\n  scenarioDialogueService, \r\n  ScenarioCategory, \r\n  DialogueScenario, \r\n  DialogueSession, \r\n  DialogueTurn \r\n} from '../services/scenarioDialogue';\r\n\r\nconst ScenarioDialoguePage: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const chatEndRef = useRef<HTMLDivElement>(null);\r\n  \r\n  const [categories, setCategories] = useState<ScenarioCategory[]>([]);\r\n  const [selectedCategory, setSelectedCategory] = useState<ScenarioCategory | null>(null);\r\n  const [selectedScenario, setSelectedScenario] = useState<DialogueScenario | null>(null);\r\n  const [currentSession, setCurrentSession] = useState<DialogueSession | null>(null);\r\n  const [currentTurn, setCurrentTurn] = useState<DialogueTurn | null>(null);\r\n  const [userInput, setUserInput] = useState('');\r\n  const [chatHistory, setChatHistory] = useState<Array<{\r\n    speaker: 'user' | 'ai';\r\n    message: string;\r\n    feedback?: string;\r\n    score?: number;\r\n    timestamp: Date;\r\n  }>>([]);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [isCompleted, setIsCompleted] = useState(false);\r\n  const [sessionSummary, setSessionSummary] = useState<any>(null);\r\n\r\n  useEffect(() => {\r\n    loadCategories();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    scrollToBottom();\r\n  }, [chatHistory]);\r\n\r\n  const scrollToBottom = () => {\r\n    chatEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n  };\r\n\r\n  const loadCategories = async () => {\r\n    setIsLoading(true);\r\n    try {\r\n      const categoriesData = await scenarioDialogueService.getScenarioCategories();\r\n      setCategories(categoriesData);\r\n    } catch (error) {\r\n      console.error('Failed to load categories:', error);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleCategorySelect = (category: ScenarioCategory) => {\r\n    setSelectedCategory(category);\r\n    setSelectedScenario(null);\r\n  };\r\n\r\n  const handleScenarioSelect = async (scenario: DialogueScenario) => {\r\n    setSelectedScenario(scenario);\r\n    try {\r\n      const session = await scenarioDialogueService.startDialogueSession('current-user', scenario.id);\r\n      setCurrentSession(session);\r\n      \r\n      // ì²« ë²ˆì§¸ AI í„´ì´ ìˆìœ¼ë©´ í‘œì‹œ\r\n      if (scenario.turns && scenario.turns.length > 0) {\r\n        const firstTurn = scenario.turns[0];\r\n        if (firstTurn.speaker === 'ai') {\r\n          setChatHistory([{\r\n            speaker: 'ai',\r\n            message: firstTurn.text_en,\r\n            timestamp: new Date()\r\n          }]);\r\n          setCurrentTurn(firstTurn);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to start dialogue session:', error);\r\n    }\r\n  };\r\n\r\n  const handleUserSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (!userInput.trim() || !currentSession || isLoading) return;\r\n\r\n    setIsLoading(true);\r\n    \r\n    // ì‚¬ìš©ì ì…ë ¥ì„ ì±„íŒ… íˆìŠ¤í† ë¦¬ì— ì¶”ê°€\r\n    const userMessage = {\r\n      speaker: 'user' as const,\r\n      message: userInput,\r\n      timestamp: new Date()\r\n    };\r\n    setChatHistory(prev => [...prev, userMessage]);\r\n    setUserInput('');\r\n\r\n    try {\r\n      const response = await scenarioDialogueService.processUserTurn(currentSession.sessionId, userInput);\r\n      \r\n      // AI ì‘ë‹µì„ ì±„íŒ… íˆìŠ¤í† ë¦¬ì— ì¶”ê°€\r\n      const aiMessage = {\r\n        speaker: 'ai' as const,\r\n        message: response.aiResponse,\r\n        feedback: response.feedback,\r\n        score: response.score,\r\n        timestamp: new Date()\r\n      };\r\n      setChatHistory(prev => [...prev, aiMessage]);\r\n\r\n      if (response.isCompleted) {\r\n        setIsCompleted(true);\r\n        const summary = await scenarioDialogueService.completeDialogueSession(currentSession.sessionId);\r\n        setSessionSummary(summary);\r\n      } else if (response.nextTurn) {\r\n        setCurrentTurn(response.nextTurn);\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to process user turn:', error);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleRestart = () => {\r\n    setSelectedCategory(null);\r\n    setSelectedScenario(null);\r\n    setCurrentSession(null);\r\n    setCurrentTurn(null);\r\n    setChatHistory([]);\r\n    setIsCompleted(false);\r\n    setSessionSummary(null);\r\n    setUserInput('');\r\n  };\r\n\r\n  const getDifficultyColor = (difficulty: string) => {\r\n    switch (difficulty) {\r\n      case 'beginner': return 'bg-green-100 text-green-800';\r\n      case 'intermediate': return 'bg-yellow-100 text-yellow-800';\r\n      case 'advanced': return 'bg-red-100 text-red-800';\r\n      default: return 'bg-gray-100 text-gray-800';\r\n    }\r\n  };\r\n\r\n  const getDifficultyText = (difficulty: string) => {\r\n    switch (difficulty) {\r\n      case 'beginner': return 'ì´ˆê¸‰';\r\n      case 'intermediate': return 'ì¤‘ê¸‰';\r\n      case 'advanced': return 'ê³ ê¸‰';\r\n      default: return difficulty;\r\n    }\r\n  };\r\n\r\n  if (isLoading && categories.length === 0) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto mb-4\"></div>\r\n          <p className=\"text-gray-600\">ì‹œë‚˜ë¦¬ì˜¤ ë¡œë”© ì¤‘...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100\">\r\n      {/* Header */}\r\n      <div className=\"bg-white shadow-sm border-b border-gray-200 p-4\">\r\n        <div className=\"max-w-4xl mx-auto flex items-center justify-between\">\r\n          <div className=\"flex items-center space-x-3\">\r\n            <button\r\n              onClick={() => navigate('/')}\r\n              className=\"text-gray-600 hover:text-gray-800 transition-colors\"\r\n            >\r\n              â†\r\n            </button>\r\n            <h1 className=\"text-2xl font-bold text-gray-800 flex items-center\">\r\n              ğŸ­ ì‹œë‚˜ë¦¬ì˜¤ ëŒ€í™” ëª¨ë“œ\r\n            </h1>\r\n          </div>\r\n          \r\n          {currentSession && (\r\n            <div className=\"flex items-center space-x-3\">\r\n              <span className=\"text-sm text-gray-600\">\r\n                Turn {chatHistory.filter(h => h.speaker === 'user').length}\r\n              </span>\r\n              <button\r\n                onClick={handleRestart}\r\n                className=\"px-3 py-1 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors text-sm\"\r\n              >\r\n                ë‹¤ì‹œ ì‹œì‘\r\n              </button>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"max-w-4xl mx-auto p-4\">\r\n        {!selectedCategory ? (\r\n          /* Category Selection */\r\n          <div>\r\n            <div className=\"text-center mb-8\">\r\n              <h2 className=\"text-3xl font-bold text-gray-800 mb-2\">ëŒ€í™” ì‹œë‚˜ë¦¬ì˜¤ ì„ íƒ</h2>\r\n              <p className=\"text-gray-600\">ìƒí™©ì— ë§ëŠ” ëŒ€í™”ë¥¼ ì—°ìŠµí•´ë³´ì„¸ìš”</p>\r\n            </div>\r\n\r\n            <div className=\"grid md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n              {categories.map((category) => (\r\n                <div\r\n                  key={category.id}\r\n                  onClick={() => handleCategorySelect(category)}\r\n                  className=\"bg-white rounded-2xl shadow-lg p-6 cursor-pointer hover:shadow-xl transition-shadow duration-200 border border-gray-100\"\r\n                >\r\n                  <div className=\"text-center\">\r\n                    <div className=\"text-4xl mb-3\">{category.icon}</div>\r\n                    <h3 className=\"text-xl font-bold text-gray-800 mb-2\">{category.name}</h3>\r\n                    <p className=\"text-gray-600 text-sm mb-4\">{category.description}</p>\r\n                    <div className=\"text-xs text-gray-500\">\r\n                      {category.scenarios.length}ê°œ ì‹œë‚˜ë¦¬ì˜¤\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        ) : !selectedScenario ? (\r\n          /* Scenario Selection */\r\n          <div>\r\n            <div className=\"flex items-center mb-6\">\r\n              <button\r\n                onClick={() => setSelectedCategory(null)}\r\n                className=\"text-gray-600 hover:text-gray-800 mr-3\"\r\n              >\r\n                â† ë’¤ë¡œ\r\n              </button>\r\n              <div>\r\n                <h2 className=\"text-2xl font-bold text-gray-800 flex items-center\">\r\n                  {selectedCategory.icon} {selectedCategory.name}\r\n                </h2>\r\n                <p className=\"text-gray-600\">{selectedCategory.description}</p>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"space-y-4\">\r\n              {selectedCategory.scenarios.map((scenario) => (\r\n                <div\r\n                  key={scenario.id}\r\n                  onClick={() => handleScenarioSelect(scenario)}\r\n                  className=\"bg-white rounded-xl shadow-lg p-6 cursor-pointer hover:shadow-xl transition-shadow duration-200 border border-gray-100\"\r\n                >\r\n                  <div className=\"flex items-start justify-between mb-3\">\r\n                    <h3 className=\"text-xl font-bold text-gray-800\">{scenario.title}</h3>\r\n                    <span className={`px-3 py-1 rounded-full text-sm font-medium ${getDifficultyColor(scenario.difficulty)}`}>\r\n                      {getDifficultyText(scenario.difficulty)}\r\n                    </span>\r\n                  </div>\r\n                  \r\n                  <p className=\"text-gray-600 mb-4\">{scenario.description}</p>\r\n                  \r\n                  <div className=\"flex items-center justify-between text-sm text-gray-500\">\r\n                    <div className=\"flex items-center space-x-4\">\r\n                      <span>â±ï¸ {scenario.estimatedTime}ë¶„</span>\r\n                      <span>ğŸ’¬ {scenario.totalTurns}í„´</span>\r\n                    </div>\r\n                    <span className=\"text-blue-600 font-medium\">ì‹œì‘í•˜ê¸° â†’</span>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        ) : (\r\n          /* Chat Interface */\r\n          <div className=\"bg-white rounded-2xl shadow-xl h-[70vh] flex flex-col\">\r\n            {/* Scenario Info Header */}\r\n            <div className=\"border-b border-gray-200 p-4\">\r\n              <div className=\"flex items-start justify-between mb-2\">\r\n                <h3 className=\"font-bold text-gray-800\">{selectedScenario.title}</h3>\r\n                <span className={`px-2 py-1 rounded-full text-xs font-medium ${getDifficultyColor(selectedScenario.difficulty)}`}>\r\n                  {getDifficultyText(selectedScenario.difficulty)}\r\n                </span>\r\n              </div>\r\n              <p className=\"text-sm text-gray-600\">{selectedScenario.context}</p>\r\n              <p className=\"text-xs text-blue-600 mt-1\">ëª©í‘œ: {selectedScenario.objective}</p>\r\n            </div>\r\n\r\n            {/* Chat Messages */}\r\n            <div className=\"flex-1 overflow-y-auto p-4 space-y-4\">\r\n              {chatHistory.map((chat, index) => (\r\n                <div\r\n                  key={index}\r\n                  className={`flex ${chat.speaker === 'user' ? 'justify-end' : 'justify-start'}`}\r\n                >\r\n                  <div className={`max-w-[70%] rounded-2xl p-3 ${\r\n                    chat.speaker === 'user' \r\n                      ? 'bg-blue-600 text-white' \r\n                      : 'bg-gray-100 text-gray-800'\r\n                  }`}>\r\n                    <p>{chat.message}</p>\r\n                    {chat.feedback && (\r\n                      <div className=\"mt-2 p-2 bg-green-50 rounded-lg border border-green-200\">\r\n                        <p className=\"text-xs text-green-800\">ğŸ’¡ {chat.feedback}</p>\r\n                        {chat.score && (\r\n                          <p className=\"text-xs text-green-600 mt-1\">ì ìˆ˜: {chat.score}/100</p>\r\n                        )}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              ))}\r\n              \r\n              {isLoading && (\r\n                <div className=\"flex justify-start\">\r\n                  <div className=\"bg-gray-100 rounded-2xl p-3\">\r\n                    <div className=\"flex space-x-1\">\r\n                      <div className=\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\"></div>\r\n                      <div className=\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\" style={{ animationDelay: '0.1s' }}></div>\r\n                      <div className=\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\" style={{ animationDelay: '0.2s' }}></div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              )}\r\n              <div ref={chatEndRef} />\r\n            </div>\r\n\r\n            {/* Input Area */}\r\n            {!isCompleted && (\r\n              <div className=\"border-t border-gray-200 p-4\">\r\n                <form onSubmit={handleUserSubmit} className=\"flex space-x-3\">\r\n                  <input\r\n                    type=\"text\"\r\n                    value={userInput}\r\n                    onChange={(e) => setUserInput(e.target.value)}\r\n                    placeholder=\"ì˜ì–´ë¡œ ë‹µë³€í•´ë³´ì„¸ìš”...\"\r\n                    className=\"flex-1 border border-gray-300 rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                    disabled={isLoading}\r\n                  />\r\n                  <button\r\n                    type=\"submit\"\r\n                    disabled={!userInput.trim() || isLoading}\r\n                    className=\"px-6 py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n                  >\r\n                    ì „ì†¡\r\n                  </button>\r\n                </form>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {/* Session Summary Modal */}\r\n        {isCompleted && sessionSummary && (\r\n          <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\">\r\n            <div className=\"bg-white rounded-2xl shadow-2xl max-w-lg w-full p-6\">\r\n              <div className=\"text-center mb-6\">\r\n                <div className=\"text-6xl mb-3\">ğŸ‰</div>\r\n                <h3 className=\"text-2xl font-bold text-gray-800\">ëŒ€í™” ì™„ë£Œ!</h3>\r\n                <p className=\"text-lg text-blue-600 font-semibold mt-2\">\r\n                  ìµœì¢… ì ìˆ˜: {sessionSummary.finalScore}/100\r\n                </p>\r\n              </div>\r\n\r\n              <div className=\"space-y-4 mb-6\">\r\n                <div>\r\n                  <h4 className=\"font-medium text-gray-800 mb-2\">ğŸ“‹ ìš”ì•½</h4>\r\n                  <p className=\"text-sm text-gray-600\">{sessionSummary.summary}</p>\r\n                </div>\r\n\r\n                <div>\r\n                  <h4 className=\"font-medium text-gray-800 mb-2\">ğŸ† ì„±ì·¨</h4>\r\n                  <div className=\"space-y-1\">\r\n                    {sessionSummary.achievements.map((achievement: string, index: number) => (\r\n                      <div key={index} className=\"flex items-center text-sm text-green-700\">\r\n                        <span className=\"mr-2\">âœ“</span>\r\n                        {achievement}\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n\r\n                <div>\r\n                  <h4 className=\"font-medium text-gray-800 mb-2\">ğŸ’¡ ê°œì„  ì‚¬í•­</h4>\r\n                  <div className=\"space-y-1\">\r\n                    {sessionSummary.recommendations.map((recommendation: string, index: number) => (\r\n                      <div key={index} className=\"flex items-center text-sm text-blue-700\">\r\n                        <span className=\"mr-2\">â†’</span>\r\n                        {recommendation}\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"flex space-x-3\">\r\n                <button\r\n                  onClick={handleRestart}\r\n                  className=\"flex-1 py-3 px-4 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors font-medium\"\r\n                >\r\n                  ë‹¤ë¥¸ ì‹œë‚˜ë¦¬ì˜¤ ì‹œë„\r\n                </button>\r\n                <button\r\n                  onClick={() => navigate('/')}\r\n                  className=\"flex-1 py-3 px-4 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors font-medium\"\r\n                >\r\n                  í™ˆìœ¼ë¡œ ê°€ê¸°\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ScenarioDialoguePage;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\pages\\SettingsPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\pages\\SituationPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Situation' is defined but never used. Allowed unused vars must match /^_/u.","line":11,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'currentScenario' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":28,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":28,"endColumn":25}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Situation Page - ìƒí™© í•™ìŠµ í˜ì´ì§€\r\n */\r\n\r\nimport React, { useState } from 'react';\r\n\r\ninterface SituationPageProps {\r\n  // TODO: Props íƒ€ì… ì •ì˜ ì¶”ê°€\r\n}\r\n\r\ninterface Situation {\r\n  id: string;\r\n  title: string;\r\n  description: string;\r\n  level: string;\r\n  scenarios: Array<{\r\n    id: string;\r\n    situation: string;\r\n    dialogue: Array<{\r\n      speaker: string;\r\n      text: string;\r\n    }>;\r\n  }>;\r\n}\r\n\r\nconst SituationPage: React.FC<SituationPageProps> = () => {\r\n  const [selectedSituation, setSelectedSituation] = useState<string>('restaurant');\r\n  const [currentScenario, setCurrentScenario] = useState(0);\r\n  const [userResponse, setUserResponse] = useState<string>('');\r\n\r\n  const situations = [\r\n    { id: 'restaurant', title: 'ë ˆìŠ¤í† ë‘ì—ì„œ', description: 'ìŒì‹ ì£¼ë¬¸í•˜ê¸°' },\r\n    { id: 'airport', title: 'ê³µí•­ì—ì„œ', description: 'ì²´í¬ì¸ ë° íƒ‘ìŠ¹' },\r\n    { id: 'hotel', title: 'í˜¸í…”ì—ì„œ', description: 'ì²´í¬ì¸ ë° ë¬¸ì˜' },\r\n    { id: 'shopping', title: 'ì‡¼í•‘í•  ë•Œ', description: 'ì œí’ˆ ë¬¸ì˜ ë° êµ¬ë§¤' },\r\n    { id: 'business', title: 'ë¹„ì¦ˆë‹ˆìŠ¤ ë¯¸íŒ…', description: 'íšŒì˜ ë° í”„ë ˆì  í…Œì´ì…˜' },\r\n  ];\r\n\r\n  const mockDialogue = [\r\n    { speaker: 'Waiter', text: 'Good evening! Welcome to our restaurant. How many people are in your party?' },\r\n    { speaker: 'You', text: '[Your response here]' },\r\n    { speaker: 'Waiter', text: 'Right this way, please. Here are your menus.' },\r\n    { speaker: 'You', text: '[Your response here]' }\r\n  ];\r\n\r\n  const handleSituationChange = (situationId: string) => {\r\n    setSelectedSituation(situationId);\r\n    setCurrentScenario(0);\r\n    setUserResponse('');\r\n  };\r\n\r\n  const handleResponseSubmit = () => {\r\n    // TODO: ì‚¬ìš©ì ì‘ë‹µ ë¶„ì„ ë° í”¼ë“œë°± ì œê³µ\r\n    console.log('User response:', userResponse);\r\n  };\r\n\r\n  return (\r\n    <div className=\"situation-page\">\r\n      <div className=\"container mx-auto px-4 py-6\">\r\n        <h1 className=\"text-2xl font-bold mb-6\">ìƒí™© í•™ìŠµ</h1>\r\n        \r\n        {/* ìƒí™© ì„ íƒ ì„¹ì…˜ */}\r\n        <div className=\"situation-selector bg-white rounded-lg shadow-md p-6 mb-6\">\r\n          <h2 className=\"text-xl font-semibold mb-4\">í•™ìŠµí•  ìƒí™© ì„ íƒ</h2>\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n            {situations.map((situation) => (\r\n              <div\r\n                key={situation.id}\r\n                onClick={() => handleSituationChange(situation.id)}\r\n                className={`situation-card p-4 rounded-lg cursor-pointer transition-colors ${\r\n                  selectedSituation === situation.id\r\n                    ? 'bg-blue-100 border-2 border-blue-500'\r\n                    : 'bg-gray-50 border-2 border-gray-200 hover:bg-gray-100'\r\n                }`}\r\n              >\r\n                <h3 className=\"font-medium text-gray-800 mb-1\">{situation.title}</h3>\r\n                <p className=\"text-sm text-gray-600\">{situation.description}</p>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        {/* ëŒ€í™” ì‹œë‚˜ë¦¬ì˜¤ ì„¹ì…˜ */}\r\n        <div className=\"scenario-section bg-white rounded-lg shadow-md p-6 mb-6\">\r\n          <h2 className=\"text-xl font-semibold mb-4\">\r\n            ëŒ€í™” ì‹œë‚˜ë¦¬ì˜¤: {situations.find(s => s.id === selectedSituation)?.title}\r\n          </h2>\r\n          \r\n          <div className=\"dialogue-container mb-6\">\r\n            {mockDialogue.map((line, index) => (\r\n              <div key={index} className={`dialogue-line mb-3 ${line.speaker === 'You' ? 'user-line' : 'other-line'}`}>\r\n                <div className={`p-3 rounded-lg ${\r\n                  line.speaker === 'You' \r\n                    ? 'bg-blue-50 ml-8' \r\n                    : 'bg-gray-50 mr-8'\r\n                }`}>\r\n                  <div className=\"speaker-name font-medium text-sm mb-1\">\r\n                    {line.speaker}\r\n                  </div>\r\n                  {line.speaker === 'You' && line.text.includes('[Your response here]') ? (\r\n                    <textarea\r\n                      value={userResponse}\r\n                      onChange={(e) => setUserResponse(e.target.value)}\r\n                      placeholder=\"ì—¬ê¸°ì— ì‘ë‹µì„ ì…ë ¥í•˜ì„¸ìš”...\"\r\n                      className=\"w-full p-2 border border-gray-300 rounded resize-none\"\r\n                      rows={2}\r\n                    />\r\n                  ) : (\r\n                    <div className=\"dialogue-text\">{line.text}</div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n\r\n          {/* ì‘ë‹µ ì œì¶œ ë²„íŠ¼ */}\r\n          <div className=\"response-actions\">\r\n            <button \r\n              onClick={handleResponseSubmit}\r\n              disabled={!userResponse.trim()}\r\n              className=\"bg-blue-500 text-white px-6 py-2 rounded-md hover:bg-blue-600 transition-colors disabled:bg-gray-300 mr-3\"\r\n            >\r\n              ì‘ë‹µ ì œì¶œ\r\n            </button>\r\n            <button className=\"bg-gray-500 text-white px-6 py-2 rounded-md hover:bg-gray-600 transition-colors\">\r\n              ğŸ”Š ìŒì„±ìœ¼ë¡œ ì‘ë‹µ\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* ìƒí™©ë³„ í•µì‹¬ í‘œí˜„ ì„¹ì…˜ */}\r\n        <div className=\"key-expressions bg-white rounded-lg shadow-md p-6\">\r\n          <h2 className=\"text-xl font-semibold mb-4\">í•µì‹¬ í‘œí˜„</h2>\r\n          <div className=\"expressions-grid grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n            <div className=\"expression-card bg-green-50 rounded-lg p-3\">\r\n              <div className=\"expression font-medium text-green-800 mb-1\">\r\n                Table for two, please.\r\n              </div>\r\n              <div className=\"translation text-sm text-green-600\">\r\n                ë‘ ëª… ìë¦¬ ë¶€íƒí•©ë‹ˆë‹¤.\r\n              </div>\r\n            </div>\r\n            <div className=\"expression-card bg-green-50 rounded-lg p-3\">\r\n              <div className=\"expression font-medium text-green-800 mb-1\">\r\n                Could I see the menu?\r\n              </div>\r\n              <div className=\"translation text-sm text-green-600\">\r\n                ë©”ë‰´ ì¢€ ë³¼ ìˆ˜ ìˆì„ê¹Œìš”?\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SituationPage;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\pages\\SituationalTrainingPage.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'levelGroupMapping'. Either include it or remove the dependency array.","line":104,"column":6,"nodeType":"ArrayExpression","endLine":104,"endColumn":20,"suggestions":[{"desc":"Update the dependencies array to be: [level, group, levelGroupMapping]","fix":{"range":[4048,4062],"text":"[level, group, levelGroupMapping]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect, useState } from 'react';\nimport { useNavigate, useSearchParams } from 'react-router-dom';\nimport { useAnswerEvaluation } from '@/hooks/useAnswerEvaluation';\n\ninterface Sentence {\n  id: string;\n  kr: string;\n  en: string;\n  form: 'aff' | 'neg' | 'wh_q';\n}\n\ninterface StageData {\n  stage_id: string;\n  title: string;\n  count: number;\n  sentences: Sentence[];\n  forms_distribution?: {\n    aff: number;\n    neg: number;\n    wh_q: number;\n  };\n}\n\nexport const SituationalTrainingPage: React.FC = () => {\n  const navigate = useNavigate();\n  const [searchParams] = useSearchParams();\n  const [stageData, setStageData] = useState<StageData[]>([]);\n  const [currentSentence, setCurrentSentence] = useState<Sentence | null>(null);\n  const [userInput, setUserInput] = useState('');\n  const [feedback, setFeedback] = useState<{type: 'correct' | 'incorrect' | null, message: string}>({type: null, message: ''});\n  const [currentIndex, setCurrentIndex] = useState(0);\n  const [score, setScore] = useState({ correct: 0, total: 0 });\n  const [isLoading, setIsLoading] = useState(true);\n\n  const level = searchParams.get('level');\n  const group = searchParams.get('group');\n  const groupTitle = searchParams.get('title');\n\n  // Answer evaluation hook with level-appropriate settings\n  const { evaluate } = useAnswerEvaluation({\n    level: parseInt(level || '4'),\n    mode: 'situational',\n    enableLogging: true\n  });\n\n  // Levelë³„ ê·¸ë£¹ ìŠ¤í…Œì´ì§€ ID ë§¤í•‘\n  const levelGroupMapping: { [key: string]: { [key: string]: string[] } } = {\n    '4': {\n      '1': ['Lv4-A5-S17', 'Lv4-A5-S18', 'Lv4-A5-S19', 'Lv4-A5-S20'], // Customer Excellence\n      '2': ['Lv4-A4-S13', 'Lv4-A4-S14', 'Lv4-A4-S15', 'Lv4-A4-S16'], // Professional Communication\n      '3': ['Lv4-A1-S01', 'Lv4-A1-S02', 'Lv4-A1-S03', 'Lv4-A1-S04'], // Meeting Leadership\n      '4': ['Lv4-A2-S05', 'Lv4-A2-S06', 'Lv4-A2-S07', 'Lv4-A2-S08'], // Presentation Mastery\n      '5': ['Lv4-A3-S09', 'Lv4-A3-S10', 'Lv4-A3-S11', 'Lv4-A3-S12'], // Strategic Negotiation\n      '6': ['Lv4-A6-S21', 'Lv4-A6-S22', 'Lv4-A6-S23', 'Lv4-A6-S24']  // Team Leadership\n    },\n    '5': {\n      '1': ['Lv5-A1-S01', 'Lv5-A1-S02', 'Lv5-A1-S03', 'Lv5-A1-S04'], // Research Foundation\n      '2': ['Lv5-A2-S05', 'Lv5-A2-S06', 'Lv5-A2-S07', 'Lv5-A2-S08'], // Academic Presentation\n      '3': ['Lv5-A3-S09', 'Lv5-A3-S10', 'Lv5-A3-S11', 'Lv5-A3-S12'], // Research Methodology\n      '4': ['Lv5-A4-S13', 'Lv5-A4-S14', 'Lv5-A4-S15', 'Lv5-A4-S16'], // Interdisciplinary Research\n      '5': ['Lv5-A5-S17', 'Lv5-A5-S18', 'Lv5-A5-S19', 'Lv5-A5-S20'], // Publication & Peer Review\n      '6': ['Lv5-A6-S21', 'Lv5-A6-S22', 'Lv5-A6-S23', 'Lv5-A6-S24']  // Academic Leadership\n    },\n    '6': {\n      '1': ['Lv6-D1-S01', 'Lv6-D1-S02', 'Lv6-D1-S03'], // Legal Excellence\n      '2': ['Lv6-D2-S04', 'Lv6-D2-S05', 'Lv6-D2-S06'], // Medical Professional\n      '3': ['Lv6-D3-S07', 'Lv6-D3-S08', 'Lv6-D3-S09'], // Technical Engineering\n      '4': ['Lv6-D4-S10', 'Lv6-D4-S11', 'Lv6-D4-S12']  // Financial Expertise\n    }\n  };\n\n  const allSentences = stageData.flatMap(stage => stage.sentences);\n\n  useEffect(() => {\n    const loadStageData = async () => {\n      if (!level || !group || !levelGroupMapping[level] || !levelGroupMapping[level][group]) {\n        console.error('Invalid level or group:', level, group);\n        return;\n      }\n\n      setIsLoading(true);\n      const stageIds = levelGroupMapping[level][group];\n      const loadedStages: StageData[] = [];\n\n      for (const stageId of stageIds) {\n        try {\n          const response = await fetch(`/patterns/level_${level}_situational/${stageId}_bank.json`);\n          if (response.ok) {\n            const stageData = await response.json();\n            loadedStages.push(stageData);\n          } else {\n            console.error(`Failed to load stage ${stageId}`);\n          }\n        } catch (error) {\n          console.error(`Error loading stage ${stageId}:`, error);\n        }\n      }\n\n      setStageData(loadedStages);\n      setIsLoading(false);\n    };\n\n    loadStageData();\n  }, [level, group]);\n\n  useEffect(() => {\n    if (allSentences.length > 0 && currentIndex < allSentences.length) {\n      setCurrentSentence(allSentences[currentIndex]);\n      setUserInput('');\n      setFeedback({type: null, message: ''});\n    }\n  }, [allSentences, currentIndex]);\n\n  const checkAnswer = () => {\n    if (!currentSentence) return;\n\n    // Use modular answer evaluation with contraction support\n    const evaluation = evaluate(userInput, currentSentence.en);\n    \n    setScore(prev => ({\n      correct: prev.correct + (evaluation.isCorrect ? 1 : 0),\n      total: prev.total + 1\n    }));\n\n    setFeedback({\n      type: evaluation.isCorrect ? 'correct' : 'incorrect',\n      message: evaluation.isCorrect ? 'ì •ë‹µì…ë‹ˆë‹¤! ğŸ‰' : evaluation.feedback\n    });\n\n    // 2ì´ˆ í›„ ë‹¤ìŒ ë¬¸ì œë¡œ\n    setTimeout(() => {\n      setCurrentIndex(prev => prev + 1);\n    }, 2000);\n  };\n\n  const handleKeyPress = (e: React.KeyboardEvent) => {\n    if (e.key === 'Enter' && !feedback.type) {\n      checkAnswer();\n    }\n  };\n\n  if (isLoading) {\n    return (\n      <div style={{\n        display: 'flex',\n        justifyContent: 'center',\n        alignItems: 'center',\n        height: '100vh',\n        background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)'\n      }}>\n        <div style={{ color: 'white', fontSize: '1.5em' }}>\n          ìƒí™©í•™ìŠµ ë°ì´í„° ë¡œë”© ì¤‘... ğŸ”„\n        </div>\n      </div>\n    );\n  }\n\n  if (currentIndex >= allSentences.length) {\n    const accuracy = Math.round((score.correct / score.total) * 100);\n    \n    return (\n      <div style={{\n        fontFamily: \"'Segoe UI', Arial, sans-serif\",\n        background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',\n        minHeight: '100vh',\n        display: 'flex',\n        justifyContent: 'center',\n        alignItems: 'center'\n      }}>\n        <div style={{\n          background: 'white',\n          borderRadius: '20px',\n          padding: '40px',\n          textAlign: 'center',\n          boxShadow: '0 20px 40px rgba(0,0,0,0.3)',\n          maxWidth: '500px'\n        }}>\n          <h1 style={{ color: '#1f2937', marginBottom: '20px' }}>ğŸ‰ í›ˆë ¨ ì™„ë£Œ!</h1>\n          <div style={{ fontSize: '3em', marginBottom: '20px' }}>\n            {accuracy >= 90 ? 'ğŸ†' : accuracy >= 80 ? 'ğŸ¥ˆ' : accuracy >= 70 ? 'ğŸ¥‰' : 'ğŸ“š'}\n          </div>\n          <div style={{ fontSize: '2em', color: '#1f2937', marginBottom: '10px' }}>\n            ì •í™•ë„: {accuracy}%\n          </div>\n          <div style={{ color: '#64748b', marginBottom: '30px' }}>\n            {score.correct} / {score.total} ì •ë‹µ\n          </div>\n          <div style={{ display: 'flex', gap: '15px', justifyContent: 'center' }}>\n            <button\n              onClick={() => navigate('/dashboard')}\n              style={{\n                background: 'linear-gradient(135deg, #3b82f6, #1d4ed8)',\n                color: 'white',\n                border: 'none',\n                padding: '12px 24px',\n                borderRadius: '10px',\n                fontSize: '16px',\n                cursor: 'pointer'\n              }}\n            >\n              í™ˆìœ¼ë¡œ\n            </button>\n            <button\n              onClick={() => window.location.reload()}\n              style={{\n                background: 'linear-gradient(135deg, #10b981, #059669)',\n                color: 'white',\n                border: 'none',\n                padding: '12px 24px',\n                borderRadius: '10px',\n                fontSize: '16px',\n                cursor: 'pointer'\n              }}\n            >\n              ë‹¤ì‹œ ë„ì „\n            </button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div style={{\n      fontFamily: \"'Segoe UI', Arial, sans-serif\",\n      background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',\n      minHeight: '100vh',\n      padding: '20px'\n    }}>\n      <div style={{\n        maxWidth: '800px',\n        margin: '0 auto',\n        background: 'white',\n        borderRadius: '20px',\n        boxShadow: '0 20px 40px rgba(0,0,0,0.3)',\n        overflow: 'hidden'\n      }}>\n        {/* í—¤ë” */}\n        <div style={{\n          background: 'linear-gradient(135deg, #4338ca, #7c3aed)',\n          color: 'white',\n          padding: '30px',\n          textAlign: 'center',\n          position: 'relative'\n        }}>\n          <button\n            onClick={() => navigate('/dashboard')}\n            style={{\n              position: 'absolute',\n              top: '20px',\n              left: '20px',\n              background: 'rgba(255,255,255,0.2)',\n              border: '1px solid rgba(255,255,255,0.3)',\n              color: 'white',\n              padding: '8px 15px',\n              borderRadius: '25px',\n              cursor: 'pointer',\n              fontSize: '14px',\n              fontWeight: 'bold',\n              backdropFilter: 'blur(10px)'\n            }}\n          >\n            â† í™ˆ\n          </button>\n\n          <h1 style={{ fontSize: '2em', marginBottom: '10px' }}>\n            {level === '4' ? 'ğŸ’¼' : level === '5' ? 'ğŸ“' : 'ğŸ¯'} Level {level} ìƒí™©í•™ìŠµ - {groupTitle}\n          </h1>\n          <div style={{ display: 'flex', justifyContent: 'center', gap: '30px' }}>\n            <div>\n              <div style={{ fontSize: '1.5em', fontWeight: 'bold' }}>{currentIndex + 1}</div>\n              <div style={{ fontSize: '0.9em', opacity: 0.8 }}>/ {allSentences.length}</div>\n            </div>\n            <div>\n              <div style={{ fontSize: '1.5em', fontWeight: 'bold' }}>{Math.round((score.correct / Math.max(score.total, 1)) * 100)}%</div>\n              <div style={{ fontSize: '0.9em', opacity: 0.8 }}>ì •í™•ë„</div>\n            </div>\n            <div>\n              <div style={{ fontSize: '1.5em', fontWeight: 'bold' }}>{score.correct}</div>\n              <div style={{ fontSize: '0.9em', opacity: 0.8 }}>ì •ë‹µ</div>\n            </div>\n          </div>\n        </div>\n\n        {/* í›ˆë ¨ ì˜ì—­ */}\n        <div style={{ padding: '40px' }}>\n          {currentSentence && (\n            <>\n              <div style={{\n                background: '#f8fafc',\n                borderRadius: '15px',\n                padding: '30px',\n                textAlign: 'center',\n                marginBottom: '30px',\n                border: '2px solid #e2e8f0'\n              }}>\n                <div style={{ fontSize: '1.2em', color: '#64748b', marginBottom: '15px' }}>\n                  ë‹¤ìŒì„ ì˜ì–´ë¡œ ë²ˆì—­í•˜ì„¸ìš”:\n                </div>\n                <div style={{ fontSize: '1.8em', color: '#1f2937', fontWeight: 'bold' }}>\n                  {currentSentence.kr}\n                </div>\n              </div>\n\n              <div style={{ marginBottom: '20px' }}>\n                <input\n                  type=\"text\"\n                  value={userInput}\n                  onChange={(e) => setUserInput(e.target.value)}\n                  onKeyPress={handleKeyPress}\n                  placeholder=\"ì˜ì–´ ë²ˆì—­ì„ ì…ë ¥í•˜ì„¸ìš”...\"\n                  style={{\n                    width: '100%',\n                    padding: '15px 20px',\n                    fontSize: '18px',\n                    border: '2px solid #e2e8f0',\n                    borderRadius: '10px',\n                    outline: 'none',\n                    background: feedback.type ? \n                      (feedback.type === 'correct' ? '#f0fdf4' : '#fef2f2') : 'white',\n                    borderColor: feedback.type ?\n                      (feedback.type === 'correct' ? '#10b981' : '#ef4444') : '#e2e8f0'\n                  }}\n                  disabled={!!feedback.type}\n                />\n              </div>\n\n              {feedback.message && (\n                <div style={{\n                  padding: '15px',\n                  borderRadius: '10px',\n                  textAlign: 'center',\n                  fontSize: '1.1em',\n                  fontWeight: 'bold',\n                  background: feedback.type === 'correct' ? '#dcfce7' : '#fee2e2',\n                  color: feedback.type === 'correct' ? '#166534' : '#dc2626',\n                  marginBottom: '20px'\n                }}>\n                  {feedback.message}\n                </div>\n              )}\n\n              {!feedback.type && (\n                <div style={{ textAlign: 'center' }}>\n                  <button\n                    onClick={checkAnswer}\n                    disabled={!userInput.trim()}\n                    style={{\n                      background: userInput.trim() ? \n                        'linear-gradient(135deg, #10b981, #059669)' : '#e5e7eb',\n                      color: userInput.trim() ? 'white' : '#9ca3af',\n                      border: 'none',\n                      padding: '15px 30px',\n                      borderRadius: '10px',\n                      fontSize: '18px',\n                      fontWeight: 'bold',\n                      cursor: userInput.trim() ? 'pointer' : 'not-allowed',\n                      transition: 'all 0.3s'\n                    }}\n                  >\n                    í™•ì¸ âœ“\n                  </button>\n                </div>\n              )}\n            </>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\pages\\SmartReviewPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useEffect' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":36}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport SmartReviewSession from '../components/SmartReviewSession';\r\nimport ReviewAnalyticsDashboard from '../components/ReviewAnalyticsDashboard';\r\n\r\ninterface ReviewResults {\r\n  totalSentences: number;\r\n  correctAnswers: number;\r\n  averageTime: number;\r\n  improvementAreas: string[];\r\n}\r\n\r\nconst SmartReviewPage: React.FC = () => {\r\n  const [currentView, setCurrentView] = useState<'dashboard' | 'session' | 'results'>('dashboard');\r\n  const [sessionResults, setSessionResults] = useState<ReviewResults | null>(null);\r\n  const userId = 'dev-user'; // ì‹¤ì œë¡œëŠ” auth contextì—ì„œ ê°€ì ¸ì˜´\r\n\r\n  const handleStartReview = () => {\r\n    setCurrentView('session');\r\n    setSessionResults(null);\r\n  };\r\n\r\n  const handleSessionComplete = (results: ReviewResults) => {\r\n    setSessionResults(results);\r\n    setCurrentView('results');\r\n  };\r\n\r\n  const handleBackToDashboard = () => {\r\n    setCurrentView('dashboard');\r\n    setSessionResults(null);\r\n  };\r\n\r\n  const renderSessionResults = () => {\r\n    if (!sessionResults) return null;\r\n\r\n    const accuracyPercentage = Math.round((sessionResults.correctAnswers / sessionResults.totalSentences) * 100);\r\n    const averageTimeSeconds = Math.round(sessionResults.averageTime / 1000);\r\n\r\n    return (\r\n      <div className=\"max-w-4xl mx-auto p-6\">\r\n        <div className=\"text-center mb-8\">\r\n          <h2 className=\"text-3xl font-bold text-gray-900 mb-2\">ğŸ‰ ë³µìŠµ ì™„ë£Œ!</h2>\r\n          <p className=\"text-gray-600\">ì˜¤ëŠ˜ì˜ ë³µìŠµ ì„¸ì…˜ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.</p>\r\n        </div>\r\n\r\n        {/* ì£¼ìš” ê²°ê³¼ */}\r\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\">\r\n          <div className=\"bg-white border border-gray-200 rounded-lg p-6 text-center\">\r\n            <div className=\"text-3xl font-bold text-blue-600 mb-2\">{sessionResults.totalSentences}</div>\r\n            <div className=\"text-gray-600\">ë³µìŠµí•œ ë¬¸ì¥</div>\r\n          </div>\r\n          \r\n          <div className=\"bg-white border border-gray-200 rounded-lg p-6 text-center\">\r\n            <div className=\"text-3xl font-bold text-green-600 mb-2\">{accuracyPercentage}%</div>\r\n            <div className=\"text-gray-600\">ì •í™•ë„</div>\r\n          </div>\r\n          \r\n          <div className=\"bg-white border border-gray-200 rounded-lg p-6 text-center\">\r\n            <div className=\"text-3xl font-bold text-purple-600 mb-2\">{averageTimeSeconds}ì´ˆ</div>\r\n            <div className=\"text-gray-600\">í‰ê·  ì‘ë‹µ ì‹œê°„</div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* ì„±ê³¼ ë¶„ì„ */}\r\n        <div className=\"bg-white border border-gray-200 rounded-lg p-6 mb-8\">\r\n          <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">ğŸ“ˆ ì„±ê³¼ ë¶„ì„</h3>\r\n          \r\n          {accuracyPercentage >= 80 ? (\r\n            <div className=\"flex items-start gap-3 p-4 bg-green-50 border border-green-200 rounded-lg mb-4\">\r\n              <span className=\"text-green-500 text-2xl\">ğŸŒŸ</span>\r\n              <div>\r\n                <h4 className=\"font-medium text-green-900\">í›Œë¥­í•œ ì„±ê³¼!</h4>\r\n                <p className=\"text-green-700 text-sm\">ë†’ì€ ì •í™•ë„ë¥¼ ë³´ì—¬ì£¼ê³  ìˆìŠµë‹ˆë‹¤. ë” ì–´ë ¤ìš´ ë‹¨ê³„ë¡œ ë„ì „í•´ë³´ì„¸ìš”!</p>\r\n              </div>\r\n            </div>\r\n          ) : accuracyPercentage >= 60 ? (\r\n            <div className=\"flex items-start gap-3 p-4 bg-yellow-50 border border-yellow-200 rounded-lg mb-4\">\r\n              <span className=\"text-yellow-500 text-2xl\">ğŸ“š</span>\r\n              <div>\r\n                <h4 className=\"font-medium text-yellow-900\">ì¢‹ì€ ì§„ì „!</h4>\r\n                <p className=\"text-yellow-700 text-sm\">ê¾¸ì¤€íˆ í–¥ìƒë˜ê³  ìˆìŠµë‹ˆë‹¤. ì¡°ê¸ˆ ë” ì§‘ì¤‘í•´ì„œ í•™ìŠµí•´ë³´ì„¸ìš”.</p>\r\n              </div>\r\n            </div>\r\n          ) : (\r\n            <div className=\"flex items-start gap-3 p-4 bg-blue-50 border border-blue-200 rounded-lg mb-4\">\r\n              <span className=\"text-blue-500 text-2xl\">ğŸ’ª</span>\r\n              <div>\r\n                <h4 className=\"font-medium text-blue-900\">ì¶”ê°€ í•™ìŠµì´ í•„ìš”í•´ìš”</h4>\r\n                <p className=\"text-blue-700 text-sm\">ê¸°ì´ˆë¥¼ ë‹¤ì‹œ í•œë²ˆ ì ê²€í•˜ê³  ê¾¸ì¤€íˆ ë³µìŠµí•˜ë©´ í–¥ìƒë  ê±°ì˜ˆìš”!</p>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* ê°œì„  ì˜ì—­ */}\r\n          {sessionResults.improvementAreas.length > 0 && (\r\n            <div>\r\n              <h4 className=\"font-medium text-gray-900 mb-3\">ğŸ¯ ì§‘ì¤‘ ê°œì„  ì˜ì—­</h4>\r\n              <div className=\"space-y-2\">\r\n                {sessionResults.improvementAreas.map((area, index) => (\r\n                  <div key={index} className=\"flex items-center gap-2 text-sm text-gray-700\">\r\n                    <span className=\"w-1.5 h-1.5 bg-blue-500 rounded-full\"></span>\r\n                    {area}\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* ë‹¤ìŒ ë‹¨ê³„ ì¶”ì²œ */}\r\n        <div className=\"bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-lg p-6 mb-8\">\r\n          <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">ğŸš€ ë‹¤ìŒ ë‹¨ê³„</h3>\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n            <button\r\n              onClick={handleStartReview}\r\n              className=\"p-4 bg-white border border-blue-200 rounded-lg hover:bg-blue-50 transition-colors text-left\"\r\n            >\r\n              <h4 className=\"font-medium text-blue-900 mb-1\">ì¶”ê°€ ë³µìŠµí•˜ê¸°</h4>\r\n              <p className=\"text-sm text-blue-700\">ë” ë§ì€ ë¬¸ì¥ìœ¼ë¡œ ë³µìŠµì„ ì´ì–´ê°€ì„¸ìš”</p>\r\n            </button>\r\n            \r\n            <button\r\n              onClick={handleBackToDashboard}\r\n              className=\"p-4 bg-white border border-purple-200 rounded-lg hover:bg-purple-50 transition-colors text-left\"\r\n            >\r\n              <h4 className=\"font-medium text-purple-900 mb-1\">ë¶„ì„ ë³´ê¸°</h4>\r\n              <p className=\"text-sm text-purple-700\">ìƒì„¸í•œ í•™ìŠµ ë¶„ì„ì„ í™•ì¸í•˜ì„¸ìš”</p>\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* ëŒì•„ê°€ê¸° ë²„íŠ¼ */}\r\n        <div className=\"text-center\">\r\n          <button\r\n            onClick={handleBackToDashboard}\r\n            className=\"px-6 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors\"\r\n          >\r\n            ëŒ€ì‹œë³´ë“œë¡œ ëŒì•„ê°€ê¸°\r\n          </button>\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const renderContent = () => {\r\n    switch (currentView) {\r\n      case 'session':\r\n        return (\r\n          <SmartReviewSession\r\n            userId={userId}\r\n            onComplete={handleSessionComplete}\r\n          />\r\n        );\r\n      \r\n      case 'results':\r\n        return renderSessionResults();\r\n      \r\n      case 'dashboard':\r\n      default:\r\n        return (\r\n          <div>\r\n            {/* ëŒ€ì‹œë³´ë“œ í—¤ë” */}\r\n            <div className=\"max-w-6xl mx-auto p-6\">\r\n              <div className=\"flex justify-between items-center mb-6\">\r\n                <div>\r\n                  <h1 className=\"text-3xl font-bold text-gray-900 mb-2\">ğŸ§  ìŠ¤ë§ˆíŠ¸ ë³µìŠµ</h1>\r\n                  <p className=\"text-gray-600\">AI ê¸°ë°˜ ê°œì¸ ë§ì¶¤ ë³µìŠµ ì‹œìŠ¤í…œ</p>\r\n                </div>\r\n                \r\n                <button\r\n                  onClick={handleStartReview}\r\n                  className=\"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium\"\r\n                >\r\n                  ë³µìŠµ ì‹œì‘í•˜ê¸°\r\n                </button>\r\n              </div>\r\n\r\n              {/* ë¹ ë¥¸ ì‹œì‘ ì¹´ë“œë“¤ */}\r\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\">\r\n                <div \r\n                  onClick={handleStartReview}\r\n                  className=\"bg-gradient-to-br from-blue-500 to-blue-600 text-white p-6 rounded-lg cursor-pointer hover:from-blue-600 hover:to-blue-700 transition-all\"\r\n                >\r\n                  <h3 className=\"text-lg font-semibold mb-2\">ğŸ“š ì˜¤ëŠ˜ì˜ ë³µìŠµ</h3>\r\n                  <p className=\"text-blue-100 text-sm mb-3\">ê°œì¸ ë§ì¶¤ ë³µìŠµ ë¬¸ì¥ìœ¼ë¡œ í•™ìŠµ</p>\r\n                  <div className=\"text-2xl font-bold\">30ê°œ ë¬¸ì¥</div>\r\n                </div>\r\n\r\n                <div className=\"bg-gradient-to-br from-green-500 to-green-600 text-white p-6 rounded-lg\">\r\n                  <h3 className=\"text-lg font-semibold mb-2\">ğŸ¯ ì·¨ì•½ì  ì§‘ì¤‘</h3>\r\n                  <p className=\"text-green-100 text-sm mb-3\">ì–´ë ¤ì› ë˜ ë¬¸ì¥ ìœ„ì£¼ë¡œ ë³µìŠµ</p>\r\n                  <div className=\"text-2xl font-bold\">15ê°œ ë¬¸ì¥</div>\r\n                </div>\r\n\r\n                <div className=\"bg-gradient-to-br from-purple-500 to-purple-600 text-white p-6 rounded-lg\">\r\n                  <h3 className=\"text-lg font-semibold mb-2\">âš¡ ë¹ ë¥¸ ë³µìŠµ</h3>\r\n                  <p className=\"text-purple-100 text-sm mb-3\">5ë¶„ ì•ˆì— ë¹ ë¥´ê²Œ ë³µìŠµ</p>\r\n                  <div className=\"text-2xl font-bold\">10ê°œ ë¬¸ì¥</div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* ë¶„ì„ ëŒ€ì‹œë³´ë“œ */}\r\n            <ReviewAnalyticsDashboard userId={userId} />\r\n          </div>\r\n        );\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50\">\r\n      {renderContent()}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SmartReviewPage;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\pages\\SpeedModePage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\pages\\StageFocusPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\pages\\StudyPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SpeechRecorder' is defined but never used. Allowed unused vars must match /^_/u.","line":4,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SpeakingStageSelector' is defined but never used. Allowed unused vars must match /^_/u.","line":5,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":31},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SpeakingFlowController' is defined but never used. Allowed unused vars must match /^_/u.","line":6,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":32},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useSRSEngine' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":22},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'DrillCard' is defined but never used. Allowed unused vars must match /^_/u.","line":17,"column":15,"nodeType":null,"messageId":"unusedVar","endLine":17,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'FeedbackResponse' is defined but never used. Allowed unused vars must match /^_/u.","line":17,"column":26,"nodeType":null,"messageId":"unusedVar","endLine":17,"endColumn":42},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'sessionStartTime' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":39,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":39,"endColumn":26},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'speakingFlowState' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":46,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":46,"endColumn":27},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'sessionConfig' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":53,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":53,"endColumn":22},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'autoNextTimeoutId', 'setError', and 'user'. Either include them or remove the dependency array.","line":140,"column":6,"nodeType":"ArrayExpression","endLine":140,"endColumn":43,"suggestions":[{"desc":"Update the dependencies array to be: [autoNextTimeoutId, loadCards, resetStudyState, setError, user, user.id]","fix":{"range":[5652,5689],"text":"[autoNextTimeoutId, loadCards, resetStudyState, setError, user, user.id]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'startSession'. Either include it or remove the dependency array.","line":147,"column":6,"nodeType":"ArrayExpression","endLine":147,"endColumn":55,"suggestions":[{"desc":"Update the dependencies array to be: [study.cards, isSessionActive, isTrainingRunning, startSession]","fix":{"range":[5916,5965],"text":"[study.cards, isSessionActive, isTrainingRunning, startSession]"}}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":173,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":173,"endColumn":19},{"ruleId":"no-undef","severity":1,"message":"'srsService' is not defined.","line":285,"column":17,"nodeType":"Identifier","messageId":"undef","endLine":285,"endColumn":27},{"ruleId":"no-undef","severity":1,"message":"'srsService' is not defined.","line":423,"column":15,"nodeType":"Identifier","messageId":"undef","endLine":423,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":431,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":431,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":563,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":563,"endColumn":19},{"ruleId":"no-undef","severity":1,"message":"'PatternTrainingFlowFinal' is not defined.","line":709,"column":16,"nodeType":"JSXIdentifier","messageId":"undef","endLine":709,"endColumn":40}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":17,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback, useMemo, memo } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useAppStore, useUser, useStudy, useUI, useLearningMode, useSpeakingStage } from '@/store/useAppStore';\r\nimport { SpeechRecorder } from '@/components/SpeechRecorder';\r\nimport { SpeakingStageSelector } from '@/components/SpeakingStageSelector';\r\nimport { SpeakingFlowController } from '@/components/SpeakingFlowController';\r\n// import { PatternTrainingFlow } from '@/components/PatternTrainingFlow';\\n// TODO: Migrate to new modularized PatternTrainingPageV3 system\\nimport { PatternTrainingFlowFinal } from '@/components/PatternTrainingFlowFinal';\r\nimport { FeedbackPanel } from '@/components/FeedbackPanel';\r\nimport { WritingModeInput } from '@/components/WritingModeInput';\r\nimport { WritingModeFeedback } from '@/components/WritingModeFeedback';\r\nimport { useSpeech } from '@/hooks/useSpeech';\r\nimport { api } from '@/lib/api';\r\n// import { srsService } from '@/services/srsService';\r\n// TODO: Migrate to new SRS Engine system\r\nimport { useSRSEngine } from '@/hooks/useSRSEngine';\r\nimport { useAuthService } from '@/services/authService';\r\nimport type { DrillCard, FeedbackResponse } from '@/types';\r\nimport type { WritingFeedback } from '@/services/writingMode';\r\n\r\nexport const StudyPage: React.FC = memo(() => {\r\n  const navigate = useNavigate();\r\n  const user = useUser();\r\n  const study = useStudy();\r\n  const ui = useUI();\r\n  const learningMode = useLearningMode();\r\n  const speakingStage = useSpeakingStage();\r\n  \r\n  const {\r\n    setCurrentCard,\r\n    setCards,\r\n    setFeedback,\r\n    setCurrentSession,\r\n    resetStudyState,\r\n    setLoading,\r\n    setError,\r\n    clearError,\r\n  } = useAppStore();\r\n\r\n  const [sessionStartTime, setSessionStartTime] = useState<number>(0);\r\n  const [cardStartTime, setCardStartTime] = useState<number>(0);\r\n  const [isSessionActive, setIsSessionActive] = useState(false);\r\n  const [writingFeedback, setWritingFeedback] = useState<WritingFeedback | null>(null);\r\n  const [writingInputValue, setWritingInputValue] = useState<string>('');\r\n  const [autoNextTimeoutId, setAutoNextTimeoutId] = useState<NodeJS.Timeout | null>(null);\r\n  const [autoNextCountdown, setAutoNextCountdown] = useState<number>(0);\r\n  const [speakingFlowState, setSpeakingFlowState] = useState<'idle' | 'tts' | 'beep' | 'waiting' | 'recording'>('idle');\r\n  const [isTrainingRunning, setIsTrainingRunning] = useState(false);\r\n  const [isTrainingPaused, setIsTrainingPaused] = useState(false);\r\n\r\n  const { handleStudyComplete, isAuthenticated } = useAuthService();\r\n  \r\n  // Memoize expensive calculations\r\n  const sessionConfig = useMemo(() => ({\r\n    level: user.level,\r\n    stage: user.stage,\r\n    mode: learningMode.mode\r\n  }), [user.level, user.stage, learningMode.mode]);\r\n  \r\n  const speech = useSpeech({\r\n    apiBaseUrl: import.meta.env.VITE_API_BASE_URL,\r\n    preferCloudSTT: false,\r\n    language: 'en-US',\r\n  });\r\n\r\n  const loadCards = useCallback(async () => {\r\n    setLoading(true);\r\n    clearError();\r\n    \r\n    try {\r\n      console.log(`ğŸ”„ ì¹´ë“œ ë¡œë”© ì‹œì‘: Level ${user.level}, Stage ${user.stage}`);\r\n      \r\n      let response;\r\n      if (user.stage === 'ALL') {\r\n        console.log(`ğŸ”„ ALL ëª¨ë“œë¡œ ì¹´ë“œ ë¡œë”©: Level ${user.level}`);\r\n        response = await api.getAllLevelCards(user.level);\r\n      } else {\r\n        response = await api.getCards(user.level, user.stage);\r\n      }\r\n      \r\n      // ğŸ“‹ ìƒì„¸í•œ API ì‘ë‹µ êµ¬ì¡° ë¡œê¹…\r\n      console.log('ğŸ“¥ API ì‘ë‹µ ì „ì²´:', JSON.stringify(response, null, 2));\r\n      console.log('ğŸ“¥ response.success:', response.success);\r\n      console.log('ğŸ“¥ response.data:', response.data);\r\n      console.log('ğŸ“¥ response.data?.cards:', response.data?.cards);\r\n      console.log('ğŸ“¥ response.data?.cards íƒ€ì…:', typeof response.data?.cards);\r\n      console.log('ğŸ“¥ response.data?.cards Array.isArray:', Array.isArray(response.data?.cards));\r\n      \r\n      if (response.success && response.data) {\r\n        // âœ… ì´ì¤‘ ë˜í•‘ëœ êµ¬ì¡°ì—ì„œ ì¹´ë“œ ë°ì´í„° ì ‘ê·¼\r\n        const cards = response.data.data?.cards;\r\n        \r\n        if (Array.isArray(cards)) {\r\n          console.log(`âœ… ì¹´ë“œ ë¡œë”© ì„±ê³µ: ${cards.length}ê°œ`);\r\n          setCards(cards);\r\n          \r\n          if (cards.length > 0) {\r\n            setCurrentCard(cards[0], 0);\r\n            setCardStartTime(Date.now());\r\n            // ìƒˆ ì„¸ì…˜ ì‹œì‘ ì‹œ ì…ë ¥ê°’ í´ë¦¬ì–´\r\n            setWritingInputValue('');\r\n          } else {\r\n            console.warn('âš ï¸ ì¹´ë“œ ë°°ì—´ì´ ë¹„ì–´ìˆìŒ');\r\n            setError('ì´ ë ˆë²¨/ìŠ¤í…Œì´ì§€ì— ì¹´ë“œê°€ ì—†ìŠµë‹ˆë‹¤');\r\n          }\r\n        } else {\r\n          console.error('âŒ response.data.cardsê°€ ë°°ì—´ì´ ì•„ë‹˜:', cards);\r\n          setError('ì¹´ë“œ ë°ì´í„° í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤');\r\n        }\r\n      } else {\r\n        console.error('âŒ API ì‘ë‹µ ì‹¤íŒ¨:');\r\n        console.error('  - response.success:', response.success);\r\n        console.error('  - response.error:', response.error);\r\n        console.error('  - response.data:', response.data);\r\n        setError(response.error || 'ì¹´ë“œë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');\r\n      }\r\n    } catch (error) {\r\n      console.error('âŒ ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜:', error);\r\n      setError('ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [user.level, user.stage, setLoading, clearError, setCards, setCurrentCard, setError]);\r\n\r\n  // Load cards when component mounts\r\n  useEffect(() => {\r\n    console.log('ğŸ StudyPage ë§ˆìš´íŠ¸, ì‚¬ìš©ì ìƒíƒœ:', user);\r\n    if (user.id) {\r\n      loadCards();\r\n    } else {\r\n      console.warn('âš ï¸ ì‚¬ìš©ì IDê°€ ì—†ì–´ ì¹´ë“œ ë¡œë”©ì„ ê±´ë„ˆëœ€');\r\n      setError('ì‚¬ìš©ì ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.');\r\n    }\r\n    return () => {\r\n      // Cleanup on unmount\r\n      if (autoNextTimeoutId) {\r\n        clearTimeout(autoNextTimeoutId);\r\n      }\r\n      resetStudyState();\r\n    };\r\n  }, [loadCards, resetStudyState, user.id]);\r\n\r\n  // Start session when cards are loaded and training is running\r\n  useEffect(() => {\r\n    if (study.cards?.length && study.cards.length > 0 && !isSessionActive && isTrainingRunning) {\r\n      startSession();\r\n    }\r\n  }, [study.cards, isSessionActive, isTrainingRunning]);\r\n\r\n  const startSession = async () => {\r\n    if (!user.id || !study.cards?.length || study.cards.length === 0) return;\r\n\r\n    try {\r\n      const cardIds = study.cards.map(card => card.id);\r\n      const response = await api.startSession({\r\n        userId: user.id,\r\n        level: user.level,\r\n        stage: user.stage,\r\n        cardIds,\r\n      });\r\n\r\n      if (response.success && response.data) {\r\n        setCurrentSession({\r\n          id: response.data.sessionId,\r\n          userId: user.id,\r\n          level: user.level,\r\n          stage: user.stage,\r\n          startedAt: new Date(),\r\n          items: [],\r\n        });\r\n        setIsSessionActive(true);\r\n        setSessionStartTime(Date.now());\r\n      }\r\n    } catch (error) {\r\n      setError('ì„¸ì…˜ ì‹œì‘ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');\r\n    }\r\n  };\r\n\r\n  // Pattern Training Flow Result Handler with Firebase integration\r\n  const handlePatternTrainingResult = async (userAnswer: string, isCorrect: boolean, confidence: number, responseTime?: number) => {\r\n    console.log('ğŸ¯ StudyPage: handlePatternTrainingResult í˜¸ì¶œë¨', { userAnswer, isCorrect, confidence, responseTime });\r\n    \r\n    // Calculate score based on correctness and confidence\r\n    const score = isCorrect ? Math.max(70, Math.round(confidence * 100)) : 0;\r\n    \r\n    // Firebase ì§„í–‰ë„ ì—…ë°ì´íŠ¸ (ì¸ì¦ëœ ì‚¬ìš©ìë§Œ)\r\n    if (isAuthenticated && responseTime) {\r\n      console.log('[DEBUG] ğŸ”¥ Firebase ì§„í–‰ë„ ì—…ë°ì´íŠ¸ ì‹œì‘');\r\n      \r\n      const completionData = {\r\n        level: user.level,\r\n        stage: user.stage,\r\n        score: score,\r\n        timeSpent: responseTime,\r\n        mistakes: isCorrect ? 0 : 1\r\n      };\r\n      \r\n      // ë°±ê·¸ë¼ìš´ë“œì—ì„œ Firebase ì—…ë°ì´íŠ¸ (ê¸°ì¡´ ë¡œì§ì— ì˜í–¥ ì£¼ì§€ ì•ŠìŒ)\r\n      handleStudyComplete(completionData).then(success => {\r\n        if (success) {\r\n          console.log('[DEBUG] âœ… Firebase ì§„í–‰ë„ ì—…ë°ì´íŠ¸ ì„±ê³µ');\r\n        } else {\r\n          console.log('[DEBUG] âŒ Firebase ì§„í–‰ë„ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨');\r\n        }\r\n      }).catch(error => {\r\n        console.error('[DEBUG] âŒ Firebase ì§„í–‰ë„ ì—…ë°ì´íŠ¸ ì—ëŸ¬:', error);\r\n      });\r\n    } else {\r\n      console.log('[DEBUG] âš ï¸ Firebase ì—…ë°ì´íŠ¸ ìŠ¤í‚µ:', { \r\n        isAuthenticated, \r\n        hasResponseTime: !!responseTime \r\n      });\r\n    }\r\n    \r\n    // ê¸°ì¡´ ë¡œì§ ìœ ì§€\r\n    await handleSpeechResult(userAnswer, confidence);\r\n  };\r\n\r\n  const handleSpeechResult = async (transcript: string, confidence: number) => {\r\n    console.log('ğŸ¯ StudyPage: handleSpeechResult í˜¸ì¶œë¨', { transcript, confidence });\r\n    console.log('ğŸ¯ StudyPage: currentCard:', study.currentCard);\r\n    console.log('ğŸ¯ StudyPage: currentSession:', study.currentSession);\r\n    \r\n    if (!study.currentCard) {\r\n      console.error('âŒ StudyPage: currentCardê°€ ì—†ìŒ');\r\n      return;\r\n    }\r\n    \r\n    // ì„¸ì…˜ì´ ì—†ìœ¼ë©´ ìë™ìœ¼ë¡œ ìƒì„± ì‹œë„\r\n    if (!study.currentSession && user.id) {\r\n      console.log('ğŸ”„ StudyPage: ì„¸ì…˜ì´ ì—†ì–´ì„œ ìë™ìœ¼ë¡œ ì„¸ì…˜ ì‹œì‘ ì‹œë„');\r\n      try {\r\n        await startSession();\r\n      } catch (error) {\r\n        console.error('âŒ ì„¸ì…˜ ì‹œì‘ ì‹¤íŒ¨:', error);\r\n      }\r\n    }\r\n\r\n    const responseTime = Date.now() - cardStartTime;\r\n    console.log('ğŸ• StudyPage: responseTime:', responseTime);\r\n    setLoading(true);\r\n\r\n    // ë¹ˆ transcriptì¸ ê²½ìš° ê¸°ë³¸ê°’ìœ¼ë¡œ ì²˜ë¦¬\r\n    const processedTranscript = transcript.trim() || '[ìŒì„± ì¸ì‹ ì‹¤íŒ¨]';\r\n    \r\n    try {\r\n      \r\n      // Get rule-based feedback\r\n      const feedbackResponse = await api.getFeedback({\r\n        front_ko: study.currentCard.front_ko,\r\n        sttText: processedTranscript,\r\n        target_en: study.currentCard.target_en,\r\n      });\r\n\r\n      console.log('ğŸ“ StudyPage: feedbackResponse:', feedbackResponse);\r\n      \r\n      if (feedbackResponse.success && feedbackResponse.data) {\r\n        const feedback = feedbackResponse.data;\r\n        console.log('âœ… StudyPage: í”¼ë“œë°± ì„¤ì •:', feedback);\r\n        setFeedback(feedback);\r\n\r\n        // Submit answer to session (ì„¸ì…˜ì´ ìˆëŠ” ê²½ìš°ì—ë§Œ)\r\n        if (study.currentSession?.id) {\r\n          await api.submitAnswer({\r\n            sessionId: study.currentSession.id,\r\n            cardId: study.currentCard.id,\r\n            userAnswer: transcript,\r\n            isCorrect: feedback.correct,\r\n            score: feedback.score,\r\n            timeSpent: Math.round(responseTime / 1000),\r\n          });\r\n        } else {\r\n          console.log('âš ï¸ StudyPage: ì„¸ì…˜ì´ ì—†ì–´ì„œ ë‹µë³€ ì œì¶œ ê±´ë„ˆëœ€');\r\n        }\r\n\r\n        // Play correct answer if TTS is available and answer was incorrect\r\n        // Speaking ëª¨ë“œì—ì„œëŠ” ìë™ í”Œë¡œìš°ê°€ TTSë¥¼ ë‹´ë‹¹í•˜ë¯€ë¡œ ì—¬ê¸°ì„œëŠ” ì¬ìƒí•˜ì§€ ì•ŠìŒ\r\n        if (speech.isTTSAvailable && !feedback.correct && learningMode.mode !== 'speaking') {\r\n          setTimeout(() => {\r\n            speech.speak(study.currentCard!.target_en);\r\n          }, 1500);\r\n        }\r\n\r\n        // SRS ì‹œìŠ¤í…œì— ì¹´ë“œ ì¶”ê°€ (ì²« í•™ìŠµ ì‹œ)\r\n        try {\r\n          await srsService.addCardToSRS(user.id, study.currentCard.id, {\r\n            level: user.level,\r\n            stage: user.stage,\r\n            difficulty: 'medium'\r\n          });\r\n        } catch (error) {\r\n          console.error('SRS ì¹´ë“œ ì¶”ê°€ ì‹¤íŒ¨:', error);\r\n        }\r\n        \r\n        // Speaking ëª¨ë“œì—ì„œ ìë™ìœ¼ë¡œ 4ì´ˆ í›„ ë‹¤ìŒ ì¹´ë“œë¡œ ì§„í–‰ (HTML ë²„ì „ê³¼ ë™ì¼)\r\n        console.log('ğŸ¯ StudyPage: learningMode:', learningMode);\r\n        if (learningMode.mode === 'speaking') {\r\n          console.log('ğŸ¤ StudyPage: Speaking ëª¨ë“œ - 4ì´ˆ í›„ ìë™ ì§„í–‰ ì„¤ì •');\r\n          const timeout = setTimeout(() => {\r\n            console.log('â° StudyPage: 4ì´ˆ í›„ ë‹¤ìŒ ì¹´ë“œ ì´ë™');\r\n            handleNextCard();\r\n          }, 4000); // HTML ë²„ì „ê³¼ ë™ì¼í•˜ê²Œ 4ì´ˆë¡œ ë³€ê²½\r\n          setAutoNextTimeoutId(timeout);\r\n          setAutoNextCountdown(4); // 4ì´ˆë¡œ ë³€ê²½\r\n          \r\n          // ì¹´ìš´íŠ¸ë‹¤ìš´ íƒ€ì´ë¨¸\r\n          const countdownInterval = setInterval(() => {\r\n            setAutoNextCountdown(prev => {\r\n              if (prev <= 1) {\r\n                clearInterval(countdownInterval);\r\n                return 0;\r\n              }\r\n              return prev - 1;\r\n            });\r\n          }, 1000);\r\n        }\r\n      } else {\r\n        console.error('âŒ StudyPage: í”¼ë“œë°± ì‹¤íŒ¨:', feedbackResponse.error);\r\n        \r\n        // í”¼ë“œë°± ì‹¤íŒ¨ ì‹œì—ë„ ê¸°ë³¸ í”¼ë“œë°± ìƒì„±í•˜ì—¬ ì§„í–‰\r\n        const fallbackFeedback = {\r\n          correct: false,\r\n          score: 0,\r\n          message: 'ìŒì„± ì¸ì‹ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ìŒ ë¬¸ì œë¡œ ë„˜ì–´ê°‘ë‹ˆë‹¤.',\r\n          userAnswer: processedTranscript,\r\n          correctAnswer: study.currentCard.target_en,\r\n          feedback: 'ìŒì„±ì„ ë‹¤ì‹œ í•œ ë²ˆ ëª…í™•í•˜ê²Œ ë§í•´ì£¼ì„¸ìš”.'\r\n        };\r\n        \r\n        console.log('ğŸ”„ StudyPage: ê¸°ë³¸ í”¼ë“œë°±ìœ¼ë¡œ ì§„í–‰:', fallbackFeedback);\r\n        setFeedback(fallbackFeedback);\r\n        \r\n        // Speaking ëª¨ë“œì—ì„œ ìë™ìœ¼ë¡œ 4ì´ˆ í›„ ë‹¤ìŒ ì¹´ë“œë¡œ ì§„í–‰ (HTML ë²„ì „ê³¼ ë™ì¼)\r\n        console.log('ğŸ¯ StudyPage: learningMode:', learningMode);\r\n        if (learningMode.mode === 'speaking') {\r\n          console.log('ğŸ¤ StudyPage: Speaking ëª¨ë“œ - 4ì´ˆ í›„ ìë™ ì§„í–‰ ì„¤ì •');\r\n          const timeout = setTimeout(() => {\r\n            console.log('â° StudyPage: 4ì´ˆ í›„ ë‹¤ìŒ ì¹´ë“œ ì´ë™');\r\n            handleNextCard();\r\n          }, 4000);\r\n          setAutoNextTimeoutId(timeout);\r\n          setAutoNextCountdown(4);\r\n          \r\n          // ì¹´ìš´íŠ¸ë‹¤ìš´ íƒ€ì´ë¨¸\r\n          const countdownInterval = setInterval(() => {\r\n            setAutoNextCountdown(prev => {\r\n              if (prev <= 1) {\r\n                clearInterval(countdownInterval);\r\n                return 0;\r\n              }\r\n              return prev - 1;\r\n            });\r\n          }, 1000);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('âŒ StudyPage: í”¼ë“œë°± ì²˜ë¦¬ ì˜¤ë¥˜:', error);\r\n      \r\n      // ì˜¤ë¥˜ ë°œìƒ ì‹œì—ë„ ê¸°ë³¸ í”¼ë“œë°± ìƒì„±í•˜ì—¬ ì§„í–‰\r\n      const errorFeedback = {\r\n        correct: false,\r\n        score: 0,\r\n        message: 'ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ìŒ ë¬¸ì œë¡œ ë„˜ì–´ê°‘ë‹ˆë‹¤.',\r\n        userAnswer: processedTranscript || '[ì²˜ë¦¬ ì˜¤ë¥˜]',\r\n        correctAnswer: study.currentCard.target_en,\r\n        feedback: 'ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.'\r\n      };\r\n      \r\n      console.log('ğŸ”„ StudyPage: ì˜¤ë¥˜ ì‹œ ê¸°ë³¸ í”¼ë“œë°±ìœ¼ë¡œ ì§„í–‰:', errorFeedback);\r\n      setFeedback(errorFeedback);\r\n      \r\n      // Speaking ëª¨ë“œì—ì„œ ìë™ìœ¼ë¡œ 4ì´ˆ í›„ ë‹¤ìŒ ì¹´ë“œë¡œ ì§„í–‰\r\n      if (learningMode.mode === 'speaking') {\r\n        console.log('ğŸ¤ StudyPage: ì˜¤ë¥˜ ì‹œì—ë„ Speaking ëª¨ë“œ - 4ì´ˆ í›„ ìë™ ì§„í–‰');\r\n        const timeout = setTimeout(() => {\r\n          console.log('â° StudyPage: ì˜¤ë¥˜ ì²˜ë¦¬ í›„ 4ì´ˆ í›„ ë‹¤ìŒ ì¹´ë“œ ì´ë™');\r\n          handleNextCard();\r\n        }, 4000);\r\n        setAutoNextTimeoutId(timeout);\r\n        setAutoNextCountdown(4);\r\n        \r\n        // ì¹´ìš´íŠ¸ë‹¤ìš´ íƒ€ì´ë¨¸\r\n        const countdownInterval = setInterval(() => {\r\n          setAutoNextCountdown(prev => {\r\n            if (prev <= 1) {\r\n              clearInterval(countdownInterval);\r\n              return 0;\r\n            }\r\n            return prev - 1;\r\n          });\r\n        }, 1000);\r\n      }\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleWritingSubmit = async (userInput: string, feedback: WritingFeedback) => {\r\n    if (!study.currentCard || !study.currentSession) return;\r\n\r\n    setWritingFeedback(feedback);\r\n    setLoading(true);\r\n\r\n    try {\r\n      // Submit answer to session\r\n      await api.submitAnswer({\r\n        sessionId: study.currentSession.id!,\r\n        cardId: study.currentCard.id,\r\n        userAnswer: userInput,\r\n        isCorrect: feedback.isCorrect,\r\n        score: feedback.score,\r\n        timeSpent: Math.round((Date.now() - cardStartTime) / 1000),\r\n      });\r\n\r\n      // Play correct answer if available\r\n      if (speech.isTTSAvailable) {\r\n        setTimeout(() => {\r\n          speech.speak(study.currentCard!.target_en);\r\n        }, 1000);\r\n      }\r\n\r\n      // SRS ì‹œìŠ¤í…œì— ì¹´ë“œ ì¶”ê°€ (Writing ëª¨ë“œ)\r\n      try {\r\n        await srsService.addCardToSRS(user.id, study.currentCard.id, {\r\n          level: user.level,\r\n          stage: user.stage,\r\n          difficulty: 'medium'\r\n        });\r\n      } catch (error) {\r\n        console.error('SRS ì¹´ë“œ ì¶”ê°€ ì‹¤íŒ¨:', error);\r\n      }\r\n    } catch (error) {\r\n      setError('ë‹µë³€ ì œì¶œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleStartTraining = () => {\r\n    console.log('ğŸš€ Training ì‹œì‘');\r\n    setIsTrainingRunning(true);\r\n    setIsTrainingPaused(false);\r\n  };\r\n\r\n  const handlePauseTraining = () => {\r\n    console.log('â¸ï¸ Training ì¼ì‹œì •ì§€');\r\n    setIsTrainingPaused(true);\r\n    \r\n    // ìë™ ì§„í–‰ íƒ€ì´ë¨¸ ì¤‘ì§€\r\n    if (autoNextTimeoutId) {\r\n      clearTimeout(autoNextTimeoutId);\r\n      setAutoNextTimeoutId(null);\r\n    }\r\n    \r\n    // PatternTrainingFlowì— ì¼ì‹œì •ì§€ ì‹ í˜¸ ì „ë‹¬ (disabled propì„ í†µí•´)\r\n    // ì‹¤ì œë¡œëŠ” disabled propì´ trueê°€ ë˜ì–´ PatternTrainingFlowê°€ ì¼ì‹œì •ì§€ë¨\r\n  };\r\n\r\n  const handleResumeTraining = () => {\r\n    console.log('â–¶ï¸ Training ì¬ê°œ');\r\n    setIsTrainingPaused(false);\r\n    \r\n    // PatternTrainingFlowê°€ ìë™ìœ¼ë¡œ ì¬ê°œë¨ (disabledê°€ falseê°€ ë˜ê³  autoStartê°€ trueì´ë¯€ë¡œ)\r\n  };\r\n\r\n  const handleResetTraining = () => {\r\n    console.log('ğŸ”„ Training ì¬ì‹œì‘');\r\n    setIsTrainingRunning(false);\r\n    setIsTrainingPaused(false);\r\n    setFeedback(null);\r\n    setWritingFeedback(null);\r\n    \r\n    // ìë™ ì§„í–‰ íƒ€ì´ë¨¸ ì¤‘ì§€\r\n    if (autoNextTimeoutId) {\r\n      clearTimeout(autoNextTimeoutId);\r\n      setAutoNextTimeoutId(null);\r\n    }\r\n    \r\n    // ì²« ë²ˆì§¸ ì¹´ë“œë¡œ ëŒì•„ê°€ê¸°\r\n    if (study.cards?.length && study.cards.length > 0) {\r\n      setCurrentCard(study.cards[0], 0);\r\n      setCardStartTime(Date.now());\r\n      setWritingInputValue('');\r\n    }\r\n  };\r\n\r\n  const handleNextCard = () => {\r\n    console.log('ğŸ”„ StudyPage: handleNextCard í˜¸ì¶œë¨');\r\n    \r\n    // ìë™ ì§„í–‰ íƒ€ì´ë¨¸ê°€ ìˆë‹¤ë©´ í´ë¦¬ì–´\r\n    if (autoNextTimeoutId) {\r\n      clearTimeout(autoNextTimeoutId);\r\n      setAutoNextTimeoutId(null);\r\n    }\r\n\r\n    const nextIndex = study.currentIndex + 1;\r\n    \r\n    if (study.cards?.length && nextIndex < study.cards.length) {\r\n      console.log(`ğŸ”„ StudyPage: ë‹¤ìŒ ì¹´ë“œë¡œ ì´ë™ (${nextIndex + 1}/${study.cards.length})`);\r\n      \r\n      // ë‹¤ìŒ ì¹´ë“œë¡œ ìë™ ì§„í–‰\r\n      setCurrentCard(study.cards[nextIndex], nextIndex);\r\n      setCardStartTime(Date.now());\r\n      setFeedback(null);\r\n      setWritingFeedback(null);\r\n      \r\n      // Speaking ëª¨ë“œ ìƒíƒœ ì´ˆê¸°í™”\r\n      setSpeakingFlowState('idle');\r\n      setAutoNextCountdown(0);\r\n      \r\n      // ì…ë ¥ê°’ ìë™ í´ë¦¬ì–´\r\n      setWritingInputValue('');\r\n      \r\n      // ìŒì„± ì¸ì‹ì´ ì§„í–‰ ì¤‘ì´ë¼ë©´ ì¤‘ì§€\r\n      if (speech.isRecording) {\r\n        speech.stopRecording();\r\n      }\r\n    } else {\r\n      // ë§ˆì§€ë§‰ ì¹´ë“œì¸ ê²½ìš° ì„¸ì…˜ ì™„ë£Œ\r\n      console.log('ğŸ StudyPage: ë§ˆì§€ë§‰ ì¹´ë“œ ë„ë‹¬, ì„¸ì…˜ ì™„ë£Œ');\r\n      finishSession();\r\n    }\r\n  };\r\n\r\n  const handlePreviousCard = () => {\r\n    // ìë™ ì§„í–‰ íƒ€ì´ë¨¸ê°€ ìˆë‹¤ë©´ í´ë¦¬ì–´\r\n    if (autoNextTimeoutId) {\r\n      clearTimeout(autoNextTimeoutId);\r\n      setAutoNextTimeoutId(null);\r\n    }\r\n\r\n    const prevIndex = study.currentIndex - 1;\r\n    \r\n    if (study.cards?.length && prevIndex >= 0) {\r\n      setCurrentCard(study.cards[prevIndex], prevIndex);\r\n      setCardStartTime(Date.now());\r\n      setFeedback(null);\r\n      setWritingFeedback(null);\r\n      // ì…ë ¥ê°’ ìë™ í´ë¦¬ì–´\r\n      setWritingInputValue('');\r\n    }\r\n  };\r\n\r\n  const finishSession = async () => {\r\n    if (!study.currentSession) return;\r\n\r\n    setLoading(true);\r\n    \r\n    try {\r\n      const response = await api.finishSession(study.currentSession.id!);\r\n      \r\n      if (response.success) {\r\n        // Navigate to results page with session summary\r\n        navigate('/result', { \r\n          state: { \r\n            summary: response.data?.summary,\r\n            level: user.level,\r\n            stage: user.stage,\r\n          }\r\n        });\r\n      } else {\r\n        setError(response.error || 'ì„¸ì…˜ ì¢…ë£Œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');\r\n      }\r\n    } catch (error) {\r\n      setError('ì„¸ì…˜ ì¢…ë£Œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  if (ui.isLoading && !study.currentCard) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4\"></div>\r\n          <p className=\"text-gray-600\">ë¡œë”© ì¤‘...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (ui.error) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center p-4\">\r\n        <div className=\"max-w-md w-full bg-red-50 border border-red-200 rounded-lg p-6 text-center\">\r\n          <div className=\"text-red-500 text-4xl mb-4\">âš ï¸</div>\r\n          <h2 className=\"text-lg font-semibold text-red-800 mb-2\">ì˜¤ë¥˜ ë°œìƒ</h2>\r\n          <p className=\"text-red-600 mb-4\">{ui.error}</p>\r\n          <div className=\"space-x-2\">\r\n            <button\r\n              onClick={loadCards}\r\n              className=\"px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600\"\r\n            >\r\n              ë‹¤ì‹œ ì‹œë„\r\n            </button>\r\n            <button\r\n              onClick={() => navigate('/')}\r\n              className=\"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600\"\r\n            >\r\n              ëŒì•„ê°€ê¸°\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!study.currentCard) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center p-4\">\r\n        <div className=\"text-center\">\r\n          <p className=\"text-gray-600 mb-4\">í•™ìŠµí•  ì¹´ë“œê°€ ì—†ìŠµë‹ˆë‹¤</p>\r\n          <button\r\n            onClick={() => navigate('/')}\r\n            className=\"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600\"\r\n          >\r\n            í™ˆìœ¼ë¡œ ëŒì•„ê°€ê¸°\r\n          </button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50\">\r\n      {/* Header */}\r\n      <div className=\"bg-white shadow-sm border-b\">\r\n        <div className=\"max-w-2xl mx-auto px-4 py-3\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <button\r\n              onClick={() => navigate('/')}\r\n              className=\"text-gray-600 hover:text-gray-800\"\r\n            >\r\n              â† ë’¤ë¡œ\r\n            </button>\r\n            <div className=\"text-center\">\r\n              <h1 className=\"text-lg font-semibold\">\r\n                Level {user.level}.{user.stage}\r\n              </h1>\r\n            </div>\r\n            <div className=\"text-sm text-gray-500\">\r\n              {study.currentIndex + 1}/{study.cards?.length || 0}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Progress Bar */}\r\n      <div className=\"bg-white border-b\">\r\n        <div className=\"max-w-2xl mx-auto px-4 py-2\">\r\n          <div className=\"bg-gray-200 rounded-full h-2\">\r\n            <div \r\n              className=\"bg-blue-500 h-2 rounded-full transition-all duration-300\"\r\n              style={{ \r\n                width: `${study.cards?.length ? ((study.currentIndex + 1) / study.cards.length) * 100 : 0}%`\r\n              }}\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Main Content */}\r\n      <div className=\"max-w-2xl mx-auto px-4 py-8\">\r\n        {/* Korean Prompt Card - Only show in Writing mode */}\r\n        {learningMode.mode === 'writing' && (\r\n          <div className=\"bg-white rounded-lg shadow-lg p-8 mb-8\">\r\n            <div className=\"text-center\">\r\n              <h2 className=\"text-sm font-medium text-gray-500 mb-2\">í•œêµ­ì–´ë¥¼ ì˜ì–´ë¡œ</h2>\r\n              <p className=\"text-2xl font-bold text-gray-800 mb-6\">\r\n                {study.currentCard.front_ko}\r\n              </p>\r\n              \r\n              {/* Expected Answer (shown after feedback) */}\r\n              {study.feedback && (\r\n                <div className=\"text-sm text-gray-600 bg-gray-50 rounded p-3\">\r\n                  <span className=\"font-medium\">ì •ë‹µ: </span>\r\n                  {study.currentCard.target_en}\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n\r\n\r\n        {/* Input Section - Conditional Rendering Based on Learning Mode */}\r\n        <div className=\"mb-8\">\r\n          {learningMode.mode === 'writing' ? (\r\n            <div className=\"bg-white rounded-lg shadow-lg p-8\">\r\n              <div className=\"text-center\">\r\n                <WritingModeInput\r\n                  question={{\r\n                    id: study.currentCard.id,\r\n                    front_ko: study.currentCard.front_ko,\r\n                    target_en: study.currentCard.target_en,\r\n                    level: user.level,\r\n                    stage: user.stage,\r\n                    difficulty: 'medium'\r\n                  }}\r\n                  value={writingInputValue}\r\n                  onInputChange={setWritingInputValue}\r\n                  onSubmit={handleWritingSubmit}\r\n                  onAutoNext={handleNextCard}\r\n                  disabled={ui.isLoading || !!writingFeedback}\r\n                />\r\n              </div>\r\n            </div>\r\n          ) : (\r\n            <div className=\"bg-white rounded-lg shadow-lg p-8\">\r\n              <PatternTrainingFlowFinal\r\n                koreanText={study.currentCard.front_ko}\r\n                expectedEnglish={study.currentCard.target_en}\r\n                onResult={handlePatternTrainingResult}\r\n                onError={(error) => setError(error)}\r\n                stage={speakingStage.stage}\r\n                disabled={ui.isLoading || !!study.feedback || !isTrainingRunning || isTrainingPaused}\r\n                autoStart={isTrainingRunning && !isTrainingPaused && !study.feedback}\r\n                className=\"text-center\"\r\n                showCorrectAnswer={true}\r\n                mistakeId={undefined}\r\n              />\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Feedback Section - Conditional Rendering Based on Learning Mode */}\r\n        {learningMode.mode === 'writing' && writingFeedback && (\r\n          <WritingModeFeedback\r\n            feedback={writingFeedback}\r\n            targetAnswer={study.currentCard.target_en}\r\n            onPlayAnswer={() => speech.speak(study.currentCard!.target_en)}\r\n            canPlayAnswer={speech.isTTSAvailable}\r\n          />\r\n        )}\r\n\r\n        {learningMode.mode === 'speaking' && study.feedback && (\r\n          <>\r\n            <FeedbackPanel\r\n              feedback={study.feedback}\r\n              onPlayAnswer={() => speech.speak(study.currentCard!.target_en)}\r\n              canPlayAnswer={speech.isTTSAvailable}\r\n            />\r\n            \r\n            {/* ìë™ ì§„í–‰ ì•ˆë‚´ */}\r\n            {autoNextCountdown > 0 && (\r\n              <div className=\"bg-green-50 border border-green-200 rounded-lg p-4 text-center mb-6\">\r\n                <div className=\"text-green-800\">\r\n                  <div className=\"text-lg font-semibold mb-2\">âœ… ë‹µë³€ ì™„ë£Œ!</div>\r\n                  <div className=\"text-sm\">\r\n                    {autoNextCountdown}ì´ˆ í›„ ë‹¤ìŒ ë¬¸ì œë¡œ ì´ë™í•©ë‹ˆë‹¤...\r\n                  </div>\r\n                  <div className=\"mt-2\">\r\n                    <button\r\n                      onClick={handleNextCard}\r\n                      className=\"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm\"\r\n                    >\r\n                      ì§€ê¸ˆ ì´ë™í•˜ê¸°\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </>\r\n        )}\r\n\r\n        {/* Training Controls - Speaking ëª¨ë“œì—ì„œë§Œ í‘œì‹œí•˜ë˜, PatternTrainingFlowê°€ idle ìƒíƒœì¼ ë•Œë§Œ */}\r\n        {learningMode.mode === 'speaking' && (\r\n          <div className=\"flex justify-center gap-4 mb-6\">\r\n            {!isTrainingRunning ? (\r\n              <button\r\n                onClick={handleStartTraining}\r\n                className=\"px-6 py-3 bg-gradient-to-r from-green-500 to-green-600 text-white font-bold rounded-lg hover:from-green-600 hover:to-green-700 transition-all duration-200 transform hover:scale-105 shadow-lg\"\r\n              >\r\n                ğŸš€ ì‹œì‘í•˜ê¸°\r\n              </button>\r\n            ) : (\r\n              <div className=\"flex gap-4\">\r\n                {!isTrainingPaused ? (\r\n                  <button\r\n                    onClick={handlePauseTraining}\r\n                    className=\"px-6 py-3 bg-gradient-to-r from-yellow-500 to-orange-500 text-white font-bold rounded-lg hover:from-yellow-600 hover:to-orange-600 transition-all duration-200 transform hover:scale-105 shadow-lg\"\r\n                  >\r\n                    â¸ï¸ ì¼ì‹œì •ì§€\r\n                  </button>\r\n                ) : (\r\n                  <button\r\n                    onClick={handleResumeTraining}\r\n                    className=\"px-6 py-3 bg-gradient-to-r from-green-500 to-green-600 text-white font-bold rounded-lg hover:from-green-600 hover:to-green-700 transition-all duration-200 transform hover:scale-105 shadow-lg\"\r\n                  >\r\n                    â–¶ï¸ ì¬ê°œ\r\n                  </button>\r\n                )}\r\n                <button\r\n                  onClick={handleResetTraining}\r\n                  className=\"px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white font-bold rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-200 transform hover:scale-105 shadow-lg\"\r\n                >\r\n                  ğŸ”„ ë‹¤ì‹œí•˜ê¸°\r\n                </button>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {/* Navigation Controls */}\r\n        <div className=\"flex justify-between items-center\">\r\n          <button\r\n            onClick={handlePreviousCard}\r\n            disabled={study.currentIndex === 0}\r\n            className=\"px-6 py-3 bg-gray-500 text-white rounded-lg disabled:bg-gray-300 disabled:cursor-not-allowed hover:bg-gray-600 transition-colors\"\r\n          >\r\n            â† ì´ì „ ì¹´ë“œ\r\n          </button>\r\n\r\n          <div className=\"flex space-x-2\">\r\n            {(study.feedback || writingFeedback) && (\r\n              <button\r\n                onClick={() => speech.speak(study.currentCard!.target_en)}\r\n                disabled={!speech.isTTSAvailable}\r\n                className=\"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 disabled:bg-gray-300 text-sm\"\r\n              >\r\n                ğŸ”Š ì •ë‹µ ë“£ê¸°\r\n              </button>\r\n            )}\r\n          </div>\r\n\r\n          {study.cards?.length && study.currentIndex < study.cards.length - 1 ? (\r\n            <button\r\n              onClick={handleNextCard}\r\n              className=\"px-6 py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors\"\r\n            >\r\n              ë‹¤ìŒ ì¹´ë“œ â†’\r\n            </button>\r\n          ) : (\r\n            <button\r\n              onClick={handleNextCard}\r\n              className=\"px-6 py-3 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors\"\r\n            >\r\n              ì„¸ì…˜ ì™„ë£Œ\r\n            </button>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n});","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\pages\\VocabularyPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isPlaying' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":17,"column":56,"nodeType":null,"messageId":"unusedVar","endLine":17,"endColumn":65},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'vocabularyWords' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":20,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":20,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'onStatusChange' is defined but never used. Allowed unused args must match /^_/u.","line":355,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":355,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'onPlayExample' is defined but never used. Allowed unused args must match /^_/u.","line":358,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":358,"endColumn":16},{"ruleId":"no-undef","severity":1,"message":"'isPlaying' is not defined.","line":371,"column":19,"nodeType":"Identifier","messageId":"undef","endLine":371,"endColumn":28},{"ruleId":"no-undef","severity":1,"message":"'isPlaying' is not defined.","line":375,"column":27,"nodeType":"Identifier","messageId":"undef","endLine":375,"endColumn":36},{"ruleId":"no-undef","severity":1,"message":"'isPlaying' is not defined.","line":377,"column":18,"nodeType":"Identifier","messageId":"undef","endLine":377,"endColumn":27},{"ruleId":"no-undef","severity":1,"message":"'isPlaying' is not defined.","line":425,"column":21,"nodeType":"Identifier","messageId":"undef","endLine":425,"endColumn":30},{"ruleId":"no-undef","severity":1,"message":"'isPlaying' is not defined.","line":429,"column":29,"nodeType":"Identifier","messageId":"undef","endLine":429,"endColumn":38},{"ruleId":"no-undef","severity":1,"message":"'isPlaying' is not defined.","line":431,"column":20,"nodeType":"Identifier","messageId":"undef","endLine":431,"endColumn":29},{"ruleId":"no-undef","severity":1,"message":"'isPlaying' is not defined.","line":492,"column":21,"nodeType":"Identifier","messageId":"undef","endLine":492,"endColumn":30},{"ruleId":"no-undef","severity":1,"message":"'isPlaying' is not defined.","line":496,"column":29,"nodeType":"Identifier","messageId":"undef","endLine":496,"endColumn":38},{"ruleId":"no-undef","severity":1,"message":"'isPlaying' is not defined.","line":498,"column":20,"nodeType":"Identifier","messageId":"undef","endLine":498,"endColumn":29},{"ruleId":"no-undef","severity":1,"message":"'isPlaying' is not defined.","line":576,"column":27,"nodeType":"Identifier","messageId":"undef","endLine":576,"endColumn":36},{"ruleId":"no-undef","severity":1,"message":"'isPlaying' is not defined.","line":580,"column":35,"nodeType":"Identifier","messageId":"undef","endLine":580,"endColumn":44},{"ruleId":"no-undef","severity":1,"message":"'isPlaying' is not defined.","line":582,"column":26,"nodeType":"Identifier","messageId":"undef","endLine":582,"endColumn":35}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":16,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * VocabularyPage - ë‹¨ì–´ì¥ ë©”ì¸ í˜ì´ì§€\r\n * - ë ˆë²¨ë³„/ì¹´í…Œê³ ë¦¬ë³„ ë‹¨ì–´ ëª©ë¡ í‘œì‹œ\r\n * - ê²€ìƒ‰, í•„í„°ë§, ì •ë ¬ ê¸°ëŠ¥\r\n * - ë‹¨ì–´ í•™ìŠµ ìƒíƒœ ê´€ë¦¬ ë° ì¦ê²¨ì°¾ê¸°\r\n * - SRS ê¸°ë°˜ ë³µìŠµ ë‹¨ì–´ ì¶”ì²œ\r\n */\r\n\r\nimport React, { useState, useMemo } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useVocabulary } from '@/hooks/useVocabulary';\r\nimport { useAudioManager } from '@/hooks/useAudioManager';\r\nimport { VocabularyWord, UserVocabularyProgress } from '@/services/vocabularyService';\r\n\r\nexport const VocabularyPage: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const { playEnglishTTS, playKoreanTTS, stopAllAudio, isPlaying } = useAudioManager();\r\n  \r\n  const {\r\n    vocabularyWords,\r\n    filteredWords,\r\n    stats,\r\n    isLoading,\r\n    error,\r\n    filters,\r\n    setFilters,\r\n    clearFilters,\r\n    searchWords,\r\n    updateWordStatus,\r\n    toggleFavorite,\r\n    getWordsForReview,\r\n    getNewWordsToLearn,\r\n    refreshVocabulary\r\n  } = useVocabulary();\r\n\r\n  // ë¡œì»¬ ìƒíƒœ\r\n  const [selectedWord, setSelectedWord] = useState<VocabularyWord | null>(null);\r\n  const [viewMode, setViewMode] = useState<'list' | 'cards'>('list');\r\n  const [sortBy, setSortBy] = useState<'frequency' | 'alphabetical' | 'level'>('frequency');\r\n\r\n  // ë³µìŠµ ë° ì‹ ê·œ ë‹¨ì–´\r\n  const reviewWords = useMemo(() => getWordsForReview(), [getWordsForReview]);\r\n  const newWords = useMemo(() => getNewWordsToLearn(20), [getNewWordsToLearn]);\r\n\r\n  // ì •ë ¬ëœ ë‹¨ì–´ ëª©ë¡\r\n  const sortedWords = useMemo(() => {\r\n    const sorted = [...filteredWords];\r\n    switch (sortBy) {\r\n      case 'alphabetical':\r\n        return sorted.sort((a, b) => a.word.localeCompare(b.word));\r\n      case 'level':\r\n        return sorted.sort((a, b) => a.level - b.level || b.frequency - a.frequency);\r\n      case 'frequency':\r\n      default:\r\n        return sorted.sort((a, b) => b.frequency - a.frequency);\r\n    }\r\n  }, [filteredWords, sortBy]);\r\n\r\n  // ë‹¨ì–´ ë°œìŒ ì¬ìƒ (ì¤‘ë³µ ë°©ì§€)\r\n  const playWordPronunciation = async (word: VocabularyWord) => {\r\n    stopAllAudio(); // ê¸°ì¡´ ìŒì„± ì¤‘ë‹¨\r\n    setTimeout(() => playEnglishTTS(word.word), 50);\r\n  };\r\n\r\n  // ì˜ˆë¬¸ ë°œìŒ ì¬ìƒ (ì¤‘ë³µ ë°©ì§€)\r\n  const playExample = async (sentence: string, translation: string) => {\r\n    stopAllAudio(); // ê¸°ì¡´ ìŒì„± ì¤‘ë‹¨\r\n    setTimeout(async () => {\r\n      await playEnglishTTS(sentence);\r\n      setTimeout(() => playKoreanTTS(translation), 2000);\r\n    }, 50);\r\n  };\r\n\r\n  // ë‹¨ì–´ ìƒíƒœ ë³€ê²½ í•¸ë“¤ëŸ¬\r\n  const handleWordStatusChange = (wordId: string, status: UserVocabularyProgress['status']) => {\r\n    updateWordStatus(wordId, status);\r\n  };\r\n\r\n  // ì¦ê²¨ì°¾ê¸° í† ê¸€\r\n  const handleToggleFavorite = (wordId: string) => {\r\n    toggleFavorite(wordId);\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4\"></div>\r\n          <p className=\"text-gray-600 dark:text-gray-300\">ë‹¨ì–´ì¥ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <div className=\"text-red-500 text-6xl mb-4\">âš ï¸</div>\r\n          <h2 className=\"text-xl font-semibold text-gray-800 dark:text-white mb-2\">ì˜¤ë¥˜ ë°œìƒ</h2>\r\n          <p className=\"text-gray-600 dark:text-gray-300 mb-4\">{error}</p>\r\n          <button\r\n            onClick={refreshVocabulary}\r\n            className=\"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors\"\r\n          >\r\n            ë‹¤ì‹œ ì‹œë„\r\n          </button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50\">\r\n      {/* Header */}\r\n      <div className=\"bg-white shadow-sm border-b\">\r\n        <div className=\"max-w-6xl mx-auto px-4 py-4\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div className=\"flex items-center gap-4\">\r\n              <button\r\n                onClick={() => navigate('/')}\r\n                className=\"p-2 hover:bg-gray-100 rounded-lg transition-colors\"\r\n              >\r\n                <svg className=\"w-6 h-6 text-gray-600 dark:text-gray-300\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 19l-7-7 7-7\" />\r\n                </svg>\r\n              </button>\r\n              <div>\r\n                <h1 className=\"text-2xl font-bold text-gray-800 dark:text-white\">ğŸ“– ë‹¨ì–´ì¥</h1>\r\n                <p className=\"text-sm text-gray-600 dark:text-gray-300\">íŒ¨í„´ í•™ìŠµ ê¸°ë°˜ ì–´íœ˜ ê´€ë¦¬</p>\r\n              </div>\r\n            </div>\r\n            \r\n            {/* í†µê³„ ìš”ì•½ */}\r\n            <div className=\"flex items-center gap-6 text-sm\">\r\n              <div className=\"text-center\">\r\n                <div className=\"text-lg font-bold text-blue-600\">{stats.totalWords}</div>\r\n                <div className=\"text-gray-600 dark:text-gray-300\">ì „ì²´</div>\r\n              </div>\r\n              <div className=\"text-center\">\r\n                <div className=\"text-lg font-bold text-green-600\">{stats.knownWords}</div>\r\n                <div className=\"text-gray-600 dark:text-gray-300\">í•™ìŠµì™„ë£Œ</div>\r\n              </div>\r\n              <div className=\"text-center\">\r\n                <div className=\"text-lg font-bold text-orange-600\">{reviewWords.length}</div>\r\n                <div className=\"text-gray-600 dark:text-gray-300\">ë³µìŠµí•„ìš”</div>\r\n              </div>\r\n              <div className=\"text-center\">\r\n                <div className=\"text-lg font-bold text-purple-600\">{newWords.length}</div>\r\n                <div className=\"text-gray-600 dark:text-gray-300\">ì‹ ê·œí•™ìŠµ</div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"max-w-6xl mx-auto px-4 py-6\">\r\n        {/* ë¹ ë¥¸ ì•¡ì…˜ ë²„íŠ¼ */}\r\n        {(reviewWords.length > 0 || newWords.length > 0) && (\r\n          <div className=\"mb-6\">\r\n            <h2 className=\"text-lg font-semibold text-gray-800 dark:text-white mb-3\">ğŸ“š ì¶”ì²œ í•™ìŠµ</h2>\r\n            <div className=\"flex gap-4\">\r\n              {reviewWords.length > 0 && (\r\n                <button className=\"flex-1 p-4 bg-orange-50 border border-orange-200 rounded-lg hover:bg-orange-100 transition-colors\">\r\n                  <div className=\"text-left\">\r\n                    <div className=\"text-orange-800 font-semibold\">ë³µìŠµí•˜ê¸°</div>\r\n                    <div className=\"text-orange-600 text-sm\">{reviewWords.length}ê°œ ë‹¨ì–´ê°€ ë³µìŠµì„ ê¸°ë‹¤ë¦¬ê³  ìˆìŠµë‹ˆë‹¤</div>\r\n                  </div>\r\n                </button>\r\n              )}\r\n              {newWords.length > 0 && (\r\n                <button className=\"flex-1 p-4 bg-blue-50 border border-blue-200 rounded-lg hover:bg-blue-100 transition-colors\">\r\n                  <div className=\"text-left\">\r\n                    <div className=\"text-blue-800 font-semibold\">ìƒˆ ë‹¨ì–´ í•™ìŠµ</div>\r\n                    <div className=\"text-blue-600 text-sm\">{newWords.length}ê°œ ìƒˆ ë‹¨ì–´ë¥¼ í•™ìŠµí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</div>\r\n                  </div>\r\n                </button>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* ê²€ìƒ‰ ë° í•„í„° */}\r\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg transition-colors duration-300 shadow p-4 mb-6\">\r\n          <div className=\"flex flex-col lg:flex-row gap-4\">\r\n            {/* ê²€ìƒ‰ì°½ */}\r\n            <div className=\"flex-1\">\r\n              <div className=\"relative\">\r\n                <input\r\n                  type=\"text\"\r\n                  placeholder=\"ë‹¨ì–´ ê²€ìƒ‰... (ì˜ì–´ ë˜ëŠ” í•œêµ­ì–´)\"\r\n                  value={filters.searchQuery || ''}\r\n                  onChange={(e) => searchWords(e.target.value)}\r\n                  className=\"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                />\r\n                <svg className=\"w-5 h-5 text-gray-400 absolute left-3 top-1/2 transform -translate-y-1/2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\" />\r\n                </svg>\r\n              </div>\r\n            </div>\r\n\r\n            {/* í•„í„° */}\r\n            <div className=\"flex gap-2\">\r\n              <select\r\n                value={filters.level || ''}\r\n                onChange={(e) => setFilters({ level: e.target.value ? parseInt(e.target.value) : undefined })}\r\n                className=\"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n              >\r\n                <option value=\"\">ëª¨ë“  ë ˆë²¨</option>\r\n                {Array.from({length: 10}, (_, i) => (\r\n                  <option key={i + 1} value={i + 1}>Level {i + 1}</option>\r\n                ))}\r\n              </select>\r\n\r\n              <select\r\n                value={filters.category || ''}\r\n                onChange={(e) => setFilters({ category: e.target.value as VocabularyWord['category'] || undefined })}\r\n                className=\"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n              >\r\n                <option value=\"\">ëª¨ë“  í’ˆì‚¬</option>\r\n                <option value=\"noun\">ëª…ì‚¬</option>\r\n                <option value=\"verb\">ë™ì‚¬</option>\r\n                <option value=\"adjective\">í˜•ìš©ì‚¬</option>\r\n                <option value=\"adverb\">ë¶€ì‚¬</option>\r\n                <option value=\"pronoun\">ëŒ€ëª…ì‚¬</option>\r\n                <option value=\"preposition\">ì „ì¹˜ì‚¬</option>\r\n              </select>\r\n\r\n              <select\r\n                value={filters.status || ''}\r\n                onChange={(e) => setFilters({ status: e.target.value as UserVocabularyProgress['status'] || undefined })}\r\n                className=\"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n              >\r\n                <option value=\"\">ëª¨ë“  ìƒíƒœ</option>\r\n                <option value=\"unknown\">ëª¨ë¦„</option>\r\n                <option value=\"learning\">í•™ìŠµì¤‘</option>\r\n                <option value=\"known\">ì•Œê³  ìˆìŒ</option>\r\n                <option value=\"review\">ë³µìŠµ í•„ìš”</option>\r\n              </select>\r\n\r\n              <button\r\n                onClick={() => setFilters({ onlyFavorites: !filters.onlyFavorites })}\r\n                className={`px-3 py-2 border rounded-lg transition-colors ${\r\n                  filters.onlyFavorites \r\n                    ? 'bg-yellow-100 border-yellow-300 text-yellow-800' \r\n                    : 'border-gray-300 text-gray-600 dark:text-gray-300 hover:bg-gray-50'\r\n                }`}\r\n              >\r\n                â­ ì¦ê²¨ì°¾ê¸°\r\n              </button>\r\n\r\n              <button\r\n                onClick={clearFilters}\r\n                className=\"px-3 py-2 text-gray-600 dark:text-gray-300 hover:text-gray-800 dark:text-white transition-colors\"\r\n              >\r\n                ì´ˆê¸°í™”\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n          {/* ì •ë ¬ ë° ë·° ëª¨ë“œ */}\r\n          <div className=\"flex justify-between items-center mt-4 pt-4 border-t border-gray-200\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <span className=\"text-sm text-gray-600 dark:text-gray-300\">ì •ë ¬:</span>\r\n              <select\r\n                value={sortBy}\r\n                onChange={(e) => setSortBy(e.target.value as typeof sortBy)}\r\n                className=\"text-sm border border-gray-300 rounded px-2 py-1\"\r\n              >\r\n                <option value=\"frequency\">ë¹ˆë„ìˆœ</option>\r\n                <option value=\"alphabetical\">ì•ŒíŒŒë²³ìˆœ</option>\r\n                <option value=\"level\">ë ˆë²¨ìˆœ</option>\r\n              </select>\r\n            </div>\r\n\r\n            <div className=\"flex items-center gap-2\">\r\n              <span className=\"text-sm text-gray-600 dark:text-gray-300\">{sortedWords.length}ê°œ ë‹¨ì–´</span>\r\n              <div className=\"flex border border-gray-300 rounded overflow-hidden\">\r\n                <button\r\n                  onClick={() => setViewMode('list')}\r\n                  className={`px-3 py-1 text-sm ${viewMode === 'list' ? 'bg-blue-500 text-white' : 'text-gray-600 dark:text-gray-300 hover:bg-gray-50'}`}\r\n                >\r\n                  ëª©ë¡\r\n                </button>\r\n                <button\r\n                  onClick={() => setViewMode('cards')}\r\n                  className={`px-3 py-1 text-sm ${viewMode === 'cards' ? 'bg-blue-500 text-white' : 'text-gray-600 dark:text-gray-300 hover:bg-gray-50'}`}\r\n                >\r\n                  ì¹´ë“œ\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* ë‹¨ì–´ ëª©ë¡ */}\r\n        {sortedWords.length === 0 ? (\r\n          <div className=\"text-center py-12\">\r\n            <div className=\"text-gray-400 text-6xl mb-4\">ğŸ“</div>\r\n            <p className=\"text-gray-600 dark:text-gray-300\">ì¡°ê±´ì— ë§ëŠ” ë‹¨ì–´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>\r\n            <button\r\n              onClick={clearFilters}\r\n              className=\"mt-4 px-4 py-2 text-blue-600 hover:text-blue-800 transition-colors\"\r\n            >\r\n              í•„í„° ì´ˆê¸°í™”\r\n            </button>\r\n          </div>\r\n        ) : (\r\n          <div className={`grid gap-4 ${viewMode === 'cards' ? 'grid-cols-1 md:grid-cols-2 lg:grid-cols-3' : 'grid-cols-1'}`}>\r\n            {sortedWords.map((word) => (\r\n              <VocabularyWordItem\r\n                key={word.id}\r\n                word={word}\r\n                viewMode={viewMode}\r\n                onStatusChange={handleWordStatusChange}\r\n                onToggleFavorite={handleToggleFavorite}\r\n                onPlayWord={() => playWordPronunciation(word)}\r\n                onPlayExample={playExample}\r\n                onSelectWord={() => setSelectedWord(word)}\r\n              />\r\n            ))}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* ë‹¨ì–´ ìƒì„¸ ëª¨ë‹¬ */}\r\n      {selectedWord && (\r\n        <VocabularyWordModal\r\n          word={selectedWord}\r\n          onClose={() => setSelectedWord(null)}\r\n          onStatusChange={handleWordStatusChange}\r\n          onToggleFavorite={handleToggleFavorite}\r\n          onPlayWord={() => playWordPronunciation(selectedWord)}\r\n          onPlayExample={playExample}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\n// ë‹¨ì–´ ì•„ì´í…œ ì»´í¬ë„ŒíŠ¸\r\ninterface VocabularyWordItemProps {\r\n  word: VocabularyWord;\r\n  viewMode: 'list' | 'cards';\r\n  onStatusChange: (wordId: string, status: UserVocabularyProgress['status']) => void;\r\n  onToggleFavorite: (wordId: string) => void;\r\n  onPlayWord: () => void;\r\n  onPlayExample: (sentence: string, translation: string) => void;\r\n  onSelectWord: () => void;\r\n}\r\n\r\nconst VocabularyWordItem: React.FC<VocabularyWordItemProps> = ({\r\n  word,\r\n  viewMode,\r\n  onStatusChange,\r\n  onToggleFavorite,\r\n  onPlayWord,\r\n  onPlayExample,\r\n  onSelectWord\r\n}) => {\r\n  if (viewMode === 'cards') {\r\n    return (\r\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg transition-colors duration-300 shadow hover:shadow-md transition-shadow p-4 cursor-pointer\" onClick={onSelectWord}>\r\n        <div className=\"flex justify-between items-start mb-3\">\r\n          <div className=\"flex-1\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <h3 className=\"text-lg font-semibold text-gray-800 dark:text-white\">{word.word}</h3>\r\n              <button \r\n                onClick={(e) => { e.stopPropagation(); onPlayWord(); }}\r\n                className={`p-1 transition-colors ${\r\n                  isPlaying \r\n                    ? 'text-gray-400 cursor-not-allowed' \r\n                    : 'text-blue-500 hover:text-blue-700'\r\n                }`}\r\n                disabled={isPlaying}\r\n              >\r\n                {isPlaying ? 'â¸ï¸' : 'ğŸ”Š'}\r\n              </button>\r\n            </div>\r\n            <p className=\"text-gray-600 dark:text-gray-300\">{word.translation}</p>\r\n            <div className=\"flex items-center gap-2 mt-2\">\r\n              <span className={`px-2 py-1 text-xs rounded ${\r\n                word.difficulty === 'basic' ? 'bg-green-100 text-green-800' :\r\n                word.difficulty === 'intermediate' ? 'bg-yellow-100 text-yellow-800' :\r\n                'bg-red-100 text-red-800'\r\n              }`}>\r\n                {word.difficulty}\r\n              </span>\r\n              <span className=\"px-2 py-1 text-xs bg-gray-100 text-gray-800 dark:text-white rounded\">\r\n                Lv.{word.level}\r\n              </span>\r\n              <span className=\"px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded\">\r\n                {word.category}\r\n              </span>\r\n            </div>\r\n          </div>\r\n          <button\r\n            onClick={(e) => { e.stopPropagation(); onToggleFavorite(word.id); }}\r\n            className=\"text-yellow-500 hover:text-yellow-600 transition-colors\"\r\n          >\r\n            â­\r\n          </button>\r\n        </div>\r\n        {word.examples.length > 0 && (\r\n          <div className=\"border-t pt-3\">\r\n            <p className=\"text-sm text-gray-600 dark:text-gray-300\">{word.examples[0].sentence}</p>\r\n            <p className=\"text-sm text-gray-500\">{word.examples[0].translation}</p>\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg transition-colors duration-300 shadow hover:shadow-md transition-shadow p-4\">\r\n      <div className=\"flex items-center justify-between\">\r\n        <div className=\"flex-1 cursor-pointer\" onClick={onSelectWord}>\r\n          <div className=\"flex items-center gap-3\">\r\n            <div>\r\n              <div className=\"flex items-center gap-2\">\r\n                <h3 className=\"text-lg font-semibold text-gray-800 dark:text-white\">{word.word}</h3>\r\n                <button \r\n                  onClick={(e) => { e.stopPropagation(); onPlayWord(); }}\r\n                  className={`p-1 transition-colors ${\r\n                    isPlaying \r\n                      ? 'text-gray-400 cursor-not-allowed' \r\n                      : 'text-blue-500 hover:text-blue-700'\r\n                  }`}\r\n                  disabled={isPlaying}\r\n                >\r\n                  {isPlaying ? 'â¸ï¸' : 'ğŸ”Š'}\r\n                </button>\r\n              </div>\r\n              <p className=\"text-gray-600 dark:text-gray-300\">{word.translation}</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        <div className=\"flex items-center gap-2\">\r\n          <span className={`px-2 py-1 text-xs rounded ${\r\n            word.difficulty === 'basic' ? 'bg-green-100 text-green-800' :\r\n            word.difficulty === 'intermediate' ? 'bg-yellow-100 text-yellow-800' :\r\n            'bg-red-100 text-red-800'\r\n          }`}>\r\n            {word.difficulty}\r\n          </span>\r\n          <span className=\"px-2 py-1 text-xs bg-gray-100 text-gray-800 dark:text-white rounded\">\r\n            Lv.{word.level}\r\n          </span>\r\n          <button\r\n            onClick={() => onToggleFavorite(word.id)}\r\n            className=\"text-yellow-500 hover:text-yellow-600 transition-colors\"\r\n          >\r\n            â­\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n// ë‹¨ì–´ ìƒì„¸ ëª¨ë‹¬ ì»´í¬ë„ŒíŠ¸\r\ninterface VocabularyWordModalProps {\r\n  word: VocabularyWord;\r\n  onClose: () => void;\r\n  onStatusChange: (wordId: string, status: UserVocabularyProgress['status']) => void;\r\n  onToggleFavorite: (wordId: string) => void;\r\n  onPlayWord: () => void;\r\n  onPlayExample: (sentence: string, translation: string) => void;\r\n}\r\n\r\nconst VocabularyWordModal: React.FC<VocabularyWordModalProps> = ({\r\n  word,\r\n  onClose,\r\n  onStatusChange,\r\n  onToggleFavorite,\r\n  onPlayWord,\r\n  onPlayExample\r\n}) => {\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg transition-colors duration-300 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto\">\r\n        <div className=\"p-6\">\r\n          {/* í—¤ë” */}\r\n          <div className=\"flex justify-between items-start mb-4\">\r\n            <div className=\"flex-1\">\r\n              <div className=\"flex items-center gap-3 mb-2\">\r\n                <h2 className=\"text-2xl font-bold text-gray-800 dark:text-white\">{word.word}</h2>\r\n                <button \r\n                  onClick={onPlayWord}\r\n                  className={`p-2 transition-colors ${\r\n                    isPlaying \r\n                      ? 'text-gray-400 cursor-not-allowed' \r\n                      : 'text-blue-500 hover:text-blue-700'\r\n                  }`}\r\n                  disabled={isPlaying}\r\n                >\r\n                  {isPlaying ? 'â¸ï¸' : 'ğŸ”Š'}\r\n                </button>\r\n                <button\r\n                  onClick={() => onToggleFavorite(word.id)}\r\n                  className=\"text-yellow-500 hover:text-yellow-600 transition-colors\"\r\n                >\r\n                  â­\r\n                </button>\r\n              </div>\r\n              <p className=\"text-xl text-gray-600 dark:text-gray-300 mb-4\">{word.translation}</p>\r\n              \r\n              <div className=\"flex flex-wrap gap-2\">\r\n                <span className={`px-3 py-1 text-sm rounded-full ${\r\n                  word.difficulty === 'basic' ? 'bg-green-100 text-green-800' :\r\n                  word.difficulty === 'intermediate' ? 'bg-yellow-100 text-yellow-800' :\r\n                  'bg-red-100 text-red-800'\r\n                }`}>\r\n                  {word.difficulty}\r\n                </span>\r\n                <span className=\"px-3 py-1 text-sm bg-gray-100 text-gray-800 dark:text-white rounded-full\">\r\n                  Level {word.level}\r\n                </span>\r\n                <span className=\"px-3 py-1 text-sm bg-blue-100 text-blue-800 rounded-full\">\r\n                  {word.category}\r\n                </span>\r\n                <span className=\"px-3 py-1 text-sm bg-purple-100 text-purple-800 rounded-full\">\r\n                  ë¹ˆë„: {word.frequency}íšŒ\r\n                </span>\r\n              </div>\r\n            </div>\r\n            \r\n            <button\r\n              onClick={onClose}\r\n              className=\"text-gray-400 hover:text-gray-600 dark:text-gray-300 transition-colors\"\r\n            >\r\n              <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n              </svg>\r\n            </button>\r\n          </div>\r\n\r\n          {/* í•™ìŠµ ìƒíƒœ ì„¤ì • */}\r\n          <div className=\"mb-6\">\r\n            <h3 className=\"font-semibold text-gray-800 dark:text-white mb-3\">í•™ìŠµ ìƒíƒœ</h3>\r\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-2\">\r\n              {[\r\n                { status: 'unknown' as const, label: 'ëª¨ë¦„', color: 'gray' },\r\n                { status: 'learning' as const, label: 'í•™ìŠµì¤‘', color: 'yellow' },\r\n                { status: 'known' as const, label: 'ì•Œê³  ìˆìŒ', color: 'green' },\r\n                { status: 'review' as const, label: 'ë³µìŠµ í•„ìš”', color: 'orange' }\r\n              ].map(({ status, label, color }) => (\r\n                <button\r\n                  key={status}\r\n                  onClick={() => onStatusChange(word.id, status)}\r\n                  className={`px-4 py-2 text-sm font-medium rounded-lg transition-colors\r\n                    ${color === 'gray' ? 'bg-gray-100 text-gray-800 dark:text-white hover:bg-gray-200' :\r\n                      color === 'yellow' ? 'bg-yellow-100 text-yellow-800 hover:bg-yellow-200' :\r\n                      color === 'green' ? 'bg-green-100 text-green-800 hover:bg-green-200' :\r\n                      'bg-orange-100 text-orange-800 hover:bg-orange-200'}`}\r\n                >\r\n                  {label}\r\n                </button>\r\n              ))}\r\n            </div>\r\n          </div>\r\n\r\n          {/* ì˜ˆë¬¸ */}\r\n          {word.examples.length > 0 && (\r\n            <div>\r\n              <h3 className=\"font-semibold text-gray-800 dark:text-white mb-3\">ì˜ˆë¬¸</h3>\r\n              <div className=\"space-y-4\">\r\n                {word.examples.map((example, index) => (\r\n                  <div key={index} className=\"p-4 bg-gray-50 rounded-lg\">\r\n                    <div className=\"flex items-start gap-2 mb-2\">\r\n                      <p className=\"flex-1 text-gray-800 dark:text-white\">{example.sentence}</p>\r\n                      <button\r\n                        onClick={() => onPlayExample(example.sentence, example.translation)}\r\n                        className={`transition-colors ${\r\n                          isPlaying \r\n                            ? 'text-gray-400 cursor-not-allowed' \r\n                            : 'text-blue-500 hover:text-blue-700'\r\n                        }`}\r\n                        disabled={isPlaying}\r\n                      >\r\n                        {isPlaying ? 'â¸ï¸' : 'ğŸ”Š'}\r\n                      </button>\r\n                    </div>\r\n                    <p className=\"text-gray-600 dark:text-gray-300\">{example.translation}</p>\r\n                    <p className=\"text-xs text-gray-500 mt-2\">ì¶œì²˜: {example.stageId}</p>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default VocabularyPage;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\plugins\\PluginManager.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'PluginConfigEntry' is defined but never used. Allowed unused vars must match /^_/u.","line":9,"column":24,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":41},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'loadedInfo' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":267,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":267,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * í†µí•© í”ŒëŸ¬ê·¸ì¸ ë§¤ë‹ˆì € (Facade Pattern)\r\n * @description ëª¨ë“  í”ŒëŸ¬ê·¸ì¸ ê¸°ëŠ¥ì„ í†µí•©í•˜ì—¬ ê°„ë‹¨í•œ API ì œê³µ\r\n */\r\n\r\nimport { IPlugin, IPluginFactory, PluginStatus } from './core/IPlugin';\r\nimport { pluginRegistry } from './core/PluginRegistry';\r\nimport { pluginLifecycle } from './core/PluginLifecycleManager';\r\nimport { pluginConfig, PluginConfigEntry } from './config/PluginConfig';\r\nimport { ISpeechPlugin } from './speech/ISpeechPlugin';\r\nimport { WebSpeechPluginFactory } from './speech/WebSpeechPluginFactory';\r\nimport { ISpeedTrainingPlugin } from './speed/ISpeedTrainingPlugin';\r\nimport { SpeedTrainingPluginFactory } from './speed/SpeedTrainingPluginFactory';\r\nimport { IPerformancePlugin } from './performance/IPerformancePlugin';\r\nimport { PerformancePluginFactory } from './performance/PerformancePluginFactory';\r\nimport { NonEmptyString, Result, Ok, Err, assertNonEmptyString, isNonEmptyString } from '@/types/core';\r\n\r\n// í”ŒëŸ¬ê·¸ì¸ ì´ˆê¸°í™” ì˜µì…˜\r\nexport interface PluginManagerOptions {\r\n  readonly environment?: 'development' | 'production' | 'test';\r\n  readonly autoLoad?: boolean;\r\n  readonly enableMetrics?: boolean;\r\n  readonly loadTimeout?: number;\r\n}\r\n\r\n// í”ŒëŸ¬ê·¸ì¸ ì¡°íšŒ ê²°ê³¼\r\nexport interface PluginInfo {\r\n  readonly name: NonEmptyString;\r\n  readonly status: PluginStatus;\r\n  readonly implementation: string;\r\n  readonly enabled: boolean;\r\n  readonly loadTime?: number;\r\n  readonly errorCount?: number;\r\n}\r\n\r\n/**\r\n * í†µí•© í”ŒëŸ¬ê·¸ì¸ ë§¤ë‹ˆì €\r\n * @description í”ŒëŸ¬ê·¸ì¸ ì‹œìŠ¤í…œì˜ ëª¨ë“  ê¸°ëŠ¥ì„ í†µí•©í•œ ë‹¨ì¼ ì¸í„°í˜ì´ìŠ¤\r\n */\r\nexport class PluginManager {\r\n  private static instance: PluginManager;\r\n  private initialized = false;\r\n\r\n  private constructor() {}\r\n\r\n  static getInstance(): PluginManager {\r\n    if (!PluginManager.instance) {\r\n      PluginManager.instance = new PluginManager();\r\n    }\r\n    return PluginManager.instance;\r\n  }\r\n\r\n  /**\r\n   * í”ŒëŸ¬ê·¸ì¸ ì‹œìŠ¤í…œ ì´ˆê¸°í™”\r\n   */\r\n  async initialize(options: PluginManagerOptions = {}): Promise<Result<void>> {\r\n    if (this.initialized) {\r\n      return Ok(undefined);\r\n    }\r\n\r\n    try {\r\n      console.log('ğŸ”Œ Initializing Plugin System...');\r\n\r\n      // 1. ê¸°ë³¸ í”ŒëŸ¬ê·¸ì¸ íŒ©í† ë¦¬ë“¤ ë“±ë¡\r\n      await this.registerBuiltinPlugins();\r\n\r\n      // 2. ì„¤ì •ì—ì„œ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ë¡œë“œ\r\n      const loadConfigResult = pluginConfig.loadFromStorage();\r\n      if (loadConfigResult.success) {\r\n        console.log('ğŸ“‹ Plugin configuration loaded from storage');\r\n      }\r\n\r\n      // 3. ìë™ ë¡œë“œ í™œì„±í™”ëœ í”ŒëŸ¬ê·¸ì¸ë“¤ ë¡œë“œ\r\n      if (options.autoLoad !== false) {\r\n        await this.autoLoadPlugins();\r\n      }\r\n\r\n      // 4. ë©”íŠ¸ë¦­ìŠ¤ ìˆ˜ì§‘ ì‹œì‘\r\n      if (options.enableMetrics !== false) {\r\n        this.startMetricsCollection();\r\n      }\r\n\r\n      this.initialized = true;\r\n      console.log('âœ… Plugin System initialized successfully');\r\n      \r\n      return Ok(undefined);\r\n    } catch (error) {\r\n      console.error('âŒ Plugin System initialization failed:', error);\r\n      return Err(error as Error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ë‚´ì¥ í”ŒëŸ¬ê·¸ì¸ë“¤ ë“±ë¡\r\n   */\r\n  private async registerBuiltinPlugins(): Promise<void> {\r\n    const builtinPlugins: Array<{\r\n      name: NonEmptyString;\r\n      factory: IPluginFactory;\r\n    }> = [\r\n      {\r\n        name: assertNonEmptyString('speech', 'plugin name'),\r\n        factory: new WebSpeechPluginFactory()\r\n      },\r\n      {\r\n        name: assertNonEmptyString('speed-training', 'plugin name'),\r\n        factory: new SpeedTrainingPluginFactory()\r\n      },\r\n      {\r\n        name: assertNonEmptyString('performance', 'plugin name'),\r\n        factory: new PerformancePluginFactory()\r\n      }\r\n      // í–¥í›„ ë‹¤ë¥¸ í”ŒëŸ¬ê·¸ì¸ë“¤ ì¶”ê°€\r\n    ];\r\n\r\n    for (const { name, factory } of builtinPlugins) {\r\n      const result = await pluginLifecycle.registerPlugin(name, factory);\r\n      if (result.success) {\r\n        console.log(`ğŸ“¦ Registered plugin: ${name}`);\r\n      } else {\r\n        console.warn(`âš ï¸ Failed to register plugin ${name}:`, result.error);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ìë™ ë¡œë“œ ëŒ€ìƒ í”ŒëŸ¬ê·¸ì¸ë“¤ ë¡œë“œ\r\n   */\r\n  private async autoLoadPlugins(): Promise<void> {\r\n    const enabledPlugins = pluginConfig.getEnabledPlugins();\r\n    const autoLoadPlugins = enabledPlugins.filter(({ config }) => !config.loadOnDemand);\r\n\r\n    console.log(`ğŸš€ Auto-loading ${autoLoadPlugins.length} plugins...`);\r\n\r\n    for (const { name } of autoLoadPlugins) {\r\n      const result = await pluginLifecycle.loadPlugin(name as NonEmptyString);\r\n      if (result.success) {\r\n        console.log(`âœ… Auto-loaded plugin: ${name}`);\r\n      } else {\r\n        console.warn(`âš ï¸ Failed to auto-load plugin ${name}:`, result.error);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ë©”íŠ¸ë¦­ìŠ¤ ìˆ˜ì§‘ ì‹œì‘\r\n   */\r\n  private startMetricsCollection(): void {\r\n    // ì£¼ê¸°ì ìœ¼ë¡œ ë©”íŠ¸ë¦­ìŠ¤ ìˆ˜ì§‘ (ê°œë°œìš©)\r\n    if (pluginConfig.getEnvironment() === 'development') {\r\n      setInterval(() => {\r\n        const metrics = pluginLifecycle.getSystemMetrics();\r\n        console.debug('ğŸ“Š Plugin Metrics:', metrics);\r\n      }, 30000); // 30ì´ˆë§ˆë‹¤\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Speech í”ŒëŸ¬ê·¸ì¸ ê°€ì ¸ì˜¤ê¸° (íƒ€ì… ì•ˆì „)\r\n   */\r\n  async getSpeechPlugin(): Promise<Result<ISpeechPlugin>> {\r\n    return this.getPlugin<ISpeechPlugin>('speech');\r\n  }\r\n\r\n  /**\r\n   * Speed Training í”ŒëŸ¬ê·¸ì¸ ê°€ì ¸ì˜¤ê¸° (íƒ€ì… ì•ˆì „)\r\n   */\r\n  async getSpeedTrainingPlugin(): Promise<Result<ISpeedTrainingPlugin>> {\r\n    return this.getPlugin<ISpeedTrainingPlugin>('speed-training');\r\n  }\r\n\r\n  /**\r\n   * Performance í”ŒëŸ¬ê·¸ì¸ ê°€ì ¸ì˜¤ê¸° (íƒ€ì… ì•ˆì „)\r\n   */\r\n  async getPerformancePlugin(): Promise<Result<IPerformancePlugin>> {\r\n    return this.getPlugin<IPerformancePlugin>('performance');\r\n  }\r\n\r\n  /**\r\n   * íŠ¹ì • íƒ€ì…ì˜ í”ŒëŸ¬ê·¸ì¸ ê°€ì ¸ì˜¤ê¸°\r\n   */\r\n  async getPlugin<T extends IPlugin>(name: string): Promise<Result<T>> {\r\n    if (!isNonEmptyString(name)) {\r\n      return Err(new Error('Plugin name must be non-empty'));\r\n    }\r\n\r\n    const pluginName = name as NonEmptyString;\r\n    \r\n    // ì´ë¯¸ ë¡œë“œëœ ê²½ìš°\r\n    const loadedPlugins = pluginLifecycle.getLoadedPlugins();\r\n    const loadedPlugin = loadedPlugins.get(pluginName);\r\n    \r\n    if (loadedPlugin?.instance) {\r\n      return Ok(loadedPlugin.instance as T);\r\n    }\r\n\r\n    // ì˜¨ë””ë§¨ë“œ ë¡œë”©\r\n    const config = pluginConfig.getPluginConfig(name);\r\n    if (config?.enabled) {\r\n      const loadResult = await pluginLifecycle.loadPlugin(pluginName);\r\n      if (loadResult.success) {\r\n        return Ok(loadResult.data as T);\r\n      }\r\n      return Err(loadResult.error);\r\n    }\r\n\r\n    return Err(new Error(`Plugin '${name}' is not enabled or not found`));\r\n  }\r\n\r\n  /**\r\n   * í”ŒëŸ¬ê·¸ì¸ í™œì„±í™”/ë¹„í™œì„±í™”\r\n   */\r\n  async setPluginEnabled(name: string, enabled: boolean): Promise<Result<void>> {\r\n    if (!isNonEmptyString(name)) {\r\n      return Err(new Error('Plugin name must be non-empty'));\r\n    }\r\n\r\n    const pluginName = name as NonEmptyString;\r\n    \r\n    // ì„¤ì • ì—…ë°ì´íŠ¸\r\n    const configResult = pluginConfig.setPluginEnabled(name, enabled);\r\n    if (!configResult.success) {\r\n      return configResult;\r\n    }\r\n\r\n    // í™œì„±í™”: ë¡œë“œí•˜ê¸°\r\n    if (enabled) {\r\n      const loadResult = await pluginLifecycle.loadPlugin(pluginName);\r\n      if (!loadResult.success) {\r\n        return Err(loadResult.error);\r\n      }\r\n    } \r\n    // ë¹„í™œì„±í™”: ì–¸ë¡œë“œí•˜ê¸°\r\n    else {\r\n      const unloadResult = await pluginLifecycle.unloadPlugin(pluginName);\r\n      if (!unloadResult.success) {\r\n        return Err(unloadResult.error);\r\n      }\r\n    }\r\n\r\n    // ì„¤ì • ì €ì¥\r\n    pluginConfig.saveToStorage();\r\n\r\n    return Ok(undefined);\r\n  }\r\n\r\n  /**\r\n   * í”ŒëŸ¬ê·¸ì¸ ì¬ì‹œì‘\r\n   */\r\n  async restartPlugin(name: string): Promise<Result<IPlugin>> {\r\n    if (!isNonEmptyString(name)) {\r\n      return Err(new Error('Plugin name must be non-empty'));\r\n    }\r\n\r\n    return pluginLifecycle.restartPlugin(name as NonEmptyString);\r\n  }\r\n\r\n  /**\r\n   * ëª¨ë“  í”ŒëŸ¬ê·¸ì¸ ì •ë³´ ì¡°íšŒ\r\n   */\r\n  getAllPlugins(): readonly PluginInfo[] {\r\n    const registered = pluginRegistry.getRegisteredPlugins();\r\n    const loaded = pluginLifecycle.getLoadedPlugins();\r\n\r\n    return registered.map(name => {\r\n      const config = pluginConfig.getPluginConfig(name);\r\n      const loadedInfo = loaded.get(name);\r\n      const status = pluginLifecycle.getPluginStatus(name);\r\n      const metrics = pluginLifecycle.getPluginMetrics(name);\r\n\r\n      return {\r\n        name,\r\n        status: status || 'unloaded',\r\n        implementation: config?.implementation || 'unknown',\r\n        enabled: config?.enabled || false,\r\n        loadTime: metrics.loadTime || undefined,\r\n        errorCount: metrics.errorCount || undefined\r\n      };\r\n    });\r\n  }\r\n\r\n  /**\r\n   * í™œì„±í™”ëœ í”ŒëŸ¬ê·¸ì¸ë“¤ë§Œ ì¡°íšŒ\r\n   */\r\n  getActivePlugins(): readonly PluginInfo[] {\r\n    return this.getAllPlugins().filter(plugin => \r\n      plugin.enabled && plugin.status !== 'unloaded'\r\n    );\r\n  }\r\n\r\n  /**\r\n   * í”ŒëŸ¬ê·¸ì¸ ìƒíƒœ ì¡°íšŒ\r\n   */\r\n  getPluginStatus(name: string): PluginStatus | null {\r\n    if (!isNonEmptyString(name)) return null;\r\n    return pluginLifecycle.getPluginStatus(name as NonEmptyString);\r\n  }\r\n\r\n  /**\r\n   * ì‹œìŠ¤í…œ ë©”íŠ¸ë¦­ìŠ¤ ì¡°íšŒ\r\n   */\r\n  getSystemMetrics() {\r\n    return pluginLifecycle.getSystemMetrics();\r\n  }\r\n\r\n  /**\r\n   * í”ŒëŸ¬ê·¸ì¸ ì„¤ì • ì—…ë°ì´íŠ¸\r\n   */\r\n  async updatePluginConfig(\r\n    name: string, \r\n    config: Record<string, unknown>\r\n  ): Promise<Result<void>> {\r\n    if (!isNonEmptyString(name)) {\r\n      return Err(new Error('Plugin name must be non-empty'));\r\n    }\r\n\r\n    const pluginName = name as NonEmptyString;\r\n    \r\n    // ì„¤ì • ì—…ë°ì´íŠ¸\r\n    const updateResult = pluginConfig.updatePluginConfig(name, { config });\r\n    if (!updateResult.success) {\r\n      return updateResult;\r\n    }\r\n\r\n    // ë¡œë“œëœ í”ŒëŸ¬ê·¸ì¸ì´ ìˆìœ¼ë©´ ì„¤ì • ì ìš©\r\n    const loadedPlugins = pluginLifecycle.getLoadedPlugins();\r\n    const loadedPlugin = loadedPlugins.get(pluginName);\r\n    \r\n    if (loadedPlugin?.instance) {\r\n      const configUpdateResult = await loadedPlugin.instance.updateConfig(config);\r\n      if (!configUpdateResult.success) {\r\n        return Err(configUpdateResult.error);\r\n      }\r\n    }\r\n\r\n    // ì„¤ì • ì €ì¥\r\n    pluginConfig.saveToStorage();\r\n\r\n    return Ok(undefined);\r\n  }\r\n\r\n  /**\r\n   * í”ŒëŸ¬ê·¸ì¸ ì„¤ì • ë‚´ë³´ë‚´ê¸°\r\n   */\r\n  exportConfig(): string {\r\n    return pluginConfig.exportConfig();\r\n  }\r\n\r\n  /**\r\n   * í”ŒëŸ¬ê·¸ì¸ ì„¤ì • ê°€ì ¸ì˜¤ê¸°\r\n   */\r\n  async importConfig(configJson: string): Promise<Result<void>> {\r\n    const importResult = pluginConfig.importConfig(configJson);\r\n    if (!importResult.success) {\r\n      return importResult;\r\n    }\r\n\r\n    // ì„¤ì • ì €ì¥\r\n    pluginConfig.saveToStorage();\r\n\r\n    // ë³€ê²½ëœ ì„¤ì •ì— ë”°ë¼ í”ŒëŸ¬ê·¸ì¸ ì¬ë¡œë“œ\r\n    await this.reloadAllPlugins();\r\n\r\n    return Ok(undefined);\r\n  }\r\n\r\n  /**\r\n   * ëª¨ë“  í”ŒëŸ¬ê·¸ì¸ ì¬ë¡œë“œ\r\n   */\r\n  private async reloadAllPlugins(): Promise<void> {\r\n    // ëª¨ë“  í”ŒëŸ¬ê·¸ì¸ ì–¸ë¡œë“œ\r\n    await pluginLifecycle.unloadAllPlugins();\r\n    \r\n    // ìë™ ë¡œë“œ í”ŒëŸ¬ê·¸ì¸ë“¤ ë‹¤ì‹œ ë¡œë“œ\r\n    await this.autoLoadPlugins();\r\n  }\r\n\r\n  /**\r\n   * íŠ¹ì • íƒ€ì…ì˜ í”ŒëŸ¬ê·¸ì¸ë“¤ ê²€ìƒ‰\r\n   */\r\n  getPluginsByType(type: string): readonly PluginInfo[] {\r\n    if (!isNonEmptyString(type)) return [];\r\n    \r\n    const pluginNames = pluginRegistry.getPluginsByType(type as NonEmptyString);\r\n    return this.getAllPlugins().filter(plugin => \r\n      pluginNames.includes(plugin.name)\r\n    );\r\n  }\r\n\r\n  /**\r\n   * í”ŒëŸ¬ê·¸ì¸ì´ ì‚¬ìš© ê°€ëŠ¥í•œì§€ í™•ì¸\r\n   */\r\n  isPluginAvailable(name: string): boolean {\r\n    if (!isNonEmptyString(name)) return false;\r\n    \r\n    const config = pluginConfig.getPluginConfig(name);\r\n    const status = pluginLifecycle.getPluginStatus(name as NonEmptyString);\r\n    \r\n    return config?.enabled === true && status === 'ready';\r\n  }\r\n\r\n  /**\r\n   * ì‹œìŠ¤í…œ ì¢…ë£Œ ì‹œ ì •ë¦¬\r\n   */\r\n  async dispose(): Promise<Result<void>> {\r\n    console.log('ğŸ”Œ Shutting down Plugin System...');\r\n    \r\n    try {\r\n      // ì„¤ì • ì €ì¥\r\n      pluginConfig.saveToStorage();\r\n      \r\n      // ëª¨ë“  í”ŒëŸ¬ê·¸ì¸ ì •ë¦¬\r\n      const result = await pluginLifecycle.dispose();\r\n      \r\n      this.initialized = false;\r\n      console.log('âœ… Plugin System shut down successfully');\r\n      \r\n      return result;\r\n    } catch (error) {\r\n      console.error('âŒ Plugin System shutdown failed:', error);\r\n      return Err(error as Error);\r\n    }\r\n  }\r\n}\r\n\r\n// ì „ì—­ í”ŒëŸ¬ê·¸ì¸ ë§¤ë‹ˆì € ì¸ìŠ¤í„´ìŠ¤\r\nexport const pluginManager = PluginManager.getInstance();\r\n\r\n// í¸ì˜ í•¨ìˆ˜ë“¤\r\nexport const getSpeechPlugin = () => pluginManager.getSpeechPlugin();\r\nexport const getSpeedTrainingPlugin = () => pluginManager.getSpeedTrainingPlugin();\r\nexport const getPerformancePlugin = () => pluginManager.getPerformancePlugin();\r\nexport const getPlugin = <T extends IPlugin>(name: string) => pluginManager.getPlugin<T>(name);\r\nexport const isPluginAvailable = (name: string) => pluginManager.isPluginAvailable(name);","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\plugins\\config\\PluginConfig.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'NonEmptyString' is defined but never used. Allowed unused vars must match /^_/u.","line":6,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":24}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * í”ŒëŸ¬ê·¸ì¸ ì„¤ì • ê´€ë¦¬ ì‹œìŠ¤í…œ\r\n * @description ì„¤ì • ê¸°ë°˜ í”ŒëŸ¬ê·¸ì¸ í™œì„±í™”/ë¹„í™œì„±í™” ë° êµ¬ì„± ê´€ë¦¬\r\n */\r\n\r\nimport { NonEmptyString, Result, Ok, Err, isNonEmptyString } from '@/types/core';\r\n\r\n// í”ŒëŸ¬ê·¸ì¸ ì„¤ì • íƒ€ì…\r\nexport interface PluginConfigEntry {\r\n  readonly enabled: boolean;\r\n  readonly implementation: string;\r\n  readonly config: Record<string, unknown>;\r\n  readonly priority?: number;\r\n  readonly loadOnDemand?: boolean;\r\n}\r\n\r\n// ì „ì—­ í”ŒëŸ¬ê·¸ì¸ ì„¤ì •\r\nexport interface GlobalPluginConfig {\r\n  readonly plugins: Record<string, PluginConfigEntry>;\r\n  readonly environment: 'development' | 'production' | 'test';\r\n  readonly features: {\r\n    readonly autoLoad: boolean;\r\n    readonly lazyLoading: boolean;\r\n    readonly hotReload: boolean;\r\n    readonly debugging: boolean;\r\n  };\r\n  readonly performance: {\r\n    readonly maxConcurrentLoads: number;\r\n    readonly loadTimeoutMs: number;\r\n    readonly enableMetrics: boolean;\r\n  };\r\n}\r\n\r\n// ê¸°ë³¸ ì„¤ì •\r\nconst DEFAULT_CONFIG: GlobalPluginConfig = {\r\n  plugins: {\r\n    speech: {\r\n      enabled: true,\r\n      implementation: 'web',\r\n      config: {\r\n        recognitionLanguage: 'ko-KR',\r\n        synthesisLanguage: 'ko-KR',\r\n        speechRate: 1.0,\r\n        enableContinuous: false,\r\n        enableInterimResults: true,\r\n        autoRestart: false\r\n      },\r\n      priority: 1,\r\n      loadOnDemand: false\r\n    },\r\n    audioProcessor: {\r\n      enabled: true,\r\n      implementation: 'advanced',\r\n      config: {\r\n        sampleRate: 44100,\r\n        bufferSize: 2048,\r\n        enableNoiseReduction: true,\r\n        enableEcho: false\r\n      },\r\n      priority: 2,\r\n      loadOnDemand: true\r\n    },\r\n    analytics: {\r\n      enabled: false, // ê¸°ë³¸ì ìœ¼ë¡œ ë¹„í™œì„±í™”\r\n      implementation: 'google',\r\n      config: {\r\n        trackingId: '',\r\n        anonymizeIp: true,\r\n        enableEvents: true\r\n      },\r\n      priority: 10,\r\n      loadOnDemand: true\r\n    }\r\n  },\r\n  environment: 'development',\r\n  features: {\r\n    autoLoad: true,\r\n    lazyLoading: true,\r\n    hotReload: false, // ê°œë°œ í™˜ê²½ì—ì„œë§Œ true\r\n    debugging: true\r\n  },\r\n  performance: {\r\n    maxConcurrentLoads: 3,\r\n    loadTimeoutMs: 10000,\r\n    enableMetrics: false\r\n  }\r\n};\r\n\r\n// í™˜ê²½ë³„ ì„¤ì • ì˜¤ë²„ë¼ì´ë“œ\r\nconst ENVIRONMENT_OVERRIDES: Record<string, Partial<GlobalPluginConfig>> = {\r\n  production: {\r\n    features: {\r\n      autoLoad: true,\r\n      lazyLoading: true,\r\n      hotReload: false,\r\n      debugging: false\r\n    },\r\n    performance: {\r\n      maxConcurrentLoads: 5,\r\n      loadTimeoutMs: 5000,\r\n      enableMetrics: true\r\n    },\r\n    plugins: {\r\n      analytics: {\r\n        enabled: true,\r\n        implementation: 'google',\r\n        config: {\r\n          trackingId: import.meta.env.VITE_GA_TRACKING_ID || '',\r\n          anonymizeIp: true,\r\n          enableEvents: true\r\n        },\r\n        priority: 10,\r\n        loadOnDemand: true\r\n      }\r\n    }\r\n  },\r\n  test: {\r\n    plugins: {\r\n      speech: {\r\n        enabled: true,\r\n        implementation: 'mock',\r\n        config: {\r\n          mockResponses: true,\r\n          simulateLatency: false\r\n        },\r\n        priority: 1,\r\n        loadOnDemand: false\r\n      },\r\n      audioProcessor: {\r\n        enabled: false,\r\n        implementation: 'mock',\r\n        config: {},\r\n        priority: 2,\r\n        loadOnDemand: false\r\n      },\r\n      analytics: {\r\n        enabled: false,\r\n        implementation: 'mock',\r\n        config: {},\r\n        priority: 10,\r\n        loadOnDemand: false\r\n      }\r\n    },\r\n    features: {\r\n      autoLoad: false,\r\n      lazyLoading: false,\r\n      hotReload: false,\r\n      debugging: true\r\n    },\r\n    performance: {\r\n      maxConcurrentLoads: 1,\r\n      loadTimeoutMs: 1000,\r\n      enableMetrics: false\r\n    }\r\n  }\r\n};\r\n\r\n/**\r\n * í”ŒëŸ¬ê·¸ì¸ ì„¤ì • ë§¤ë‹ˆì €\r\n */\r\nexport class PluginConfigManager {\r\n  private static instance: PluginConfigManager;\r\n  private config: GlobalPluginConfig;\r\n  private listeners = new Set<(config: GlobalPluginConfig) => void>();\r\n\r\n  private constructor(environment?: string) {\r\n    this.config = this.buildConfig(environment);\r\n  }\r\n\r\n  static getInstance(environment?: string): PluginConfigManager {\r\n    if (!PluginConfigManager.instance) {\r\n      PluginConfigManager.instance = new PluginConfigManager(environment);\r\n    }\r\n    return PluginConfigManager.instance;\r\n  }\r\n\r\n  private buildConfig(environment?: string): GlobalPluginConfig {\r\n    const env = environment || import.meta.env.MODE || 'development';\r\n    const override = ENVIRONMENT_OVERRIDES[env] || {};\r\n    \r\n    return this.deepMerge(DEFAULT_CONFIG, override);\r\n  }\r\n\r\n  private deepMerge<T extends Record<string, any>>(target: T, source: Partial<T>): T {\r\n    const result = { ...target };\r\n    \r\n    for (const [key, value] of Object.entries(source)) {\r\n      if (value && typeof value === 'object' && !Array.isArray(value)) {\r\n        result[key as keyof T] = this.deepMerge(\r\n          result[key as keyof T] as any, \r\n          value\r\n        );\r\n      } else {\r\n        result[key as keyof T] = value;\r\n      }\r\n    }\r\n    \r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * ì „ì²´ ì„¤ì • ë°˜í™˜\r\n   */\r\n  getConfig(): GlobalPluginConfig {\r\n    return { ...this.config };\r\n  }\r\n\r\n  /**\r\n   * íŠ¹ì • í”ŒëŸ¬ê·¸ì¸ ì„¤ì • ë°˜í™˜\r\n   */\r\n  getPluginConfig(pluginName: string): PluginConfigEntry | null {\r\n    return this.config.plugins[pluginName] || null;\r\n  }\r\n\r\n  /**\r\n   * í”ŒëŸ¬ê·¸ì¸ì´ í™œì„±í™”ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸\r\n   */\r\n  isPluginEnabled(pluginName: string): boolean {\r\n    const pluginConfig = this.getPluginConfig(pluginName);\r\n    return pluginConfig?.enabled ?? false;\r\n  }\r\n\r\n  /**\r\n   * í™œì„±í™”ëœ í”ŒëŸ¬ê·¸ì¸ ëª©ë¡ ë°˜í™˜\r\n   */\r\n  getEnabledPlugins(): Array<{ name: string; config: PluginConfigEntry }> {\r\n    return Object.entries(this.config.plugins)\r\n      .filter(([_, config]) => config.enabled)\r\n      .map(([name, config]) => ({ name, config }))\r\n      .sort((a, b) => (a.config.priority || 999) - (b.config.priority || 999));\r\n  }\r\n\r\n  /**\r\n   * í”ŒëŸ¬ê·¸ì¸ êµ¬í˜„ì²´ ë°˜í™˜\r\n   */\r\n  getPluginImplementation(pluginName: string): string | null {\r\n    const pluginConfig = this.getPluginConfig(pluginName);\r\n    return pluginConfig?.implementation || null;\r\n  }\r\n\r\n  /**\r\n   * í”ŒëŸ¬ê·¸ì¸ ì„¤ì • ì—…ë°ì´íŠ¸\r\n   */\r\n  updatePluginConfig(\r\n    pluginName: string, \r\n    updates: Partial<PluginConfigEntry>\r\n  ): Result<void> {\r\n    try {\r\n      if (!isNonEmptyString(pluginName)) {\r\n        return Err(new Error('Plugin name must be a non-empty string'));\r\n      }\r\n\r\n      const currentConfig = this.config.plugins[pluginName] || {\r\n        enabled: false,\r\n        implementation: 'default',\r\n        config: {}\r\n      };\r\n\r\n      this.config = {\r\n        ...this.config,\r\n        plugins: {\r\n          ...this.config.plugins,\r\n          [pluginName]: {\r\n            ...currentConfig,\r\n            ...updates,\r\n            config: {\r\n              ...currentConfig.config,\r\n              ...(updates.config || {})\r\n            }\r\n          }\r\n        }\r\n      };\r\n\r\n      this.notifyListeners();\r\n      return Ok(undefined);\r\n    } catch (error) {\r\n      return Err(error as Error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * í”ŒëŸ¬ê·¸ì¸ í™œì„±í™”/ë¹„í™œì„±í™”\r\n   */\r\n  setPluginEnabled(pluginName: string, enabled: boolean): Result<void> {\r\n    return this.updatePluginConfig(pluginName, { enabled });\r\n  }\r\n\r\n  /**\r\n   * í”ŒëŸ¬ê·¸ì¸ êµ¬í˜„ì²´ ë³€ê²½\r\n   */\r\n  setPluginImplementation(\r\n    pluginName: string, \r\n    implementation: string\r\n  ): Result<void> {\r\n    return this.updatePluginConfig(pluginName, { implementation });\r\n  }\r\n\r\n  /**\r\n   * í™˜ê²½ ì„¤ì • ë°˜í™˜\r\n   */\r\n  getEnvironment(): string {\r\n    return this.config.environment;\r\n  }\r\n\r\n  /**\r\n   * ê¸°ëŠ¥ ì„¤ì • ë°˜í™˜\r\n   */\r\n  getFeatures(): GlobalPluginConfig['features'] {\r\n    return { ...this.config.features };\r\n  }\r\n\r\n  /**\r\n   * ì„±ëŠ¥ ì„¤ì • ë°˜í™˜\r\n   */\r\n  getPerformanceConfig(): GlobalPluginConfig['performance'] {\r\n    return { ...this.config.performance };\r\n  }\r\n\r\n  /**\r\n   * ì„¤ì • ë³€ê²½ ë¦¬ìŠ¤ë„ˆ ë“±ë¡\r\n   */\r\n  addChangeListener(listener: (config: GlobalPluginConfig) => void): void {\r\n    this.listeners.add(listener);\r\n  }\r\n\r\n  /**\r\n   * ì„¤ì • ë³€ê²½ ë¦¬ìŠ¤ë„ˆ ì œê±°\r\n   */\r\n  removeChangeListener(listener: (config: GlobalPluginConfig) => void): void {\r\n    this.listeners.delete(listener);\r\n  }\r\n\r\n  /**\r\n   * ë¦¬ìŠ¤ë„ˆë“¤ì—ê²Œ ë³€ê²½ ì•Œë¦¼\r\n   */\r\n  private notifyListeners(): void {\r\n    this.listeners.forEach(listener => {\r\n      try {\r\n        listener(this.getConfig());\r\n      } catch (error) {\r\n        console.error('Plugin config listener error:', error);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * ì„¤ì •ì„ JSONìœ¼ë¡œ ë‚´ë³´ë‚´ê¸°\r\n   */\r\n  exportConfig(): string {\r\n    return JSON.stringify(this.config, null, 2);\r\n  }\r\n\r\n  /**\r\n   * JSONì—ì„œ ì„¤ì • ê°€ì ¸ì˜¤ê¸°\r\n   */\r\n  importConfig(configJson: string): Result<void> {\r\n    try {\r\n      const importedConfig = JSON.parse(configJson);\r\n      \r\n      // ê¸°ë³¸ êµ¬ì¡° ê²€ì¦\r\n      if (!importedConfig.plugins || typeof importedConfig.plugins !== 'object') {\r\n        return Err(new Error('Invalid config format: missing plugins'));\r\n      }\r\n\r\n      this.config = this.deepMerge(DEFAULT_CONFIG, importedConfig);\r\n      this.notifyListeners();\r\n      \r\n      return Ok(undefined);\r\n    } catch (error) {\r\n      return Err(new Error(`Failed to import config: ${error}`));\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì„¤ì • ì €ì¥\r\n   */\r\n  saveToStorage(key = 'pluginConfig'): Result<void> {\r\n    try {\r\n      const configJson = this.exportConfig();\r\n      localStorage.setItem(key, configJson);\r\n      return Ok(undefined);\r\n    } catch (error) {\r\n      return Err(new Error(`Failed to save config to storage: ${error}`));\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ì„¤ì • ë¡œë“œ\r\n   */\r\n  loadFromStorage(key = 'pluginConfig'): Result<void> {\r\n    try {\r\n      const configJson = localStorage.getItem(key);\r\n      if (!configJson) {\r\n        return Ok(undefined); // ì €ì¥ëœ ì„¤ì •ì´ ì—†ìŒ (ì •ìƒ)\r\n      }\r\n\r\n      return this.importConfig(configJson);\r\n    } catch (error) {\r\n      return Err(new Error(`Failed to load config from storage: ${error}`));\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ì„¤ì • ì´ˆê¸°í™” (ê¸°ë³¸ê°’ìœ¼ë¡œ ë³µì›)\r\n   */\r\n  reset(): void {\r\n    this.config = this.buildConfig();\r\n    this.notifyListeners();\r\n  }\r\n}\r\n\r\n// ì „ì—­ ì„¤ì • ë§¤ë‹ˆì € ì¸ìŠ¤í„´ìŠ¤\r\nexport const pluginConfig = PluginConfigManager.getInstance();","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\plugins\\core\\BasePlugin.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'config' is defined but never used. Allowed unused args must match /^_/u.","line":227,"column":34,"nodeType":null,"messageId":"unusedVar","endLine":227,"endColumn":40},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'config' is defined but never used. Allowed unused args must match /^_/u.","line":235,"column":28,"nodeType":null,"messageId":"unusedVar","endLine":235,"endColumn":34}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * ê¸°ë³¸ í”ŒëŸ¬ê·¸ì¸ ë² ì´ìŠ¤ í´ë˜ìŠ¤\r\n * @description ëª¨ë“  í”ŒëŸ¬ê·¸ì¸ì´ ìƒì†ë°›ì„ ìˆ˜ ìˆëŠ” ê¸°ë³¸ êµ¬í˜„ì²´\r\n */\r\n\r\nimport { \r\n  IPlugin, \r\n  PluginMetadata, \r\n  PluginConfig, \r\n  PluginStatus, \r\n  PluginEvent,\r\n  PluginEventHandler \r\n} from './IPlugin';\r\nimport { NonEmptyString, Result, Ok, Err } from '@/types/core';\r\n\r\n/**\r\n * ì¶”ìƒ ê¸°ë³¸ í”ŒëŸ¬ê·¸ì¸ í´ë˜ìŠ¤\r\n */\r\nexport abstract class BasePlugin implements IPlugin {\r\n  private _status: PluginStatus = 'unloaded';\r\n  private _config: PluginConfig = {};\r\n  private readonly _eventHandlers = new Map<string, Set<PluginEventHandler>>();\r\n\r\n  constructor(\r\n    public readonly metadata: PluginMetadata\r\n  ) {}\r\n\r\n  get status(): PluginStatus {\r\n    return this._status;\r\n  }\r\n\r\n  protected setStatus(status: PluginStatus): void {\r\n    if (this._status !== status) {\r\n      const previousStatus = this._status;\r\n      this._status = status;\r\n      \r\n      this.emit({\r\n        type: 'statusChange',\r\n        pluginName: this.metadata.name,\r\n        timestamp: Date.now(),\r\n        data: { \r\n          previousStatus, \r\n          newStatus: status \r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * í”ŒëŸ¬ê·¸ì¸ ì´ˆê¸°í™” - í•˜ìœ„ í´ë˜ìŠ¤ì—ì„œ êµ¬í˜„\r\n   */\r\n  async initialize(config: PluginConfig = {}): Promise<Result<void>> {\r\n    try {\r\n      this.setStatus('initializing');\r\n      \r\n      // ì„¤ì • ê²€ì¦\r\n      const configValidation = this.validateConfig(config);\r\n      if (!configValidation.success) {\r\n        this.setStatus('error');\r\n        return configValidation;\r\n      }\r\n\r\n      this._config = { ...this._config, ...config };\r\n\r\n      // í•˜ìœ„ í´ë˜ìŠ¤ì˜ ì´ˆê¸°í™” ë¡œì§ ì‹¤í–‰\r\n      const initResult = await this.onInitialize(this._config);\r\n      if (!initResult.success) {\r\n        this.setStatus('error');\r\n        return initResult;\r\n      }\r\n\r\n      this.setStatus('ready');\r\n      return Ok(undefined);\r\n    } catch (error) {\r\n      this.setStatus('error');\r\n      return Err(error as Error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * í”ŒëŸ¬ê·¸ì¸ ì •ë¦¬ - í•˜ìœ„ í´ë˜ìŠ¤ì—ì„œ êµ¬í˜„\r\n   */\r\n  async dispose(): Promise<Result<void>> {\r\n    try {\r\n      this.setStatus('disposing');\r\n      \r\n      const disposeResult = await this.onDispose();\r\n      if (!disposeResult.success) {\r\n        return disposeResult;\r\n      }\r\n\r\n      // ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì •ë¦¬\r\n      this._eventHandlers.clear();\r\n      \r\n      this.setStatus('unloaded');\r\n      return Ok(undefined);\r\n    } catch (error) {\r\n      this.setStatus('error');\r\n      return Err(error as Error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ì„¤ì • ì—…ë°ì´íŠ¸\r\n   */\r\n  async updateConfig(config: Partial<PluginConfig>): Promise<Result<void>> {\r\n    try {\r\n      const newConfig = { ...this._config, ...config };\r\n      \r\n      const configValidation = this.validateConfig(newConfig);\r\n      if (!configValidation.success) {\r\n        return configValidation;\r\n      }\r\n\r\n      const updateResult = await this.onConfigUpdate(newConfig);\r\n      if (!updateResult.success) {\r\n        return updateResult;\r\n      }\r\n\r\n      this._config = newConfig;\r\n      \r\n      this.emit({\r\n        type: 'configChange',\r\n        pluginName: this.metadata.name,\r\n        timestamp: Date.now(),\r\n        data: { config: newConfig }\r\n      });\r\n\r\n      return Ok(undefined);\r\n    } catch (error) {\r\n      return Err(error as Error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * í˜„ì¬ ì„¤ì • ë°˜í™˜\r\n   */\r\n  getConfig(): PluginConfig {\r\n    return { ...this._config };\r\n  }\r\n\r\n  /**\r\n   * í˜¸í™˜ì„± ê²€ì‚¬ - ê¸°ë³¸ êµ¬í˜„\r\n   */\r\n  isCompatible(systemVersion: NonEmptyString): boolean {\r\n    const { minSystemVersion } = this.metadata;\r\n    if (!minSystemVersion) return true;\r\n\r\n    // ê°„ë‹¨í•œ ë²„ì „ ë¹„êµ (semver ë°©ì‹)\r\n    const parseVersion = (version: string) => \r\n      version.split('.').map(n => parseInt(n, 10));\r\n    \r\n    try {\r\n      const minVer = parseVersion(minSystemVersion);\r\n      const sysVer = parseVersion(systemVersion);\r\n      \r\n      for (let i = 0; i < Math.max(minVer.length, sysVer.length); i++) {\r\n        const minPart = minVer[i] || 0;\r\n        const sysPart = sysVer[i] || 0;\r\n        \r\n        if (sysPart < minPart) return false;\r\n        if (sysPart > minPart) return true;\r\n      }\r\n      \r\n      return true;\r\n    } catch {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ë“±ë¡\r\n   */\r\n  on(event: string, handler: PluginEventHandler): void {\r\n    if (!this._eventHandlers.has(event)) {\r\n      this._eventHandlers.set(event, new Set());\r\n    }\r\n    this._eventHandlers.get(event)!.add(handler);\r\n  }\r\n\r\n  /**\r\n   * ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì œê±°\r\n   */\r\n  off(event: string, handler: PluginEventHandler): void {\r\n    const handlers = this._eventHandlers.get(event);\r\n    if (handlers) {\r\n      handlers.delete(handler);\r\n      if (handlers.size === 0) {\r\n        this._eventHandlers.delete(event);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ì´ë²¤íŠ¸ ë°œìƒ\r\n   */\r\n  emit(event: PluginEvent): void {\r\n    const handlers = this._eventHandlers.get(event.type);\r\n    if (handlers) {\r\n      handlers.forEach(handler => {\r\n        try {\r\n          handler(event);\r\n        } catch (error) {\r\n          console.error(`Plugin ${this.metadata.name} event handler error:`, error);\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ë³´í˜¸ëœ ë©”ì„œë“œë“¤ - í•˜ìœ„ í´ë˜ìŠ¤ì—ì„œ êµ¬í˜„\r\n   */\r\n  \r\n  /**\r\n   * ì´ˆê¸°í™” ë¡œì§ êµ¬í˜„\r\n   */\r\n  protected abstract onInitialize(config: PluginConfig): Promise<Result<void>>;\r\n\r\n  /**\r\n   * ì •ë¦¬ ë¡œì§ êµ¬í˜„\r\n   */\r\n  protected abstract onDispose(): Promise<Result<void>>;\r\n\r\n  /**\r\n   * ì„¤ì • ì—…ë°ì´íŠ¸ ë¡œì§ êµ¬í˜„\r\n   */\r\n  protected async onConfigUpdate(config: PluginConfig): Promise<Result<void>> {\r\n    // ê¸°ë³¸ì ìœ¼ë¡œëŠ” ì•„ë¬´ê²ƒë„ í•˜ì§€ ì•ŠìŒ - í•„ìš”ì‹œ ì˜¤ë²„ë¼ì´ë“œ\r\n    return Ok(undefined);\r\n  }\r\n\r\n  /**\r\n   * ì„¤ì • ê²€ì¦ ë¡œì§ - í•˜ìœ„ í´ë˜ìŠ¤ì—ì„œ ì˜¤ë²„ë¼ì´ë“œ ê°€ëŠ¥\r\n   */\r\n  protected validateConfig(config: PluginConfig): Result<void> {\r\n    // ê¸°ë³¸ì ìœ¼ë¡œëŠ” í•­ìƒ ì„±ê³µ - í•„ìš”ì‹œ ì˜¤ë²„ë¼ì´ë“œ\r\n    return Ok(undefined);\r\n  }\r\n\r\n  /**\r\n   * ìœ í‹¸ë¦¬í‹° ë©”ì„œë“œë“¤\r\n   */\r\n  \r\n  /**\r\n   * ì•ˆì „í•œ ë¹„ë™ê¸° ì‘ì—… ì‹¤í–‰\r\n   */\r\n  protected async safeAsync<T>(\r\n    operation: () => Promise<T>,\r\n    errorMessage?: string\r\n  ): Promise<Result<T>> {\r\n    try {\r\n      const result = await operation();\r\n      return Ok(result);\r\n    } catch (error) {\r\n      const message = errorMessage || 'Plugin operation failed';\r\n      console.error(`${this.metadata.name}: ${message}`, error);\r\n      return Err(error as Error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ì˜ì¡´ì„± ê²€ì‚¬\r\n   */\r\n  protected checkDependencies(availablePlugins: readonly string[]): Result<void> {\r\n    const { dependencies = [] } = this.metadata;\r\n    \r\n    const missingDeps = dependencies.filter(dep => \r\n      !availablePlugins.includes(dep)\r\n    );\r\n\r\n    if (missingDeps.length > 0) {\r\n      return Err(new Error(\r\n        `Missing dependencies: ${missingDeps.join(', ')}`\r\n      ));\r\n    }\r\n\r\n    return Ok(undefined);\r\n  }\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\plugins\\core\\IPlugin.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\plugins\\core\\PluginLifecycleManager.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'PluginEvent' is defined but never used. Allowed unused vars must match /^_/u.","line":10,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'PluginEventHandler' is defined but never used. Allowed unused vars must match /^_/u.","line":11,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isNonEmptyString' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":43,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":59},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'newConfig' is defined but never used. Allowed unused args must match /^_/u.","line":476,"column":33,"nodeType":null,"messageId":"unusedVar","endLine":476,"endColumn":42}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * í”ŒëŸ¬ê·¸ì¸ ë¼ì´í”„ì‚¬ì´í´ ë§¤ë‹ˆì €\r\n * @description í”ŒëŸ¬ê·¸ì¸ì˜ ì „ì²´ ë¼ì´í”„ì‚¬ì´í´ì„ ê´€ë¦¬ (ë¡œë“œ, ì´ˆê¸°í™”, ì‹¤í–‰, ì •ë¦¬)\r\n */\r\n\r\nimport { \r\n  IPlugin, \r\n  IPluginFactory, \r\n  PluginStatus, \r\n  PluginEvent,\r\n  PluginEventHandler \r\n} from './IPlugin';\r\nimport { pluginRegistry } from './PluginRegistry';\r\nimport { pluginConfig, PluginConfigEntry } from '@/plugins/config/PluginConfig';\r\nimport { NonEmptyString, Result, Ok, Err, isNonEmptyString } from '@/types/core';\r\n\r\n// ë¼ì´í”„ì‚¬ì´í´ ì´ë²¤íŠ¸\r\ninterface LifecycleEvent {\r\n  readonly type: 'load' | 'initialize' | 'start' | 'stop' | 'error' | 'metrics';\r\n  readonly pluginName: NonEmptyString;\r\n  readonly timestamp: number;\r\n  readonly data?: unknown;\r\n}\r\n\r\ntype LifecycleEventHandler = (event: LifecycleEvent) => void;\r\n\r\n// í”ŒëŸ¬ê·¸ì¸ ë©”íŠ¸ë¦­ìŠ¤\r\ninterface PluginMetrics {\r\n  readonly loadTime: number;\r\n  readonly initTime: number;\r\n  readonly errorCount: number;\r\n  readonly restartCount: number;\r\n  readonly lastActivity: number;\r\n  readonly memoryUsage?: number;\r\n}\r\n\r\n// ë¡œë“œëœ í”ŒëŸ¬ê·¸ì¸ ì •ë³´\r\ninterface LoadedPluginInfo {\r\n  readonly factory: IPluginFactory;\r\n  readonly instance?: IPlugin;\r\n  readonly status: PluginStatus;\r\n  readonly config: PluginConfigEntry;\r\n  readonly metrics: PluginMetrics;\r\n  readonly dependencies: readonly string[];\r\n  readonly dependents: readonly string[];\r\n}\r\n\r\n/**\r\n * í”ŒëŸ¬ê·¸ì¸ ë¼ì´í”„ì‚¬ì´í´ ë§¤ë‹ˆì €\r\n */\r\nexport class PluginLifecycleManager {\r\n  private static instance: PluginLifecycleManager;\r\n  \r\n  private readonly loadedPlugins = new Map<NonEmptyString, LoadedPluginInfo>();\r\n  private readonly loadPromises = new Map<NonEmptyString, Promise<Result<IPlugin>>>();\r\n  private readonly lifecycleHandlers = new Set<LifecycleEventHandler>();\r\n  \r\n  private readonly maxConcurrentLoads: number;\r\n  private readonly loadTimeoutMs: number;\r\n  private currentConcurrentLoads = 0;\r\n  \r\n  private constructor() {\r\n    const performanceConfig = pluginConfig.getPerformanceConfig();\r\n    this.maxConcurrentLoads = performanceConfig.maxConcurrentLoads;\r\n    this.loadTimeoutMs = performanceConfig.loadTimeoutMs;\r\n    \r\n    // ì„¤ì • ë³€ê²½ ê°ì§€\r\n    pluginConfig.addChangeListener(this.onConfigChange.bind(this));\r\n  }\r\n\r\n  static getInstance(): PluginLifecycleManager {\r\n    if (!PluginLifecycleManager.instance) {\r\n      PluginLifecycleManager.instance = new PluginLifecycleManager();\r\n    }\r\n    return PluginLifecycleManager.instance;\r\n  }\r\n\r\n  /**\r\n   * í”ŒëŸ¬ê·¸ì¸ íŒ©í† ë¦¬ ë“±ë¡ ë° ìë™ ë¡œë“œ\r\n   */\r\n  async registerPlugin<T extends IPlugin>(\r\n    name: NonEmptyString,\r\n    factory: IPluginFactory<T>\r\n  ): Promise<Result<void>> {\r\n    try {\r\n      // ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— ë“±ë¡\r\n      const registerResult = pluginRegistry.register(name, factory);\r\n      if (!registerResult.success) {\r\n        return registerResult;\r\n      }\r\n\r\n      // ì„¤ì • í™•ì¸í•˜ì—¬ ìë™ ë¡œë“œ ì—¬ë¶€ ê²°ì •\r\n      const config = pluginConfig.getPluginConfig(name);\r\n      if (config?.enabled && !config.loadOnDemand) {\r\n        const loadResult = await this.loadPlugin(name);\r\n        if (!loadResult.success) {\r\n          console.warn(`Failed to auto-load plugin ${name}:`, loadResult.error);\r\n        }\r\n      }\r\n\r\n      this.emitLifecycleEvent({\r\n        type: 'load',\r\n        pluginName: name,\r\n        timestamp: Date.now(),\r\n        data: { action: 'registered' }\r\n      });\r\n\r\n      return Ok(undefined);\r\n    } catch (error) {\r\n      return Err(error as Error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * í”ŒëŸ¬ê·¸ì¸ ë¡œë“œ (íŒ©í† ë¦¬ì—ì„œ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±)\r\n   */\r\n  async loadPlugin(name: NonEmptyString): Promise<Result<IPlugin>> {\r\n    // ì´ë¯¸ ë¡œë“œ ì¤‘ì´ë©´ ê¸°ì¡´ Promise ë°˜í™˜\r\n    if (this.loadPromises.has(name)) {\r\n      return this.loadPromises.get(name)!;\r\n    }\r\n\r\n    // ë™ì‹œ ë¡œë“œ ì œí•œ\r\n    if (this.currentConcurrentLoads >= this.maxConcurrentLoads) {\r\n      return Err(new Error('Maximum concurrent plugin loads exceeded'));\r\n    }\r\n\r\n    const loadPromise = this.performLoad(name);\r\n    this.loadPromises.set(name, loadPromise);\r\n    \r\n    try {\r\n      const result = await loadPromise;\r\n      return result;\r\n    } finally {\r\n      this.loadPromises.delete(name);\r\n    }\r\n  }\r\n\r\n  private async performLoad(name: NonEmptyString): Promise<Result<IPlugin>> {\r\n    const startTime = Date.now();\r\n    this.currentConcurrentLoads++;\r\n\r\n    try {\r\n      // ì„¤ì • í™•ì¸\r\n      const config = pluginConfig.getPluginConfig(name);\r\n      if (!config?.enabled) {\r\n        return Err(new Error(`Plugin ${name} is not enabled`));\r\n      }\r\n\r\n      // ì˜ì¡´ì„± í™•ì¸\r\n      const dependencyCheck = await this.checkAndLoadDependencies(name);\r\n      if (!dependencyCheck.success) {\r\n        return dependencyCheck;\r\n      }\r\n\r\n      // íƒ€ì„ì•„ì›ƒ ì„¤ì •\r\n      const timeoutPromise = new Promise<Result<IPlugin>>((_, reject) => {\r\n        setTimeout(() => {\r\n          reject(new Error(`Plugin ${name} load timeout`));\r\n        }, this.loadTimeoutMs);\r\n      });\r\n\r\n      // ì‹¤ì œ ë¡œë“œ ì‘ì—…\r\n      const loadPromise = this.doLoad(name, config);\r\n      \r\n      const result = await Promise.race([loadPromise, timeoutPromise]);\r\n      \r\n      if (result.success) {\r\n        const loadTime = Date.now() - startTime;\r\n        this.updatePluginInfo(name, {\r\n          instance: result.data,\r\n          status: result.data.status,\r\n          metrics: {\r\n            ...this.getPluginMetrics(name),\r\n            loadTime,\r\n            lastActivity: Date.now()\r\n          }\r\n        });\r\n\r\n        this.emitLifecycleEvent({\r\n          type: 'load',\r\n          pluginName: name,\r\n          timestamp: Date.now(),\r\n          data: { \r\n            action: 'loaded', \r\n            loadTime,\r\n            status: result.data.status \r\n          }\r\n        });\r\n      }\r\n\r\n      return result;\r\n    } catch (error) {\r\n      this.emitLifecycleEvent({\r\n        type: 'error',\r\n        pluginName: name,\r\n        timestamp: Date.now(),\r\n        data: { \r\n          action: 'load', \r\n          error: error instanceof Error ? error.message : String(error) \r\n        }\r\n      });\r\n      \r\n      return Err(error as Error);\r\n    } finally {\r\n      this.currentConcurrentLoads--;\r\n    }\r\n  }\r\n\r\n  private async doLoad(\r\n    name: NonEmptyString, \r\n    config: PluginConfigEntry\r\n  ): Promise<Result<IPlugin>> {\r\n    // ë ˆì§€ìŠ¤íŠ¸ë¦¬ì—ì„œ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±\r\n    const instanceResult = await pluginRegistry.getInstance(name, config.config);\r\n    if (!instanceResult.success) {\r\n      return instanceResult;\r\n    }\r\n\r\n    const instance = instanceResult.data;\r\n\r\n    // í”ŒëŸ¬ê·¸ì¸ ì •ë³´ ì—…ë°ì´íŠ¸\r\n    const factory = this.getRegisteredFactory(name);\r\n    if (factory) {\r\n      const metrics: PluginMetrics = {\r\n        loadTime: 0, // ë‚˜ì¤‘ì— ì—…ë°ì´íŠ¸ë¨\r\n        initTime: 0,\r\n        errorCount: 0,\r\n        restartCount: 0,\r\n        lastActivity: Date.now()\r\n      };\r\n\r\n      this.loadedPlugins.set(name, {\r\n        factory,\r\n        instance,\r\n        status: instance.status,\r\n        config,\r\n        metrics,\r\n        dependencies: [],\r\n        dependents: []\r\n      });\r\n    }\r\n\r\n    return Ok(instance);\r\n  }\r\n\r\n  /**\r\n   * í”ŒëŸ¬ê·¸ì¸ ì–¸ë¡œë“œ\r\n   */\r\n  async unloadPlugin(name: NonEmptyString): Promise<Result<void>> {\r\n    try {\r\n      const pluginInfo = this.loadedPlugins.get(name);\r\n      if (!pluginInfo?.instance) {\r\n        return Ok(undefined); // ì´ë¯¸ ì–¸ë¡œë“œë¨\r\n      }\r\n\r\n      // ì˜ì¡´í•˜ëŠ” í”ŒëŸ¬ê·¸ì¸ë“¤ ë¨¼ì € ì–¸ë¡œë“œ\r\n      for (const dependentName of pluginInfo.dependents) {\r\n        await this.unloadPlugin(dependentName as NonEmptyString);\r\n      }\r\n\r\n      // í”ŒëŸ¬ê·¸ì¸ ì •ë¦¬\r\n      const disposeResult = await pluginInfo.instance.dispose();\r\n      if (!disposeResult.success) {\r\n        return disposeResult;\r\n      }\r\n\r\n      // ì •ë³´ ì œê±°\r\n      this.loadedPlugins.delete(name);\r\n\r\n      // ë ˆì§€ìŠ¤íŠ¸ë¦¬ì—ì„œ ì œê±°\r\n      await pluginRegistry.unregister(name);\r\n\r\n      this.emitLifecycleEvent({\r\n        type: 'stop',\r\n        pluginName: name,\r\n        timestamp: Date.now(),\r\n        data: { action: 'unloaded' }\r\n      });\r\n\r\n      return Ok(undefined);\r\n    } catch (error) {\r\n      return Err(error as Error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ëª¨ë“  í™œì„± í”ŒëŸ¬ê·¸ì¸ ì–¸ë¡œë“œ\r\n   */\r\n  async unloadAllPlugins(): Promise<Result<void>> {\r\n    try {\r\n      const loadedNames = Array.from(this.loadedPlugins.keys());\r\n      \r\n      // ì˜ì¡´ì„± ìˆœì„œë¥¼ ê³ ë ¤í•˜ì—¬ ì—­ìˆœìœ¼ë¡œ ì–¸ë¡œë“œ\r\n      const sortedNames = this.sortPluginsByDependencies(loadedNames).reverse();\r\n      \r\n      for (const name of sortedNames) {\r\n        const result = await this.unloadPlugin(name);\r\n        if (!result.success) {\r\n          console.error(`Failed to unload plugin ${name}:`, result.error);\r\n        }\r\n      }\r\n\r\n      return Ok(undefined);\r\n    } catch (error) {\r\n      return Err(error as Error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * í”ŒëŸ¬ê·¸ì¸ ì¬ì‹œì‘\r\n   */\r\n  async restartPlugin(name: NonEmptyString): Promise<Result<IPlugin>> {\r\n    try {\r\n      // ì–¸ë¡œë“œ\r\n      const unloadResult = await this.unloadPlugin(name);\r\n      if (!unloadResult.success) {\r\n        return Err(unloadResult.error);\r\n      }\r\n\r\n      // ì¬ì‹œì‘ ì¹´ìš´íŠ¸ ì¦ê°€\r\n      const metrics = this.getPluginMetrics(name);\r\n      this.updatePluginMetrics(name, {\r\n        ...metrics,\r\n        restartCount: metrics.restartCount + 1\r\n      });\r\n\r\n      // ë‹¤ì‹œ ë¡œë“œ\r\n      const loadResult = await this.loadPlugin(name);\r\n      \r\n      this.emitLifecycleEvent({\r\n        type: 'start',\r\n        pluginName: name,\r\n        timestamp: Date.now(),\r\n        data: { action: 'restarted' }\r\n      });\r\n\r\n      return loadResult;\r\n    } catch (error) {\r\n      return Err(error as Error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * í”ŒëŸ¬ê·¸ì¸ ìƒíƒœ ì¡°íšŒ\r\n   */\r\n  getPluginStatus(name: NonEmptyString): PluginStatus | null {\r\n    const pluginInfo = this.loadedPlugins.get(name);\r\n    return pluginInfo?.status || null;\r\n  }\r\n\r\n  /**\r\n   * ë¡œë“œëœ ëª¨ë“  í”ŒëŸ¬ê·¸ì¸ ì¡°íšŒ\r\n   */\r\n  getLoadedPlugins(): ReadonlyMap<NonEmptyString, LoadedPluginInfo> {\r\n    return new Map(this.loadedPlugins);\r\n  }\r\n\r\n  /**\r\n   * í”ŒëŸ¬ê·¸ì¸ ë©”íŠ¸ë¦­ìŠ¤ ì¡°íšŒ\r\n   */\r\n  getPluginMetrics(name: NonEmptyString): PluginMetrics {\r\n    const pluginInfo = this.loadedPlugins.get(name);\r\n    return pluginInfo?.metrics || {\r\n      loadTime: 0,\r\n      initTime: 0,\r\n      errorCount: 0,\r\n      restartCount: 0,\r\n      lastActivity: 0\r\n    };\r\n  }\r\n\r\n  /**\r\n   * ì „ì²´ ì‹œìŠ¤í…œ ë©”íŠ¸ë¦­ìŠ¤ ì¡°íšŒ\r\n   */\r\n  getSystemMetrics(): {\r\n    totalPlugins: number;\r\n    loadedPlugins: number;\r\n    errorCount: number;\r\n    averageLoadTime: number;\r\n    memoryUsage: number;\r\n  } {\r\n    const loaded = Array.from(this.loadedPlugins.values());\r\n    const totalErrors = loaded.reduce((sum, info) => sum + info.metrics.errorCount, 0);\r\n    const avgLoadTime = loaded.length > 0 \r\n      ? loaded.reduce((sum, info) => sum + info.metrics.loadTime, 0) / loaded.length \r\n      : 0;\r\n\r\n    return {\r\n      totalPlugins: pluginRegistry.getRegisteredPlugins().length,\r\n      loadedPlugins: loaded.length,\r\n      errorCount: totalErrors,\r\n      averageLoadTime: avgLoadTime,\r\n      memoryUsage: this.estimateMemoryUsage()\r\n    };\r\n  }\r\n\r\n  /**\r\n   * ì˜ì¡´ì„± í™•ì¸ ë° ë¡œë“œ\r\n   */\r\n  private async checkAndLoadDependencies(name: NonEmptyString): Promise<Result<void>> {\r\n    const factory = this.getRegisteredFactory(name);\r\n    if (!factory) {\r\n      return Err(new Error(`Plugin factory ${name} not found`));\r\n    }\r\n\r\n    // ì˜ì¡´ì„± ì •ë³´ê°€ ë©”íƒ€ë°ì´í„°ì— ìˆë‹¤ë©´ í™•ì¸\r\n    const metadata = (factory as any).metadata;\r\n    const dependencies = metadata?.dependencies || [];\r\n\r\n    for (const depName of dependencies) {\r\n      if (!this.isPluginLoaded(depName as NonEmptyString)) {\r\n        const loadResult = await this.loadPlugin(depName as NonEmptyString);\r\n        if (!loadResult.success) {\r\n          return Err(new Error(`Failed to load dependency ${depName}: ${loadResult.error}`));\r\n        }\r\n      }\r\n    }\r\n\r\n    return Ok(undefined);\r\n  }\r\n\r\n  private isPluginLoaded(name: NonEmptyString): boolean {\r\n    const pluginInfo = this.loadedPlugins.get(name);\r\n    return pluginInfo?.instance != null;\r\n  }\r\n\r\n  private getRegisteredFactory(name: NonEmptyString): IPluginFactory | null {\r\n    // pluginRegistryì—ì„œ íŒ©í† ë¦¬ ì¡°íšŒ (ë‚´ë¶€ êµ¬í˜„ì— ì ‘ê·¼)\r\n    return (pluginRegistry as any).plugins.get(name)?.factory || null;\r\n  }\r\n\r\n  private sortPluginsByDependencies(names: NonEmptyString[]): NonEmptyString[] {\r\n    // ë‹¨ìˆœí•œ í† í´ë¡œì§€ ì •ë ¬ (ì‹¤ì œë¡œëŠ” ë” ë³µì¡í•œ êµ¬í˜„ í•„ìš”)\r\n    return names.sort((a, b) => {\r\n      const aInfo = this.loadedPlugins.get(a);\r\n      const bInfo = this.loadedPlugins.get(b);\r\n      return (aInfo?.dependencies.length || 0) - (bInfo?.dependencies.length || 0);\r\n    });\r\n  }\r\n\r\n  private updatePluginInfo(\r\n    name: NonEmptyString, \r\n    updates: Partial<LoadedPluginInfo>\r\n  ): void {\r\n    const current = this.loadedPlugins.get(name);\r\n    if (current) {\r\n      this.loadedPlugins.set(name, { ...current, ...updates });\r\n    }\r\n  }\r\n\r\n  private updatePluginMetrics(name: NonEmptyString, metrics: PluginMetrics): void {\r\n    const current = this.loadedPlugins.get(name);\r\n    if (current) {\r\n      this.loadedPlugins.set(name, { ...current, metrics });\r\n    }\r\n  }\r\n\r\n  private estimateMemoryUsage(): number {\r\n    // ê°„ë‹¨í•œ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ì¶”ì •\r\n    if (performance.memory) {\r\n      return performance.memory.usedJSHeapSize;\r\n    }\r\n    return 0;\r\n  }\r\n\r\n  private onConfigChange(newConfig: any): void {\r\n    // ì„¤ì • ë³€ê²½ ì‹œ í”ŒëŸ¬ê·¸ì¸ ì¬ë¡œë“œ ì²˜ë¦¬\r\n    const features = newConfig.features;\r\n    if (features.hotReload) {\r\n      // Hot reload ë¡œì§ êµ¬í˜„\r\n      this.handleHotReload(newConfig);\r\n    }\r\n  }\r\n\r\n  private async handleHotReload(newConfig: any): Promise<void> {\r\n    // Hot reload êµ¬í˜„ (ê°œë°œ í™˜ê²½ì—ì„œë§Œ)\r\n    console.log('Hot reloading plugins with new config...');\r\n  }\r\n\r\n  /**\r\n   * ë¼ì´í”„ì‚¬ì´í´ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ë“±ë¡\r\n   */\r\n  onLifecycleEvent(handler: LifecycleEventHandler): void {\r\n    this.lifecycleHandlers.add(handler);\r\n  }\r\n\r\n  offLifecycleEvent(handler: LifecycleEventHandler): void {\r\n    this.lifecycleHandlers.delete(handler);\r\n  }\r\n\r\n  private emitLifecycleEvent(event: LifecycleEvent): void {\r\n    this.lifecycleHandlers.forEach(handler => {\r\n      try {\r\n        handler(event);\r\n      } catch (error) {\r\n        console.error('Lifecycle event handler error:', error);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * ì‹œìŠ¤í…œ ì •ë¦¬ (ì•± ì¢…ë£Œ ì‹œ)\r\n   */\r\n  async dispose(): Promise<Result<void>> {\r\n    const result = await this.unloadAllPlugins();\r\n    this.lifecycleHandlers.clear();\r\n    return result;\r\n  }\r\n}\r\n\r\n// ì „ì—­ ë¼ì´í”„ì‚¬ì´í´ ë§¤ë‹ˆì €\r\nexport const pluginLifecycle = PluginLifecycleManager.getInstance();","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\plugins\\core\\PluginRegistry.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isNonEmptyString' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":43,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":59}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * í”ŒëŸ¬ê·¸ì¸ ë ˆì§€ìŠ¤íŠ¸ë¦¬ - ì¤‘ì•™ ì§‘ì¤‘ì‹ í”ŒëŸ¬ê·¸ì¸ ê´€ë¦¬\r\n * @description Registry Patternì„ êµ¬í˜„í•˜ì—¬ í”ŒëŸ¬ê·¸ì¸ë“¤ì„ ê´€ë¦¬\r\n */\r\n\r\nimport { \r\n  IPlugin, \r\n  IPluginFactory, \r\n  PluginMetadata, \r\n  PluginConfig, \r\n  PluginEvent,\r\n  PluginEventHandler,\r\n  PluginStatus \r\n} from './IPlugin';\r\nimport { NonEmptyString, Result, Ok, Err, isNonEmptyString } from '@/types/core';\r\n\r\n// ë“±ë¡ëœ í”ŒëŸ¬ê·¸ì¸ ì •ë³´\r\ninterface RegisteredPlugin {\r\n  readonly factory: IPluginFactory;\r\n  readonly instance?: IPlugin;\r\n  readonly config?: PluginConfig;\r\n  readonly registeredAt: number;\r\n}\r\n\r\n// í”ŒëŸ¬ê·¸ì¸ ê²€ìƒ‰ ì¿¼ë¦¬\r\ninterface PluginQuery {\r\n  readonly type?: NonEmptyString;\r\n  readonly name?: NonEmptyString;\r\n  readonly status?: PluginStatus;\r\n  readonly tags?: readonly string[];\r\n}\r\n\r\n/**\r\n * í”ŒëŸ¬ê·¸ì¸ ë ˆì§€ìŠ¤íŠ¸ë¦¬ - ì‹±ê¸€í†¤\r\n */\r\nexport class PluginRegistry {\r\n  private static instance: PluginRegistry;\r\n  \r\n  private readonly plugins = new Map<NonEmptyString, RegisteredPlugin>();\r\n  private readonly typeIndex = new Map<NonEmptyString, Set<NonEmptyString>>();\r\n  private readonly eventHandlers = new Map<string, Set<PluginEventHandler>>();\r\n  \r\n  private constructor() {}\r\n  \r\n  static getInstance(): PluginRegistry {\r\n    if (!PluginRegistry.instance) {\r\n      PluginRegistry.instance = new PluginRegistry();\r\n    }\r\n    return PluginRegistry.instance;\r\n  }\r\n\r\n  /**\r\n   * í”ŒëŸ¬ê·¸ì¸ íŒ©í† ë¦¬ ë“±ë¡\r\n   */\r\n  register<T extends IPlugin>(\r\n    name: NonEmptyString,\r\n    factory: IPluginFactory<T>\r\n  ): Result<void> {\r\n    try {\r\n      if (this.plugins.has(name)) {\r\n        return Err(new Error(`Plugin '${name}' is already registered`));\r\n      }\r\n\r\n      const registered: RegisteredPlugin = {\r\n        factory,\r\n        registeredAt: Date.now()\r\n      };\r\n\r\n      this.plugins.set(name, registered);\r\n      \r\n      // íƒ€ì…ë³„ ì¸ë±ìŠ¤ ì—…ë°ì´íŠ¸\r\n      const pluginType = factory.pluginType;\r\n      if (!this.typeIndex.has(pluginType)) {\r\n        this.typeIndex.set(pluginType, new Set());\r\n      }\r\n      this.typeIndex.get(pluginType)!.add(name);\r\n\r\n      this.emit({\r\n        type: 'statusChange',\r\n        pluginName: name,\r\n        timestamp: Date.now(),\r\n        data: { status: 'registered' }\r\n      });\r\n\r\n      return Ok(undefined);\r\n    } catch (error) {\r\n      return Err(error as Error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * í”ŒëŸ¬ê·¸ì¸ ë“±ë¡ í•´ì œ\r\n   */\r\n  async unregister(name: NonEmptyString): Promise<Result<void>> {\r\n    try {\r\n      const registered = this.plugins.get(name);\r\n      if (!registered) {\r\n        return Err(new Error(`Plugin '${name}' is not registered`));\r\n      }\r\n\r\n      // ì¸ìŠ¤í„´ìŠ¤ê°€ ìˆìœ¼ë©´ ì •ë¦¬\r\n      if (registered.instance) {\r\n        const disposeResult = await registered.instance.dispose();\r\n        if (!disposeResult.success) {\r\n          return disposeResult;\r\n        }\r\n      }\r\n\r\n      // íƒ€ì… ì¸ë±ìŠ¤ì—ì„œ ì œê±°\r\n      const pluginType = registered.factory.pluginType;\r\n      const typeSet = this.typeIndex.get(pluginType);\r\n      if (typeSet) {\r\n        typeSet.delete(name);\r\n        if (typeSet.size === 0) {\r\n          this.typeIndex.delete(pluginType);\r\n        }\r\n      }\r\n\r\n      this.plugins.delete(name);\r\n\r\n      this.emit({\r\n        type: 'statusChange',\r\n        pluginName: name,\r\n        timestamp: Date.now(),\r\n        data: { status: 'unregistered' }\r\n      });\r\n\r\n      return Ok(undefined);\r\n    } catch (error) {\r\n      return Err(error as Error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * í”ŒëŸ¬ê·¸ì¸ ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ë˜ëŠ” ë°˜í™˜\r\n   */\r\n  async getInstance<T extends IPlugin>(\r\n    name: NonEmptyString,\r\n    config?: PluginConfig\r\n  ): Promise<Result<T>> {\r\n    try {\r\n      const registered = this.plugins.get(name);\r\n      if (!registered) {\r\n        return Err(new Error(`Plugin '${name}' is not registered`));\r\n      }\r\n\r\n      // ì´ë¯¸ ì¸ìŠ¤í„´ìŠ¤ê°€ ìˆê³  ì„¤ì •ì´ ë™ì¼í•˜ë©´ ì¬ì‚¬ìš©\r\n      if (registered.instance && \r\n          JSON.stringify(registered.config) === JSON.stringify(config)) {\r\n        return Ok(registered.instance as T);\r\n      }\r\n\r\n      // ìƒˆ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±\r\n      const createResult = await registered.factory.create(config);\r\n      if (!createResult.success) {\r\n        return createResult;\r\n      }\r\n\r\n      const instance = createResult.data;\r\n      \r\n      // ì´ˆê¸°í™”\r\n      const initResult = await instance.initialize(config);\r\n      if (!initResult.success) {\r\n        return Err(initResult.error);\r\n      }\r\n\r\n      // ë“±ë¡ ì •ë³´ ì—…ë°ì´íŠ¸\r\n      const updatedRegistered: RegisteredPlugin = {\r\n        ...registered,\r\n        instance,\r\n        config\r\n      };\r\n      this.plugins.set(name, updatedRegistered);\r\n\r\n      return Ok(instance as T);\r\n    } catch (error) {\r\n      return Err(error as Error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * íƒ€ì…ë³„ í”ŒëŸ¬ê·¸ì¸ ê²€ìƒ‰\r\n   */\r\n  getPluginsByType(pluginType: NonEmptyString): readonly NonEmptyString[] {\r\n    const typeSet = this.typeIndex.get(pluginType);\r\n    return typeSet ? Array.from(typeSet) : [];\r\n  }\r\n\r\n  /**\r\n   * í”ŒëŸ¬ê·¸ì¸ ê²€ìƒ‰\r\n   */\r\n  search(query: PluginQuery): readonly NonEmptyString[] {\r\n    const results: NonEmptyString[] = [];\r\n\r\n    for (const [name, registered] of this.plugins) {\r\n      let matches = true;\r\n\r\n      // íƒ€ì… í•„í„°\r\n      if (query.type && registered.factory.pluginType !== query.type) {\r\n        matches = false;\r\n      }\r\n\r\n      // ì´ë¦„ í•„í„°\r\n      if (query.name && name !== query.name) {\r\n        matches = false;\r\n      }\r\n\r\n      // ìƒíƒœ í•„í„°\r\n      if (query.status && registered.instance?.status !== query.status) {\r\n        matches = false;\r\n      }\r\n\r\n      // íƒœê·¸ í•„í„°\r\n      if (query.tags && query.tags.length > 0) {\r\n        const metadata = registered.instance?.metadata || \r\n                        (registered.factory as any).metadata;\r\n        const pluginTags = metadata?.tags || [];\r\n        const hasMatchingTag = query.tags.some(tag => \r\n          pluginTags.includes(tag)\r\n        );\r\n        if (!hasMatchingTag) {\r\n          matches = false;\r\n        }\r\n      }\r\n\r\n      if (matches) {\r\n        results.push(name);\r\n      }\r\n    }\r\n\r\n    return results;\r\n  }\r\n\r\n  /**\r\n   * ë“±ë¡ëœ ëª¨ë“  í”ŒëŸ¬ê·¸ì¸ ì¡°íšŒ\r\n   */\r\n  getRegisteredPlugins(): readonly NonEmptyString[] {\r\n    return Array.from(this.plugins.keys());\r\n  }\r\n\r\n  /**\r\n   * í”ŒëŸ¬ê·¸ì¸ ë©”íƒ€ë°ì´í„° ì¡°íšŒ\r\n   */\r\n  getMetadata(name: NonEmptyString): PluginMetadata | null {\r\n    const registered = this.plugins.get(name);\r\n    if (!registered) return null;\r\n    \r\n    return registered.instance?.metadata || \r\n           (registered.factory as any).metadata || null;\r\n  }\r\n\r\n  /**\r\n   * í”ŒëŸ¬ê·¸ì¸ ìƒíƒœ ì¡°íšŒ\r\n   */\r\n  getStatus(name: NonEmptyString): PluginStatus | null {\r\n    const registered = this.plugins.get(name);\r\n    if (!registered) return null;\r\n    \r\n    return registered.instance?.status || 'unloaded';\r\n  }\r\n\r\n  /**\r\n   * ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ë“±ë¡\r\n   */\r\n  on(event: string, handler: PluginEventHandler): void {\r\n    if (!this.eventHandlers.has(event)) {\r\n      this.eventHandlers.set(event, new Set());\r\n    }\r\n    this.eventHandlers.get(event)!.add(handler);\r\n  }\r\n\r\n  /**\r\n   * ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì œê±°\r\n   */\r\n  off(event: string, handler: PluginEventHandler): void {\r\n    const handlers = this.eventHandlers.get(event);\r\n    if (handlers) {\r\n      handlers.delete(handler);\r\n      if (handlers.size === 0) {\r\n        this.eventHandlers.delete(event);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ì´ë²¤íŠ¸ ë°œìƒ\r\n   */\r\n  private emit(event: PluginEvent): void {\r\n    const handlers = this.eventHandlers.get(event.type);\r\n    if (handlers) {\r\n      handlers.forEach(handler => {\r\n        try {\r\n          handler(event);\r\n        } catch (error) {\r\n          console.error('Plugin event handler error:', error);\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì´ˆê¸°í™” (í…ŒìŠ¤íŠ¸ìš©)\r\n   */\r\n  async clear(): Promise<void> {\r\n    const disposePromises = Array.from(this.plugins.values())\r\n      .filter(registered => registered.instance)\r\n      .map(registered => registered.instance!.dispose());\r\n\r\n    await Promise.all(disposePromises);\r\n\r\n    this.plugins.clear();\r\n    this.typeIndex.clear();\r\n    this.eventHandlers.clear();\r\n  }\r\n}\r\n\r\n// ì „ì—­ ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì¸ìŠ¤í„´ìŠ¤\r\nexport const pluginRegistry = PluginRegistry.getInstance();","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\plugins\\index.ts","messages":[{"ruleId":"no-undef","severity":1,"message":"'PluginManagerOptions' is not defined.","line":56,"column":51,"nodeType":"Identifier","messageId":"undef","endLine":56,"endColumn":71},{"ruleId":"no-undef","severity":1,"message":"'pluginManager' is not defined.","line":57,"column":10,"nodeType":"Identifier","messageId":"undef","endLine":57,"endColumn":23},{"ruleId":"no-undef","severity":1,"message":"'pluginManager' is not defined.","line":61,"column":10,"nodeType":"Identifier","messageId":"undef","endLine":61,"endColumn":23},{"ruleId":"no-undef","severity":1,"message":"'pluginManager' is not defined.","line":66,"column":19,"nodeType":"Identifier","messageId":"undef","endLine":66,"endColumn":32},{"ruleId":"no-undef","severity":1,"message":"'pluginManager' is not defined.","line":67,"column":25,"nodeType":"Identifier","messageId":"undef","endLine":67,"endColumn":38}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * í”ŒëŸ¬ê·¸ì¸ ì‹œìŠ¤í…œ ì§„ì…ì \r\n * @description ëª¨ë“  í”ŒëŸ¬ê·¸ì¸ ê´€ë ¨ ê¸°ëŠ¥ì˜ ì¤‘ì•™ ì§„ì…ì \r\n */\r\n\r\n// Core exports\r\nexport type { \r\n  IPlugin, \r\n  PluginMetadata, \r\n  PluginConfig as BasePluginConfig,\r\n  PluginStatus,\r\n  PluginEvent,\r\n  PluginEventHandler,\r\n  IPluginFactory \r\n} from './core/IPlugin';\r\n\r\nexport { BasePlugin } from './core/BasePlugin';\r\nexport { pluginRegistry } from './core/PluginRegistry';\r\nexport { pluginLifecycle } from './core/PluginLifecycleManager';\r\n\r\n// Config exports\r\nexport type { \r\n  PluginConfigEntry, \r\n  GlobalPluginConfig \r\n} from './config/PluginConfig';\r\nexport { pluginConfig } from './config/PluginConfig';\r\n\r\n// Speech plugin exports\r\nexport type { \r\n  ISpeechPlugin, \r\n  SpeechPluginConfig,\r\n  SpeechProcessingState,\r\n  SpeechPluginEvent,\r\n  SpeechEventHandler,\r\n  ISpeechPluginFactory \r\n} from './speech/ISpeechPlugin';\r\n\r\nexport { WebSpeechPlugin } from './speech/WebSpeechPlugin';\r\nexport { WebSpeechPluginFactory } from './speech/WebSpeechPluginFactory';\r\n\r\n// Main manager exports\r\nexport type { \r\n  PluginManagerOptions, \r\n  PluginInfo \r\n} from './PluginManager';\r\n\r\nexport { \r\n  PluginManager,\r\n  pluginManager,\r\n  getSpeechPlugin,\r\n  getPlugin,\r\n  isPluginAvailable \r\n} from './PluginManager';\r\n\r\n// Utility functions for easy initialization\r\nexport const initializePlugins = async (options?: PluginManagerOptions) => {\r\n  return pluginManager.initialize(options);\r\n};\r\n\r\nexport const shutdownPlugins = async () => {\r\n  return pluginManager.dispose();\r\n};\r\n\r\n// Plugin system health check\r\nexport const checkPluginSystemHealth = () => {\r\n  const metrics = pluginManager.getSystemMetrics();\r\n  const activePlugins = pluginManager.getActivePlugins();\r\n  \r\n  return {\r\n    isHealthy: metrics.errorCount === 0 && activePlugins.length > 0,\r\n    metrics,\r\n    activePlugins: activePlugins.length,\r\n    totalPlugins: metrics.totalPlugins\r\n  };\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\plugins\\performance\\IPerformancePlugin.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\plugins\\performance\\PerformancePlugin.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\plugins\\performance\\PerformancePluginFactory.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\plugins\\simple\\AdvancedIntegration.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AdvancedSpeechPlugin' is defined but never used. Allowed unused vars must match /^_/u.","line":13,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":30}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Advanced Plugin System Integration\r\n * @description Complete integration example with all advanced features\r\n */\r\n\r\nimport {\r\n  dynamicPluginRegistry,\r\n  registerPluginLoader,\r\n  IAdvancedSpeechPlugin\r\n} from './AdvancedPluginSystem';\r\n\r\nimport { bundlingManager } from './BundlingStrategy';\r\nimport { AdvancedSpeechPlugin } from './AdvancedSpeechPlugin';\r\n\r\n// ===== Complete System Initialization =====\r\n\r\nexport async function initializeAdvancedPluginSystem(): Promise<{\r\n  success: boolean;\r\n  loadedPlugins: string[];\r\n  bundleAnalysis: any;\r\n  error?: string;\r\n}> {\r\n  try {\r\n    console.log('ğŸš€ Initializing Advanced Plugin System...');\r\n\r\n    // Step 1: Initialize bundling strategy\r\n    await bundlingManager.initializePluginLoading();\r\n\r\n    // Step 2: Register plugins with dynamic loading\r\n    await registerAdvancedPlugins();\r\n\r\n    // Step 3: Preload critical plugins\r\n    const preloadResult = await dynamicPluginRegistry.preloadPlugins([\r\n      'speech/advanced'\r\n    ]);\r\n\r\n    if (!preloadResult.ok) {\r\n      console.warn('Preload warning:', preloadResult.cause);\r\n    }\r\n\r\n    // Step 4: Get system metrics\r\n    const systemMetrics = dynamicPluginRegistry.getSystemMetrics();\r\n    const bundleAnalysis = bundlingManager.getBundleAnalysis();\r\n\r\n    console.log('âœ… Advanced Plugin System Ready!');\r\n    console.log('ğŸ“Š System Metrics:', systemMetrics);\r\n    console.log('ğŸ“¦ Bundle Analysis:', bundleAnalysis);\r\n\r\n    return {\r\n      success: true,\r\n      loadedPlugins: dynamicPluginRegistry.listRegistrations().map(r => r.name),\r\n      bundleAnalysis\r\n    };\r\n\r\n  } catch (error) {\r\n    console.error('âŒ Advanced Plugin System initialization failed:', error);\r\n    return {\r\n      success: false,\r\n      loadedPlugins: [],\r\n      bundleAnalysis: null,\r\n      error: error instanceof Error ? error.message : 'Unknown error'\r\n    };\r\n  }\r\n}\r\n\r\n// ===== Plugin Registration =====\r\n\r\nasync function registerAdvancedPlugins(): Promise<void> {\r\n  // Advanced Speech Plugin with dynamic loading\r\n  registerPluginLoader(\r\n    'speech/advanced',\r\n    async () => {\r\n      // Track chunk loading\r\n      bundlingManager.trackChunkLoaded('speech-advanced-chunk');\r\n      \r\n      // Dynamic import with chunk name\r\n      const module = await import(\r\n        /* webpackChunkName: \"speech-advanced\" */\r\n        './AdvancedSpeechPlugin'\r\n      );\r\n      \r\n      return { default: module.AdvancedSpeechPlugin };\r\n    },\r\n    'lazy',\r\n    'speech-advanced-chunk',\r\n    // Preload condition: load if device supports advanced speech features\r\n    () => 'speechSynthesis' in window && 'webkitSpeechRecognition' in window\r\n  );\r\n\r\n  // Future plugin examples with different loading strategies\r\n  registerFuturePlugins();\r\n}\r\n\r\nfunction registerFuturePlugins(): void {\r\n  // Example: Analytics Plugin (lazy loaded)\r\n  registerPluginLoader(\r\n    'analytics/google',\r\n    async () => {\r\n      bundlingManager.trackChunkLoaded('analytics-chunk');\r\n      \r\n      // Simulate analytics plugin\r\n      return {\r\n        default: class GoogleAnalyticsPlugin {\r\n          name = 'google-analytics';\r\n          version = '1.0.0';\r\n          \r\n          async initialize() {\r\n            console.log('ğŸ“Š Google Analytics Plugin initialized');\r\n            return { ok: true, data: undefined };\r\n          }\r\n          \r\n          async dispose() {\r\n            return { ok: true, data: undefined };\r\n          }\r\n          \r\n          getMetrics() {\r\n            return {\r\n              errorCount: 0,\r\n              lastActivity: new Date(),\r\n              activeOperations: 0\r\n            };\r\n          }\r\n          \r\n          stopAll() {\r\n            return { ok: true, data: undefined };\r\n          }\r\n          \r\n          getQueueSize() { return 0; }\r\n          clearQueue() { return { ok: true, data: undefined }; }\r\n          getActiveOperations() { return []; }\r\n        }\r\n      };\r\n    },\r\n    'lazy',\r\n    'analytics-chunk'\r\n  );\r\n}\r\n\r\n// ===== Advanced Usage Hook =====\r\n\r\nimport { useState, useEffect, useCallback } from 'react';\r\n\r\nexport interface UseAdvancedSpeechResult {\r\n  // State\r\n  isLoading: boolean;\r\n  error: string | null;\r\n  isProcessing: boolean;\r\n  queueSize: number;\r\n  activeOperations: string[];\r\n  \r\n  // Enhanced Methods with Concurrency Control\r\n  speakText: (\r\n    text: string, \r\n    options?: {\r\n      priority?: number;\r\n      timeout?: number;\r\n      onCancel?: (reason: string) => void;\r\n      language?: string;\r\n      rate?: number;\r\n    }\r\n  ) => Promise<{ success: boolean; queuePosition?: number }>;\r\n  \r\n  recognizeSpeech: (\r\n    options?: {\r\n      priority?: number;\r\n      timeout?: number;\r\n      onCancel?: (reason: string) => void;\r\n      language?: string;\r\n      maxDuration?: number;\r\n    }\r\n  ) => Promise<{ \r\n    success: boolean; \r\n    transcript?: string; \r\n    confidence?: number;\r\n    queuePosition?: number;\r\n  }>;\r\n  \r\n  playBeep: (\r\n    frequency?: number,\r\n    duration?: number,\r\n    options?: {\r\n      priority?: number;\r\n      onCancel?: () => void;\r\n    }\r\n  ) => Promise<boolean>;\r\n  \r\n  // Control Methods\r\n  stopAll: (reason?: 'user' | 'navigate' | 'error') => boolean;\r\n  clearQueue: () => boolean;\r\n  \r\n  // Metrics\r\n  getMetrics: () => any;\r\n  getBundleAnalysis: () => any;\r\n}\r\n\r\nexport function useAdvancedSpeech(): UseAdvancedSpeechResult {\r\n  const [state, setState] = useState({\r\n    isLoading: true,\r\n    error: null as string | null,\r\n    plugin: null as IAdvancedSpeechPlugin | null,\r\n    queueSize: 0,\r\n    activeOperations: [] as string[]\r\n  });\r\n\r\n  // Initialize plugin\r\n  useEffect(() => {\r\n    let mounted = true;\r\n    \r\n    const initPlugin = async () => {\r\n      try {\r\n        const result = await dynamicPluginRegistry.getPlugin<IAdvancedSpeechPlugin>('speech/advanced');\r\n        \r\n        if (!mounted) return;\r\n        \r\n        if (result.ok) {\r\n          setState(prev => ({\r\n            ...prev,\r\n            isLoading: false,\r\n            plugin: result.data,\r\n            error: null\r\n          }));\r\n        } else {\r\n          setState(prev => ({\r\n            ...prev,\r\n            isLoading: false,\r\n            error: result.cause || 'Failed to load speech plugin'\r\n          }));\r\n        }\r\n      } catch (error) {\r\n        if (!mounted) return;\r\n        setState(prev => ({\r\n          ...prev,\r\n          isLoading: false,\r\n          error: error instanceof Error ? error.message : 'Unknown error'\r\n        }));\r\n      }\r\n    };\r\n\r\n    initPlugin();\r\n    \r\n    return () => { mounted = false; };\r\n  }, []);\r\n\r\n  // Update queue metrics periodically\r\n  useEffect(() => {\r\n    if (!state.plugin) return;\r\n    \r\n    const interval = setInterval(() => {\r\n      if (state.plugin) {\r\n        setState(prev => ({\r\n          ...prev,\r\n          queueSize: prev.plugin?.getQueueSize() || 0,\r\n          activeOperations: prev.plugin?.getActiveOperations() || []\r\n        }));\r\n      }\r\n    }, 1000); // Update every second\r\n    \r\n    return () => clearInterval(interval);\r\n  }, [state.plugin]);\r\n\r\n  // Enhanced speech methods\r\n  const speakText = useCallback(async (\r\n    text: string, \r\n    options: {\r\n      priority?: number;\r\n      timeout?: number;\r\n      onCancel?: (reason: string) => void;\r\n      language?: string;\r\n      rate?: number;\r\n    } = {}\r\n  ) => {\r\n    if (!state.plugin) return { success: false };\r\n    \r\n    const controller = new AbortController();\r\n    \r\n    const result = await state.plugin.speakText(text, {\r\n      priority: options.priority,\r\n      timeout: options.timeout,\r\n      onCancel: options.onCancel,\r\n      language: options.language,\r\n      rate: options.rate,\r\n      signal: controller.signal\r\n    });\r\n    \r\n    if (result.ok) {\r\n      return {\r\n        success: true,\r\n        queuePosition: result.data.queuePosition\r\n      };\r\n    } else {\r\n      setState(prev => ({ ...prev, error: result.cause || 'Speech failed' }));\r\n      return { success: false };\r\n    }\r\n  }, [state.plugin]);\r\n\r\n  const recognizeSpeech = useCallback(async (\r\n    options: {\r\n      priority?: number;\r\n      timeout?: number;\r\n      onCancel?: (reason: string) => void;\r\n      language?: string;\r\n      maxDuration?: number;\r\n    } = {}\r\n  ) => {\r\n    if (!state.plugin) return { success: false };\r\n    \r\n    const controller = new AbortController();\r\n    \r\n    const result = await state.plugin.recognizeSpeech({\r\n      priority: options.priority,\r\n      timeout: options.timeout,\r\n      onCancel: options.onCancel,\r\n      language: options.language,\r\n      maxDuration: options.maxDuration,\r\n      signal: controller.signal\r\n    });\r\n    \r\n    if (result.ok) {\r\n      return {\r\n        success: true,\r\n        transcript: result.data.transcript,\r\n        confidence: result.data.confidence,\r\n        queuePosition: result.data.queuePosition\r\n      };\r\n    } else {\r\n      setState(prev => ({ ...prev, error: result.cause || 'Recognition failed' }));\r\n      return { success: false };\r\n    }\r\n  }, [state.plugin]);\r\n\r\n  const playBeep = useCallback(async (\r\n    frequency = 800,\r\n    duration = 200,\r\n    options: {\r\n      priority?: number;\r\n      onCancel?: () => void;\r\n    } = {}\r\n  ) => {\r\n    if (!state.plugin) return false;\r\n    \r\n    const controller = new AbortController();\r\n    \r\n    const result = await state.plugin.playBeep(frequency, duration, {\r\n      priority: options.priority,\r\n      signal: controller.signal,\r\n      onCancel: options.onCancel\r\n    });\r\n    \r\n    if (!result.ok) {\r\n      setState(prev => ({ ...prev, error: result.cause || 'Beep failed' }));\r\n      return false;\r\n    }\r\n    \r\n    return true;\r\n  }, [state.plugin]);\r\n\r\n  const stopAll = useCallback((reason: 'user' | 'navigate' | 'error' = 'user') => {\r\n    if (!state.plugin) return false;\r\n    \r\n    const result = state.plugin.stopAll(reason);\r\n    if (!result.ok) {\r\n      setState(prev => ({ ...prev, error: result.cause || 'Stop failed' }));\r\n      return false;\r\n    }\r\n    \r\n    return true;\r\n  }, [state.plugin]);\r\n\r\n  const clearQueue = useCallback(() => {\r\n    if (!state.plugin) return false;\r\n    \r\n    const result = state.plugin.clearQueue();\r\n    if (!result.ok) {\r\n      setState(prev => ({ ...prev, error: result.cause || 'Clear queue failed' }));\r\n      return false;\r\n    }\r\n    \r\n    return true;\r\n  }, [state.plugin]);\r\n\r\n  const getMetrics = useCallback(() => {\r\n    return state.plugin?.getMetrics();\r\n  }, [state.plugin]);\r\n\r\n  const getBundleAnalysis = useCallback(() => {\r\n    return bundlingManager.getBundleAnalysis();\r\n  }, []);\r\n\r\n  return {\r\n    // State\r\n    isLoading: state.isLoading,\r\n    error: state.error,\r\n    isProcessing: state.activeOperations.length > 0,\r\n    queueSize: state.queueSize,\r\n    activeOperations: state.activeOperations,\r\n    \r\n    // Methods\r\n    speakText,\r\n    recognizeSpeech,\r\n    playBeep,\r\n    stopAll,\r\n    clearQueue,\r\n    getMetrics,\r\n    getBundleAnalysis\r\n  };\r\n}\r\n\r\n// ===== System Health & Monitoring =====\r\n\r\nexport function getAdvancedPluginSystemHealth(): {\r\n  systemStatus: 'healthy' | 'degraded' | 'critical';\r\n  pluginCount: number;\r\n  memoryUsage: number;\r\n  averageLoadTime: number;\r\n  errorRate: number;\r\n  recommendations: string[];\r\n} {\r\n  const metrics = dynamicPluginRegistry.getSystemMetrics();\r\n  const bundleAnalysis = bundlingManager.getBundleAnalysis();\r\n  \r\n  let systemStatus: 'healthy' | 'degraded' | 'critical' = 'healthy';\r\n  const recommendations: string[] = [];\r\n  \r\n  // Assess system health\r\n  if (metrics.averageLoadTime > 1000) {\r\n    systemStatus = 'degraded';\r\n    recommendations.push('Plugin load times are high - consider code splitting');\r\n  }\r\n  \r\n  if (metrics.totalMemoryUsage > 50 * 1024 * 1024) { // 50MB\r\n    systemStatus = 'critical';\r\n    recommendations.push('High memory usage - consider unloading unused plugins');\r\n  }\r\n  \r\n  return {\r\n    systemStatus,\r\n    pluginCount: metrics.loadedPlugins,\r\n    memoryUsage: metrics.totalMemoryUsage,\r\n    averageLoadTime: metrics.averageLoadTime,\r\n    errorRate: 0, // Would need to track errors over time\r\n    recommendations: [...recommendations, ...bundleAnalysis.recommendations]\r\n  };\r\n}\r\n\r\n// ===== Development Tools =====\r\n\r\nif (import.meta.env.DEV) {\r\n  // Export for dev console access\r\n  (window as any).__advancedPluginSystem = {\r\n    registry: dynamicPluginRegistry,\r\n    bundling: bundlingManager,\r\n    health: getAdvancedPluginSystemHealth,\r\n    init: initializeAdvancedPluginSystem\r\n  };\r\n  \r\n  console.log('ğŸ› ï¸ Advanced Plugin System dev tools available at window.__advancedPluginSystem');\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\plugins\\simple\\AdvancedPluginSystem.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Err' is defined but never used. Allowed unused vars must match /^_/u.","line":9,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":6},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ErrCode' is defined but never used. Allowed unused vars must match /^_/u.","line":10,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":10}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * ê³ ê¸‰ í”ŒëŸ¬ê·¸ì¸ ì‹œìŠ¤í…œ - Dynamic Loading & Concurrency Control\r\n * @description Discovery/Loading Strategy + Cancellation/Concurrency ê°œì„ \r\n */\r\n\r\nimport { \r\n  Result, \r\n  Ok, \r\n  Err, \r\n  ErrCode, \r\n  CommonErrors,\r\n  ISimplePlugin \r\n} from './SimplePluginSystem';\r\n\r\n// ===== Enhanced Plugin Interfaces =====\r\n\r\nexport type PluginLoadingStrategy = 'static' | 'lazy' | 'preload';\r\nexport type QueuePolicy = 'fifo' | 'lifo' | 'priority' | 'concurrent';\r\nexport type StopReason = 'user' | 'navigate' | 'error' | 'dispose' | 'timeout' | 'memory';\r\n\r\nexport interface PluginMetrics {\r\n  loadTime?: number;\r\n  memoryUsage?: number;\r\n  errorCount: number;\r\n  lastActivity: Date;\r\n  activeOperations: number;\r\n}\r\n\r\nexport interface ConcurrencyConfig {\r\n  readonly maxConcurrency: number;\r\n  readonly queuePolicy: QueuePolicy;\r\n  readonly timeout?: number;\r\n}\r\n\r\nexport interface IAdvancedPlugin extends ISimplePlugin {\r\n  // Concurrency Control\r\n  readonly concurrencyConfig?: ConcurrencyConfig;\r\n  \r\n  // Enhanced Lifecycle with Metrics\r\n  getMetrics(): PluginMetrics;\r\n  \r\n  // Enhanced Stop Control\r\n  stopAll(reason: StopReason): Result<void>;\r\n  \r\n  // Queue Management\r\n  getQueueSize(): number;\r\n  clearQueue(): Result<void>;\r\n}\r\n\r\n// ===== Enhanced Speech Plugin Interface =====\r\n\r\nexport interface SpeechOptionsAdvanced {\r\n  readonly language?: string;\r\n  readonly rate?: number;\r\n  readonly priority?: number; // 0-10, 10 = highest\r\n  readonly signal?: AbortSignal;\r\n  readonly onCancel?: (reason: string) => void;\r\n  readonly timeout?: number;\r\n}\r\n\r\nexport interface RecognitionOptionsAdvanced {\r\n  readonly language?: string;\r\n  readonly maxDuration?: number;\r\n  readonly continuous?: boolean;\r\n  readonly priority?: number;\r\n  readonly signal?: AbortSignal;\r\n  readonly onCancel?: (reason: string) => void;\r\n  readonly timeout?: number;\r\n}\r\n\r\nexport interface IAdvancedSpeechPlugin extends IAdvancedPlugin {\r\n  // Enhanced TTS with concurrency\r\n  speakText(\r\n    text: string, \r\n    opts?: SpeechOptionsAdvanced\r\n  ): Promise<Result<{ duration: number; queuePosition?: number }>>;\r\n  \r\n  // Enhanced STT with concurrency\r\n  recognizeSpeech(\r\n    opts?: RecognitionOptionsAdvanced\r\n  ): Promise<Result<{ transcript: string; confidence: number; queuePosition?: number }>>;\r\n  \r\n  // Beep with concurrency\r\n  playBeep(\r\n    frequency?: number, \r\n    duration?: number,\r\n    opts?: { priority?: number; signal?: AbortSignal; onCancel?: () => void }\r\n  ): Promise<Result<void>>;\r\n  \r\n  // Queue inspection\r\n  getActiveOperations(): string[];\r\n  getSpeechQueue(): Array<{ id: string; text: string; priority: number }>;\r\n}\r\n\r\n// ===== Plugin Factory & Loader System =====\r\n\r\nexport type PluginFactory<T extends IAdvancedPlugin> = () => Promise<T>;\r\nexport type PluginLoader<T extends IAdvancedPlugin> = () => Promise<{ default: new() => T }>;\r\n\r\nexport interface PluginRegistration<T extends IAdvancedPlugin> {\r\n  readonly name: string;\r\n  readonly factory?: PluginFactory<T>;\r\n  readonly loader?: PluginLoader<T>;\r\n  readonly strategy: PluginLoadingStrategy;\r\n  readonly bundleChunk?: string; // For code-splitting\r\n  readonly preloadCondition?: () => boolean;\r\n}\r\n\r\n// ===== Dynamic Plugin Registry =====\r\n\r\nexport class DynamicPluginRegistry {\r\n  private registrations = new Map<string, PluginRegistration<any>>();\r\n  private loadedPlugins = new Map<string, IAdvancedPlugin>();\r\n  private loadingPromises = new Map<string, Promise<IAdvancedPlugin>>();\r\n  private metrics = new Map<string, PluginMetrics>();\r\n\r\n  /**\r\n   * Register plugin with dynamic loading capability\r\n   */\r\n  register<T extends IAdvancedPlugin>(\r\n    registration: PluginRegistration<T>\r\n  ): Result<void> {\r\n    if (this.registrations.has(registration.name)) {\r\n      return CommonErrors.INVALID_INPUT(`Plugin '${registration.name}' already registered`);\r\n    }\r\n\r\n    // Validate registration\r\n    if (!registration.factory && !registration.loader) {\r\n      return CommonErrors.INVALID_INPUT('Either factory or loader must be provided');\r\n    }\r\n\r\n    this.registrations.set(registration.name, registration);\r\n\r\n    // Handle preload strategy\r\n    if (registration.strategy === 'preload') {\r\n      const shouldPreload = registration.preloadCondition?.() ?? true;\r\n      if (shouldPreload) {\r\n        // Start loading in background (don't await)\r\n        this.loadPlugin(registration.name).catch(error => {\r\n          console.warn(`Preload failed for ${registration.name}:`, error);\r\n        });\r\n      }\r\n    }\r\n\r\n    return Ok(undefined);\r\n  }\r\n\r\n  /**\r\n   * Dynamic plugin loading with caching\r\n   */\r\n  async loadPlugin<T extends IAdvancedPlugin>(name: string): Promise<Result<T>> {\r\n    // Return cached instance if available\r\n    const cached = this.loadedPlugins.get(name);\r\n    if (cached) {\r\n      return Ok(cached as T);\r\n    }\r\n\r\n    // Return in-flight loading promise if exists\r\n    const inFlight = this.loadingPromises.get(name);\r\n    if (inFlight) {\r\n      try {\r\n        const plugin = await inFlight;\r\n        return Ok(plugin as T);\r\n      } catch (error) {\r\n        return CommonErrors.INTERNAL(`Loading failed: ${error}`);\r\n      }\r\n    }\r\n\r\n    // Start new loading process\r\n    const registration = this.registrations.get(name);\r\n    if (!registration) {\r\n      return CommonErrors.INVALID_INPUT(`Plugin '${name}' not registered`);\r\n    }\r\n\r\n    const loadingPromise = this.createLoadingPromise<T>(registration);\r\n    this.loadingPromises.set(name, loadingPromise);\r\n\r\n    try {\r\n      const startTime = Date.now();\r\n      const plugin = await loadingPromise;\r\n      \r\n      // Initialize plugin\r\n      const initResult = await plugin.initialize?.();\r\n      if (initResult && !initResult.ok) {\r\n        throw new Error(`Initialization failed: ${initResult.cause}`);\r\n      }\r\n\r\n      // Cache the loaded plugin\r\n      this.loadedPlugins.set(name, plugin);\r\n      \r\n      // Record metrics\r\n      this.metrics.set(name, {\r\n        loadTime: Date.now() - startTime,\r\n        errorCount: 0,\r\n        lastActivity: new Date(),\r\n        activeOperations: 0\r\n      });\r\n\r\n      return Ok(plugin as T);\r\n\r\n    } catch (error) {\r\n      this.loadingPromises.delete(name);\r\n      return CommonErrors.INTERNAL(`Plugin loading failed: ${error}`);\r\n    } finally {\r\n      this.loadingPromises.delete(name);\r\n    }\r\n  }\r\n\r\n  private async createLoadingPromise<T extends IAdvancedPlugin>(\r\n    registration: PluginRegistration<T>\r\n  ): Promise<T> {\r\n    if (registration.factory) {\r\n      return await registration.factory();\r\n    }\r\n\r\n    if (registration.loader) {\r\n      const module = await registration.loader();\r\n      return new module.default();\r\n    }\r\n\r\n    throw new Error('No factory or loader provided');\r\n  }\r\n\r\n  /**\r\n   * Get plugin with dynamic loading\r\n   */\r\n  async getPlugin<T extends IAdvancedPlugin>(name: string): Promise<Result<T>> {\r\n    return await this.loadPlugin<T>(name);\r\n  }\r\n\r\n  /**\r\n   * Preload specific plugins\r\n   */\r\n  async preloadPlugins(names: string[]): Promise<Result<void>> {\r\n    const failures: string[] = [];\r\n    \r\n    await Promise.allSettled(\r\n      names.map(async (name) => {\r\n        const result = await this.loadPlugin(name);\r\n        if (!result.ok) {\r\n          failures.push(`${name}: ${result.cause}`);\r\n        }\r\n      })\r\n    );\r\n\r\n    if (failures.length > 0) {\r\n      return CommonErrors.INTERNAL(`Preload failures: ${failures.join(', ')}`);\r\n    }\r\n\r\n    return Ok(undefined);\r\n  }\r\n\r\n  /**\r\n   * Unload plugin and free memory\r\n   */\r\n  async unloadPlugin(name: string): Promise<Result<void>> {\r\n    const plugin = this.loadedPlugins.get(name);\r\n    if (!plugin) {\r\n      return CommonErrors.INVALID_INPUT(`Plugin '${name}' not loaded`);\r\n    }\r\n\r\n    try {\r\n      // Stop all operations\r\n      plugin.stopAll('dispose');\r\n      \r\n      // Dispose plugin\r\n      const disposeResult = await plugin.dispose?.();\r\n      if (disposeResult && !disposeResult.ok) {\r\n        console.warn(`Dispose warning for ${name}:`, disposeResult.cause);\r\n      }\r\n\r\n      // Remove from caches\r\n      this.loadedPlugins.delete(name);\r\n      this.metrics.delete(name);\r\n\r\n      return Ok(undefined);\r\n    } catch (error) {\r\n      return CommonErrors.INTERNAL(`Unload failed: ${error}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get system metrics\r\n   */\r\n  getSystemMetrics(): {\r\n    registeredPlugins: number;\r\n    loadedPlugins: number;\r\n    totalMemoryUsage: number;\r\n    averageLoadTime: number;\r\n  } {\r\n    const metricsArray = Array.from(this.metrics.values());\r\n    \r\n    return {\r\n      registeredPlugins: this.registrations.size,\r\n      loadedPlugins: this.loadedPlugins.size,\r\n      totalMemoryUsage: metricsArray.reduce((sum, m) => sum + (m.memoryUsage || 0), 0),\r\n      averageLoadTime: metricsArray.length > 0 \r\n        ? metricsArray.reduce((sum, m) => sum + (m.loadTime || 0), 0) / metricsArray.length\r\n        : 0\r\n    };\r\n  }\r\n\r\n  /**\r\n   * List all registered plugins\r\n   */\r\n  listRegistrations(): Array<{\r\n    name: string;\r\n    strategy: PluginLoadingStrategy;\r\n    loaded: boolean;\r\n    bundleChunk?: string;\r\n  }> {\r\n    return Array.from(this.registrations.entries()).map(([name, reg]) => ({\r\n      name,\r\n      strategy: reg.strategy,\r\n      loaded: this.loadedPlugins.has(name),\r\n      bundleChunk: reg.bundleChunk\r\n    }));\r\n  }\r\n\r\n  /**\r\n   * Clean up all plugins\r\n   */\r\n  async dispose(): Promise<Result<void>> {\r\n    const names = Array.from(this.loadedPlugins.keys());\r\n    const failures: string[] = [];\r\n\r\n    await Promise.allSettled(\r\n      names.map(async (name) => {\r\n        const result = await this.unloadPlugin(name);\r\n        if (!result.ok) {\r\n          failures.push(`${name}: ${result.cause}`);\r\n        }\r\n      })\r\n    );\r\n\r\n    // Clear all maps\r\n    this.registrations.clear();\r\n    this.loadedPlugins.clear();\r\n    this.loadingPromises.clear();\r\n    this.metrics.clear();\r\n\r\n    if (failures.length > 0) {\r\n      return CommonErrors.INTERNAL(`Cleanup failures: ${failures.join(', ')}`);\r\n    }\r\n\r\n    return Ok(undefined);\r\n  }\r\n}\r\n\r\n// ===== Global Registry Instance =====\r\nexport const dynamicPluginRegistry = new DynamicPluginRegistry();\r\n\r\n// ===== Convenience Functions =====\r\n\r\n/**\r\n * Register plugin with factory function\r\n */\r\nexport function registerPluginFactory<T extends IAdvancedPlugin>(\r\n  name: string,\r\n  factory: PluginFactory<T>,\r\n  strategy: PluginLoadingStrategy = 'lazy',\r\n  bundleChunk?: string\r\n): Result<void> {\r\n  return dynamicPluginRegistry.register({\r\n    name,\r\n    factory,\r\n    strategy,\r\n    bundleChunk\r\n  });\r\n}\r\n\r\n/**\r\n * Register plugin with dynamic import loader\r\n */\r\nexport function registerPluginLoader<T extends IAdvancedPlugin>(\r\n  name: string,\r\n  loader: PluginLoader<T>,\r\n  strategy: PluginLoadingStrategy = 'lazy',\r\n  bundleChunk?: string,\r\n  preloadCondition?: () => boolean\r\n): Result<void> {\r\n  return dynamicPluginRegistry.register({\r\n    name,\r\n    loader,\r\n    strategy,\r\n    bundleChunk,\r\n    preloadCondition\r\n  });\r\n}\r\n\r\n// ===== Usage Examples in Comments =====\r\n\r\n/*\r\n// Example 1: Static Registration\r\nregisterPluginFactory(\r\n  'speech/simple',\r\n  async () => new SimpleSpeechPlugin(),\r\n  'static'\r\n);\r\n\r\n// Example 2: Dynamic Import with Code Splitting\r\nregisterPluginLoader(\r\n  'speech/web', \r\n  async () => {\r\n    const m = await import('./speech/WebSpeechPlugin');\r\n    return m;\r\n  },\r\n  'lazy',\r\n  'speech-web-chunk'\r\n);\r\n\r\n// Example 3: Preload with Condition\r\nregisterPluginLoader(\r\n  'analytics/google',\r\n  async () => import('./analytics/GoogleAnalyticsPlugin'),\r\n  'preload',\r\n  'analytics-chunk',\r\n  () => import.meta.env.PROD && window.gtag !== undefined\r\n);\r\n\r\n// Example 4: Usage\r\nconst speechPlugin = await dynamicPluginRegistry.getPlugin<IAdvancedSpeechPlugin>('speech/web');\r\nif (speechPlugin.ok) {\r\n  await speechPlugin.data.speakText('Hello', { \r\n    priority: 5,\r\n    timeout: 10000,\r\n    onCancel: (reason) => console.log('Cancelled:', reason)\r\n  });\r\n}\r\n*/","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\plugins\\simple\\AdvancedSpeechPlugin.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\plugins\\simple\\BundlingStrategy.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\plugins\\simple\\MetricsAndSLOs.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'originalRecognizeSpeech' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":529,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":529,"endColumn":32},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'originalPlayBeep' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":530,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":530,"endColumn":25}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Concrete Metrics & SLO Definitions\r\n * @description Real measurements with SLOs, dashboards, and release gates\r\n */\r\n\r\n// ===== SLO Definitions =====\r\n\r\nexport interface SpeechSLO {\r\n  // Latency SLOs\r\n  p50StartLatency: number;    // ms - 50th percentile\r\n  p95StartLatency: number;    // ms - 95th percentile  \r\n  p99StartLatency: number;    // ms - 99th percentile\r\n  \r\n  // Reliability SLOs\r\n  successRate: number;        // % - successful operations\r\n  availabilityRate: number;   // % - service availability\r\n  \r\n  // Quality SLOs\r\n  interruptionRate: number;   // % - operations interrupted\r\n  errorRate: number;          // % - failed operations\r\n  \r\n  // Resource SLOs\r\n  memoryUsageCeiling: number; // bytes - max memory usage\r\n  cpuUsageLimit: number;      // % - max CPU usage\r\n}\r\n\r\nexport const PRODUCTION_SLO: SpeechSLO = {\r\n  // âœ… Latency targets (based on user experience research)\r\n  p50StartLatency: 100,      // 100ms - barely noticeable\r\n  p95StartLatency: 250,      // 250ms - acceptable delay\r\n  p99StartLatency: 500,      // 500ms - maximum tolerable\r\n  \r\n  // âœ… Reliability targets (industry standard)\r\n  successRate: 99.5,         // 99.5% - high reliability\r\n  availabilityRate: 99.9,    // 99.9% - \"three nines\"\r\n  \r\n  // âœ… Quality targets (user satisfaction)\r\n  interruptionRate: 2.0,     // <2% interruption rate\r\n  errorRate: 0.5,            // <0.5% error rate\r\n  \r\n  // âœ… Resource targets (performance)\r\n  memoryUsageCeiling: 50 * 1024 * 1024, // 50MB max\r\n  cpuUsageLimit: 10.0        // <10% CPU usage\r\n};\r\n\r\n// ===== Metrics Collection System =====\r\n\r\nexport interface MetricPoint {\r\n  timestamp: number;\r\n  value: number;\r\n  tags: Record<string, string>;\r\n}\r\n\r\nexport interface OperationMetrics {\r\n  // Timing metrics\r\n  startTime: number;\r\n  endTime?: number;\r\n  duration?: number;\r\n  \r\n  // Outcome metrics\r\n  success: boolean;\r\n  errorCode?: string;\r\n  errorMessage?: string;\r\n  \r\n  // Context metrics\r\n  operationType: 'speakText' | 'recognizeSpeech' | 'playBeep';\r\n  textLength?: number;\r\n  language?: string;\r\n  priority?: number;\r\n  \r\n  // Quality metrics\r\n  interrupted: boolean;\r\n  queueWaitTime?: number;\r\n  retryCount: number;\r\n}\r\n\r\nexport class SpeechMetricsCollector {\r\n  private metrics: OperationMetrics[] = [];\r\n  private memoryUsage: number[] = [];\r\n  private cpuMeasurements: number[] = [];\r\n  \r\n  // âœ… Real-time metric collection\r\n  private currentOperations = new Map<string, OperationMetrics>();\r\n  \r\n  /**\r\n   * Start tracking an operation\r\n   */\r\n  startOperation(\r\n    operationId: string,\r\n    type: 'speakText' | 'recognizeSpeech' | 'playBeep',\r\n    context: {\r\n      textLength?: number;\r\n      language?: string;\r\n      priority?: number;\r\n    }\r\n  ): void {\r\n    const metric: OperationMetrics = {\r\n      startTime: performance.now(),\r\n      success: false,\r\n      operationType: type,\r\n      interrupted: false,\r\n      retryCount: 0,\r\n      ...context\r\n    };\r\n    \r\n    this.currentOperations.set(operationId, metric);\r\n  }\r\n  \r\n  /**\r\n   * Complete an operation with outcome\r\n   */\r\n  completeOperation(\r\n    operationId: string,\r\n    outcome: {\r\n      success: boolean;\r\n      errorCode?: string;\r\n      errorMessage?: string;\r\n      interrupted?: boolean;\r\n      queueWaitTime?: number;\r\n      retryCount?: number;\r\n    }\r\n  ): void {\r\n    const metric = this.currentOperations.get(operationId);\r\n    if (!metric) return;\r\n    \r\n    metric.endTime = performance.now();\r\n    metric.duration = metric.endTime - metric.startTime;\r\n    metric.success = outcome.success;\r\n    metric.errorCode = outcome.errorCode;\r\n    metric.errorMessage = outcome.errorMessage;\r\n    metric.interrupted = outcome.interrupted || false;\r\n    metric.queueWaitTime = outcome.queueWaitTime;\r\n    metric.retryCount = outcome.retryCount || 0;\r\n    \r\n    this.metrics.push(metric);\r\n    this.currentOperations.delete(operationId);\r\n    \r\n    // Cleanup old metrics (keep last 1000)\r\n    if (this.metrics.length > 1000) {\r\n      this.metrics = this.metrics.slice(-1000);\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Record memory usage\r\n   */\r\n  recordMemoryUsage(): void {\r\n    if ('memory' in performance) {\r\n      const memory = (performance as any).memory;\r\n      this.memoryUsage.push(memory.usedJSHeapSize);\r\n      \r\n      // Keep last 100 measurements\r\n      if (this.memoryUsage.length > 100) {\r\n        this.memoryUsage = this.memoryUsage.slice(-100);\r\n      }\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Calculate percentile latency\r\n   */\r\n  calculateLatencyPercentile(percentile: number, operationType?: string): number {\r\n    let durations = this.metrics\r\n      .filter(m => m.duration !== undefined && m.success)\r\n      .map(m => m.duration!);\r\n    \r\n    if (operationType) {\r\n      durations = this.metrics\r\n        .filter(m => m.operationType === operationType && m.duration !== undefined && m.success)\r\n        .map(m => m.duration!);\r\n    }\r\n    \r\n    if (durations.length === 0) return 0;\r\n    \r\n    durations.sort((a, b) => a - b);\r\n    const index = Math.ceil(durations.length * (percentile / 100)) - 1;\r\n    return durations[Math.max(0, index)];\r\n  }\r\n  \r\n  /**\r\n   * Calculate success rate\r\n   */\r\n  calculateSuccessRate(operationType?: string, timeWindowMs: number = 300000): number {\r\n    const cutoff = Date.now() - timeWindowMs;\r\n    let relevantMetrics = this.metrics.filter(m => \r\n      m.startTime >= cutoff && m.endTime !== undefined\r\n    );\r\n    \r\n    if (operationType) {\r\n      relevantMetrics = relevantMetrics.filter(m => m.operationType === operationType);\r\n    }\r\n    \r\n    if (relevantMetrics.length === 0) return 100; // No data = assume healthy\r\n    \r\n    const successful = relevantMetrics.filter(m => m.success).length;\r\n    return (successful / relevantMetrics.length) * 100;\r\n  }\r\n  \r\n  /**\r\n   * Calculate interruption rate\r\n   */\r\n  calculateInterruptionRate(timeWindowMs: number = 300000): number {\r\n    const cutoff = Date.now() - timeWindowMs;\r\n    const relevantMetrics = this.metrics.filter(m => \r\n      m.startTime >= cutoff && m.endTime !== undefined\r\n    );\r\n    \r\n    if (relevantMetrics.length === 0) return 0;\r\n    \r\n    const interrupted = relevantMetrics.filter(m => m.interrupted).length;\r\n    return (interrupted / relevantMetrics.length) * 100;\r\n  }\r\n  \r\n  /**\r\n   * Get current memory usage\r\n   */\r\n  getCurrentMemoryUsage(): number {\r\n    if (this.memoryUsage.length === 0) return 0;\r\n    return this.memoryUsage[this.memoryUsage.length - 1];\r\n  }\r\n  \r\n  /**\r\n   * Get error rate by error code\r\n   */\r\n  getErrorBreakdown(timeWindowMs: number = 300000): Record<string, number> {\r\n    const cutoff = Date.now() - timeWindowMs;\r\n    const failures = this.metrics.filter(m => \r\n      m.startTime >= cutoff && !m.success && m.errorCode\r\n    );\r\n    \r\n    const breakdown: Record<string, number> = {};\r\n    failures.forEach(m => {\r\n      breakdown[m.errorCode!] = (breakdown[m.errorCode!] || 0) + 1;\r\n    });\r\n    \r\n    return breakdown;\r\n  }\r\n}\r\n\r\n// ===== SLO Monitoring & Alerting =====\r\n\r\nexport interface SLOViolation {\r\n  metric: keyof SpeechSLO;\r\n  target: number;\r\n  actual: number;\r\n  severity: 'warning' | 'critical';\r\n  timestamp: number;\r\n  details?: string;\r\n}\r\n\r\nexport class SLOMonitor {\r\n  private violations: SLOViolation[] = [];\r\n  \r\n  constructor(\r\n    private metricsCollector: SpeechMetricsCollector,\r\n    private slo: SpeechSLO = PRODUCTION_SLO\r\n  ) {}\r\n  \r\n  /**\r\n   * Check all SLOs and report violations\r\n   */\r\n  checkSLOs(): SLOViolation[] {\r\n    const violations: SLOViolation[] = [];\r\n    const now = Date.now();\r\n    \r\n    // âœ… Check latency SLOs\r\n    const p95Latency = this.metricsCollector.calculateLatencyPercentile(95, 'speakText');\r\n    if (p95Latency > this.slo.p95StartLatency) {\r\n      violations.push({\r\n        metric: 'p95StartLatency',\r\n        target: this.slo.p95StartLatency,\r\n        actual: p95Latency,\r\n        severity: p95Latency > this.slo.p95StartLatency * 2 ? 'critical' : 'warning',\r\n        timestamp: now,\r\n        details: `speakText p95 latency: ${p95Latency}ms > ${this.slo.p95StartLatency}ms`\r\n      });\r\n    }\r\n    \r\n    // âœ… Check success rate SLO\r\n    const successRate = this.metricsCollector.calculateSuccessRate();\r\n    if (successRate < this.slo.successRate) {\r\n      violations.push({\r\n        metric: 'successRate',\r\n        target: this.slo.successRate,\r\n        actual: successRate,\r\n        severity: successRate < this.slo.successRate * 0.95 ? 'critical' : 'warning',\r\n        timestamp: now,\r\n        details: `Success rate: ${successRate.toFixed(2)}% < ${this.slo.successRate}%`\r\n      });\r\n    }\r\n    \r\n    // âœ… Check interruption rate SLO\r\n    const interruptionRate = this.metricsCollector.calculateInterruptionRate();\r\n    if (interruptionRate > this.slo.interruptionRate) {\r\n      violations.push({\r\n        metric: 'interruptionRate',\r\n        target: this.slo.interruptionRate,\r\n        actual: interruptionRate,\r\n        severity: interruptionRate > this.slo.interruptionRate * 2 ? 'critical' : 'warning',\r\n        timestamp: now,\r\n        details: `Interruption rate: ${interruptionRate.toFixed(2)}% > ${this.slo.interruptionRate}%`\r\n      });\r\n    }\r\n    \r\n    // âœ… Check memory usage SLO\r\n    const memoryUsage = this.metricsCollector.getCurrentMemoryUsage();\r\n    if (memoryUsage > this.slo.memoryUsageCeiling) {\r\n      violations.push({\r\n        metric: 'memoryUsageCeiling',\r\n        target: this.slo.memoryUsageCeiling,\r\n        actual: memoryUsage,\r\n        severity: memoryUsage > this.slo.memoryUsageCeiling * 1.2 ? 'critical' : 'warning',\r\n        timestamp: now,\r\n        details: `Memory usage: ${(memoryUsage / 1024 / 1024).toFixed(1)}MB > ${(this.slo.memoryUsageCeiling / 1024 / 1024).toFixed(1)}MB`\r\n      });\r\n    }\r\n    \r\n    // Store violations\r\n    this.violations.push(...violations);\r\n    \r\n    // Cleanup old violations (keep last 24 hours)\r\n    const dayAgo = now - 24 * 60 * 60 * 1000;\r\n    this.violations = this.violations.filter(v => v.timestamp > dayAgo);\r\n    \r\n    return violations;\r\n  }\r\n  \r\n  /**\r\n   * Get SLO compliance report\r\n   */\r\n  getComplianceReport(timeWindowMs: number = 300000): {\r\n    compliant: boolean;\r\n    violations: SLOViolation[];\r\n    summary: {\r\n      latencyP95: number;\r\n      successRate: number;\r\n      interruptionRate: number;\r\n      memoryUsage: number;\r\n      errorBreakdown: Record<string, number>;\r\n    };\r\n  } {\r\n    const violations = this.checkSLOs();\r\n    const summary = {\r\n      latencyP95: this.metricsCollector.calculateLatencyPercentile(95),\r\n      successRate: this.metricsCollector.calculateSuccessRate(),\r\n      interruptionRate: this.metricsCollector.calculateInterruptionRate(timeWindowMs),\r\n      memoryUsage: this.metricsCollector.getCurrentMemoryUsage(),\r\n      errorBreakdown: this.metricsCollector.getErrorBreakdown(timeWindowMs)\r\n    };\r\n    \r\n    return {\r\n      compliant: violations.length === 0,\r\n      violations,\r\n      summary\r\n    };\r\n  }\r\n}\r\n\r\n// ===== Release Gate Implementation =====\r\n\r\nexport interface ReleaseGate {\r\n  name: string;\r\n  check: () => Promise<{ passed: boolean; reason?: string; metrics?: any }>;\r\n  required: boolean;\r\n  timeout: number; // ms\r\n}\r\n\r\nexport class ReleaseGateValidator {\r\n  private gates: ReleaseGate[] = [\r\n    // âœ… Gate 1: SLO Compliance\r\n    {\r\n      name: 'SLO Compliance',\r\n      check: async () => {\r\n        const monitor = new SLOMonitor(metricsCollector);\r\n        const report = monitor.getComplianceReport();\r\n        \r\n        const criticalViolations = report.violations.filter(v => v.severity === 'critical');\r\n        \r\n        return {\r\n          passed: criticalViolations.length === 0,\r\n          reason: criticalViolations.length > 0 \r\n            ? `Critical SLO violations: ${criticalViolations.map(v => v.details).join(', ')}`\r\n            : undefined,\r\n          metrics: report.summary\r\n        };\r\n      },\r\n      required: true,\r\n      timeout: 5000\r\n    },\r\n    \r\n    // âœ… Gate 2: Memory Leak Check\r\n    {\r\n      name: 'Memory Leak Check',\r\n      check: async () => {\r\n        // Simulate heavy usage and check memory growth\r\n        const initialMemory = metricsCollector.getCurrentMemoryUsage();\r\n        \r\n        // Simulate 100 operations\r\n        for (let i = 0; i < 100; i++) {\r\n          const opId = `test-${i}`;\r\n          metricsCollector.startOperation(opId, 'speakText', { textLength: 50 });\r\n          metricsCollector.completeOperation(opId, { success: true });\r\n        }\r\n        \r\n        await new Promise(resolve => setTimeout(resolve, 1000)); // Wait 1s\r\n        \r\n        const finalMemory = metricsCollector.getCurrentMemoryUsage();\r\n        const memoryGrowth = finalMemory - initialMemory;\r\n        const maxAllowedGrowth = 5 * 1024 * 1024; // 5MB\r\n        \r\n        return {\r\n          passed: memoryGrowth < maxAllowedGrowth,\r\n          reason: memoryGrowth >= maxAllowedGrowth \r\n            ? `Memory leak detected: grew by ${(memoryGrowth / 1024 / 1024).toFixed(1)}MB`\r\n            : undefined,\r\n          metrics: { initialMemory, finalMemory, memoryGrowth }\r\n        };\r\n      },\r\n      required: true,\r\n      timeout: 10000\r\n    },\r\n    \r\n    // âœ… Gate 3: Error Rate Threshold\r\n    {\r\n      name: 'Error Rate Threshold',\r\n      check: async () => {\r\n        const errorRate = 100 - metricsCollector.calculateSuccessRate();\r\n        const maxErrorRate = 1.0; // 1% max error rate\r\n        \r\n        return {\r\n          passed: errorRate <= maxErrorRate,\r\n          reason: errorRate > maxErrorRate \r\n            ? `Error rate too high: ${errorRate.toFixed(2)}% > ${maxErrorRate}%`\r\n            : undefined,\r\n          metrics: { errorRate, maxErrorRate }\r\n        };\r\n      },\r\n      required: true,\r\n      timeout: 3000\r\n    }\r\n  ];\r\n  \r\n  /**\r\n   * Run all release gates\r\n   */\r\n  async runReleaseGates(): Promise<{\r\n    passed: boolean;\r\n    results: Array<{\r\n      gate: string;\r\n      passed: boolean;\r\n      reason?: string;\r\n      metrics?: any;\r\n      duration: number;\r\n    }>;\r\n    overallMetrics: any;\r\n  }> {\r\n    const results = [];\r\n    let allPassed = true;\r\n    \r\n    for (const gate of this.gates) {\r\n      const startTime = Date.now();\r\n      \r\n      try {\r\n        // Run gate with timeout\r\n        const result = await Promise.race([\r\n          gate.check(),\r\n          new Promise<{ passed: boolean; reason: string }>((_, reject) =>\r\n            setTimeout(() => reject(new Error('Gate timeout')), gate.timeout)\r\n          )\r\n        ]);\r\n        \r\n        const duration = Date.now() - startTime;\r\n        \r\n        results.push({\r\n          gate: gate.name,\r\n          passed: result.passed,\r\n          reason: result.reason,\r\n          metrics: result.metrics,\r\n          duration\r\n        });\r\n        \r\n        if (gate.required && !result.passed) {\r\n          allPassed = false;\r\n        }\r\n        \r\n      } catch (error) {\r\n        const duration = Date.now() - startTime;\r\n        \r\n        results.push({\r\n          gate: gate.name,\r\n          passed: false,\r\n          reason: `Gate execution failed: ${error}`,\r\n          duration\r\n        });\r\n        \r\n        if (gate.required) {\r\n          allPassed = false;\r\n        }\r\n      }\r\n    }\r\n    \r\n    // Collect overall metrics\r\n    const monitor = new SLOMonitor(metricsCollector);\r\n    const complianceReport = monitor.getComplianceReport();\r\n    \r\n    return {\r\n      passed: allPassed,\r\n      results,\r\n      overallMetrics: {\r\n        ...complianceReport.summary,\r\n        sloViolations: complianceReport.violations.length,\r\n        totalOperations: metricsCollector['metrics'].length\r\n      }\r\n    };\r\n  }\r\n}\r\n\r\n// ===== Global Metrics Instance =====\r\nexport const metricsCollector = new SpeechMetricsCollector();\r\nexport const sloMonitor = new SLOMonitor(metricsCollector);\r\nexport const releaseGateValidator = new ReleaseGateValidator();\r\n\r\n// ===== Integration with Speech Plugin =====\r\n\r\nexport function instrumentSpeechPlugin<T extends { speakText: any; recognizeSpeech: any; playBeep: any }>(\r\n  plugin: T\r\n): T {\r\n  const originalSpeakText = plugin.speakText.bind(plugin);\r\n  const originalRecognizeSpeech = plugin.recognizeSpeech.bind(plugin);\r\n  const originalPlayBeep = plugin.playBeep.bind(plugin);\r\n  \r\n  plugin.speakText = async (text: string, opts: any = {}) => {\r\n    const operationId = `speak-${Date.now()}-${Math.random()}`;\r\n    \r\n    metricsCollector.startOperation(operationId, 'speakText', {\r\n      textLength: text.length,\r\n      language: opts.language,\r\n      priority: opts.priority\r\n    });\r\n    \r\n    try {\r\n      const result = await originalSpeakText(text, opts);\r\n      \r\n      metricsCollector.completeOperation(operationId, {\r\n        success: result.ok || result.success,\r\n        errorCode: !result.ok ? result.code : undefined,\r\n        errorMessage: !result.ok ? result.cause : undefined,\r\n        interrupted: false // Would need to track this from plugin\r\n      });\r\n      \r\n      return result;\r\n    } catch (error) {\r\n      metricsCollector.completeOperation(operationId, {\r\n        success: false,\r\n        errorCode: 'E_EXCEPTION',\r\n        errorMessage: error instanceof Error ? error.message : 'Unknown error'\r\n      });\r\n      throw error;\r\n    }\r\n  };\r\n  \r\n  // Similar instrumentation for recognizeSpeech and playBeep...\r\n  \r\n  return plugin;\r\n}\r\n\r\n// ===== Export for dashboard integration =====\r\nexport function getMetricsDashboardData(): {\r\n  realTimeMetrics: {\r\n    p95Latency: number;\r\n    successRate: number;\r\n    interruptionRate: number;\r\n    memoryUsage: number;\r\n    activeOperations: number;\r\n  };\r\n  sloCompliance: {\r\n    compliant: boolean;\r\n    violations: SLOViolation[];\r\n  };\r\n  errorBreakdown: Record<string, number>;\r\n  historicalTrends: {\r\n    timestamps: number[];\r\n    latencies: number[];\r\n    successRates: number[];\r\n  };\r\n} {\r\n  const report = sloMonitor.getComplianceReport();\r\n  \r\n  return {\r\n    realTimeMetrics: {\r\n      p95Latency: report.summary.latencyP95,\r\n      successRate: report.summary.successRate,\r\n      interruptionRate: report.summary.interruptionRate,\r\n      memoryUsage: report.summary.memoryUsage,\r\n      activeOperations: metricsCollector['currentOperations'].size\r\n    },\r\n    sloCompliance: {\r\n      compliant: report.compliant,\r\n      violations: report.violations\r\n    },\r\n    errorBreakdown: report.summary.errorBreakdown,\r\n    historicalTrends: {\r\n      // Would need to implement time-series storage for real historical data\r\n      timestamps: [Date.now() - 60000, Date.now() - 30000, Date.now()],\r\n      latencies: [120, 115, 108],\r\n      successRates: [99.8, 99.7, 99.9]\r\n    }\r\n  };\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\plugins\\simple\\SimplePluginSystem.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\plugins\\simple\\SimpleSpeechPlugin.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TimeoutController' is defined but never used. Allowed unused vars must match /^_/u.","line":16,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":16,"endColumn":20}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * ë‹¨ìˆœí™”ëœ Speech í”ŒëŸ¬ê·¸ì¸\r\n * @description ê³¼ë„í•œ ì¶”ìƒí™” ì œê±°, ì·¨ì†Œ ì§€ì›, í‘œì¤€ ì—ëŸ¬ ì²˜ë¦¬\r\n */\r\n\r\nimport { \r\n  ISpeechPlugin, \r\n  SpeechOptions, \r\n  RecognitionOptions,\r\n  SpeechResult, \r\n  RecognitionResult,\r\n  Result,\r\n  Ok,\r\n  CommonErrors,\r\n  withTimeout,\r\n  TimeoutController\r\n} from './SimplePluginSystem';\r\n\r\n/**\r\n * ì›¹ ë¸Œë¼ìš°ì € Speech APIë¥¼ ì‚¬ìš©í•˜ëŠ” ë‹¨ìˆœí•œ êµ¬í˜„\r\n */\r\nexport class SimpleSpeechPlugin implements ISpeechPlugin {\r\n  readonly name = 'simple-speech';\r\n  readonly version = '1.0.0';\r\n  \r\n  private synthesis?: SpeechSynthesis;\r\n  private recognition?: SpeechRecognition;\r\n  private audioContext?: AudioContext;\r\n  \r\n  // í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ ì‘ì—…ë“¤ (ì·¨ì†Œìš©)\r\n  private currentSpeech?: {\r\n    utterance: SpeechSynthesisUtterance;\r\n    controller: AbortController;\r\n  };\r\n  \r\n  private currentRecognition?: {\r\n    recognition: SpeechRecognition;\r\n    controller: AbortController;\r\n  };\r\n\r\n  /**\r\n   * ì´ˆê¸°í™”\r\n   */\r\n  async initialize(): Promise<Result<void>> {\r\n    try {\r\n      // Speech Synthesis í™•ì¸\r\n      if (!window.speechSynthesis) {\r\n        return CommonErrors.UNSUPPORTED('speechSynthesis');\r\n      }\r\n      this.synthesis = window.speechSynthesis;\r\n\r\n      // Speech Recognition í™•ì¸ (ì„ íƒì )\r\n      const SpeechRecognition = window.SpeechRecognition || \r\n                               (window as any).webkitSpeechRecognition;\r\n      if (SpeechRecognition) {\r\n        this.recognition = new SpeechRecognition();\r\n      }\r\n\r\n      // AudioContext í™•ì¸ (ì‹ í˜¸ìŒìš©)\r\n      const AudioContext = window.AudioContext || \r\n                           (window as any).webkitAudioContext;\r\n      if (AudioContext) {\r\n        this.audioContext = new AudioContext();\r\n      }\r\n\r\n      return Ok(undefined);\r\n    } catch (error) {\r\n      return CommonErrors.INTERNAL(`Initialization failed: ${error}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ì •ë¦¬\r\n   */\r\n  async dispose(): Promise<Result<void>> {\r\n    try {\r\n      // ëª¨ë“  ì‘ì—… ì¤‘ì§€\r\n      this.stopAll('dispose');\r\n      \r\n      // AudioContext ì •ë¦¬\r\n      if (this.audioContext && this.audioContext.state !== 'closed') {\r\n        await this.audioContext.close();\r\n      }\r\n\r\n      return Ok(undefined);\r\n    } catch (error) {\r\n      return CommonErrors.INTERNAL(`Dispose failed: ${error}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * í…ìŠ¤íŠ¸ ìŒì„± ë³€í™˜ (ì·¨ì†Œ ì§€ì›)\r\n   */\r\n  async speakText(text: string, opts: SpeechOptions = {}): Promise<Result<SpeechResult>> {\r\n    if (!this.synthesis) {\r\n      return CommonErrors.UNSUPPORTED('speechSynthesis');\r\n    }\r\n\r\n    if (!text.trim()) {\r\n      return CommonErrors.INVALID_INPUT('text cannot be empty');\r\n    }\r\n\r\n    // ê¸°ì¡´ ìŒì„± ì¤‘ì§€\r\n    if (this.currentSpeech) {\r\n      this.currentSpeech.controller.abort('new-request');\r\n    }\r\n\r\n    const controller = new AbortController();\r\n    const utterance = new SpeechSynthesisUtterance(text);\r\n    \r\n    // ì„¤ì • ì ìš©\r\n    if (opts.language) utterance.lang = opts.language;\r\n    if (opts.rate) utterance.rate = Math.max(0.1, Math.min(10, opts.rate));\r\n\r\n    this.currentSpeech = { utterance, controller };\r\n\r\n    return new Promise((resolve) => {\r\n      const startTime = Date.now();\r\n      let resolved = false;\r\n\r\n      const cleanup = () => {\r\n        if (this.currentSpeech?.utterance === utterance) {\r\n          this.currentSpeech = undefined;\r\n        }\r\n        resolved = true;\r\n      };\r\n\r\n      // ì·¨ì†Œ ì²˜ë¦¬\r\n      const handleAbort = () => {\r\n        if (resolved) return;\r\n        cleanup();\r\n        this.synthesis!.cancel();\r\n        resolve(CommonErrors.ABORTED(controller.signal.reason || 'unknown'));\r\n      };\r\n\r\n      // ì™¸ë¶€ signal ì—°ê²°\r\n      if (opts.signal) {\r\n        opts.signal.addEventListener('abort', handleAbort);\r\n      }\r\n      \r\n      controller.signal.addEventListener('abort', handleAbort);\r\n\r\n      // ìŒì„± ì´ë²¤íŠ¸ ì²˜ë¦¬\r\n      utterance.onstart = () => {\r\n        if (resolved) return;\r\n        console.log(`[Speech] Started: \"${text}\"`);\r\n      };\r\n\r\n      utterance.onend = () => {\r\n        if (resolved) return;\r\n        cleanup();\r\n        \r\n        const duration = Date.now() - startTime;\r\n        resolve(Ok({\r\n          duration,\r\n          actualText: text\r\n        }));\r\n      };\r\n\r\n      utterance.onerror = (event) => {\r\n        if (resolved) return;\r\n        cleanup();\r\n        \r\n        const errorMap: Record<string, typeof CommonErrors[keyof typeof CommonErrors]> = {\r\n          'not-allowed': CommonErrors.PERMISSION_DENIED,\r\n          'network': CommonErrors.NETWORK,\r\n          'synthesis-unavailable': CommonErrors.UNSUPPORTED,\r\n          'synthesis-failed': CommonErrors.INTERNAL,\r\n          'language-unavailable': () => CommonErrors.UNSUPPORTED(`language: ${opts.language}`),\r\n          'voice-unavailable': CommonErrors.UNSUPPORTED,\r\n          'text-too-long': () => CommonErrors.INVALID_INPUT('text too long'),\r\n          'rate-not-supported': () => CommonErrors.INVALID_INPUT(`rate: ${opts.rate}`),\r\n          'interrupted': CommonErrors.ABORTED,\r\n          'paused': CommonErrors.ABORTED\r\n        };\r\n\r\n        const errorFn = errorMap[event.error] || CommonErrors.INTERNAL;\r\n        resolve(typeof errorFn === 'function' ? errorFn() : errorFn(`TTS error: ${event.error}`));\r\n      };\r\n\r\n      try {\r\n        this.synthesis!.speak(utterance);\r\n      } catch (error) {\r\n        if (resolved) return;\r\n        cleanup();\r\n        resolve(CommonErrors.INTERNAL(`Speech failed: ${error}`));\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * ìŒì„± ì¸ì‹ (ì·¨ì†Œ ì§€ì›)\r\n   */\r\n  async recognizeSpeech(opts: RecognitionOptions = {}): Promise<Result<RecognitionResult>> {\r\n    if (!this.recognition) {\r\n      return CommonErrors.UNSUPPORTED('speechRecognition');\r\n    }\r\n\r\n    // ê¸°ì¡´ ì¸ì‹ ì¤‘ì§€\r\n    if (this.currentRecognition) {\r\n      this.currentRecognition.controller.abort('new-request');\r\n    }\r\n\r\n    const controller = new AbortController();\r\n    const recognition = new (window.SpeechRecognition || \r\n                            (window as any).webkitSpeechRecognition)();\r\n    \r\n    // ì„¤ì • ì ìš©\r\n    recognition.lang = opts.language || 'ko-KR';\r\n    recognition.continuous = opts.continuous || false;\r\n    recognition.interimResults = true;\r\n\r\n    this.currentRecognition = { recognition, controller };\r\n\r\n    const recognitionPromise = new Promise<RecognitionResult>((resolve, reject) => {\r\n      let finalTranscript = '';\r\n      let maxConfidence = 0;\r\n      let resolved = false;\r\n\r\n      const cleanup = () => {\r\n        if (this.currentRecognition?.recognition === recognition) {\r\n          this.currentRecognition = undefined;\r\n        }\r\n        resolved = true;\r\n      };\r\n\r\n      // ì·¨ì†Œ ì²˜ë¦¬\r\n      const handleAbort = () => {\r\n        if (resolved) return;\r\n        cleanup();\r\n        try { recognition.stop(); } catch {}\r\n        reject(new Error('aborted'));\r\n      };\r\n\r\n      if (opts.signal) {\r\n        opts.signal.addEventListener('abort', handleAbort);\r\n      }\r\n      \r\n      controller.signal.addEventListener('abort', handleAbort);\r\n\r\n      // íƒ€ì„ì•„ì›ƒ ì²˜ë¦¬\r\n      let timeoutId: NodeJS.Timeout | undefined;\r\n      if (opts.maxDuration && opts.maxDuration > 0) {\r\n        timeoutId = setTimeout(() => {\r\n          if (resolved) return;\r\n          cleanup();\r\n          try { recognition.stop(); } catch {}\r\n          reject(new Error('timeout'));\r\n        }, opts.maxDuration);\r\n      }\r\n\r\n      recognition.onstart = () => {\r\n        console.log('[Speech Recognition] Started');\r\n      };\r\n\r\n      recognition.onresult = (event) => {\r\n        if (resolved) return;\r\n        \r\n        for (let i = event.resultIndex; i < event.results.length; i++) {\r\n          const result = event.results[i];\r\n          if (result.isFinal) {\r\n            finalTranscript += result[0].transcript;\r\n            maxConfidence = Math.max(maxConfidence, result[0].confidence);\r\n          }\r\n        }\r\n      };\r\n\r\n      recognition.onend = () => {\r\n        if (resolved) return;\r\n        cleanup();\r\n        if (timeoutId) clearTimeout(timeoutId);\r\n        \r\n        if (finalTranscript.trim()) {\r\n          resolve({\r\n            transcript: finalTranscript.trim(),\r\n            confidence: maxConfidence,\r\n            isFinal: true\r\n          });\r\n        } else {\r\n          reject(new Error('no-speech'));\r\n        }\r\n      };\r\n\r\n      recognition.onerror = (event) => {\r\n        if (resolved) return;\r\n        cleanup();\r\n        if (timeoutId) clearTimeout(timeoutId);\r\n        \r\n        reject(new Error(event.error));\r\n      };\r\n\r\n      try {\r\n        recognition.start();\r\n      } catch (error) {\r\n        cleanup();\r\n        if (timeoutId) clearTimeout(timeoutId);\r\n        reject(error);\r\n      }\r\n    });\r\n\r\n    // withTimeoutìœ¼ë¡œ ê°ì‹¸ì„œ í‘œì¤€ Result ë°˜í™˜\r\n    return withTimeout(recognitionPromise, opts.maxDuration || 30000, opts.signal)\r\n      .then(result => {\r\n        if (!result.ok) {\r\n          // ì—ëŸ¬ íƒ€ì…ë³„ ë§¤í•‘\r\n          if (result.code === 'E_TIMEOUT') return result;\r\n          if (result.code === 'E_ABORTED') return result;\r\n          \r\n          const cause = result.cause || 'unknown';\r\n          if (cause.includes('not-allowed')) return CommonErrors.PERMISSION_DENIED();\r\n          if (cause.includes('network')) return CommonErrors.NETWORK();\r\n          if (cause.includes('no-speech')) return CommonErrors.INVALID_INPUT('no speech detected');\r\n          \r\n          return CommonErrors.INTERNAL(cause);\r\n        }\r\n        return result;\r\n      });\r\n  }\r\n\r\n  /**\r\n   * ì‹ í˜¸ìŒ ì¬ìƒ (ì·¨ì†Œ ì§€ì›)\r\n   */\r\n  async playBeep(frequency = 800, duration = 200): Promise<Result<void>> {\r\n    if (!this.audioContext) {\r\n      return CommonErrors.UNSUPPORTED('audioContext');\r\n    }\r\n\r\n    try {\r\n      const context = this.audioContext;\r\n      \r\n      // AudioContext í™œì„±í™”\r\n      if (context.state === 'suspended') {\r\n        await context.resume();\r\n      }\r\n\r\n      const oscillator = context.createOscillator();\r\n      const gainNode = context.createGain();\r\n      \r\n      oscillator.connect(gainNode);\r\n      gainNode.connect(context.destination);\r\n      \r\n      oscillator.frequency.value = frequency;\r\n      oscillator.type = 'sine';\r\n      \r\n      // ë¶€ë“œëŸ¬ìš´ í˜ì´ë“œ ì¸/ì•„ì›ƒ\r\n      const now = context.currentTime;\r\n      gainNode.gain.setValueAtTime(0, now);\r\n      gainNode.gain.linearRampToValueAtTime(0.3, now + 0.01);\r\n      gainNode.gain.exponentialRampToValueAtTime(0.01, now + duration / 1000);\r\n      \r\n      oscillator.start(now);\r\n      oscillator.stop(now + duration / 1000);\r\n      \r\n      return Ok(undefined);\r\n    } catch (error) {\r\n      return CommonErrors.INTERNAL(`Beep failed: ${error}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ëª¨ë“  ì‘ì—… ì¤‘ì§€\r\n   */\r\n  stopAll(reason: 'user' | 'navigate' | 'error' = 'user'): Result<void> {\r\n    try {\r\n      // TTS ì¤‘ì§€\r\n      if (this.currentSpeech) {\r\n        this.currentSpeech.controller.abort(reason);\r\n        this.synthesis?.cancel();\r\n      }\r\n\r\n      // STT ì¤‘ì§€\r\n      if (this.currentRecognition) {\r\n        this.currentRecognition.controller.abort(reason);\r\n      }\r\n\r\n      return Ok(undefined);\r\n    } catch (error) {\r\n      return CommonErrors.INTERNAL(`Stop failed: ${error}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ì²˜ë¦¬ ì¤‘ì¸ì§€ í™•ì¸\r\n   */\r\n  isProcessing(): boolean {\r\n    return !!(this.currentSpeech || this.currentRecognition);\r\n  }\r\n}\r\n\r\n// ===== React Hook (ë‹¨ìˆœí™”ëœ ë²„ì „) =====\r\nimport { useState, useEffect, useCallback } from 'react';\r\nimport { simplePluginManager } from './SimplePluginSystem';\r\n\r\nexport function useSimpleSpeech() {\r\n  const [plugin, setPlugin] = useState<SimpleSpeechPlugin | null>(null);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    const init = async () => {\r\n      try {\r\n        setIsLoading(true);\r\n        \r\n        // í”ŒëŸ¬ê·¸ì¸ ìƒì„± ë° ë“±ë¡ (í•œ ë²ˆë§Œ)\r\n        let speechPlugin = simplePluginManager.get<SimpleSpeechPlugin>('speech');\r\n        if (!speechPlugin.ok) {\r\n          const newPlugin = new SimpleSpeechPlugin();\r\n          const registerResult = simplePluginManager.register('speech', newPlugin);\r\n          if (!registerResult.ok) {\r\n            throw new Error(registerResult.cause);\r\n          }\r\n          \r\n          const initResult = await newPlugin.initialize();\r\n          if (!initResult.ok) {\r\n            throw new Error(initResult.cause);\r\n          }\r\n          \r\n          setPlugin(newPlugin);\r\n        } else {\r\n          setPlugin(speechPlugin.data);\r\n        }\r\n        \r\n        setError(null);\r\n      } catch (err) {\r\n        setError(err instanceof Error ? err.message : 'Unknown error');\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n    };\r\n\r\n    init();\r\n  }, []);\r\n\r\n  const speakText = useCallback(async (\r\n    text: string, \r\n    options?: SpeechOptions\r\n  ): Promise<boolean> => {\r\n    if (!plugin) return false;\r\n    \r\n    const result = await plugin.speakText(text, options);\r\n    if (!result.ok) {\r\n      setError(result.cause || result.code);\r\n      return false;\r\n    }\r\n    \r\n    return true;\r\n  }, [plugin]);\r\n\r\n  const recognizeSpeech = useCallback(async (\r\n    options?: RecognitionOptions\r\n  ): Promise<{ success: boolean; transcript?: string; confidence?: number }> => {\r\n    if (!plugin) return { success: false };\r\n    \r\n    const result = await plugin.recognizeSpeech(options);\r\n    if (!result.ok) {\r\n      setError(result.cause || result.code);\r\n      return { success: false };\r\n    }\r\n    \r\n    return {\r\n      success: true,\r\n      transcript: result.data.transcript,\r\n      confidence: result.data.confidence\r\n    };\r\n  }, [plugin]);\r\n\r\n  const playBeep = useCallback(async (): Promise<boolean> => {\r\n    if (!plugin) return false;\r\n    \r\n    const result = await plugin.playBeep();\r\n    if (!result.ok) {\r\n      setError(result.cause || result.code);\r\n      return false;\r\n    }\r\n    \r\n    return true;\r\n  }, [plugin]);\r\n\r\n  const stopAll = useCallback((): boolean => {\r\n    if (!plugin) return false;\r\n    \r\n    const result = plugin.stopAll('user');\r\n    if (!result.ok) {\r\n      setError(result.cause || result.code);\r\n      return false;\r\n    }\r\n    \r\n    return true;\r\n  }, [plugin]);\r\n\r\n  return {\r\n    // ìƒíƒœ\r\n    isLoading,\r\n    error,\r\n    isProcessing: plugin?.isProcessing() || false,\r\n    \r\n    // ë©”ì„œë“œ\r\n    speakText,\r\n    recognizeSpeech,\r\n    playBeep,\r\n    stopAll,\r\n    \r\n    // ì§ì ‘ í”ŒëŸ¬ê·¸ì¸ ì ‘ê·¼ (ê³ ê¸‰ ì‚¬ìš©)\r\n    plugin\r\n  };\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\plugins\\speech\\ISpeechPlugin.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\plugins\\speech\\SpeechFeatureChunk.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\plugins\\speech\\WebSpeechPlugin.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'assertPositiveNumber' is defined but never used. Allowed unused vars must match /^_/u.","line":26,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":26,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'config' is defined but never used. Allowed unused args must match /^_/u.","line":70,"column":32,"nodeType":null,"messageId":"unusedVar","endLine":70,"endColumn":38}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Web Speech API í”ŒëŸ¬ê·¸ì¸ êµ¬í˜„\r\n * @description ë¸Œë¼ìš°ì €ì˜ Web Speech APIë¥¼ ì‚¬ìš©í•˜ëŠ” í”ŒëŸ¬ê·¸ì¸\r\n */\r\n\r\nimport { BasePlugin } from '@/plugins/core/BasePlugin';\r\nimport { \r\n  ISpeechPlugin, \r\n  SpeechPluginConfig, \r\n  SpeechProcessingState,\r\n  SpeechPluginEvent,\r\n  SpeechEventHandler \r\n} from './ISpeechPlugin';\r\nimport { \r\n  SpeechResult, \r\n  SpeechRecognitionResult,\r\n  SpeechResultCallback \r\n} from '@/types/services';\r\nimport { \r\n  NonEmptyString, \r\n  PositiveNumber, \r\n  Result, \r\n  Ok, \r\n  Err,\r\n  assertNonEmptyString,\r\n  assertPositiveNumber \r\n} from '@/types/core';\r\n\r\n/**\r\n * Web Speech API í”ŒëŸ¬ê·¸ì¸\r\n */\r\nexport class WebSpeechPlugin extends BasePlugin implements ISpeechPlugin {\r\n  private _processingState: SpeechProcessingState = 'idle';\r\n  private speechSynthesis?: SpeechSynthesis;\r\n  private speechRecognition?: SpeechRecognition;\r\n  private audioContext?: AudioContext;\r\n  \r\n  // í˜„ì¬ ì²˜ë¦¬ ì¤‘ì¸ ì‘ì—…ë“¤\r\n  private currentUtterance?: SpeechSynthesisUtterance;\r\n  private currentRecognition?: SpeechRecognition;\r\n  \r\n  // ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë“¤\r\n  private speechEventHandlers = new Set<SpeechEventHandler>();\r\n  \r\n  constructor() {\r\n    super({\r\n      name: assertNonEmptyString('web-speech', 'plugin name'),\r\n      version: assertNonEmptyString('1.0.0', 'plugin version'),\r\n      description: 'Web Speech API plugin for TTS and Speech Recognition',\r\n      author: 'DaSi Team',\r\n      tags: ['speech', 'tts', 'recognition', 'web-api']\r\n    });\r\n  }\r\n\r\n  get processingState(): SpeechProcessingState {\r\n    return this._processingState;\r\n  }\r\n\r\n  private setProcessingState(state: SpeechProcessingState): void {\r\n    if (this._processingState !== state) {\r\n      this._processingState = state;\r\n      this.emitSpeechEvent({\r\n        type: 'stateChange',\r\n        timestamp: Date.now(),\r\n        data: { state }\r\n      });\r\n    }\r\n  }\r\n\r\n  protected async onInitialize(config: SpeechPluginConfig): Promise<Result<void>> {\r\n    return this.safeAsync(async () => {\r\n      // Web Speech API ì§€ì› í™•ì¸\r\n      if (!window.speechSynthesis) {\r\n        throw new Error('SpeechSynthesis not supported');\r\n      }\r\n\r\n      // SpeechRecognition ì§€ì› í™•ì¸ (ì„ íƒì )\r\n      const SpeechRecognitionConstructor = \r\n        window.SpeechRecognition || \r\n        (window as any).webkitSpeechRecognition;\r\n      \r\n      if (!SpeechRecognitionConstructor) {\r\n        console.warn('SpeechRecognition not supported - TTS only mode');\r\n      }\r\n\r\n      this.speechSynthesis = window.speechSynthesis;\r\n      \r\n      if (SpeechRecognitionConstructor) {\r\n        this.speechRecognition = new SpeechRecognitionConstructor();\r\n        this.setupRecognition();\r\n      }\r\n\r\n      // AudioContext for beep sounds\r\n      if (window.AudioContext || (window as any).webkitAudioContext) {\r\n        const AudioContextConstructor = window.AudioContext || \r\n                                       (window as any).webkitAudioContext;\r\n        this.audioContext = new AudioContextConstructor();\r\n      }\r\n\r\n      console.log('WebSpeechPlugin initialized successfully');\r\n    }, 'Failed to initialize WebSpeechPlugin');\r\n  }\r\n\r\n  protected async onDispose(): Promise<Result<void>> {\r\n    return this.safeAsync(async () => {\r\n      // ëª¨ë“  ì²˜ë¦¬ ì¤‘ì§€\r\n      this.stopAll();\r\n      \r\n      // AudioContext ì •ë¦¬\r\n      if (this.audioContext && this.audioContext.state !== 'closed') {\r\n        await this.audioContext.close();\r\n      }\r\n\r\n      // ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì •ë¦¬\r\n      this.speechEventHandlers.clear();\r\n      \r\n      this.speechSynthesis = undefined;\r\n      this.speechRecognition = undefined;\r\n      this.audioContext = undefined;\r\n      \r\n      console.log('WebSpeechPlugin disposed successfully');\r\n    }, 'Failed to dispose WebSpeechPlugin');\r\n  }\r\n\r\n  protected validateConfig(config: SpeechPluginConfig): Result<void> {\r\n    try {\r\n      if (config.speechRate && (config.speechRate <= 0 || config.speechRate > 3)) {\r\n        return Err(new Error('speechRate must be between 0 and 3'));\r\n      }\r\n      return Ok(undefined);\r\n    } catch (error) {\r\n      return Err(error as Error);\r\n    }\r\n  }\r\n\r\n  private setupRecognition(): void {\r\n    if (!this.speechRecognition) return;\r\n\r\n    const config = this.getConfig() as SpeechPluginConfig;\r\n    \r\n    this.speechRecognition.continuous = config.enableContinuous ?? false;\r\n    this.speechRecognition.interimResults = config.enableInterimResults ?? true;\r\n    this.speechRecognition.lang = config.recognitionLanguage || 'ko-KR';\r\n  }\r\n\r\n  /**\r\n   * TTS êµ¬í˜„\r\n   */\r\n  async speakText(\r\n    text: NonEmptyString, \r\n    options: {\r\n      language?: NonEmptyString;\r\n      rate?: PositiveNumber;\r\n      volume?: number;\r\n      pitch?: number;\r\n    } = {}\r\n  ): Promise<Result<SpeechResult>> {\r\n    if (!this.speechSynthesis) {\r\n      return Err(new Error('Speech synthesis not available'));\r\n    }\r\n\r\n    if (this._processingState === 'speaking') {\r\n      return Err(new Error('Already speaking'));\r\n    }\r\n\r\n    return new Promise((resolve) => {\r\n      try {\r\n        const utterance = new SpeechSynthesisUtterance(text);\r\n        const config = this.getConfig() as SpeechPluginConfig;\r\n        \r\n        // ì„¤ì • ì ìš©\r\n        utterance.lang = options.language || config.synthesisLanguage || 'ko-KR';\r\n        utterance.rate = options.rate || config.speechRate || 1.0;\r\n        utterance.volume = options.volume ?? 1.0;\r\n        utterance.pitch = options.pitch ?? 1.0;\r\n\r\n        const startTime = Date.now();\r\n        \r\n        utterance.onstart = () => {\r\n          this.setProcessingState('speaking');\r\n          this.emitSpeechEvent({\r\n            type: 'start',\r\n            timestamp: Date.now()\r\n          });\r\n        };\r\n\r\n        utterance.onend = () => {\r\n          this.setProcessingState('idle');\r\n          const duration = Date.now() - startTime;\r\n          \r\n          this.emitSpeechEvent({\r\n            type: 'end',\r\n            timestamp: Date.now()\r\n          });\r\n\r\n          resolve(Ok({\r\n            success: true,\r\n            duration: duration as PositiveNumber\r\n          }));\r\n        };\r\n\r\n        utterance.onerror = (event) => {\r\n          this.setProcessingState('error');\r\n          const error = `TTS error: ${event.error}`;\r\n          \r\n          this.emitSpeechEvent({\r\n            type: 'error',\r\n            timestamp: Date.now(),\r\n            data: { error }\r\n          });\r\n\r\n          resolve(Err(new Error(error)));\r\n        };\r\n\r\n        this.currentUtterance = utterance;\r\n        this.speechSynthesis!.speak(utterance);\r\n        \r\n      } catch (error) {\r\n        this.setProcessingState('error');\r\n        resolve(Err(error as Error));\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * ìŒì„± ì¸ì‹ êµ¬í˜„\r\n   */\r\n  async recognizeSpeech(\r\n    options: {\r\n      language?: NonEmptyString;\r\n      maxDuration?: PositiveNumber;\r\n      continuous?: boolean;\r\n      interimResults?: boolean;\r\n    } = {}\r\n  ): Promise<Result<SpeechRecognitionResult>> {\r\n    if (!this.speechRecognition) {\r\n      return Err(new Error('Speech recognition not available'));\r\n    }\r\n\r\n    if (this._processingState === 'listening') {\r\n      return Err(new Error('Already listening'));\r\n    }\r\n\r\n    return new Promise((resolve) => {\r\n      try {\r\n        const recognition = this.speechRecognition!;\r\n        const config = this.getConfig() as SpeechPluginConfig;\r\n        \r\n        // ì„¤ì • ì ìš©\r\n        recognition.lang = options.language || config.recognitionLanguage || 'ko-KR';\r\n        recognition.continuous = options.continuous ?? false;\r\n        recognition.interimResults = options.interimResults ?? true;\r\n\r\n        let finalTranscript = '';\r\n        let maxConfidence = 0;\r\n        let hasResult = false;\r\n        \r\n        const cleanup = () => {\r\n          this.setProcessingState('idle');\r\n          this.currentRecognition = undefined;\r\n        };\r\n\r\n        recognition.onstart = () => {\r\n          this.setProcessingState('listening');\r\n          this.emitSpeechEvent({\r\n            type: 'start',\r\n            timestamp: Date.now()\r\n          });\r\n        };\r\n\r\n        recognition.onresult = (event) => {\r\n          for (let i = event.resultIndex; i < event.results.length; i++) {\r\n            const result = event.results[i];\r\n            \r\n            if (result.isFinal) {\r\n              finalTranscript += result[0].transcript;\r\n              maxConfidence = Math.max(maxConfidence, result[0].confidence);\r\n              hasResult = true;\r\n            }\r\n\r\n            this.emitSpeechEvent({\r\n              type: 'result',\r\n              timestamp: Date.now(),\r\n              data: {\r\n                transcript: result[0].transcript as NonEmptyString,\r\n                confidence: result[0].confidence\r\n              }\r\n            });\r\n          }\r\n        };\r\n\r\n        recognition.onend = () => {\r\n          cleanup();\r\n          \r\n          this.emitSpeechEvent({\r\n            type: 'end',\r\n            timestamp: Date.now()\r\n          });\r\n\r\n          if (hasResult && finalTranscript.trim()) {\r\n            resolve(Ok({\r\n              success: true,\r\n              transcript: finalTranscript.trim() as NonEmptyString,\r\n              confidence: maxConfidence,\r\n              isFinal: true\r\n            }));\r\n          } else {\r\n            resolve(Ok({\r\n              success: false,\r\n              error: 'No speech detected'\r\n            }));\r\n          }\r\n        };\r\n\r\n        recognition.onerror = (event) => {\r\n          cleanup();\r\n          const error = `Speech recognition error: ${event.error}`;\r\n          \r\n          this.emitSpeechEvent({\r\n            type: 'error',\r\n            timestamp: Date.now(),\r\n            data: { error }\r\n          });\r\n\r\n          resolve(Err(new Error(error)));\r\n        };\r\n\r\n        // íƒ€ì„ì•„ì›ƒ ì²˜ë¦¬\r\n        if (options.maxDuration) {\r\n          setTimeout(() => {\r\n            if (this._processingState === 'listening') {\r\n              recognition.stop();\r\n            }\r\n          }, options.maxDuration);\r\n        }\r\n\r\n        this.currentRecognition = recognition;\r\n        recognition.start();\r\n        \r\n      } catch (error) {\r\n        this.setProcessingState('error');\r\n        resolve(Err(error as Error));\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * ì‹¤ì‹œê°„ ìŒì„± ì¸ì‹ ì‹œì‘\r\n   */\r\n  startListening(\r\n    onResult: SpeechResultCallback,\r\n    options: {\r\n      language?: NonEmptyString;\r\n      continuous?: boolean;\r\n      interimResults?: boolean;\r\n    } = {}\r\n  ): Result<void> {\r\n    if (!this.speechRecognition) {\r\n      return Err(new Error('Speech recognition not available'));\r\n    }\r\n\r\n    if (this._processingState === 'listening') {\r\n      return Err(new Error('Already listening'));\r\n    }\r\n\r\n    try {\r\n      const recognition = this.speechRecognition;\r\n      const config = this.getConfig() as SpeechPluginConfig;\r\n      \r\n      recognition.lang = options.language || config.recognitionLanguage || 'ko-KR';\r\n      recognition.continuous = options.continuous ?? true;\r\n      recognition.interimResults = options.interimResults ?? true;\r\n\r\n      recognition.onresult = (event) => {\r\n        for (let i = event.resultIndex; i < event.results.length; i++) {\r\n          const result = event.results[i];\r\n          onResult(\r\n            result[0].transcript as NonEmptyString,\r\n            result[0].confidence\r\n          );\r\n        }\r\n      };\r\n\r\n      recognition.onstart = () => {\r\n        this.setProcessingState('listening');\r\n      };\r\n\r\n      recognition.onend = () => {\r\n        this.setProcessingState('idle');\r\n        // ìë™ ì¬ì‹œì‘ (continuous ëª¨ë“œì—ì„œ)\r\n        if (options.continuous && config.autoRestart) {\r\n          setTimeout(() => {\r\n            if (this._processingState === 'idle') {\r\n              recognition.start();\r\n            }\r\n          }, 100);\r\n        }\r\n      };\r\n\r\n      recognition.onerror = (event) => {\r\n        this.setProcessingState('error');\r\n        console.error('Speech recognition error:', event.error);\r\n      };\r\n\r\n      this.currentRecognition = recognition;\r\n      recognition.start();\r\n      \r\n      return Ok(undefined);\r\n    } catch (error) {\r\n      return Err(error as Error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ìŒì„± ì¸ì‹ ì¤‘ì§€\r\n   */\r\n  stopListening(): Result<void> {\r\n    if (!this.currentRecognition) {\r\n      return Ok(undefined);\r\n    }\r\n\r\n    try {\r\n      this.currentRecognition.stop();\r\n      this.currentRecognition = undefined;\r\n      this.setProcessingState('idle');\r\n      return Ok(undefined);\r\n    } catch (error) {\r\n      return Err(error as Error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ì‹ í˜¸ìŒ ì¬ìƒ\r\n   */\r\n  async playBeep(\r\n    options: {\r\n      frequency?: PositiveNumber;\r\n      duration?: PositiveNumber;\r\n      volume?: number;\r\n    } = {}\r\n  ): Promise<Result<void>> {\r\n    if (!this.audioContext) {\r\n      return Err(new Error('AudioContext not available'));\r\n    }\r\n\r\n    return this.safeAsync(async () => {\r\n      const context = this.audioContext!;\r\n      const frequency = options.frequency || (800 as PositiveNumber);\r\n      const duration = options.duration || (200 as PositiveNumber);\r\n      const volume = options.volume ?? 0.3;\r\n\r\n      // AudioContextê°€ suspended ìƒíƒœë©´ resume\r\n      if (context.state === 'suspended') {\r\n        await context.resume();\r\n      }\r\n\r\n      const oscillator = context.createOscillator();\r\n      const gainNode = context.createGain();\r\n      \r\n      oscillator.connect(gainNode);\r\n      gainNode.connect(context.destination);\r\n      \r\n      oscillator.frequency.value = frequency;\r\n      oscillator.type = 'sine';\r\n      \r\n      gainNode.gain.setValueAtTime(0, context.currentTime);\r\n      gainNode.gain.linearRampToValueAtTime(volume, context.currentTime + 0.01);\r\n      gainNode.gain.exponentialRampToValueAtTime(0.01, context.currentTime + duration / 1000);\r\n      \r\n      oscillator.start(context.currentTime);\r\n      oscillator.stop(context.currentTime + duration / 1000);\r\n      \r\n      return new Promise<void>((resolve) => {\r\n        oscillator.onended = () => resolve();\r\n      });\r\n    }, 'Failed to play beep');\r\n  }\r\n\r\n  /**\r\n   * ëª¨ë“  ì²˜ë¦¬ ì¤‘ì§€ - ë¸Œë¼ìš°ì € í˜¸í™˜ì„± ê°•í™”\r\n   */\r\n  stopAll(): Result<void> {\r\n    try {\r\n      // TTS ì¤‘ì§€ - ë‹¤ì¤‘ ì·¨ì†Œ ì‹œë„ë¡œ ë¸Œë¼ìš°ì € í˜¸í™˜ì„± í™•ë³´\r\n      if (this.speechSynthesis) {\r\n        this.speechSynthesis.cancel();\r\n        this.currentUtterance = undefined;\r\n        \r\n        // ë¸Œë¼ìš°ì €ë³„ ì•ˆì „ì„ ìœ„í•´ ì—¬ëŸ¬ ë²ˆ ì‹œë„\r\n        setTimeout(() => {\r\n          if (this.speechSynthesis && this.speechSynthesis.speaking) {\r\n            this.speechSynthesis.cancel();\r\n          }\r\n        }, 10);\r\n        \r\n        setTimeout(() => {\r\n          if (this.speechSynthesis && this.speechSynthesis.speaking) {\r\n            this.speechSynthesis.cancel();\r\n          }\r\n        }, 100);\r\n      }\r\n\r\n      // ìŒì„± ì¸ì‹ ì¤‘ì§€\r\n      if (this.currentRecognition && this._processingState === 'listening') {\r\n        this.currentRecognition.stop();\r\n        this.currentRecognition = undefined;\r\n      }\r\n\r\n      this.setProcessingState('idle');\r\n      \r\n      this.emitSpeechEvent({\r\n        type: 'end',\r\n        timestamp: Date.now(),\r\n        data: { state: 'idle' }\r\n      });\r\n      \r\n      console.log('ğŸ”‡ ëª¨ë“  ìŒì„± ì²˜ë¦¬ ì¤‘ë‹¨ (í”ŒëŸ¬ê·¸ì¸)');\r\n      return Ok(undefined);\r\n    } catch (error) {\r\n      console.error('âŒ ìŒì„± ì¤‘ë‹¨ ì˜¤ë¥˜ (í”ŒëŸ¬ê·¸ì¸):', error);\r\n      return Err(error as Error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ì²˜ë¦¬ ì¤‘ì¸ì§€ í™•ì¸\r\n   */\r\n  isProcessing(): boolean {\r\n    return this._processingState !== 'idle';\r\n  }\r\n\r\n  /**\r\n   * ì§€ì› ì–¸ì–´ ëª©ë¡\r\n   */\r\n  async getSupportedLanguages(): Promise<Result<readonly string[]>> {\r\n    return this.safeAsync(async () => {\r\n      // Web Speech APIëŠ” ì •í™•í•œ ì–¸ì–´ ëª©ë¡ì„ ì œê³µí•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ì¼ë°˜ì ì¸ ì–¸ì–´ë“¤ ë°˜í™˜\r\n      return [\r\n        'ko-KR', 'en-US', 'en-GB', 'ja-JP', 'zh-CN', 'zh-TW',\r\n        'es-ES', 'fr-FR', 'de-DE', 'it-IT', 'pt-PT', 'ru-RU'\r\n      ];\r\n    }, 'Failed to get supported languages');\r\n  }\r\n\r\n  /**\r\n   * ì‚¬ìš© ê°€ëŠ¥í•œ ìŒì„± ëª©ë¡\r\n   */\r\n  async getAvailableVoices(): Promise<Result<readonly SpeechSynthesisVoice[]>> {\r\n    if (!this.speechSynthesis) {\r\n      return Err(new Error('Speech synthesis not available'));\r\n    }\r\n\r\n    return this.safeAsync(async () => {\r\n      return new Promise<readonly SpeechSynthesisVoice[]>((resolve) => {\r\n        const getVoices = () => {\r\n          const voices = this.speechSynthesis!.getVoices();\r\n          if (voices.length > 0) {\r\n            resolve(voices);\r\n          } else {\r\n            // ì¼ë¶€ ë¸Œë¼ìš°ì €ì—ì„œëŠ” ë¹„ë™ê¸°ì ìœ¼ë¡œ ë¡œë“œë¨\r\n            setTimeout(getVoices, 100);\r\n          }\r\n        };\r\n        getVoices();\r\n      });\r\n    }, 'Failed to get available voices');\r\n  }\r\n\r\n  /**\r\n   * Speech ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ë“±ë¡\r\n   */\r\n  onSpeechEvent(handler: SpeechEventHandler): void {\r\n    this.speechEventHandlers.add(handler);\r\n  }\r\n\r\n  /**\r\n   * Speech ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì œê±°\r\n   */\r\n  offSpeechEvent(handler: SpeechEventHandler): void {\r\n    this.speechEventHandlers.delete(handler);\r\n  }\r\n\r\n  /**\r\n   * Speech ì´ë²¤íŠ¸ ë°œìƒ\r\n   */\r\n  private emitSpeechEvent(event: SpeechPluginEvent): void {\r\n    this.speechEventHandlers.forEach(handler => {\r\n      try {\r\n        handler(event);\r\n      } catch (error) {\r\n        console.error('Speech event handler error:', error);\r\n      }\r\n    });\r\n  }\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\plugins\\speech\\WebSpeechPluginFactory.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\plugins\\speed\\ISpeedTrainingPlugin.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\plugins\\speed\\SpeedTrainingPlugin.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\plugins\\speed\\SpeedTrainingPluginFactory.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\AudioFlowOrchestrator.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AdapterResult' is defined but never used. Allowed unused vars must match /^_/u.","line":11,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":16}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * AudioFlowOrchestrator - ì˜¤ë””ì˜¤ í”Œë¡œìš° ì „ì²´ ì¡°ìœ¨ ì„œë¹„ìŠ¤\r\n * ëª©ì : TTS â†’ Beep â†’ Recording â†’ Processing í”Œë¡œìš°ë¥¼ ì¤‘ì•™ì—ì„œ ê´€ë¦¬\r\n */\r\n\r\nimport { SpeechProcessingService, ProcessingResult } from './SpeechProcessingService';\r\nimport { AudioTimerService } from './AudioTimerService';\r\nimport { \r\n  IAudioContextAdapter, \r\n  BeepOptions, \r\n  AdapterResult \r\n} from '@/adapters/BrowserAPIAdapter';\r\n\r\nexport type FlowState = 'idle' | 'tts' | 'beep' | 'recording' | 'processing' | 'timeout';\r\n\r\nexport interface FlowOptions {\r\n  recordingDuration?: number;\r\n  beepOptions?: BeepOptions;\r\n  ttsOptions?: {\r\n    questionLanguage?: string;\r\n    answerLanguage?: string;\r\n    speechRate?: number;\r\n  };\r\n}\r\n\r\nexport interface FlowCallbacks {\r\n  onStateChange: (state: FlowState) => void;\r\n  onTimeUpdate: (remainingTime: number) => void;\r\n  onSpeechResult: (transcript: string, confidence: number) => void;\r\n  onTimeout: () => void;\r\n  onError?: (error: string) => void;\r\n}\r\n\r\nexport interface FlowStatus {\r\n  currentState: FlowState;\r\n  remainingTime: number;\r\n  isPaused: boolean;\r\n  canPause: boolean;\r\n  canResume: boolean;\r\n  canStop: boolean;\r\n}\r\n\r\nexport class AudioFlowOrchestrator {\r\n  private speechService: SpeechProcessingService;\r\n  private timerService: AudioTimerService;\r\n  private audioContextAdapter: IAudioContextAdapter;\r\n  \r\n  private currentState: FlowState = 'idle';\r\n  private isPaused = false;\r\n  private callbacks: FlowCallbacks;\r\n  private options: FlowOptions;\r\n  \r\n  // ê¸°ë³¸ ì„¤ì •\r\n  private defaultOptions: Required<FlowOptions> = {\r\n    recordingDuration: 10,\r\n    beepOptions: {\r\n      frequency: 800,\r\n      duration: 0.5,\r\n      volume: 0.3,\r\n      waveType: 'sine'\r\n    },\r\n    ttsOptions: {\r\n      questionLanguage: 'ko-KR',\r\n      answerLanguage: 'en-US',\r\n      speechRate: 0.9\r\n    }\r\n  };\r\n\r\n  constructor(\r\n    speechService: SpeechProcessingService,\r\n    timerService: AudioTimerService,\r\n    audioContextAdapter: IAudioContextAdapter,\r\n    callbacks: FlowCallbacks,\r\n    options: FlowOptions = {}\r\n  ) {\r\n    this.speechService = speechService;\r\n    this.timerService = timerService;\r\n    this.audioContextAdapter = audioContextAdapter;\r\n    this.callbacks = callbacks;\r\n    this.options = { ...this.defaultOptions, ...options };\r\n    \r\n    console.log('[AudioFlowOrchestrator] Initialized with options:', this.options);\r\n  }\r\n\r\n  /**\r\n   * ë©”ì¸ í”Œë¡œìš° ì‹œì‘: TTS â†’ Beep â†’ Recording\r\n   */\r\n  async startFlow(questionText: string): Promise<ProcessingResult> {\r\n    try {\r\n      const validationResult = this.validateFlowStart(questionText);\r\n      if (!validationResult.success) {\r\n        return validationResult;\r\n      }\r\n\r\n      this.initializeFlow();\r\n      \r\n      return await this.executeFlowSequence(questionText);\r\n\r\n    } catch (error) {\r\n      return this.handleFlowError(error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * í”Œë¡œìš° ì‹œì‘ ì „ ê²€ì¦\r\n   */\r\n  private validateFlowStart(questionText: string): ProcessingResult {\r\n    console.log('[AudioFlowOrchestrator] Starting flow with:', questionText);\r\n    \r\n    if (!questionText.trim()) {\r\n      return {\r\n        success: false,\r\n        error: 'Question text cannot be empty'\r\n      };\r\n    }\r\n\r\n    if (this.currentState !== 'idle') {\r\n      return {\r\n        success: false,\r\n        error: 'Flow already in progress'\r\n      };\r\n    }\r\n\r\n    return { success: true };\r\n  }\r\n\r\n  /**\r\n   * í”Œë¡œìš° ì´ˆê¸°í™”\r\n   */\r\n  private initializeFlow(): void {\r\n    this.setState('tts');\r\n    this.setPaused(false);\r\n  }\r\n\r\n  /**\r\n   * ìˆœì°¨ì  í”Œë¡œìš° ì‹¤í–‰: TTS â†’ Beep â†’ Recording\r\n   */\r\n  private async executeFlowSequence(questionText: string): Promise<ProcessingResult> {\r\n    // 1ë‹¨ê³„: TTS ì¬ìƒ\r\n    const ttsResult = await this.executeTTSPhase(questionText);\r\n    if (!ttsResult.success) {\r\n      return ttsResult;\r\n    }\r\n\r\n    // 2ë‹¨ê³„: Beep ì¬ìƒ\r\n    const beepResult = await this.executeBeepPhase();\r\n    if (!beepResult.success) {\r\n      return beepResult;\r\n    }\r\n\r\n    // 3ë‹¨ê³„: ë…¹ìŒ ì‹œì‘\r\n    const recordingResult = await this.executeRecordingPhase();\r\n    if (!recordingResult.success) {\r\n      return recordingResult;\r\n    }\r\n\r\n    return { success: true };\r\n  }\r\n\r\n  /**\r\n   * TTS ë‹¨ê³„ ì‹¤í–‰\r\n   */\r\n  private async executeTTSPhase(questionText: string): Promise<ProcessingResult> {\r\n    const ttsResult = await this.playQuestion(questionText);\r\n    \r\n    if (!ttsResult.success) {\r\n      return ttsResult;\r\n    }\r\n    \r\n    if (this.isPaused) {\r\n      return {\r\n        success: false,\r\n        error: 'Flow paused during TTS phase'\r\n      };\r\n    }\r\n\r\n    return { success: true };\r\n  }\r\n\r\n  /**\r\n   * Beep ë‹¨ê³„ ì‹¤í–‰\r\n   */\r\n  private async executeBeepPhase(): Promise<ProcessingResult> {\r\n    const beepResult = await this.playBeep();\r\n    \r\n    if (!beepResult.success) {\r\n      return beepResult;\r\n    }\r\n    \r\n    if (this.isPaused) {\r\n      return {\r\n        success: false,\r\n        error: 'Flow paused during beep phase'\r\n      };\r\n    }\r\n\r\n    return { success: true };\r\n  }\r\n\r\n  /**\r\n   * ë…¹ìŒ ë‹¨ê³„ ì‹¤í–‰\r\n   */\r\n  private async executeRecordingPhase(): Promise<ProcessingResult> {\r\n    return await this.startRecording();\r\n  }\r\n\r\n  /**\r\n   * í”Œë¡œìš° ì—ëŸ¬ ì²˜ë¦¬\r\n   */\r\n  private handleFlowError(error: unknown): ProcessingResult {\r\n    console.error('[AudioFlowOrchestrator] Flow error:', error);\r\n    \r\n    this.setState('idle');\r\n    \r\n    const errorMessage = error instanceof Error ? error.message : 'Unknown flow error';\r\n    this.callbacks.onError?.(errorMessage);\r\n    \r\n    return {\r\n      success: false,\r\n      error: errorMessage\r\n    };\r\n  }\r\n\r\n  /**\r\n   * 1ë‹¨ê³„: ë¬¸ì œ ìŒì„± ì¬ìƒ (í•œêµ­ì–´)\r\n   */\r\n  private async playQuestion(questionText: string): Promise<ProcessingResult> {\r\n    console.log('[AudioFlowOrchestrator] Playing question TTS');\r\n    \r\n    const result = await this.speechService.speakQuestion(questionText, {\r\n      lang: this.options.ttsOptions?.questionLanguage,\r\n      rate: this.options.ttsOptions?.speechRate\r\n    });\r\n\r\n    if (!result.success) {\r\n      this.callbacks.onError?.(result.error || 'Failed to play question');\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * 2ë‹¨ê³„: Beep ì¬ìƒ\r\n   */\r\n  private async playBeep(): Promise<ProcessingResult> {\r\n    try {\r\n      console.log('[AudioFlowOrchestrator] Playing beep');\r\n      this.setState('beep');\r\n\r\n      const result = await this.audioContextAdapter.createBeep(this.options.beepOptions);\r\n      \r\n      if (result.success) {\r\n        return { success: true };\r\n      } else {\r\n        return {\r\n          success: false,\r\n          error: result.error || 'Failed to play beep'\r\n        };\r\n      }\r\n\r\n    } catch (error) {\r\n      const errorMessage = error instanceof Error ? error.message : 'Beep creation error';\r\n      return {\r\n        success: false,\r\n        error: errorMessage\r\n      };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 3ë‹¨ê³„: ë…¹ìŒ ë° íƒ€ì´ë¨¸ ì‹œì‘\r\n   */\r\n  private async startRecording(): Promise<ProcessingResult> {\r\n    try {\r\n      console.log('[AudioFlowOrchestrator] Starting recording phase');\r\n      this.setState('recording');\r\n\r\n      // íƒ€ì´ë¨¸ ì‹œì‘\r\n      this.timerService.start(\r\n        this.options.recordingDuration!,\r\n        (remainingTime) => this.callbacks.onTimeUpdate(remainingTime),\r\n        () => this.handleTimeout()\r\n      );\r\n\r\n      // ìŒì„± ì¸ì‹ ì‹œì‘\r\n      const result = await this.speechService.recognizeSpeech(\r\n        (transcript, confidence) => this.handleSpeechResult(transcript, confidence),\r\n        (error) => this.callbacks.onError?.(error)\r\n      );\r\n\r\n      return result;\r\n\r\n    } catch (error) {\r\n      const errorMessage = error instanceof Error ? error.message : 'Recording start error';\r\n      return {\r\n        success: false,\r\n        error: errorMessage\r\n      };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ìŒì„± ì¸ì‹ ê²°ê³¼ ì²˜ë¦¬\r\n   */\r\n  private handleSpeechResult(transcript: string, confidence: number): void {\r\n    console.log('[AudioFlowOrchestrator] Speech result received:', { transcript, confidence });\r\n    \r\n    this.timerService.stop();\r\n    this.setState('processing');\r\n    \r\n    // ì ì‹œ í›„ ê²°ê³¼ ì „ë‹¬ ë° ìƒíƒœ ì´ˆê¸°í™”\r\n    setTimeout(() => {\r\n      this.callbacks.onSpeechResult(transcript, confidence);\r\n      this.setState('idle');\r\n    }, 100);\r\n  }\r\n\r\n  /**\r\n   * íƒ€ì„ì•„ì›ƒ ì²˜ë¦¬\r\n   */\r\n  private handleTimeout(): void {\r\n    console.log('[AudioFlowOrchestrator] Handling timeout');\r\n    \r\n    this.setState('timeout');\r\n    this.speechService.stopRecognition();\r\n    \r\n    // 1.5ì´ˆ í›„ íƒ€ì„ì•„ì›ƒ ì½œë°± í˜¸ì¶œ\r\n    setTimeout(() => {\r\n      this.callbacks.onTimeout();\r\n      this.setState('idle');\r\n    }, 1500);\r\n  }\r\n\r\n  /**\r\n   * ì •ë‹µ ì¬ìƒ ë° ë‹¤ìŒ ë‹¨ê³„ ì§„í–‰\r\n   */\r\n  async playAnswerAndNext(answerText?: string): Promise<void> {\r\n    if (answerText) {\r\n      try {\r\n        console.log('[AudioFlowOrchestrator] Playing answer:', answerText);\r\n        this.setState('processing');\r\n        \r\n        const result = await this.speechService.speakAnswer(answerText, {\r\n          lang: this.options.ttsOptions?.answerLanguage,\r\n          rate: this.options.ttsOptions?.speechRate\r\n        });\r\n\r\n        if (!result.success) {\r\n          console.error('[AudioFlowOrchestrator] Answer TTS error:', result.error);\r\n        }\r\n\r\n        // 1ì´ˆ í›„ ë‹¤ìŒ ë¬¸ì œë¡œ\r\n        setTimeout(() => {\r\n          this.setState('idle');\r\n          this.callbacks.onTimeout();\r\n        }, 1000);\r\n\r\n      } catch (error) {\r\n        console.error('[AudioFlowOrchestrator] Answer playback error:', error);\r\n        this.setState('idle');\r\n        this.callbacks.onTimeout();\r\n      }\r\n    } else {\r\n      this.setState('idle');\r\n      this.callbacks.onTimeout();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * í”Œë¡œìš° ì¼ì‹œì •ì§€\r\n   */\r\n  pauseFlow(): void {\r\n    console.log(`[AudioFlowOrchestrator] Pausing flow at state: ${this.currentState}`);\r\n    \r\n    switch (this.currentState) {\r\n      case 'tts':\r\n        this.speechService.pauseSpeech();\r\n        break;\r\n      case 'beep':\r\n        this.audioContextAdapter.stopBeep();\r\n        break;\r\n      case 'recording':\r\n        this.timerService.pause();\r\n        break;\r\n    }\r\n    \r\n    this.setPaused(true);\r\n  }\r\n\r\n  /**\r\n   * í”Œë¡œìš° ì¬ê°œ\r\n   */\r\n  resumeFlow(): void {\r\n    console.log(`[AudioFlowOrchestrator] Resuming flow at state: ${this.currentState}`);\r\n    \r\n    switch (this.currentState) {\r\n      case 'tts':\r\n        this.speechService.resumeSpeech();\r\n        break;\r\n      case 'recording':\r\n        this.timerService.resume();\r\n        break;\r\n    }\r\n    \r\n    this.setPaused(false);\r\n  }\r\n\r\n  /**\r\n   * í”Œë¡œìš° ì¤‘ì§€\r\n   */\r\n  stopFlow(): void {\r\n    console.log('[AudioFlowOrchestrator] Stopping flow');\r\n    \r\n    this.timerService.stop();\r\n    this.speechService.stopAllSpeech();\r\n    this.audioContextAdapter.stopBeep();\r\n    \r\n    this.setState('idle');\r\n    this.setPaused(false);\r\n  }\r\n\r\n  /**\r\n   * í˜„ì¬ ìƒíƒœ ì¡°íšŒ\r\n   */\r\n  getStatus(): FlowStatus {\r\n    return {\r\n      currentState: this.currentState,\r\n      remainingTime: this.timerService.getRemainingTime(),\r\n      isPaused: this.isPaused,\r\n      canPause: this.currentState !== 'idle' && !this.isPaused,\r\n      canResume: this.isPaused,\r\n      canStop: this.currentState !== 'idle'\r\n    };\r\n  }\r\n\r\n  /**\r\n   * ì˜µì…˜ ì—…ë°ì´íŠ¸\r\n   */\r\n  updateOptions(newOptions: Partial<FlowOptions>): void {\r\n    this.options = { ...this.options, ...newOptions };\r\n    console.log('[AudioFlowOrchestrator] Options updated:', this.options);\r\n  }\r\n\r\n  /**\r\n   * ìƒíƒœ ë³€ê²½ ë‚´ë¶€ ë©”ì„œë“œ\r\n   */\r\n  private setState(newState: FlowState): void {\r\n    if (this.currentState !== newState) {\r\n      console.log(`[AudioFlowOrchestrator] State change: ${this.currentState} â†’ ${newState}`);\r\n      this.currentState = newState;\r\n      this.callbacks.onStateChange(newState);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ì¼ì‹œì •ì§€ ìƒíƒœ ë³€ê²½ ë‚´ë¶€ ë©”ì„œë“œ\r\n   */\r\n  private setPaused(paused: boolean): void {\r\n    if (this.isPaused !== paused) {\r\n      this.isPaused = paused;\r\n      console.log(`[AudioFlowOrchestrator] Pause state changed: ${paused}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ë¦¬ì†ŒìŠ¤ ì •ë¦¬\r\n   */\r\n  cleanup(): void {\r\n    console.log('[AudioFlowOrchestrator] Cleaning up...');\r\n    this.stopFlow();\r\n    console.log('[AudioFlowOrchestrator] Cleanup completed');\r\n  }\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\AudioTimerService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\ScoreCalculationService.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isCorrect' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":70,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":70,"endColumn":22},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'responseTime' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":70,"column":43,"nodeType":null,"messageId":"unusedVar","endLine":70,"endColumn":55}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * ScoreCalculationService - SM-2 ì•Œê³ ë¦¬ì¦˜ ê¸°ë°˜ í•™ìŠµ í’ˆì§ˆ ì ìˆ˜ ê³„ì‚°\r\n * ëª©ì : ì‚¬ìš©ì ë‹µë³€ì˜ ì •í™•ë„ì™€ ì‹ ë¢°ë„ë¥¼ SM-2 ì•Œê³ ë¦¬ì¦˜ í’ˆì§ˆ ì ìˆ˜ë¡œ ë³€í™˜\r\n */\r\n\r\nexport interface ScoreInput {\r\n  isCorrect: boolean;\r\n  confidence: number;\r\n  score: number;\r\n  responseTime?: number;\r\n}\r\n\r\nexport interface QualityResult {\r\n  quality: 0 | 1 | 2 | 3 | 4 | 5;\r\n  reasoning: string;\r\n  category: 'perfect' | 'good' | 'acceptable' | 'poor' | 'failed';\r\n}\r\n\r\nexport interface DetailedScoreAnalysis {\r\n  quality: 0 | 1 | 2 | 3 | 4 | 5;\r\n  category: 'perfect' | 'good' | 'acceptable' | 'poor' | 'failed';\r\n  reasoning: string;\r\n  confidenceLevel: 'high' | 'medium' | 'low';\r\n  scoreLevel: 'excellent' | 'good' | 'fair' | 'poor';\r\n  recommendations: string[];\r\n}\r\n\r\nexport class ScoreCalculationService {\r\n  // SM-2 í’ˆì§ˆ ì ìˆ˜ ì„ê³„ê°’ ì„¤ì •\r\n  private readonly QUALITY_THRESHOLDS = {\r\n    PERFECT_SCORE: 90,\r\n    GOOD_SCORE: 80,\r\n    HIGH_CONFIDENCE: 0.7,\r\n    MEDIUM_CONFIDENCE: 0.4\r\n  };\r\n\r\n  // ì‘ë‹µ ì‹œê°„ ê¸°ë°˜ ë³´ë„ˆìŠ¤/í˜ë„í‹°\r\n  private readonly TIME_THRESHOLDS = {\r\n    FAST_RESPONSE: 3, // 3ì´ˆ ì´ë‚´ ë¹ ë¥¸ ì‘ë‹µ\r\n    SLOW_RESPONSE: 15, // 15ì´ˆ ì´ìƒ ëŠë¦° ì‘ë‹µ\r\n    VERY_SLOW_RESPONSE: 30 // 30ì´ˆ ì´ìƒ ë§¤ìš° ëŠë¦° ì‘ë‹µ\r\n  };\r\n\r\n  /**\r\n   * SM-2 ì•Œê³ ë¦¬ì¦˜ í’ˆì§ˆ ì ìˆ˜ ê³„ì‚° (0-5)\r\n   * 0: ì™„ì „í•œ ì‹¤íŒ¨ (blackout)\r\n   * 1: ì˜ëª»ëœ ì‘ë‹µ, ì •ë‹µì„ ê¸°ì–µí–ˆìŒ\r\n   * 2: ì˜ëª»ëœ ì‘ë‹µ, ì •ë‹µì´ ì‰½ê²Œ ê¸°ì–µë‚¨\r\n   * 3: ì •í™•í•œ ì‘ë‹µ, ì–´ë ¤ì›€ì„ ê²ªìŒ\r\n   * 4: ì •í™•í•œ ì‘ë‹µ, ì•½ê°„ì˜ ë§ì„¤ì„\r\n   * 5: ì™„ë²½í•œ ì‘ë‹µ\r\n   */\r\n  calculateQuality(input: ScoreInput): QualityResult {\r\n    const { isCorrect, confidence, score, responseTime } = input;\r\n\r\n    console.log('[ScoreCalculationService] Calculating quality for:', input);\r\n\r\n    if (!isCorrect) {\r\n      return this.calculateIncorrectQuality(confidence);\r\n    }\r\n\r\n    return this.calculateCorrectQuality(score, confidence, responseTime);\r\n  }\r\n\r\n  /**\r\n   * ìƒì„¸í•œ ì ìˆ˜ ë¶„ì„ ì œê³µ\r\n   */\r\n  getDetailedAnalysis(input: ScoreInput): DetailedScoreAnalysis {\r\n    const qualityResult = this.calculateQuality(input);\r\n    const { isCorrect, confidence, score, responseTime } = input;\r\n\r\n    const confidenceLevel = this.getConfidenceLevel(confidence);\r\n    const scoreLevel = this.getScoreLevel(score);\r\n    const recommendations = this.generateRecommendations(input, qualityResult);\r\n\r\n    return {\r\n      ...qualityResult,\r\n      confidenceLevel,\r\n      scoreLevel,\r\n      recommendations\r\n    };\r\n  }\r\n\r\n  /**\r\n   * í‹€ë¦° ë‹µë³€ì— ëŒ€í•œ í’ˆì§ˆ ì ìˆ˜ ê³„ì‚°\r\n   */\r\n  private calculateIncorrectQuality(confidence: number): QualityResult {\r\n    if (confidence > this.QUALITY_THRESHOLDS.HIGH_CONFIDENCE) {\r\n      return {\r\n        quality: 2,\r\n        reasoning: 'í‹€ë ¸ì§€ë§Œ ë†’ì€ ì‹ ë¢°ë„ë¡œ ë‹µë³€ - ì •ë‹µì„ ì‰½ê²Œ ê¸°ì–µí•  ìˆ˜ ìˆìŒ',\r\n        category: 'acceptable'\r\n      };\r\n    }\r\n\r\n    if (confidence > this.QUALITY_THRESHOLDS.MEDIUM_CONFIDENCE) {\r\n      return {\r\n        quality: 1,\r\n        reasoning: 'í‹€ë ¸ê³  ì¤‘ê°„ ì •ë„ ì‹ ë¢°ë„ - ì •ë‹µì„ ê¸°ì–µí•˜ê³  ìˆìŒ',\r\n        category: 'poor'\r\n      };\r\n    }\r\n\r\n    return {\r\n      quality: 0,\r\n      reasoning: 'í‹€ë ¸ê³  ë‚®ì€ ì‹ ë¢°ë„ - ì™„ì „í•œ ì‹¤íŒ¨ (blackout)',\r\n      category: 'failed'\r\n    };\r\n  }\r\n\r\n  /**\r\n   * ë§ì€ ë‹µë³€ì— ëŒ€í•œ í’ˆì§ˆ ì ìˆ˜ ê³„ì‚°\r\n   */\r\n  private calculateCorrectQuality(\r\n    score: number, \r\n    confidence: number, \r\n    responseTime?: number\r\n  ): QualityResult {\r\n    // ê¸°ë³¸ í’ˆì§ˆ ì ìˆ˜ ê²°ì •\r\n    const baseResult = this.determineBaseQuality(score);\r\n\r\n    // ì‘ë‹µ ì‹œê°„ ì¡°ì • ì ìš©\r\n    if (responseTime) {\r\n      return this.applyTimeAdjustment(baseResult, responseTime);\r\n    }\r\n\r\n    // ì‹ ë¢°ë„ ì¡°ì • ì ìš©\r\n    return this.applyConfidenceAdjustment(baseResult, confidence);\r\n  }\r\n\r\n  /**\r\n   * ì ìˆ˜ ê¸°ë°˜ ê¸°ë³¸ í’ˆì§ˆ ê²°ì •\r\n   */\r\n  private determineBaseQuality(score: number): {\r\n    quality: 3 | 4 | 5;\r\n    reasoning: string;\r\n    category: 'perfect' | 'good' | 'acceptable';\r\n  } {\r\n    if (score >= this.QUALITY_THRESHOLDS.PERFECT_SCORE) {\r\n      return {\r\n        quality: 5,\r\n        reasoning: 'ì™„ë²½í•œ ì ìˆ˜',\r\n        category: 'perfect'\r\n      };\r\n    }\r\n    \r\n    if (score >= this.QUALITY_THRESHOLDS.GOOD_SCORE) {\r\n      return {\r\n        quality: 4,\r\n        reasoning: 'ì¢‹ì€ ì ìˆ˜',\r\n        category: 'good'\r\n      };\r\n    }\r\n    \r\n    return {\r\n      quality: 3,\r\n      reasoning: 'ì •í™•í•˜ì§€ë§Œ ì–´ë ¤ì›€ì„ ê²ªìŒ',\r\n      category: 'acceptable'\r\n    };\r\n  }\r\n\r\n  /**\r\n   * ì‘ë‹µ ì‹œê°„ ê¸°ë°˜ í’ˆì§ˆ ì¡°ì • ì ìš©\r\n   */\r\n  private applyTimeAdjustment(\r\n    baseResult: { quality: 3 | 4 | 5; reasoning: string; category: 'perfect' | 'good' | 'acceptable' },\r\n    responseTime: number\r\n  ): QualityResult {\r\n    const timeAdjustment = this.getTimeAdjustment(responseTime, baseResult.quality);\r\n    const adjustedQuality = Math.max(3, Math.min(5, baseResult.quality + timeAdjustment)) as 3 | 4 | 5;\r\n    \r\n    if (adjustedQuality !== baseResult.quality) {\r\n      const timeDescription = this.getTimeDescription(responseTime);\r\n      const adjustedReasoning = baseResult.reasoning + ` (${timeDescription})`;\r\n      const adjustedCategory = this.getCategoryFromQuality(adjustedQuality);\r\n      \r\n      return {\r\n        quality: adjustedQuality,\r\n        reasoning: adjustedReasoning,\r\n        category: adjustedCategory\r\n      };\r\n    }\r\n    \r\n    return {\r\n      quality: baseResult.quality,\r\n      reasoning: baseResult.reasoning,\r\n      category: baseResult.category\r\n    };\r\n  }\r\n\r\n  /**\r\n   * ì‹ ë¢°ë„ ê¸°ë°˜ í’ˆì§ˆ ì¡°ì • ì ìš©\r\n   */\r\n  private applyConfidenceAdjustment(\r\n    baseResult: { quality: 3 | 4 | 5; reasoning: string; category: 'perfect' | 'good' | 'acceptable' },\r\n    confidence: number\r\n  ): QualityResult {\r\n    if (confidence < this.QUALITY_THRESHOLDS.MEDIUM_CONFIDENCE && baseResult.quality > 3) {\r\n      return {\r\n        quality: 3,\r\n        reasoning: baseResult.reasoning + ' (ë‚®ì€ ì‹ ë¢°ë„ë¡œ ì¡°ì •)',\r\n        category: 'acceptable'\r\n      };\r\n    }\r\n\r\n    return {\r\n      quality: baseResult.quality,\r\n      reasoning: baseResult.reasoning,\r\n      category: baseResult.category\r\n    };\r\n  }\r\n\r\n  /**\r\n   * í’ˆì§ˆ ì ìˆ˜ë¡œë¶€í„° ì¹´í…Œê³ ë¦¬ ê²°ì •\r\n   */\r\n  private getCategoryFromQuality(quality: 3 | 4 | 5): 'perfect' | 'good' | 'acceptable' {\r\n    if (quality === 5) return 'perfect';\r\n    if (quality === 4) return 'good';\r\n    return 'acceptable';\r\n  }\r\n\r\n  /**\r\n   * ì‘ë‹µ ì‹œê°„ ê¸°ë°˜ ì¡°ì •ê°’ ê³„ì‚°\r\n   */\r\n  private getTimeAdjustment(responseTime: number, baseQuality: number): number {\r\n    if (responseTime <= this.TIME_THRESHOLDS.FAST_RESPONSE && baseQuality < 5) {\r\n      return 1; // ë¹ ë¥¸ ì‘ë‹µ ë³´ë„ˆìŠ¤\r\n    }\r\n    \r\n    if (responseTime >= this.TIME_THRESHOLDS.VERY_SLOW_RESPONSE) {\r\n      return -1; // ë§¤ìš° ëŠë¦° ì‘ë‹µ í˜ë„í‹°\r\n    }\r\n    \r\n    if (responseTime >= this.TIME_THRESHOLDS.SLOW_RESPONSE && baseQuality > 3) {\r\n      return -1; // ëŠë¦° ì‘ë‹µ í˜ë„í‹°\r\n    }\r\n\r\n    return 0; // ì¡°ì • ì—†ìŒ\r\n  }\r\n\r\n  /**\r\n   * ì‘ë‹µ ì‹œê°„ ì„¤ëª… ìƒì„±\r\n   */\r\n  private getTimeDescription(responseTime: number): string {\r\n    if (responseTime <= this.TIME_THRESHOLDS.FAST_RESPONSE) {\r\n      return `ë¹ ë¥¸ ì‘ë‹µ ${responseTime.toFixed(1)}ì´ˆ`;\r\n    }\r\n    \r\n    if (responseTime >= this.TIME_THRESHOLDS.VERY_SLOW_RESPONSE) {\r\n      return `ë§¤ìš° ëŠë¦° ì‘ë‹µ ${responseTime.toFixed(1)}ì´ˆ`;\r\n    }\r\n    \r\n    if (responseTime >= this.TIME_THRESHOLDS.SLOW_RESPONSE) {\r\n      return `ëŠë¦° ì‘ë‹µ ${responseTime.toFixed(1)}ì´ˆ`;\r\n    }\r\n\r\n    return `ë³´í†µ ì‘ë‹µ ${responseTime.toFixed(1)}ì´ˆ`;\r\n  }\r\n\r\n  /**\r\n   * ì‹ ë¢°ë„ ë ˆë²¨ ë¶„ë¥˜\r\n   */\r\n  private getConfidenceLevel(confidence: number): 'high' | 'medium' | 'low' {\r\n    if (confidence >= this.QUALITY_THRESHOLDS.HIGH_CONFIDENCE) return 'high';\r\n    if (confidence >= this.QUALITY_THRESHOLDS.MEDIUM_CONFIDENCE) return 'medium';\r\n    return 'low';\r\n  }\r\n\r\n  /**\r\n   * ì ìˆ˜ ë ˆë²¨ ë¶„ë¥˜\r\n   */\r\n  private getScoreLevel(score: number): 'excellent' | 'good' | 'fair' | 'poor' {\r\n    if (score >= this.QUALITY_THRESHOLDS.PERFECT_SCORE) return 'excellent';\r\n    if (score >= this.QUALITY_THRESHOLDS.GOOD_SCORE) return 'good';\r\n    if (score >= 60) return 'fair';\r\n    return 'poor';\r\n  }\r\n\r\n  /**\r\n   * ê°œì„  ê¶Œì¥ì‚¬í•­ ìƒì„±\r\n   */\r\n  private generateRecommendations(input: ScoreInput, result: QualityResult): string[] {\r\n    const recommendations: string[] = [];\r\n    const { isCorrect, confidence, score, responseTime } = input;\r\n\r\n    if (!isCorrect) {\r\n      recommendations.push('ì •ë‹µì„ ë‹¤ì‹œ í•œë²ˆ í™•ì¸í•˜ê³  ì—°ìŠµí•˜ì„¸ìš”');\r\n      \r\n      if (confidence < this.QUALITY_THRESHOLDS.MEDIUM_CONFIDENCE) {\r\n        recommendations.push('í•´ë‹¹ ë¬¸ë²•ì´ë‚˜ í‘œí˜„ì„ ê¸°ì´ˆë¶€í„° ë‹¤ì‹œ í•™ìŠµí•˜ì„¸ìš”');\r\n      }\r\n    } else {\r\n      if (score < this.QUALITY_THRESHOLDS.GOOD_SCORE) {\r\n        recommendations.push('ë°œìŒì´ë‚˜ ë¬¸ë²•ì„ ë” ì •í™•í•˜ê²Œ ì—°ìŠµí•˜ì„¸ìš”');\r\n      }\r\n      \r\n      if (confidence < this.QUALITY_THRESHOLDS.HIGH_CONFIDENCE) {\r\n        recommendations.push('ë” ìì‹ ê° ìˆê²Œ ë‹µë³€í•  ìˆ˜ ìˆë„ë¡ ë°˜ë³µ ì—°ìŠµí•˜ì„¸ìš”');\r\n      }\r\n    }\r\n\r\n    if (responseTime && responseTime > this.TIME_THRESHOLDS.SLOW_RESPONSE) {\r\n      recommendations.push('ë” ë¹ ë¥¸ ë°˜ì‘ ì†ë„ë¥¼ ìœ„í•´ ìì£¼ ì‚¬ìš©í•˜ëŠ” í‘œí˜„ì„ ì•”ê¸°í•˜ì„¸ìš”');\r\n    }\r\n\r\n    if (result.quality >= 4) {\r\n      recommendations.push('í›Œë¥­í•©ë‹ˆë‹¤! ì´ ìˆ˜ì¤€ì„ ìœ ì§€í•˜ì„¸ìš”');\r\n    }\r\n\r\n    return recommendations;\r\n  }\r\n\r\n  /**\r\n   * í’ˆì§ˆ ì ìˆ˜ ì„¤ëª… ì œê³µ\r\n   */\r\n  getQualityDescription(quality: 0 | 1 | 2 | 3 | 4 | 5): string {\r\n    const descriptions = {\r\n      0: 'ì™„ì „í•œ ì‹¤íŒ¨ - ì •ë‹µì„ ì „í˜€ ê¸°ì–µí•˜ì§€ ëª»í•¨',\r\n      1: 'ì‹¤íŒ¨ í›„ ì •ë‹µ í™•ì¸ - ì •ë‹µì„ ê¸°ì–µí•˜ê³  ìˆìŒ',\r\n      2: 'ì‹¤íŒ¨ í›„ ì‰¬ìš´ ì •ë‹µ í™•ì¸ - ì •ë‹µì„ ì‰½ê²Œ ê¸°ì–µí•  ìˆ˜ ìˆìŒ',\r\n      3: 'ì„±ê³µí•˜ì§€ë§Œ ì–´ë ¤ì›€ - ì •í™•í•œ ì‘ë‹µì´ì§€ë§Œ ì–´ë ¤ì›€ì„ ê²ªìŒ',\r\n      4: 'ì„±ê³µí•˜ì§€ë§Œ ë§ì„¤ì„ - ì •í™•í•œ ì‘ë‹µì´ì§€ë§Œ ì•½ê°„ì˜ ë§ì„¤ì„',\r\n      5: 'ì™„ë²½í•œ ì„±ê³µ - ì¦‰ì‹œ ì •í™•í•œ ì‘ë‹µ'\r\n    };\r\n\r\n    return descriptions[quality];\r\n  }\r\n\r\n  /**\r\n   * í˜„ì¬ ì„¤ì •ëœ ì„ê³„ê°’ ì¡°íšŒ\r\n   */\r\n  getThresholds() {\r\n    return {\r\n      quality: this.QUALITY_THRESHOLDS,\r\n      time: this.TIME_THRESHOLDS\r\n    };\r\n  }\r\n\r\n  /**\r\n   * ì„ê³„ê°’ ì—…ë°ì´íŠ¸ (ì„¤ì • ë³€ê²½ìš©)\r\n   */\r\n  updateThresholds(newThresholds: Partial<typeof this.QUALITY_THRESHOLDS>): void {\r\n    Object.assign(this.QUALITY_THRESHOLDS, newThresholds);\r\n    console.log('[ScoreCalculationService] Thresholds updated:', this.QUALITY_THRESHOLDS);\r\n  }\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\SpeechProcessingService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\adaptivePackService.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ReviewCard' is defined but never used. Allowed unused vars must match /^_/u.","line":5,"column":15,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":25},{"ruleId":"no-undef","severity":1,"message":"'SRSCard' is not defined.","line":34,"column":13,"nodeType":"Identifier","messageId":"undef","endLine":34,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'srsStats' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":112,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":112,"endColumn":21},{"ruleId":"no-undef","severity":1,"message":"'srsService' is not defined.","line":112,"column":30,"nodeType":"Identifier","messageId":"undef","endLine":112,"endColumn":40},{"ruleId":"no-undef","severity":1,"message":"'SRSCard' is not defined.","line":114,"column":26,"nodeType":"Identifier","messageId":"undef","endLine":114,"endColumn":33},{"ruleId":"no-undef","severity":1,"message":"'SRSCard' is not defined.","line":150,"column":58,"nodeType":"Identifier","messageId":"undef","endLine":150,"endColumn":65},{"ruleId":"no-undef","severity":1,"message":"'SRSCard' is not defined.","line":191,"column":52,"nodeType":"Identifier","messageId":"undef","endLine":191,"endColumn":59},{"ruleId":"no-undef","severity":1,"message":"'SRSCard' is not defined.","line":205,"column":29,"nodeType":"Identifier","messageId":"undef","endLine":205,"endColumn":36},{"ruleId":"no-undef","severity":1,"message":"'SRSCard' is not defined.","line":248,"column":46,"nodeType":"Identifier","messageId":"undef","endLine":248,"endColumn":53},{"ruleId":"no-undef","severity":1,"message":"'SRSCard' is not defined.","line":264,"column":47,"nodeType":"Identifier","messageId":"undef","endLine":264,"endColumn":54},{"ruleId":"no-undef","severity":1,"message":"'srsService' is not defined.","line":298,"column":42,"nodeType":"Identifier","messageId":"undef","endLine":298,"endColumn":52},{"ruleId":"no-undef","severity":1,"message":"'SRSCard' is not defined.","line":351,"column":24,"nodeType":"Identifier","messageId":"undef","endLine":351,"endColumn":31},{"ruleId":"no-undef","severity":1,"message":"'SRSCard' is not defined.","line":431,"column":22,"nodeType":"Identifier","messageId":"undef","endLine":431,"endColumn":29}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":13,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Adaptive Pack Service - ì˜¤ë‹µ + ë§ê°ê³¡ì„  + íŒ¨í„´ ì™„ì „ ìë™í™”\r\n\r\n// import { srsService, type SRSCard } from './srsService';\r\n// TODO: Migrate to new SRS Engine system\r\nimport type { ReviewCard } from './srs/SRSEngine';\r\nimport { api } from '@/lib/api';\r\nimport type { DrillCard } from '@/types';\r\n\r\nexport interface WeaknessPattern {\r\n  id: string;\r\n  patternType: 'grammar' | 'vocabulary' | 'structure' | 'pronunciation';\r\n  pattern: string;\r\n  description: string;\r\n  errorCount: number;\r\n  lastErrorDate: Date;\r\n  examples: string[];\r\n  level: number;\r\n  stage: number;\r\n}\r\n\r\nexport interface AdaptivePackCard {\r\n  id: string;\r\n  cardId: string;\r\n  cardData: DrillCard;\r\n  \r\n  // ì„ íƒ ì´ìœ \r\n  reason: 'wrong_answer' | 'forgetting_curve' | 'weakness_pattern' | 'difficulty_spike';\r\n  reasonDetail: string;\r\n  \r\n  // ìš°ì„ ìˆœìœ„ ì ìˆ˜\r\n  priorityScore: number;\r\n  \r\n  // SRS ì •ë³´\r\n  srsInfo?: SRSCard;\r\n  \r\n  // ì•½ì  íŒ¨í„´ ì •ë³´\r\n  weaknessPatterns?: WeaknessPattern[];\r\n  \r\n  // ë©”íƒ€ë°ì´í„°\r\n  selectedAt: Date;\r\n  expectedDifficulty: 'easy' | 'medium' | 'hard';\r\n}\r\n\r\nexport interface AdaptivePack {\r\n  id: string;\r\n  userId: string;\r\n  title: string;\r\n  description: string;\r\n  \r\n  // êµ¬ì„± ì •ë³´\r\n  cards: AdaptivePackCard[];\r\n  totalCards: number;\r\n  estimatedTime: number; // ë¶„\r\n  \r\n  // ë¶„ì„ ì •ë³´\r\n  weaknessAnalysis: {\r\n    grammarWeaknesses: WeaknessPattern[];\r\n    vocabularyGaps: WeaknessPattern[];\r\n    structuralIssues: WeaknessPattern[];\r\n    pronunciationProblems: WeaknessPattern[];\r\n  };\r\n  \r\n  // í•™ìŠµ ëª©í‘œ\r\n  learningObjectives: string[];\r\n  \r\n  // ìƒì„± ì •ë³´\r\n  generatedAt: Date;\r\n  algorithm: 'standard' | 'intensive' | 'review_focused';\r\n}\r\n\r\nexport interface LearningAnalytics {\r\n  userId: string;\r\n  \r\n  // ì „ì²´ í†µê³„\r\n  totalAnswered: number;\r\n  correctRate: number;\r\n  averageResponseTime: number;\r\n  \r\n  // ë ˆë²¨ë³„ ì„±ê³¼\r\n  levelPerformance: Record<number, {\r\n    accuracy: number;\r\n    averageTime: number;\r\n    completedStages: number;\r\n  }>;\r\n  \r\n  // ì•½ì  íŒ¨í„´\r\n  identifiedWeaknesses: WeaknessPattern[];\r\n  \r\n  // í•™ìŠµ íŒ¨í„´\r\n  learningPattern: {\r\n    bestTimeOfDay: number; // ì‹œê°„ (0-23)\r\n    preferredSessionLength: number; // ë¶„\r\n    optimalDifficulty: 'easy' | 'medium' | 'hard';\r\n  };\r\n  \r\n  // ì¶”ì„¸ ë¶„ì„\r\n  trend: {\r\n    improvementRate: number; // ì£¼ê°„ ê°œì„ ìœ¨\r\n    consistencyScore: number; // í•™ìŠµ ì¼ê´€ì„± ì ìˆ˜\r\n    challengeReadiness: number; // ë‹¤ìŒ ë ˆë²¨ ì¤€ë¹„ë„\r\n  };\r\n}\r\n\r\nclass AdaptivePackService {\r\n  \r\n  /**\r\n   * ì‚¬ìš©ìë³„ í•™ìŠµ ë¶„ì„ ìˆ˜í–‰\r\n   */\r\n  async analyzeLearningData(userId: string): Promise<LearningAnalytics> {\r\n    try {\r\n      // SRS ë°ì´í„° ê°€ì ¸ì˜¤ê¸°\r\n      const srsStats = await srsService.getSRSStats(userId);\r\n      const storedCards = localStorage.getItem(`srs_cards_${userId}`);\r\n      const allSRSCards: SRSCard[] = storedCards ? JSON.parse(storedCards) : [];\r\n      \r\n      // í•™ìŠµ ê¸°ë¡ ë¶„ì„\r\n      const totalAnswered = allSRSCards.reduce((sum, card) => sum + card.correctCount + card.incorrectCount, 0);\r\n      const totalCorrect = allSRSCards.reduce((sum, card) => sum + card.correctCount, 0);\r\n      const correctRate = totalAnswered > 0 ? (totalCorrect / totalAnswered) * 100 : 0;\r\n      \r\n      // í‰ê·  ì‘ë‹µ ì‹œê°„ ê³„ì‚°\r\n      const averageResponseTime = allSRSCards.length > 0 \r\n        ? allSRSCards.reduce((sum, card) => sum + card.averageResponseTime, 0) / allSRSCards.length \r\n        : 0;\r\n      \r\n      // ë ˆë²¨ë³„ ì„±ê³¼ ë¶„ì„\r\n      const levelPerformance: Record<number, any> = {};\r\n      allSRSCards.forEach(card => {\r\n        if (!levelPerformance[card.level]) {\r\n          levelPerformance[card.level] = {\r\n            cards: [],\r\n            totalCorrect: 0,\r\n            totalAnswered: 0,\r\n            totalTime: 0\r\n          };\r\n        }\r\n        \r\n        levelPerformance[card.level].cards.push(card);\r\n        levelPerformance[card.level].totalCorrect += card.correctCount;\r\n        levelPerformance[card.level].totalAnswered += card.correctCount + card.incorrectCount;\r\n        levelPerformance[card.level].totalTime += card.averageResponseTime;\r\n      });\r\n      \r\n      // ë ˆë²¨ë³„ í†µê³„ ì •ë¦¬\r\n      Object.keys(levelPerformance).forEach(level => {\r\n        const data = levelPerformance[parseInt(level)];\r\n        levelPerformance[parseInt(level)] = {\r\n          accuracy: data.totalAnswered > 0 ? (data.totalCorrect / data.totalAnswered) * 100 : 0,\r\n          averageTime: data.cards.length > 0 ? data.totalTime / data.cards.length : 0,\r\n          completedStages: new Set(data.cards.map((card: SRSCard) => card.stage)).size\r\n        };\r\n      });\r\n      \r\n      // ì•½ì  íŒ¨í„´ ì‹ë³„\r\n      const identifiedWeaknesses = await this.identifyWeaknessPatterns(allSRSCards);\r\n      \r\n      // í•™ìŠµ íŒ¨í„´ ë¶„ì„\r\n      const learningPattern = {\r\n        bestTimeOfDay: 14, // ê¸°ë³¸ê°’: ì˜¤í›„ 2ì‹œ\r\n        preferredSessionLength: 20, // ê¸°ë³¸ê°’: 20ë¶„\r\n        optimalDifficulty: correctRate > 80 ? 'hard' : correctRate > 60 ? 'medium' : 'easy' as const\r\n      };\r\n      \r\n      // ì¶”ì„¸ ë¶„ì„\r\n      const trend = {\r\n        improvementRate: this.calculateImprovementRate(allSRSCards),\r\n        consistencyScore: this.calculateConsistencyScore(allSRSCards),\r\n        challengeReadiness: correctRate > 75 ? 0.8 : correctRate > 60 ? 0.6 : 0.4\r\n      };\r\n      \r\n      return {\r\n        userId,\r\n        totalAnswered,\r\n        correctRate: Math.round(correctRate),\r\n        averageResponseTime: Math.round(averageResponseTime * 10) / 10,\r\n        levelPerformance,\r\n        identifiedWeaknesses,\r\n        learningPattern,\r\n        trend\r\n      };\r\n      \r\n    } catch (error) {\r\n      console.error('í•™ìŠµ ë¶„ì„ ì‹¤íŒ¨:', error);\r\n      throw error;\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * ì•½ì  íŒ¨í„´ ì‹ë³„\r\n   */\r\n  private async identifyWeaknessPatterns(srsCards: SRSCard[]): Promise<WeaknessPattern[]> {\r\n    const weaknesses: WeaknessPattern[] = [];\r\n    \r\n    // ì •ë‹µë¥ ì´ ë‚®ì€ ì¹´ë“œë“¤ ë¶„ì„\r\n    const difficultCards = srsCards.filter(card => {\r\n      const total = card.correctCount + card.incorrectCount;\r\n      return total > 0 && (card.correctCount / total) < 0.6;\r\n    });\r\n    \r\n    // ë ˆë²¨ë³„ ê·¸ë£¹í™”\r\n    const levelGroups = difficultCards.reduce((groups, card) => {\r\n      if (!groups[card.level]) groups[card.level] = [];\r\n      groups[card.level].push(card);\r\n      return groups;\r\n    }, {} as Record<number, SRSCard[]>);\r\n    \r\n    // ê° ë ˆë²¨ë³„ ì•½ì  íŒ¨í„´ ìƒì„±\r\n    Object.entries(levelGroups).forEach(([level, cards]) => {\r\n      if (cards.length >= 3) { // ìµœì†Œ 3ê°œ ì´ìƒì¼ ë•Œë§Œ íŒ¨í„´ìœ¼ë¡œ ì¸ì‹\r\n        const levelNum = parseInt(level);\r\n        \r\n        weaknesses.push({\r\n          id: `level_${level}_weakness`,\r\n          patternType: levelNum <= 2 ? 'grammar' : levelNum <= 4 ? 'vocabulary' : 'structure',\r\n          pattern: `Level ${level} ì „ë°˜ì  ì–´ë ¤ì›€`,\r\n          description: `Level ${level}ì—ì„œ ì§€ì†ì ì¸ ì–´ë ¤ì›€ì„ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤. ê¸°ì´ˆ ê°œë… ì¬í•™ìŠµì´ í•„ìš”í•©ë‹ˆë‹¤.`,\r\n          errorCount: cards.reduce((sum, card) => sum + card.incorrectCount, 0),\r\n          lastErrorDate: new Date(Math.max(...cards.map(card => new Date(card.lastReviewDate).getTime()))),\r\n          examples: cards.slice(0, 3).map(card => `Card ID: ${card.cardId}`),\r\n          level: levelNum,\r\n          stage: Math.round(cards.reduce((sum, card) => sum + card.stage, 0) / cards.length)\r\n        });\r\n      }\r\n    });\r\n    \r\n    // easeFactorê°€ ë‚®ì€ ì¹´ë“œë“¤ (ì–´ë ¤ìš´ ì¹´ë“œë“¤)\r\n    const hardCards = srsCards.filter(card => card.easeFactor < 2.0);\r\n    if (hardCards.length >= 5) {\r\n      weaknesses.push({\r\n        id: 'difficult_cards_pattern',\r\n        patternType: 'structure',\r\n        pattern: 'ë³µì¡í•œ êµ¬ì¡° ë¬¸ì œ',\r\n        description: 'ë³µì¡í•œ ë¬¸ë²• êµ¬ì¡°ë‚˜ ê³ ê¸‰ ì–´íœ˜ì—ì„œ ì–´ë ¤ì›€ì„ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤.',\r\n        errorCount: hardCards.reduce((sum, card) => sum + card.incorrectCount, 0),\r\n        lastErrorDate: new Date(Math.max(...hardCards.map(card => new Date(card.lastReviewDate).getTime()))),\r\n        examples: hardCards.slice(0, 3).map(card => `Card ID: ${card.cardId}`),\r\n        level: Math.round(hardCards.reduce((sum, card) => sum + card.level, 0) / hardCards.length),\r\n        stage: Math.round(hardCards.reduce((sum, card) => sum + card.stage, 0) / hardCards.length)\r\n      });\r\n    }\r\n    \r\n    return weaknesses;\r\n  }\r\n  \r\n  /**\r\n   * ê°œì„ ìœ¨ ê³„ì‚°\r\n   */\r\n  private calculateImprovementRate(srsCards: SRSCard[]): number {\r\n    // ìµœê·¼ í•™ìŠµí•œ ì¹´ë“œë“¤ì˜ repetitions í‰ê· ìœ¼ë¡œ ê°œì„ ìœ¨ ì¶”ì •\r\n    const recentCards = srsCards.filter(card => {\r\n      const daysSince = (Date.now() - new Date(card.lastReviewDate).getTime()) / (24 * 60 * 60 * 1000);\r\n      return daysSince <= 7; // ìµœê·¼ 7ì¼\r\n    });\r\n    \r\n    if (recentCards.length === 0) return 0;\r\n    \r\n    const averageRepetitions = recentCards.reduce((sum, card) => sum + card.repetitions, 0) / recentCards.length;\r\n    return Math.min(100, averageRepetitions * 20); // 0-100 ì ìˆ˜ë¡œ ë³€í™˜\r\n  }\r\n  \r\n  /**\r\n   * ì¼ê´€ì„± ì ìˆ˜ ê³„ì‚°\r\n   */\r\n  private calculateConsistencyScore(srsCards: SRSCard[]): number {\r\n    if (srsCards.length === 0) return 0;\r\n    \r\n    // í•™ìŠµ ê°„ê²©ì˜ ì¼ê´€ì„± ì¸¡ì •\r\n    const intervals = srsCards.map(card => {\r\n      const daysSince = (Date.now() - new Date(card.lastReviewDate).getTime()) / (24 * 60 * 60 * 1000);\r\n      return Math.min(daysSince, 30); // ìµœëŒ€ 30ì¼ë¡œ ì œí•œ\r\n    });\r\n    \r\n    const avgInterval = intervals.reduce((sum, interval) => sum + interval, 0) / intervals.length;\r\n    const variance = intervals.reduce((sum, interval) => sum + Math.pow(interval - avgInterval, 2), 0) / intervals.length;\r\n    const standardDeviation = Math.sqrt(variance);\r\n    \r\n    // ì¼ê´€ì„± ì ìˆ˜ (í‘œì¤€í¸ì°¨ê°€ ë‚®ì„ìˆ˜ë¡ ë†’ì€ ì ìˆ˜)\r\n    return Math.max(0, 100 - (standardDeviation * 10));\r\n  }\r\n  \r\n  /**\r\n   * Adaptive Pack ìƒì„±\r\n   */\r\n  async generateAdaptivePack(\r\n    userId: string, \r\n    targetSize: number = 15,\r\n    algorithm: 'standard' | 'intensive' | 'review_focused' = 'standard'\r\n  ): Promise<AdaptivePack> {\r\n    \r\n    try {\r\n      // 1. í•™ìŠµ ë¶„ì„ ìˆ˜í–‰\r\n      const analytics = await this.analyzeLearningData(userId);\r\n      \r\n      // 2. ì˜¤ë‹µ ì¹´ë“œ ìˆ˜ì§‘\r\n      const wrongAnswerCards = await this.getWrongAnswerCards(userId);\r\n      \r\n      // 3. ë§ê°ê³¡ì„  ë³µìŠµ ì¹´ë“œ ìˆ˜ì§‘\r\n      const forgettingCurveCards = await srsService.getCardsForReview(userId, 50);\r\n      \r\n      // 4. ì•½ì  íŒ¨í„´ ê¸°ë°˜ ì¶”ê°€ ì¹´ë“œ ìˆ˜ì§‘\r\n      const patternCards = await this.getPatternReinforcementCards(analytics.identifiedWeaknesses);\r\n      \r\n      // 5. ìš°ì„ ìˆœìœ„ ì ìˆ˜ ê³„ì‚° ë° ì¹´ë“œ ì„ ë³„\r\n      const candidateCards = await this.prioritizeAndSelectCards(\r\n        wrongAnswerCards,\r\n        forgettingCurveCards,\r\n        patternCards,\r\n        targetSize,\r\n        algorithm\r\n      );\r\n      \r\n      // 6. í•™ìŠµ ëª©í‘œ ìƒì„±\r\n      const learningObjectives = this.generateLearningObjectives(analytics, candidateCards);\r\n      \r\n      // 7. Adaptive Pack ìƒì„±\r\n      const adaptivePack: AdaptivePack = {\r\n        id: `adaptive_pack_${Date.now()}`,\r\n        userId,\r\n        title: this.generatePackTitle(analytics, algorithm),\r\n        description: this.generatePackDescription(analytics, candidateCards.length),\r\n        cards: candidateCards,\r\n        totalCards: candidateCards.length,\r\n        estimatedTime: Math.ceil(candidateCards.length * 1.5), // ì¹´ë“œë‹¹ 1.5ë¶„ ì¶”ì •\r\n        weaknessAnalysis: {\r\n          grammarWeaknesses: analytics.identifiedWeaknesses.filter(w => w.patternType === 'grammar'),\r\n          vocabularyGaps: analytics.identifiedWeaknesses.filter(w => w.patternType === 'vocabulary'),\r\n          structuralIssues: analytics.identifiedWeaknesses.filter(w => w.patternType === 'structure'),\r\n          pronunciationProblems: analytics.identifiedWeaknesses.filter(w => w.patternType === 'pronunciation')\r\n        },\r\n        learningObjectives,\r\n        generatedAt: new Date(),\r\n        algorithm\r\n      };\r\n      \r\n      // 8. ë¡œì»¬ ì €ì¥\r\n      this.saveAdaptivePack(userId, adaptivePack);\r\n      \r\n      return adaptivePack;\r\n      \r\n    } catch (error) {\r\n      console.error('Adaptive Pack ìƒì„± ì‹¤íŒ¨:', error);\r\n      throw error;\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * ì˜¤ë‹µ ì¹´ë“œ ìˆ˜ì§‘\r\n   */\r\n  private async getWrongAnswerCards(userId: string): Promise<AdaptivePackCard[]> {\r\n    const storedCards = localStorage.getItem(`srs_cards_${userId}`);\r\n    const allSRSCards: SRSCard[] = storedCards ? JSON.parse(storedCards) : [];\r\n    \r\n    // ì˜¤ë‹µë¥ ì´ ë†’ì€ ì¹´ë“œë“¤ (ìµœì†Œ 2ë²ˆ ì´ìƒ ì‹œë„)\r\n    const wrongCards = allSRSCards.filter(card => {\r\n      const total = card.correctCount + card.incorrectCount;\r\n      return total >= 2 && (card.incorrectCount / total) > 0.4;\r\n    });\r\n    \r\n    const adaptiveCards: AdaptivePackCard[] = [];\r\n    \r\n    for (const srsCard of wrongCards) {\r\n      try {\r\n        // ì‹¤ì œ ì¹´ë“œ ë°ì´í„° ë¡œë“œ\r\n        const response = await api.getCards(srsCard.level, srsCard.stage);\r\n        if (response.success && response.data) {\r\n          const cardData = response.data.cards.find(card => card.id === srsCard.cardId);\r\n          if (cardData) {\r\n            adaptiveCards.push({\r\n              id: `wrong_${srsCard.cardId}`,\r\n              cardId: srsCard.cardId,\r\n              cardData,\r\n              reason: 'wrong_answer',\r\n              reasonDetail: `ì˜¤ë‹µë¥  ${Math.round((srsCard.incorrectCount / (srsCard.correctCount + srsCard.incorrectCount)) * 100)}%`,\r\n              priorityScore: srsCard.incorrectCount * 2,\r\n              srsInfo: srsCard,\r\n              selectedAt: new Date(),\r\n              expectedDifficulty: 'hard'\r\n            });\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error(`ì¹´ë“œ ë¡œë“œ ì‹¤íŒ¨: ${srsCard.cardId}`, error);\r\n      }\r\n    }\r\n    \r\n    return adaptiveCards;\r\n  }\r\n  \r\n  /**\r\n   * íŒ¨í„´ ë³´ê°• ì¹´ë“œ ìˆ˜ì§‘\r\n   */\r\n  private async getPatternReinforcementCards(weaknesses: WeaknessPattern[]): Promise<AdaptivePackCard[]> {\r\n    const adaptiveCards: AdaptivePackCard[] = [];\r\n    \r\n    for (const weakness of weaknesses) {\r\n      try {\r\n        // ì•½ì  íŒ¨í„´ê³¼ ê´€ë ¨ëœ ë ˆë²¨/ìŠ¤í…Œì´ì§€ì—ì„œ ì¶”ê°€ ì¹´ë“œ ìˆ˜ì§‘\r\n        const response = await api.getCards(weakness.level, weakness.stage);\r\n        if (response.success && response.data) {\r\n          // ëœë¤í•˜ê²Œ 2-3ê°œ ì¹´ë“œ ì„ íƒ\r\n          const shuffled = response.data.cards.sort(() => 0.5 - Math.random());\r\n          const selectedCards = shuffled.slice(0, 3);\r\n          \r\n          selectedCards.forEach(cardData => {\r\n            adaptiveCards.push({\r\n              id: `pattern_${cardData.id}`,\r\n              cardId: cardData.id,\r\n              cardData,\r\n              reason: 'weakness_pattern',\r\n              reasonDetail: `${weakness.pattern} ë³´ê°•`,\r\n              priorityScore: weakness.errorCount,\r\n              weaknessPatterns: [weakness],\r\n              selectedAt: new Date(),\r\n              expectedDifficulty: 'medium'\r\n            });\r\n          });\r\n        }\r\n      } catch (error) {\r\n        console.error(`íŒ¨í„´ ì¹´ë“œ ë¡œë“œ ì‹¤íŒ¨: Level ${weakness.level}`, error);\r\n      }\r\n    }\r\n    \r\n    return adaptiveCards;\r\n  }\r\n  \r\n  /**\r\n   * ì¹´ë“œ ìš°ì„ ìˆœìœ„ ê³„ì‚° ë° ì„ ë³„\r\n   */\r\n  private async prioritizeAndSelectCards(\r\n    wrongCards: AdaptivePackCard[],\r\n    forgettingCards: SRSCard[],\r\n    patternCards: AdaptivePackCard[],\r\n    targetSize: number,\r\n    algorithm: 'standard' | 'intensive' | 'review_focused'\r\n  ): Promise<AdaptivePackCard[]> {\r\n    \r\n    // ë§ê°ê³¡ì„  ì¹´ë“œë¥¼ AdaptivePackCardë¡œ ë³€í™˜\r\n    const forgettingAdaptiveCards: AdaptivePackCard[] = [];\r\n    for (const srsCard of forgettingCards) {\r\n      try {\r\n        const response = await api.getCards(srsCard.level, srsCard.stage);\r\n        if (response.success && response.data) {\r\n          const cardData = response.data.cards.find(card => card.id === srsCard.cardId);\r\n          if (cardData) {\r\n            const overdueDays = Math.floor(\r\n              (Date.now() - new Date(srsCard.nextReviewDate).getTime()) / (24 * 60 * 60 * 1000)\r\n            );\r\n            \r\n            forgettingAdaptiveCards.push({\r\n              id: `forgetting_${srsCard.cardId}`,\r\n              cardId: srsCard.cardId,\r\n              cardData,\r\n              reason: 'forgetting_curve',\r\n              reasonDetail: `${overdueDays}ì¼ ì§€ì—°`,\r\n              priorityScore: Math.max(0, overdueDays) + srsCard.incorrectCount,\r\n              srsInfo: srsCard,\r\n              selectedAt: new Date(),\r\n              expectedDifficulty: srsCard.easeFactor < 2.0 ? 'hard' : 'medium'\r\n            });\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error(`ë§ê°ê³¡ì„  ì¹´ë“œ ë¡œë“œ ì‹¤íŒ¨: ${srsCard.cardId}`, error);\r\n      }\r\n    }\r\n    \r\n    // ëª¨ë“  ì¹´ë“œ í•©ì¹˜ê¸°\r\n    const allCards = [...wrongCards, ...forgettingAdaptiveCards, ...patternCards];\r\n    \r\n    // ì¤‘ë³µ ì œê±°\r\n    const uniqueCards = allCards.filter((card, index, self) => \r\n      index === self.findIndex(c => c.cardId === card.cardId)\r\n    );\r\n    \r\n    // ì•Œê³ ë¦¬ì¦˜ë³„ ê°€ì¤‘ì¹˜ ì ìš©\r\n    uniqueCards.forEach(card => {\r\n      switch (algorithm) {\r\n        case 'intensive':\r\n          if (card.reason === 'wrong_answer') card.priorityScore *= 2;\r\n          break;\r\n        case 'review_focused':\r\n          if (card.reason === 'forgetting_curve') card.priorityScore *= 1.5;\r\n          break;\r\n        default: // standard\r\n          // ê· í˜•ì¡íŒ ê°€ì¤‘ì¹˜ ìœ ì§€\r\n          break;\r\n      }\r\n    });\r\n    \r\n    // ìš°ì„ ìˆœìœ„ ì •ë ¬ ë° ì„ ë³„\r\n    uniqueCards.sort((a, b) => b.priorityScore - a.priorityScore);\r\n    return uniqueCards.slice(0, targetSize);\r\n  }\r\n  \r\n  /**\r\n   * í•™ìŠµ ëª©í‘œ ìƒì„±\r\n   */\r\n  private generateLearningObjectives(analytics: LearningAnalytics, cards: AdaptivePackCard[]): string[] {\r\n    const objectives: string[] = [];\r\n    \r\n    // ì •ë‹µë¥  ê¸°ë°˜ ëª©í‘œ\r\n    if (analytics.correctRate < 70) {\r\n      objectives.push('ê¸°ì´ˆ ì •í™•ë„ 70% ì´ìƒ ë‹¬ì„±');\r\n    } else if (analytics.correctRate < 85) {\r\n      objectives.push('í•™ìŠµ ì •í™•ë„ 85% ì´ìƒ í–¥ìƒ');\r\n    }\r\n    \r\n    // ì•½ì  íŒ¨í„´ ê¸°ë°˜ ëª©í‘œ\r\n    analytics.identifiedWeaknesses.forEach(weakness => {\r\n      objectives.push(`${weakness.pattern} ê°œì„ `);\r\n    });\r\n    \r\n    // ì¹´ë“œ êµ¬ì„± ê¸°ë°˜ ëª©í‘œ\r\n    const wrongAnswerCount = cards.filter(c => c.reason === 'wrong_answer').length;\r\n    if (wrongAnswerCount > 0) {\r\n      objectives.push(`ì˜¤ë‹µ ë¬¸ì œ ${wrongAnswerCount}ê°œ ì™„ì „ ì •ë³µ`);\r\n    }\r\n    \r\n    const forgettingCount = cards.filter(c => c.reason === 'forgetting_curve').length;\r\n    if (forgettingCount > 0) {\r\n      objectives.push(`ë³µìŠµ ì§€ì—° ë¬¸ì œ ${forgettingCount}ê°œ í•´ê²°`);\r\n    }\r\n    \r\n    return objectives.slice(0, 4); // ìµœëŒ€ 4ê°œ\r\n  }\r\n  \r\n  /**\r\n   * íŒ© ì œëª© ìƒì„±\r\n   */\r\n  private generatePackTitle(analytics: LearningAnalytics, algorithm: string): string {\r\n    const algorithmNames = {\r\n      standard: 'ë§ì¶¤í˜•',\r\n      intensive: 'ì§‘ì¤‘',\r\n      review_focused: 'ë³µìŠµ ì¤‘ì‹¬'\r\n    };\r\n    \r\n    const accuracyLevel = analytics.correctRate > 80 ? 'ê³ ê¸‰' : \r\n                         analytics.correctRate > 60 ? 'ì¤‘ê¸‰' : 'ê¸°ì´ˆ';\r\n    \r\n    return `${algorithmNames[algorithm]} ${accuracyLevel} í•™ìŠµíŒ©`;\r\n  }\r\n  \r\n  /**\r\n   * íŒ© ì„¤ëª… ìƒì„±\r\n   */\r\n  private generatePackDescription(analytics: LearningAnalytics, cardCount: number): string {\r\n    const weaknessCount = analytics.identifiedWeaknesses.length;\r\n    const accuracyText = `í˜„ì¬ ì •ë‹µë¥  ${analytics.correctRate}%`;\r\n    \r\n    return `${accuracyText}ë¥¼ ë°”íƒ•ìœ¼ë¡œ ${weaknessCount}ê°œì˜ ì•½ì  íŒ¨í„´ì„ ë¶„ì„í•˜ì—¬ ${cardCount}ê°œì˜ ë§ì¶¤í˜• ë¬¸ì œë¥¼ ì„ ë³„í–ˆìŠµë‹ˆë‹¤. AIê°€ ì¶”ì²œí•˜ëŠ” ìµœì ì˜ í•™ìŠµ ìˆœì„œë¡œ êµ¬ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.`;\r\n  }\r\n  \r\n  /**\r\n   * Adaptive Pack ì €ì¥\r\n   */\r\n  private saveAdaptivePack(userId: string, pack: AdaptivePack): void {\r\n    try {\r\n      const key = `adaptive_pack_${userId}`;\r\n      const existingPacks = localStorage.getItem(key);\r\n      const packs: AdaptivePack[] = existingPacks ? JSON.parse(existingPacks) : [];\r\n      \r\n      // ìµœì‹  íŒ©ì„ ë§¨ ì•ì— ì¶”ê°€ (ìµœëŒ€ 5ê°œ ìœ ì§€)\r\n      packs.unshift(pack);\r\n      const limitedPacks = packs.slice(0, 5);\r\n      \r\n      localStorage.setItem(key, JSON.stringify(limitedPacks));\r\n    } catch (error) {\r\n      console.error('Adaptive Pack ì €ì¥ ì‹¤íŒ¨:', error);\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * ì €ì¥ëœ Adaptive Pack ì¡°íšŒ\r\n   */\r\n  async getSavedAdaptivePacks(userId: string): Promise<AdaptivePack[]> {\r\n    try {\r\n      const key = `adaptive_pack_${userId}`;\r\n      const stored = localStorage.getItem(key);\r\n      return stored ? JSON.parse(stored) : [];\r\n    } catch (error) {\r\n      console.error('Adaptive Pack ì¡°íšŒ ì‹¤íŒ¨:', error);\r\n      return [];\r\n    }\r\n  }\r\n}\r\n\r\nexport const adaptivePackService = new AdaptivePackService();","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\api.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AxiosRequestConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":8,"column":32,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":50},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AxiosResponse' is defined but never used. Allowed unused vars must match /^_/u.","line":8,"column":52,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":65},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'errorHandler' is defined but never used. Allowed unused vars must match /^_/u.","line":11,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":15}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @fileoverview í†µí•© API ì„œë¹„ìŠ¤ - ì „ë¬¸ì ì¸ ì—ëŸ¬ ì²˜ë¦¬ ë° ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ í¬í•¨\n * @description AI ë©´ì ‘ ì‹œë®¬ë ˆì´í„°ì˜ ëª¨ë“  API í†µì‹ ì„ ê´€ë¦¬í•˜ëŠ” ì¤‘ì•™ ì„œë¹„ìŠ¤\n * @author DaSiStart Team\n * @version 2.2.0\n */\n\nimport axios, { AxiosInstance, AxiosRequestConfig, AxiosResponse, AxiosError } from 'axios';\nimport { \n  logger,\n  errorHandler,\n  handleApiError\n} from '../utils/index';\nimport { CURRICULUM_CONFIG, getCurriculumPath } from '../config/curriculum';\n\n// ====== íƒ€ì… ì •ì˜ ======\n\nexport interface APIResponse<T = any> {\n  success: boolean;\n  data?: T;\n  error?: string;\n  message?: string;\n  timestamp: number;\n}\n\n// Updated to include topic\nexport interface InterviewConfig {\n  level: string;\n  topic: string;\n  position: string;\n  experience: string;\n}\n\nexport interface InterviewStartResponse {\n  interviewId: string;\n  question: string;\n  sessionInfo: {\n    level: string;\n    topic: string;\n  };\n}\n\nexport interface QuestionResponse {\n  question: string | null;\n  isComplete?: boolean;\n}\n\nexport interface EvaluationRequest {\n  interviewId: string;\n  question: string;\n  answer: string;\n}\n\nexport interface EvaluationResponse {\n  score: number;\n  feedback: string;\n  strengths: string[];\n  improvements: string[];\n}\n\n// ====== API í´ë¼ì´ì–¸íŠ¸ ì„¤ì • ======\n\nclass APIClient {\n  private axiosInstance: AxiosInstance;\n\n  constructor() {\n    this.axiosInstance = axios.create({\n      baseURL: CURRICULUM_CONFIG.baseUrl + '/api',\n      timeout: 30000,\n      headers: { \n        'Content-Type': 'application/json',\n        'X-Curriculum-Version': CURRICULUM_CONFIG.version \n      },\n    });\n\n    this.axiosInstance.interceptors.response.use(\n      (response) => response.data, // Unwrap the response data\n      (error: AxiosError) => {\n        const structuredError = handleApiError(error, { component: 'APIClient' });\n        return Promise.reject(structuredError);\n      }\n    );\n  }\n\n  public async request<T>(\n    endpoint: string,\n    method: 'GET' | 'POST',\n    data?: any\n  ): Promise<T> {\n    logger.info(`API Request: ${method} ${endpoint}`, 'API');\n    const response = await this.axiosInstance({ method, url: endpoint, data });\n    return response as T;\n  }\n}\n\n// ====== API ì„œë¹„ìŠ¤ í´ë˜ìŠ¤ë“¤ ======\n\nclass InterviewAPIService {\n  constructor(private client: APIClient) {}\n\n  start(config: InterviewConfig): Promise<APIResponse<InterviewStartResponse>> {\n    return this.client.request<APIResponse<InterviewStartResponse>>('/interview/start', 'POST', config);\n  }\n\n  getNextQuestion(data: { interviewId: string }): Promise<APIResponse<QuestionResponse>> {\n    return this.client.request<APIResponse<QuestionResponse>>('/interview/question', 'POST', data);\n  }\n\n  evaluate(data: EvaluationRequest): Promise<APIResponse<EvaluationResponse>> {\n    return this.client.request<APIResponse<EvaluationResponse>>('/interview/evaluate', 'POST', data);\n  }\n\n  end(interviewId: string): Promise<APIResponse<any>> {\n    return this.client.request<APIResponse<any>>(`/interview/${interviewId}/end`, 'POST');\n  }\n}\n\nclass CurriculumAPIService {\n  constructor(private client: APIClient) {}\n\n  async getCurriculum(level: number): Promise<APIResponse<any>> {\n    try {\n      const path = getCurriculumPath(level);\n      const response = await fetch(`${CURRICULUM_CONFIG.baseUrl}/${path}`);\n      if (!response.ok) throw new Error(`Failed to fetch curriculum: ${response.statusText}`);\n      const data = await response.json();\n      return { success: true, data, timestamp: Date.now() };\n    } catch (error) {\n      return { \n        success: false, \n        error: error instanceof Error ? error.message : 'Unknown error',\n        timestamp: Date.now() \n      };\n    }\n  }\n\n  async getStage(level: number, stageId: string): Promise<APIResponse<any>> {\n    try {\n      const curriculum = await this.getCurriculum(level);\n      if (!curriculum.success || !curriculum.data) {\n        return { success: false, error: 'Failed to load curriculum', timestamp: Date.now() };\n      }\n      const stage = curriculum.data.stages?.find((s: any) => s.stage_id === stageId);\n      return { \n        success: !!stage, \n        data: stage,\n        error: !stage ? 'Stage not found' : undefined,\n        timestamp: Date.now() \n      };\n    } catch (error) {\n      return { \n        success: false, \n        error: error instanceof Error ? error.message : 'Unknown error',\n        timestamp: Date.now() \n      };\n    }\n  }\n\n  async getAllLevelPatterns(level: number): Promise<APIResponse<any>> {\n    try {\n      const curriculum = await this.getCurriculum(level);\n      if (!curriculum.success || !curriculum.data) {\n        return { success: false, error: 'Failed to load curriculum', timestamp: Date.now() };\n      }\n\n      const allPatterns: any[] = [];\n      \n      // ëª¨ë“  ìŠ¤í…Œì´ì§€ì˜ íŒ¨í„´ë“¤ì„ ìˆ˜ì§‘\n      if (curriculum.data.stages) {\n        curriculum.data.stages.forEach((stage: any) => {\n          if (stage.patterns) {\n            stage.patterns.forEach((pattern: any) => {\n              allPatterns.push({\n                ...pattern,\n                stage_id: stage.stage_id,\n                stage_title: stage.title,\n              });\n            });\n          }\n        });\n      }\n\n      // íŒ¨í„´ë“¤ì„ ëœë¤í•˜ê²Œ ì„ê¸°\n      const shuffledPatterns = this.shuffleArray([...allPatterns]);\n\n      return { \n        success: true, \n        data: {\n          level,\n          mode: 'ALL',\n          total_patterns: shuffledPatterns.length,\n          patterns: shuffledPatterns,\n          title: `Level ${level} - ALL Mode`,\n          description: `All patterns from Level ${level} in random order`\n        },\n        timestamp: Date.now() \n      };\n    } catch (error) {\n      return { \n        success: false, \n        error: error instanceof Error ? error.message : 'Unknown error',\n        timestamp: Date.now() \n      };\n    }\n  }\n\n  private shuffleArray<T>(array: T[]): T[] {\n    const shuffled = [...array];\n    for (let i = shuffled.length - 1; i > 0; i--) {\n      const j = Math.floor(Math.random() * (i + 1));\n      [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];\n    }\n    return shuffled;\n  }\n\n  async validateCurriculum(level: number): Promise<APIResponse<any>> {\n    try {\n      const curriculum = await this.getCurriculum(level);\n      if (!curriculum.success || !curriculum.data) {\n        return { \n          success: false, \n          error: 'Failed to load curriculum for validation',\n          timestamp: Date.now() \n        };\n      }\n\n      const data = curriculum.data;\n      return { \n        success: true, \n        data: {\n          total_stages: data.total_stages || data.stages?.length || 0,\n          total_phases: data.total_phases || data.phases?.length || 0,\n          level: data.level,\n          title: data.title,\n          isRevised: getCurriculumPath(level).includes('_REVISED.json'),\n          stages: data.stages || []\n        },\n        timestamp: Date.now() \n      };\n    } catch (error) {\n      return { \n        success: false, \n        error: error instanceof Error ? error.message : 'Validation failed',\n        timestamp: Date.now() \n      };\n    }\n  }\n}\n\n// ====== ì„œë¹„ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ë° ë‚´ë³´ë‚´ê¸° ======\n\nconst apiClient = new APIClient();\n\nexport const interviewAPI = new InterviewAPIService(apiClient);\nexport const curriculumAPI = new CurriculumAPIService(apiClient);\n\n// authServiceì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê¸°ë³¸ API í´ë¼ì´ì–¸íŠ¸ export\nexport const api = apiClient;\n\nexport default { \n  interview: interviewAPI,\n  curriculum: curriculumAPI,\n  api: apiClient\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\authService.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ProgressUpdateParams' is defined but never used. Allowed unused vars must match /^_/u.","line":9,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":31},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'backendSuccess' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":147,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":147,"endColumn":27}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useAuth } from '../hooks/useAuth';\r\nimport { api } from './api';\r\n\r\ninterface ExpGainParams {\r\n  amount: number;\r\n  type: 'stage_clear' | 'review_success' | 'streak_bonus' | 'daily_login' | 'perfect_score';\r\n}\r\n\r\ninterface ProgressUpdateParams {\r\n  level?: number;\r\n  stage?: number;\r\n  exp?: number;\r\n  streak?: number;\r\n}\r\n\r\nclass AuthService {\r\n  /**\r\n   * ë°±ì—”ë“œ expServiceì™€ ì—°ë™í•˜ì—¬ ê²½í—˜ì¹˜ ì¶”ê°€\r\n   */\r\n  async addExpToBackend(userId: string, params: ExpGainParams): Promise<boolean> {\r\n    try {\r\n      console.log('[DEBUG] ğŸ“ˆ ë°±ì—”ë“œ ê²½í—˜ì¹˜ ì¶”ê°€ ìš”ì²­:', { userId, ...params });\r\n      \r\n      const response = await api.request('/exp/add', 'POST', {\r\n        userId,\r\n        amount: params.amount,\r\n        type: params.type\r\n      });\r\n      \r\n      console.log('[DEBUG] âœ… ë°±ì—”ë“œ ê²½í—˜ì¹˜ ì¶”ê°€ ì„±ê³µ:', response);\r\n      return true;\r\n    } catch (error) {\r\n      console.error('[DEBUG] âŒ ë°±ì—”ë“œ ê²½í—˜ì¹˜ ì¶”ê°€ ì‹¤íŒ¨:', error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ë°±ì—”ë“œ ìŠ¤íŠ¸ë¦­ ì—…ë°ì´íŠ¸\r\n   */\r\n  async updateStreakToBackend(userId: string): Promise<boolean> {\r\n    try {\r\n      console.log('[DEBUG] ğŸ”¥ ë°±ì—”ë“œ ìŠ¤íŠ¸ë¦­ ì—…ë°ì´íŠ¸ ìš”ì²­:', userId);\r\n      \r\n      const response = await api.request('/exp/streak', 'POST', { userId });\r\n      \r\n      console.log('[DEBUG] âœ… ë°±ì—”ë“œ ìŠ¤íŠ¸ë¦­ ì—…ë°ì´íŠ¸ ì„±ê³µ:', response);\r\n      return true;\r\n    } catch (error) {\r\n      console.error('[DEBUG] âŒ ë°±ì—”ë“œ ìŠ¤íŠ¸ë¦­ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:', error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * í•™ìŠµ ì™„ë£Œ ì‹œ ì¢…í•©ì ì¸ ì§„í–‰ë„ ì—…ë°ì´íŠ¸\r\n   */\r\n  async handleStudyCompletion(userId: string, completionData: {\r\n    level: number;\r\n    stage: number;\r\n    score: number;\r\n    timeSpent: number;\r\n    mistakes: number;\r\n  }): Promise<boolean> {\r\n    try {\r\n      console.log('[DEBUG] ğŸ“š í•™ìŠµ ì™„ë£Œ ì²˜ë¦¬:', { userId, ...completionData });\r\n\r\n      // 1. ê²½í—˜ì¹˜ ê³„ì‚° ë° ì¶”ê°€\r\n      let expGain = 10; // ê¸°ë³¸ ê²½í—˜ì¹˜\r\n      let expType: ExpGainParams['type'] = 'stage_clear';\r\n\r\n      if (completionData.score >= 90) {\r\n        expGain += 5; // ê³ ë“ì  ë³´ë„ˆìŠ¤\r\n        expType = 'perfect_score';\r\n      }\r\n\r\n      if (completionData.mistakes === 0) {\r\n        expGain += 3; // ì™„ë²½ ë³´ë„ˆìŠ¤\r\n      }\r\n\r\n      // 2. ë°±ì—”ë“œ ê²½í—˜ì¹˜ ì¶”ê°€\r\n      const expSuccess = await this.addExpToBackend(userId, {\r\n        amount: expGain,\r\n        type: expType\r\n      });\r\n\r\n      // 3. ìŠ¤íŠ¸ë¦­ ì—…ë°ì´íŠ¸\r\n      const streakSuccess = await this.updateStreakToBackend(userId);\r\n\r\n      console.log('[DEBUG] âœ… í•™ìŠµ ì™„ë£Œ ì²˜ë¦¬ ê²°ê³¼:', { expSuccess, streakSuccess });\r\n      return expSuccess && streakSuccess;\r\n    } catch (error) {\r\n      console.error('[DEBUG] âŒ í•™ìŠµ ì™„ë£Œ ì²˜ë¦¬ ì‹¤íŒ¨:', error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * í”„ë¡ íŠ¸ì—”ë“œì™€ ë°±ì—”ë“œ ì§„í–‰ë„ ë™ê¸°í™”\r\n   */\r\n  async syncProgress(userId: string): Promise<boolean> {\r\n    try {\r\n      console.log('[DEBUG] ğŸ”„ ì§„í–‰ë„ ë™ê¸°í™” ì‹œì‘:', userId);\r\n      \r\n      // ë°±ì—”ë“œì—ì„œ ìµœì‹  ì‚¬ìš©ì ë°ì´í„° ê°€ì ¸ì˜¤ê¸°\r\n      const response = await api.request(`/users/${userId}`, 'GET');\r\n      const backendUserData = response;\r\n      \r\n      console.log('[DEBUG] ğŸ“Š ë°±ì—”ë“œ ì‚¬ìš©ì ë°ì´í„°:', backendUserData);\r\n      \r\n      // í•„ìš”ì‹œ Firestore ì—…ë°ì´íŠ¸\r\n      // ì´ ë¶€ë¶„ì€ useAuth hookì—ì„œ ì²˜ë¦¬í•˜ê±°ë‚˜ ë³„ë„ í•¨ìˆ˜ë¡œ ë¶„ë¦¬ ê°€ëŠ¥\r\n      \r\n      return true;\r\n    } catch (error) {\r\n      console.error('[DEBUG] âŒ ì§„í–‰ë„ ë™ê¸°í™” ì‹¤íŒ¨:', error);\r\n      return false;\r\n    }\r\n  }\r\n}\r\n\r\n// ì‹±ê¸€í†¤ ì¸ìŠ¤í„´ìŠ¤\r\nexport const authService = new AuthService();\r\n\r\n// Hookì„ ì‚¬ìš©í•˜ëŠ” ì»¤ìŠ¤í…€ í›…\r\nexport const useAuthService = () => {\r\n  const { user, addExp, updateUserProgress } = useAuth();\r\n\r\n  const handleStudyComplete = async (completionData: {\r\n    level: number;\r\n    stage: number;\r\n    score: number;\r\n    timeSpent: number;\r\n    mistakes: number;\r\n  }) => {\r\n    if (!user) {\r\n      console.warn('[DEBUG] âš ï¸ ë¡œê·¸ì¸ë˜ì§€ ì•Šì€ ìƒíƒœì—ì„œ í•™ìŠµ ì™„ë£Œ ì²˜ë¦¬ ì‹œë„');\r\n      return false;\r\n    }\r\n\r\n    try {\r\n      // 1. í”„ë¡ íŠ¸ì—”ë“œ ì§„í–‰ë„ ì—…ë°ì´íŠ¸ (ì¦‰ì‹œ ë°˜ì˜)\r\n      const expGain = calculateExpGain(completionData);\r\n      const frontendSuccess = await addExp(expGain);\r\n\r\n      // 2. ë°±ì—”ë“œ ë™ê¸°í™” (ë°±ê·¸ë¼ìš´ë“œ)\r\n      const backendSuccess = await authService.handleStudyCompletion(user.uid, completionData);\r\n\r\n      // 3. Stage ì§„í–‰ë„ ì—…ë°ì´íŠ¸\r\n      if (completionData.score >= 70) { // 70ì  ì´ìƒ ì‹œ ë‹¤ìŒ ìŠ¤í…Œì´ì§€ë¡œ\r\n        const progressSuccess = await updateUserProgress({\r\n          level: completionData.level,\r\n          stage: completionData.stage + 1\r\n        });\r\n        console.log('[DEBUG] ğŸ“ˆ ìŠ¤í…Œì´ì§€ ì§„í–‰ë„ ì—…ë°ì´íŠ¸:', progressSuccess);\r\n      }\r\n\r\n      return frontendSuccess;\r\n    } catch (error) {\r\n      console.error('[DEBUG] âŒ í†µí•© í•™ìŠµ ì™„ë£Œ ì²˜ë¦¬ ì‹¤íŒ¨:', error);\r\n      return false;\r\n    }\r\n  };\r\n\r\n  return {\r\n    handleStudyComplete,\r\n    isAuthenticated: !!user,\r\n    userId: user?.uid\r\n  };\r\n};\r\n\r\n// ê²½í—˜ì¹˜ ê³„ì‚° í—¬í¼\r\nfunction calculateExpGain(data: { score: number; timeSpent: number; mistakes: number }): number {\r\n  let exp = 10; // ê¸°ë³¸\r\n\r\n  if (data.score >= 90) exp += 5;\r\n  if (data.mistakes === 0) exp += 3;\r\n  if (data.timeSpent < 60000) exp += 2; // 1ë¶„ ì´ë‚´\r\n\r\n  return exp;\r\n}\r\n\r\nexport default authService;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\curriculumLint.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\curriculum\\CurriculumDemo.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\curriculum\\CurriculumLoader.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\curriculum\\Level4Service.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\curriculum\\Level4ServiceQuick.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\curriculum\\LevelServiceFactory.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Level4Service' is defined but never used. Allowed unused vars must match /^_/u.","line":6,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Levelë³„ ì„œë¹„ìŠ¤ë¥¼ ê´€ë¦¬í•˜ëŠ” íŒ©í† ë¦¬ í´ë˜ìŠ¤\n * ëŠìŠ¨í•œ ê²°í•©ì„ ìœ„í•´ íŒ©í† ë¦¬ íŒ¨í„´ ì ìš©\n */\n\nimport { Level4Service } from './Level4Service';\nimport { Level4ServiceQuick } from './Level4ServiceQuick';\nimport { LegacyQuestionItem } from './types/CurriculumTypes';\n\ninterface LevelService {\n  generateLegacyQuestions(stageNumber: number): Promise<LegacyQuestionItem[]>;\n}\n\nexport class LevelServiceFactory {\n  private static services: Map<number, LevelService> = new Map();\n\n  /**\n   * ë ˆë²¨ì— í•´ë‹¹í•˜ëŠ” ì„œë¹„ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ ë°˜í™˜\n   */\n  static getService(level: number): LevelService | null {\n    // ìºì‹œëœ ì„œë¹„ìŠ¤ê°€ ìˆìœ¼ë©´ ë°˜í™˜\n    if (this.services.has(level)) {\n      return this.services.get(level)!;\n    }\n\n    // ë ˆë²¨ë³„ ì„œë¹„ìŠ¤ ìƒì„±\n    let service: LevelService | null = null;\n    \n    switch (level) {\n      case 4:\n        // ë¹ ë¥¸ í•´ê²°ì±…: í•˜ë“œì½”ë”©ëœ ì˜ˆë¬¸ ì‚¬ìš©\n        service = {\n          generateLegacyQuestions: Level4ServiceQuick.generateLegacyQuestions.bind(Level4ServiceQuick)\n        };\n        break;\n      case 5:\n        // Level5Service êµ¬í˜„ë˜ë©´ ì¶”ê°€\n        service = this.createFallbackService(5);\n        break;\n      case 6:\n        // Level6Service êµ¬í˜„ë˜ë©´ ì¶”ê°€  \n        service = this.createFallbackService(6);\n        break;\n      case 7:\n        service = this.createFallbackService(7);\n        break;\n      case 8:\n        service = this.createFallbackService(8);\n        break;\n      case 9:\n        service = this.createFallbackService(9);\n        break;\n      case 10:\n        service = this.createFallbackService(10);\n        break;\n      default:\n        console.warn(`Level ${level} ì„œë¹„ìŠ¤ê°€ êµ¬í˜„ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.`);\n        return null;\n    }\n\n    if (service) {\n      this.services.set(level, service);\n    }\n\n    return service;\n  }\n\n  /**\n   * ì•„ì§ êµ¬í˜„ë˜ì§€ ì•Šì€ ë ˆë²¨ì„ ìœ„í•œ í´ë°± ì„œë¹„ìŠ¤\n   */\n  private static createFallbackService(level: number): LevelService {\n    return {\n      async generateLegacyQuestions(stageNumber: number): Promise<LegacyQuestionItem[]> {\n        console.warn(`Level ${level} ì„œë¹„ìŠ¤ ë¯¸êµ¬í˜„. í´ë°± ë°ì´í„° ì‚¬ìš©.`);\n        \n        // ê¸°ë³¸ í´ë°± ë¬¸ì¥ë“¤ (104ê°œê¹Œì§€ ìƒì„±)\n        const sentences: LegacyQuestionItem[] = [];\n        const baseTemplates = [\n          { korean: `Level ${level} ê¸°ë³¸ ë¬¸ì¥ì…ë‹ˆë‹¤`, english: `This is a Level ${level} basic sentence` },\n          { korean: `Level ${level} ê³ ê¸‰ í‘œí˜„ì„ ì—°ìŠµí•©ë‹ˆë‹¤`, english: `Practicing Level ${level} advanced expressions` },\n          { korean: `Level ${level}ì—ì„œ ë°°ìš°ëŠ” ë¬¸ë²•ì…ë‹ˆë‹¤`, english: `Grammar learned in Level ${level}` }\n        ];\n\n        for (let i = 0; i < 104; i++) {\n          const template = baseTemplates[i % baseTemplates.length];\n          sentences.push({\n            korean: `${template.korean} (${i + 1})`,\n            english: `${template.english} (${i + 1})`,\n            level: level,\n            stage: stageNumber,\n            pattern: `Level ${level} Pattern`\n          });\n        }\n\n        return sentences;\n      }\n    };\n  }\n\n  /**\n   * íŠ¹ì • ë ˆë²¨ê³¼ ìŠ¤í…Œì´ì§€ì˜ ë¬¸ì œ ìƒì„±\n   * ê¸°ì¡´ PatternDataManager.generateQuestions ëŒ€ì²´ìš©\n   */\n  static async generateQuestions(level: number, stageNumber: number): Promise<LegacyQuestionItem[]> {\n    const service = this.getService(level);\n    if (!service) {\n      console.error(`Level ${level} ì„œë¹„ìŠ¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`);\n      return [];\n    }\n\n    try {\n      const questions = await service.generateLegacyQuestions(stageNumber);\n      console.log(`âœ… Level ${level} Stage ${stageNumber}: ${questions.length}ê°œ ë¬¸ì œ ìƒì„±`);\n      return questions;\n    } catch (error) {\n      console.error(`Level ${level} Stage ${stageNumber} ë¬¸ì œ ìƒì„± ì‹¤íŒ¨:`, error);\n      return [];\n    }\n  }\n\n  /**\n   * ëª¨ë“  ì„œë¹„ìŠ¤ ìºì‹œ í´ë¦¬ì–´\n   */\n  static clearCache(): void {\n    this.services.clear();\n  }\n\n  /**\n   * ì‚¬ìš© ê°€ëŠ¥í•œ ë ˆë²¨ ëª©ë¡ ë°˜í™˜\n   */\n  static getAvailableLevels(): number[] {\n    return [4, 5, 6, 7, 8, 9, 10];\n  }\n\n  /**\n   * íŠ¹ì • ë ˆë²¨ì´ ì§€ì›ë˜ëŠ”ì§€ í™•ì¸\n   */\n  static isLevelSupported(level: number): boolean {\n    return this.getAvailableLevels().includes(level);\n  }\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\curriculum\\types\\CurriculumTypes.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\events\\EventLifecycleManager.ts","messages":[{"ruleId":"no-undef","severity":1,"message":"'EventListener' is not defined.","line":65,"column":75,"nodeType":"Identifier","messageId":"undef","endLine":65,"endColumn":88},{"ruleId":"no-undef","severity":1,"message":"'EventListener' is not defined.","line":83,"column":75,"nodeType":"Identifier","messageId":"undef","endLine":83,"endColumn":88}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * EventLifecycleManager - ì´ë²¤íŠ¸ ë¼ì´í”„ì‚¬ì´í´ ê´€ë¦¬ ëª¨ë“ˆ\r\n * \r\n * ì—­í• :\r\n * - ì™„ë£Œ ì•Œë¦¼ ì¤‘ë³µ ë°©ì§€\r\n * - ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¤‘ë³µ ë“±ë¡ ë°©ì§€\r\n * - ì»´í¬ë„ŒíŠ¸ ìƒíƒœ ë³€í™”ì— ë”°ë¥¸ ì´ë²¤íŠ¸ ì •ë¦¬\r\n */\r\n\r\nexport type EventType = 'completion' | 'tts' | 'recognition' | 'navigation';\r\n\r\nexport interface EventConfig {\r\n  id: string;\r\n  type: EventType;\r\n  handler: Function;\r\n  element?: EventTarget;\r\n  eventName?: string;\r\n}\r\n\r\nexport interface EventState {\r\n  id: string;\r\n  type: EventType;\r\n  handler: Function;\r\n  element?: EventTarget;\r\n  eventName?: string;\r\n  isActive: boolean;\r\n  registeredAt: number;\r\n}\r\n\r\nclass EventLifecycleManager {\r\n  private events: Map<string, EventState> = new Map();\r\n  private completionHistory: Set<string> = new Set(); // ì™„ë£Œ ì´ë²¤íŠ¸ ì¤‘ë³µ ë°©ì§€\r\n  private static instance: EventLifecycleManager | null = null;\r\n\r\n  // Singleton pattern\r\n  static getInstance(): EventLifecycleManager {\r\n    if (!EventLifecycleManager.instance) {\r\n      EventLifecycleManager.instance = new EventLifecycleManager();\r\n    }\r\n    return EventLifecycleManager.instance;\r\n  }\r\n\r\n  /**\r\n   * ì´ë²¤íŠ¸ ë“±ë¡ (ì¤‘ë³µ ë°©ì§€)\r\n   */\r\n  registerEvent(config: EventConfig): boolean {\r\n    // ì´ë¯¸ ë“±ë¡ëœ ì´ë²¤íŠ¸ëŠ” ë¬´ì‹œ\r\n    if (this.events.has(config.id)) {\r\n      console.log(`âš ï¸ [EventManager] ì´ë²¤íŠ¸ ì´ë¯¸ ë“±ë¡ë¨: ${config.id}`);\r\n      return false;\r\n    }\r\n\r\n    const state: EventState = {\r\n      id: config.id,\r\n      type: config.type,\r\n      handler: config.handler,\r\n      element: config.element,\r\n      eventName: config.eventName,\r\n      isActive: true,\r\n      registeredAt: Date.now()\r\n    };\r\n\r\n    // DOM ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡\r\n    if (config.element && config.eventName) {\r\n      config.element.addEventListener(config.eventName, config.handler as EventListener);\r\n      console.log(`ğŸ“¡ [EventManager] DOM ì´ë²¤íŠ¸ ë“±ë¡: ${config.eventName} on ${config.element.constructor.name}`);\r\n    }\r\n\r\n    this.events.set(config.id, state);\r\n    console.log(`âœ… [EventManager] ì´ë²¤íŠ¸ ë“±ë¡: ${config.id} (íƒ€ì…: ${config.type})`);\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * ì´ë²¤íŠ¸ ì œê±°\r\n   */\r\n  unregisterEvent(id: string): boolean {\r\n    const state = this.events.get(id);\r\n    if (!state) return false;\r\n\r\n    // DOM ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì œê±°\r\n    if (state.element && state.eventName) {\r\n      state.element.removeEventListener(state.eventName, state.handler as EventListener);\r\n      console.log(`ğŸ“¡ [EventManager] DOM ì´ë²¤íŠ¸ ì œê±°: ${state.eventName}`);\r\n    }\r\n\r\n    state.isActive = false;\r\n    this.events.delete(id);\r\n    console.log(`ğŸ—‘ï¸ [EventManager] ì´ë²¤íŠ¸ ì œê±°: ${id}`);\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * íŠ¹ì • íƒ€ì…ì˜ ëª¨ë“  ì´ë²¤íŠ¸ ì œê±°\r\n   */\r\n  unregisterEventsByType(type: EventType): number {\r\n    let count = 0;\r\n    for (const [id, state] of this.events.entries()) {\r\n      if (state.type === type) {\r\n        this.unregisterEvent(id);\r\n        count++;\r\n      }\r\n    }\r\n    console.log(`ğŸ—‘ï¸ [EventManager] ${type} íƒ€ì… ì´ë²¤íŠ¸ ${count}ê°œ ì œê±°`);\r\n    return count;\r\n  }\r\n\r\n  /**\r\n   * ì™„ë£Œ ì´ë²¤íŠ¸ ì¤‘ë³µ ë°©ì§€ ì²˜ë¦¬\r\n   */\r\n  handleCompletion(completionId: string, callback: () => void): boolean {\r\n    // ì´ë¯¸ ì²˜ë¦¬ëœ ì™„ë£Œ ì´ë²¤íŠ¸ëŠ” ë¬´ì‹œ\r\n    if (this.completionHistory.has(completionId)) {\r\n      console.log(`âš ï¸ [EventManager] ì™„ë£Œ ì´ë²¤íŠ¸ ì¤‘ë³µ ë¬´ì‹œ: ${completionId}`);\r\n      return false;\r\n    }\r\n\r\n    // ì™„ë£Œ ì´ë²¤íŠ¸ ì²˜ë¦¬\r\n    this.completionHistory.add(completionId);\r\n    callback();\r\n    \r\n    console.log(`ğŸ‰ [EventManager] ì™„ë£Œ ì´ë²¤íŠ¸ ì²˜ë¦¬: ${completionId}`);\r\n\r\n    // 5ì´ˆ í›„ íˆìŠ¤í† ë¦¬ì—ì„œ ì œê±° (ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ë°©ì§€)\r\n    setTimeout(() => {\r\n      this.completionHistory.delete(completionId);\r\n      console.log(`ğŸ§¹ [EventManager] ì™„ë£Œ íˆìŠ¤í† ë¦¬ ì •ë¦¬: ${completionId}`);\r\n    }, 5000);\r\n\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * TTS ì´ë²¤íŠ¸ ê´€ë¦¬\r\n   */\r\n  manageTTSEvent(utterance: SpeechSynthesisUtterance, eventType: 'start' | 'end' | 'error', handler: Function): void {\r\n    const eventId = `tts-${eventType}-${Date.now()}`;\r\n    \r\n    // ê¸°ì¡´ TTS ì´ë²¤íŠ¸ ì •ë¦¬\r\n    this.unregisterEventsByType('tts');\r\n\r\n    // ìƒˆë¡œìš´ TTS ì´ë²¤íŠ¸ ë“±ë¡\r\n    const wrappedHandler = (...args: any[]) => {\r\n      handler(...args);\r\n      // TTS ì´ë²¤íŠ¸ëŠ” ì¼íšŒì„±ì´ë¯€ë¡œ ìë™ ì •ë¦¬\r\n      this.unregisterEvent(eventId);\r\n    };\r\n\r\n    this.registerEvent({\r\n      id: eventId,\r\n      type: 'tts',\r\n      handler: wrappedHandler\r\n    });\r\n\r\n    // SpeechSynthesisUtteranceì— ì§ì ‘ í• ë‹¹\r\n    if (eventType === 'start') {\r\n      utterance.onstart = wrappedHandler;\r\n    } else if (eventType === 'end') {\r\n      utterance.onend = wrappedHandler;\r\n    } else if (eventType === 'error') {\r\n      utterance.onerror = wrappedHandler;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ìŒì„±ì¸ì‹ ì´ë²¤íŠ¸ ê´€ë¦¬\r\n   */\r\n  manageRecognitionEvent(recognition: any, eventType: 'result' | 'end' | 'error', handler: Function): void {\r\n    const eventId = `recognition-${eventType}-${Date.now()}`;\r\n    \r\n    // ìƒˆë¡œìš´ ìŒì„±ì¸ì‹ ì´ë²¤íŠ¸ ë“±ë¡\r\n    const wrappedHandler = (...args: any[]) => {\r\n      handler(...args);\r\n      // result ì´ë²¤íŠ¸ëŠ” ì—¬ëŸ¬ ë²ˆ ë°œìƒí•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ end/errorë§Œ ìë™ ì •ë¦¬\r\n      if (eventType !== 'result') {\r\n        this.unregisterEvent(eventId);\r\n      }\r\n    };\r\n\r\n    this.registerEvent({\r\n      id: eventId,\r\n      type: 'recognition',\r\n      handler: wrappedHandler\r\n    });\r\n\r\n    // Recognition ê°ì²´ì— ì§ì ‘ í• ë‹¹\r\n    if (eventType === 'result') {\r\n      recognition.onresult = wrappedHandler;\r\n    } else if (eventType === 'end') {\r\n      recognition.onend = wrappedHandler;\r\n    } else if (eventType === 'error') {\r\n      recognition.onerror = wrappedHandler;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ëª¨ë“  ì´ë²¤íŠ¸ ì •ë¦¬\r\n   */\r\n  clearAllEvents(): void {\r\n    for (const [id] of this.events.entries()) {\r\n      this.unregisterEvent(id);\r\n    }\r\n    this.completionHistory.clear();\r\n    console.log(`ğŸ§¹ [EventManager] ëª¨ë“  ì´ë²¤íŠ¸ ì •ë¦¬ ì™„ë£Œ`);\r\n  }\r\n\r\n  /**\r\n   * ì´ë²¤íŠ¸ ìƒíƒœ ì¡°íšŒ\r\n   */\r\n  getEventState(id: string): EventState | null {\r\n    return this.events.get(id) || null;\r\n  }\r\n\r\n  /**\r\n   * í™œì„± ì´ë²¤íŠ¸ ëª©ë¡\r\n   */\r\n  getActiveEvents(): EventState[] {\r\n    return Array.from(this.events.values()).filter(state => state.isActive);\r\n  }\r\n\r\n  /**\r\n   * ì™„ë£Œ íˆìŠ¤í† ë¦¬ ì¡°íšŒ\r\n   */\r\n  getCompletionHistory(): string[] {\r\n    return Array.from(this.completionHistory);\r\n  }\r\n\r\n  /**\r\n   * ë””ë²„ê·¸ ì •ë³´\r\n   */\r\n  debug(): void {\r\n    console.log(`ğŸ” [EventManager] í™œì„± ì´ë²¤íŠ¸: ${this.events.size}ê°œ`);\r\n    console.log(`ğŸ” [EventManager] ì™„ë£Œ íˆìŠ¤í† ë¦¬: ${this.completionHistory.size}ê°œ`);\r\n    \r\n    for (const [id, state] of this.events.entries()) {\r\n      const age = Date.now() - state.registeredAt;\r\n      console.log(`  - ${id}: ${state.type} (ìˆ˜ëª…: ${age}ms)`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ì˜¤ë˜ëœ ì´ë²¤íŠ¸ ì •ë¦¬ (ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ë°©ì§€)\r\n   */\r\n  cleanupOldEvents(maxAge: number = 30000): number { // 30ì´ˆ\r\n    let cleaned = 0;\r\n    const now = Date.now();\r\n    \r\n    for (const [id, state] of this.events.entries()) {\r\n      if (now - state.registeredAt > maxAge) {\r\n        this.unregisterEvent(id);\r\n        cleaned++;\r\n      }\r\n    }\r\n    \r\n    if (cleaned > 0) {\r\n      console.log(`ğŸ§¹ [EventManager] ì˜¤ë˜ëœ ì´ë²¤íŠ¸ ${cleaned}ê°œ ì •ë¦¬`);\r\n    }\r\n    \r\n    return cleaned;\r\n  }\r\n}\r\n\r\nexport default EventLifecycleManager;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\feedbackService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\firestoreDoD.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\incorrectPriorityService.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'record' is defined but never used. Allowed unused args must match /^_/u.","line":347,"column":37,"nodeType":null,"messageId":"unusedVar","endLine":347,"endColumn":43}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// ì˜¤ë‹µ ìš°ì„  ì•Œê³ ë¦¬ì¦˜ - ìµœê·¼ 3ì¼ í‹€ë¦° ë¬¸ì¥ ê°€ì¤‘ ì¬ì¶œì œ\r\n\r\ninterface IncorrectRecord {\r\n  sentenceId: string;\r\n  userId: string;\r\n  level: number;\r\n  stage: number;\r\n  stageId: string;\r\n  incorrectCount: number;\r\n  lastIncorrectDate: Date;\r\n  recentMistakes: Array<{\r\n    timestamp: Date;\r\n    mistakeType: 'grammar' | 'vocabulary' | 'spelling' | 'structure';\r\n    userAnswer: string;\r\n    correctAnswer: string;\r\n  }>;\r\n  weight: number; // ìš°ì„ ìˆœìœ„ ê°€ì¤‘ì¹˜\r\n}\r\n\r\ninterface PrioritySession {\r\n  totalSentences: number;\r\n  incorrectPrioritySentences: string[];\r\n  regularSentences: string[];\r\n  sessionType: 'incorrect_focus' | 'mixed' | 'regular';\r\n}\r\n\r\nclass IncorrectPriorityService {\r\n  \r\n  /**\r\n   * ì˜¤ë‹µ ìš°ì„  ë³µìŠµ ì„¸ì…˜ ìƒì„±\r\n   */\r\n  async createIncorrectPrioritySession(\r\n    userId: string, \r\n    totalSentences: number = 30,\r\n    incorrectRatio: number = 0.7 // 70%ëŠ” ì˜¤ë‹µ ë¬¸ì¥, 30%ëŠ” ì¼ë°˜ ë¬¸ì¥\r\n  ): Promise<PrioritySession> {\r\n    \r\n    try {\r\n      // ìµœê·¼ 3ì¼ ì˜¤ë‹µ ë¬¸ì¥ë“¤ ì¡°íšŒ\r\n      const incorrectSentences = await this.getRecentIncorrectSentences(userId, 3);\r\n      \r\n      // ì˜¤ë‹µ ë¬¸ì¥ ê°œìˆ˜ ê³„ì‚°\r\n      const maxIncorrectCount = Math.floor(totalSentences * incorrectRatio);\r\n      const actualIncorrectCount = Math.min(incorrectSentences.length, maxIncorrectCount);\r\n      \r\n      // ì„¸ì…˜ íƒ€ì… ê²°ì •\r\n      let sessionType: 'incorrect_focus' | 'mixed' | 'regular';\r\n      if (incorrectSentences.length === 0) {\r\n        sessionType = 'regular';\r\n      } else if (actualIncorrectCount >= totalSentences * 0.5) {\r\n        sessionType = 'incorrect_focus';\r\n      } else {\r\n        sessionType = 'mixed';\r\n      }\r\n      \r\n      // ìš°ì„ ìˆœìœ„ ê¸°ë°˜ ì˜¤ë‹µ ë¬¸ì¥ ì„ íƒ\r\n      const prioritizedIncorrect = this.selectPriorityIncorrectSentences(\r\n        incorrectSentences, \r\n        actualIncorrectCount\r\n      );\r\n      \r\n      // ë‚˜ë¨¸ì§€ëŠ” ì¼ë°˜ ë¬¸ì¥ìœ¼ë¡œ ì±„ìš°ê¸°\r\n      const remainingCount = totalSentences - prioritizedIncorrect.length;\r\n      const regularSentences = await this.getRegularSentences(userId, remainingCount, prioritizedIncorrect);\r\n      \r\n      return {\r\n        totalSentences,\r\n        incorrectPrioritySentences: prioritizedIncorrect,\r\n        regularSentences,\r\n        sessionType\r\n      };\r\n      \r\n    } catch (error) {\r\n      console.error('ì˜¤ë‹µ ìš°ì„  ì„¸ì…˜ ìƒì„± ì‹¤íŒ¨:', error);\r\n      throw error;\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * ìµœê·¼ 3ì¼ ë‚´ í‹€ë¦° ë¬¸ì¥ë“¤ ì¡°íšŒ (ê°€ì¤‘ì¹˜ í¬í•¨)\r\n   */\r\n  async getRecentIncorrectSentences(userId: string, days: number = 3): Promise<IncorrectRecord[]> {\r\n    try {\r\n      const cutoffDate = new Date();\r\n      cutoffDate.setDate(cutoffDate.getDate() - days);\r\n      \r\n      // ì‹¤ì œë¡œëŠ” Firestoreì—ì„œ ì¡°íšŒ\r\n      // ì„ì‹œ ë°ì´í„°ë¡œ ì‹œë®¬ë ˆì´ì…˜\r\n      const mockIncorrectRecords: IncorrectRecord[] = [\r\n        {\r\n          sentenceId: 'Lv3-P2-S09_15',\r\n          userId,\r\n          level: 3,\r\n          stage: 9,\r\n          stageId: 'Lv3-P2-S09',\r\n          incorrectCount: 3,\r\n          lastIncorrectDate: new Date(Date.now() - 1 * 24 * 60 * 60 * 1000), // 1ì¼ ì „\r\n          recentMistakes: [\r\n            {\r\n              timestamp: new Date(Date.now() - 1 * 24 * 60 * 60 * 1000),\r\n              mistakeType: 'grammar',\r\n              userAnswer: 'If I would have time',\r\n              correctAnswer: 'If I had time'\r\n            }\r\n          ],\r\n          weight: 0\r\n        },\r\n        {\r\n          sentenceId: 'Lv4-B1-S02_08',\r\n          userId,\r\n          level: 4,\r\n          stage: 2,\r\n          stageId: 'Lv4-B1-S02',\r\n          incorrectCount: 2,\r\n          lastIncorrectDate: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000), // 2ì¼ ì „\r\n          recentMistakes: [\r\n            {\r\n              timestamp: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000),\r\n              mistakeType: 'vocabulary',\r\n              userAnswer: 'We must optimize our strategy',\r\n              correctAnswer: 'We need to leverage our strategy'\r\n            }\r\n          ],\r\n          weight: 0\r\n        }\r\n      ];\r\n      \r\n      // ê°€ì¤‘ì¹˜ ê³„ì‚°\r\n      return mockIncorrectRecords.map(record => ({\r\n        ...record,\r\n        weight: this.calculatePriorityWeight(record, cutoffDate)\r\n      }));\r\n      \r\n    } catch (error) {\r\n      console.error('ìµœê·¼ ì˜¤ë‹µ ë¬¸ì¥ ì¡°íšŒ ì‹¤íŒ¨:', error);\r\n      return [];\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * ìš°ì„ ìˆœìœ„ ê°€ì¤‘ì¹˜ ê³„ì‚°\r\n   */\r\n  private calculatePriorityWeight(record: IncorrectRecord, cutoffDate: Date): number {\r\n    const now = new Date();\r\n    const daysSinceLastMistake = Math.floor(\r\n      (now.getTime() - record.lastIncorrectDate.getTime()) / (24 * 60 * 60 * 1000)\r\n    );\r\n    \r\n    // ê¸°ë³¸ ê°€ì¤‘ì¹˜ (í‹€ë¦° íšŸìˆ˜ ê¸°ë°˜)\r\n    let weight = record.incorrectCount * 1.0;\r\n    \r\n    // ìµœê·¼ì„± ê°€ì¤‘ì¹˜ (ìµœê·¼ì¼ìˆ˜ë¡ ë†’ì€ ê°€ì¤‘ì¹˜)\r\n    const recencyMultiplier = Math.max(0.1, 1.0 - (daysSinceLastMistake * 0.2));\r\n    weight *= recencyMultiplier;\r\n    \r\n    // ìµœê·¼ 3ì¼ ë‚´ ì‹¤ìˆ˜ ë¹ˆë„ ê°€ì¤‘ì¹˜\r\n    const recentMistakeCount = record.recentMistakes.filter(\r\n      mistake => mistake.timestamp >= cutoffDate\r\n    ).length;\r\n    weight += recentMistakeCount * 0.5;\r\n    \r\n    // ì‹¤ìˆ˜ ìœ í˜•ë³„ ê°€ì¤‘ì¹˜\r\n    const grammarMistakes = record.recentMistakes.filter(m => m.mistakeType === 'grammar').length;\r\n    const vocabularyMistakes = record.recentMistakes.filter(m => m.mistakeType === 'vocabulary').length;\r\n    \r\n    if (grammarMistakes > 0) weight += 0.3; // ë¬¸ë²• ì‹¤ìˆ˜ëŠ” ë” ì¤‘ìš”\r\n    if (vocabularyMistakes > 0) weight += 0.2; // ì–´íœ˜ ì‹¤ìˆ˜\r\n    \r\n    return Math.min(10.0, weight); // ìµœëŒ€ ê°€ì¤‘ì¹˜ ì œí•œ\r\n  }\r\n  \r\n  /**\r\n   * ìš°ì„ ìˆœìœ„ ê¸°ë°˜ ì˜¤ë‹µ ë¬¸ì¥ ì„ íƒ\r\n   */\r\n  private selectPriorityIncorrectSentences(\r\n    incorrectRecords: IncorrectRecord[], \r\n    maxCount: number\r\n  ): string[] {\r\n    \r\n    // ê°€ì¤‘ì¹˜ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬\r\n    const sortedRecords = incorrectRecords\r\n      .filter(record => record.weight > 0.5) // ìµœì†Œ ê°€ì¤‘ì¹˜ ì´ìƒë§Œ\r\n      .sort((a, b) => b.weight - a.weight) // ê°€ì¤‘ì¹˜ ë†’ì€ ìˆœ\r\n      .slice(0, maxCount);\r\n    \r\n    return sortedRecords.map(record => record.sentenceId);\r\n  }\r\n  \r\n  /**\r\n   * ì¼ë°˜ ë¬¸ì¥ ì„ íƒ (ì˜¤ë‹µ ë¬¸ì¥ ì œì™¸)\r\n   */\r\n  private async getRegularSentences(\r\n    userId: string, \r\n    count: number, \r\n    excludeSentenceIds: string[]\r\n  ): Promise<string[]> {\r\n    \r\n    try {\r\n      // ì‚¬ìš©ì ë ˆë²¨ì— ë§ëŠ” ë¬¸ì¥ë“¤ ì¡°íšŒ (ì˜¤ë‹µ ë¬¸ì¥ ì œì™¸)\r\n      // ì‹¤ì œë¡œëŠ” Firestoreì—ì„œ ì¡°íšŒí•˜ê³  excludeSentenceIdsë¥¼ ì œì™¸\r\n      \r\n      // ì„ì‹œ ë°ì´í„°\r\n      const allSentences = [\r\n        'Lv3-P1-S01_01', 'Lv3-P1-S01_02', 'Lv3-P1-S01_03',\r\n        'Lv4-B1-S01_01', 'Lv4-B1-S01_02', 'Lv4-B1-S01_03',\r\n        'Lv5-A1-S01_01', 'Lv5-A1-S01_02', 'Lv5-A1-S01_03'\r\n      ];\r\n      \r\n      const availableSentences = allSentences.filter(\r\n        id => !excludeSentenceIds.includes(id)\r\n      );\r\n      \r\n      // ëœë¤í•˜ê²Œ ì„ íƒ\r\n      const shuffled = availableSentences.sort(() => Math.random() - 0.5);\r\n      return shuffled.slice(0, count);\r\n      \r\n    } catch (error) {\r\n      console.error('ì¼ë°˜ ë¬¸ì¥ ì„ íƒ ì‹¤íŒ¨:', error);\r\n      return [];\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * ì˜¤ë‹µ ê¸°ë¡ ì—…ë°ì´íŠ¸\r\n   */\r\n  async recordIncorrectAnswer(\r\n    userId: string,\r\n    sentenceId: string,\r\n    userAnswer: string,\r\n    correctAnswer: string,\r\n    mistakeType: 'grammar' | 'vocabulary' | 'spelling' | 'structure'\r\n  ): Promise<void> {\r\n    \r\n    try {\r\n      // ê¸°ì¡´ ì˜¤ë‹µ ê¸°ë¡ ì¡°íšŒ\r\n      const existingRecord = await this.getIncorrectRecord(userId, sentenceId);\r\n      \r\n      const newMistake = {\r\n        timestamp: new Date(),\r\n        mistakeType,\r\n        userAnswer,\r\n        correctAnswer\r\n      };\r\n      \r\n      const updatedRecord: IncorrectRecord = {\r\n        ...existingRecord,\r\n        incorrectCount: existingRecord.incorrectCount + 1,\r\n        lastIncorrectDate: new Date(),\r\n        recentMistakes: [\r\n          ...existingRecord.recentMistakes,\r\n          newMistake\r\n        ].slice(-10) // ìµœê·¼ 10ê°œë§Œ ìœ ì§€\r\n      };\r\n      \r\n      // ê°€ì¤‘ì¹˜ ì¬ê³„ì‚°\r\n      const threeDaysAgo = new Date();\r\n      threeDaysAgo.setDate(threeDaysAgo.getDate() - 3);\r\n      updatedRecord.weight = this.calculatePriorityWeight(updatedRecord, threeDaysAgo);\r\n      \r\n      // Firestoreì— ì €ì¥\r\n      await this.saveIncorrectRecord(updatedRecord);\r\n      \r\n    } catch (error) {\r\n      console.error('ì˜¤ë‹µ ê¸°ë¡ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:', error);\r\n      throw error;\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * ì˜¤ë‹µ í†µê³„ ì¡°íšŒ\r\n   */\r\n  async getIncorrectStatistics(userId: string): Promise<{\r\n    totalIncorrectSentences: number;\r\n    recentIncorrectCount: number;\r\n    mostCommonMistakeType: string;\r\n    improvementRate: number;\r\n    weakLevels: number[];\r\n  }> {\r\n    \r\n    try {\r\n      const allIncorrectRecords = await this.getAllIncorrectRecords(userId);\r\n      const recentRecords = await this.getRecentIncorrectSentences(userId, 7); // ìµœê·¼ 7ì¼\r\n      \r\n      // ì‹¤ìˆ˜ ìœ í˜• ë¶„ì„\r\n      const mistakeTypes = allIncorrectRecords.flatMap(record => \r\n        record.recentMistakes.map(mistake => mistake.mistakeType)\r\n      );\r\n      \r\n      const mistakeTypeCounts = mistakeTypes.reduce((acc, type) => {\r\n        acc[type] = (acc[type] || 0) + 1;\r\n        return acc;\r\n      }, {} as Record<string, number>);\r\n      \r\n      const mostCommonMistakeType = Object.entries(mistakeTypeCounts)\r\n        .sort(([,a], [,b]) => b - a)[0]?.[0] || 'none';\r\n      \r\n      // ì·¨ì•½ ë ˆë²¨ ë¶„ì„\r\n      const levelCounts = allIncorrectRecords.reduce((acc, record) => {\r\n        acc[record.level] = (acc[record.level] || 0) + 1;\r\n        return acc;\r\n      }, {} as Record<number, number>);\r\n      \r\n      const weakLevels = Object.entries(levelCounts)\r\n        .filter(([, count]) => count >= 3) // 3ê°œ ì´ìƒ í‹€ë¦° ë ˆë²¨\r\n        .map(([level]) => parseInt(level))\r\n        .sort((a, b) => levelCounts[b] - levelCounts[a]);\r\n      \r\n      // ê°œì„ ìœ¨ ê³„ì‚° (ìµœê·¼ 2ì£¼ ëŒ€ë¹„ ì´ì „ 2ì£¼)\r\n      const improvementRate = await this.calculateImprovementRate(userId);\r\n      \r\n      return {\r\n        totalIncorrectSentences: allIncorrectRecords.length,\r\n        recentIncorrectCount: recentRecords.length,\r\n        mostCommonMistakeType,\r\n        improvementRate,\r\n        weakLevels\r\n      };\r\n      \r\n    } catch (error) {\r\n      console.error('ì˜¤ë‹µ í†µê³„ ì¡°íšŒ ì‹¤íŒ¨:', error);\r\n      return {\r\n        totalIncorrectSentences: 0,\r\n        recentIncorrectCount: 0,\r\n        mostCommonMistakeType: 'none',\r\n        improvementRate: 0,\r\n        weakLevels: []\r\n      };\r\n    }\r\n  }\r\n  \r\n  // Private helper methods\r\n  private async getIncorrectRecord(userId: string, sentenceId: string): Promise<IncorrectRecord> {\r\n    // ê¸°ë³¸ê°’ ë°˜í™˜ (ì‹¤ì œë¡œëŠ” Firestoreì—ì„œ ì¡°íšŒ)\r\n    return {\r\n      sentenceId,\r\n      userId,\r\n      level: 1,\r\n      stage: 1,\r\n      stageId: '',\r\n      incorrectCount: 0,\r\n      lastIncorrectDate: new Date(),\r\n      recentMistakes: [],\r\n      weight: 0\r\n    };\r\n  }\r\n  \r\n  private async saveIncorrectRecord(record: IncorrectRecord): Promise<void> {\r\n    // Firestoreì— ì €ì¥\r\n  }\r\n  \r\n  private async getAllIncorrectRecords(_userId: string): Promise<IncorrectRecord[]> {\r\n    // ëª¨ë“  ì˜¤ë‹µ ê¸°ë¡ ì¡°íšŒ\r\n    return [];\r\n  }\r\n  \r\n  private async calculateImprovementRate(_userId: string): Promise<number> {\r\n    // ê°œì„ ìœ¨ ê³„ì‚° (ì„ì‹œê°’)\r\n    return 0.15; // 15% ê°œì„ \r\n  }\r\n}\r\n\r\nexport const incorrectPriorityService = new IncorrectPriorityService();","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\interviewStorage.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\navigationService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\patternDataLoader.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'_error' is defined but never used.","line":135,"column":16,"nodeType":null,"messageId":"unusedVar","endLine":135,"endColumn":22}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * ğŸ”„ Pattern Data Loader (Firebase Storage)\n * \n * íŒ¨í„´ ë°ì´í„°ë¥¼ Firebase Storageì—ì„œ ë¡œë“œí•˜ëŠ” ì„œë¹„ìŠ¤\n * ê¸°ì¡´ ë¡œì»¬ íŒŒì¼ ì‹œìŠ¤í…œ ëŒ€ì‹  ì›ê²© ì €ì¥ì†Œ ì‚¬ìš©\n */\n\ninterface Sentence {\n  id: string;\n  kr: string;\n  en: string;\n  form?: string;\n}\n\ninterface BankData {\n  stage_id: string;\n  title?: string;\n  count?: number;\n  sentences?: Sentence[];\n  sample_sentences?: Sentence[];\n  examples?: Sentence[];\n}\n\ninterface LoadResult {\n  data: BankData | null;\n  source: 'cache' | 'storage' | 'fallback';\n  loadTime: number;\n}\n\nclass PatternDataLoader {\n  private cache = new Map<string, BankData>();\n  private readonly CACHE_TTL = 10 * 60 * 1000; // 10ë¶„ ìºì‹œ (ë” ê¸¸ê²Œ)\n  private cacheTimestamps = new Map<string, number>();\n  private readonly STORAGE_BASE_URL: string;\n  \n  constructor() {\n    // Vite í™˜ê²½ë³€ìˆ˜ ì‚¬ìš© (REACT_APP -> VITE)\n    this.STORAGE_BASE_URL = import.meta.env.VITE_FIREBASE_STORAGE_URL || \n      'https://storage.googleapis.com/dasi-english-default-rtdb.appspot.com';\n      \n    console.log(`[PatternDataLoader] Storage URL: ${this.STORAGE_BASE_URL}`);\n  }\n\n  /**\n   * ğŸ¯ íŒ¨í„´ ë°ì´í„° ë¡œë“œ (ë©”ì¸ ë©”ì„œë“œ)\n   */\n  async loadBankData(level: number, stageId: string): Promise<LoadResult> {\n    const startTime = Date.now();\n    const cacheKey = `${level}-${stageId}`;\n    \n    // 1. ìºì‹œ í™•ì¸\n    if (this.isCacheValid(cacheKey)) {\n      const data = this.cache.get(cacheKey) || null;\n      return {\n        data,\n        source: 'cache',\n        loadTime: Date.now() - startTime\n      };\n    }\n\n    // 2. Firebase Storageì—ì„œ ë¡œë“œ\n    try {\n      const data = await this.loadFromStorage(level, stageId);\n      if (data) {\n        // ìºì‹œ ì €ì¥\n        this.cache.set(cacheKey, data);\n        this.cacheTimestamps.set(cacheKey, Date.now());\n        \n        return {\n          data,\n          source: 'storage',\n          loadTime: Date.now() - startTime\n        };\n      }\n    } catch (error) {\n      console.error(`[PatternDataLoader] Storage load failed for ${stageId}:`, error);\n    }\n\n    // 3. ë¡œì»¬ fallback (ë§ˆì´ê·¸ë ˆì´ì…˜ ê¸°ê°„ ì¤‘)\n    try {\n      const data = await this.loadFromLocal(level, stageId);\n      return {\n        data,\n        source: 'fallback',\n        loadTime: Date.now() - startTime\n      };\n    } catch (error) {\n      console.error(`[PatternDataLoader] Fallback load failed for ${stageId}:`, error);\n      return {\n        data: null,\n        source: 'fallback',\n        loadTime: Date.now() - startTime\n      };\n    }\n  }\n\n  /**\n   * ğŸ“¦ Firebase Storageì—ì„œ ë°ì´í„° ë¡œë“œ\n   */\n  private async loadFromStorage(level: number, stageId: string): Promise<BankData | null> {\n    const url = `${this.STORAGE_BASE_URL}/patterns/banks/level_${level}/${stageId}_bank.json`;\n    \n    console.log(`[DEBUG] ğŸ” Loading from Storage: ${url}`);\n    \n    const response = await fetch(url);\n    if (!response.ok) {\n      throw new Error(`Storage fetch failed: ${response.status}`);\n    }\n    \n    const data: BankData = await response.json();\n    console.log(`[DEBUG] âœ… Storage load success: ${stageId} (${data.sentences?.length || 0} sentences)`);\n    \n    return data;\n  }\n\n  /**\n   * ğŸ’¾ ë¡œì»¬ íŒŒì¼ì—ì„œ ë°ì´í„° ë¡œë“œ (fallback)\n   */\n  private async loadFromLocal(level: number, stageId: string): Promise<BankData | null> {\n    const paths = [\n      `/patterns/banks/level_${level}/${stageId}_bank.json`,\n      `/patterns/level_${level}_situational/${stageId}_bank.json`,\n      `/patterns/level_${level}_basic_patterns/${stageId}_bank.json`\n    ];\n\n    for (const path of paths) {\n      try {\n        console.log(`[DEBUG] ğŸ” Trying local fallback: ${path}`);\n        const response = await fetch(path);\n        if (response.ok) {\n          const data: BankData = await response.json();\n          console.log(`[DEBUG] âœ… Local fallback success: ${path}`);\n          return data;\n        }\n      } catch (_error) {\n        // Continue to next path\n      }\n    }\n    \n    return null;\n  }\n\n  /**\n   * ğŸ•’ ìºì‹œ ìœ íš¨ì„± í™•ì¸\n   */\n  private isCacheValid(cacheKey: string): boolean {\n    if (!this.cache.has(cacheKey)) {\n      return false;\n    }\n    \n    const timestamp = this.cacheTimestamps.get(cacheKey);\n    if (!timestamp) {\n      return false;\n    }\n    \n    return (Date.now() - timestamp) < this.CACHE_TTL;\n  }\n\n  /**\n   * ğŸ§¹ ìºì‹œ í´ë¦¬ì–´\n   */\n  clearCache(): void {\n    this.cache.clear();\n    this.cacheTimestamps.clear();\n    console.log('[PatternDataLoader] Cache cleared');\n  }\n\n  /**\n   * ğŸ“Š ìºì‹œ í†µê³„\n   */\n  getCacheStats() {\n    return {\n      size: this.cache.size,\n      ttl: this.CACHE_TTL,\n      entries: Array.from(this.cache.keys())\n    };\n  }\n}\n\n// ì‹±ê¸€í†¤ ì¸ìŠ¤í„´ìŠ¤\nconst patternDataLoader = new PatternDataLoader();\n\nexport { patternDataLoader, PatternDataLoader };\nexport type { BankData, Sentence, LoadResult };","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\personalizedPacks.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\progressManagement.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'currentDate' is defined but never used. Allowed unused args must match /^_/u.","line":179,"column":64,"nodeType":null,"messageId":"unusedVar","endLine":179,"endColumn":75},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'progress' is defined but never used. Allowed unused args must match /^_/u.","line":383,"column":41,"nodeType":null,"messageId":"unusedVar","endLine":383,"endColumn":49},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'incorrectAnswer' is defined but never used. Allowed unused args must match /^_/u.","line":387,"column":48,"nodeType":null,"messageId":"unusedVar","endLine":387,"endColumn":63}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// ì§„ë„ ê´€ë¦¬ ì‹œìŠ¤í…œ - ìŠ¤í…Œì´ì§€ë³„ ì™„ë£Œìœ¨ê³¼ ì˜¤ë‹µ ê¸°ë¡ ê´€ë¦¬\r\n\r\ninterface UserProgress {\r\n  userId: string;\r\n  level: number;\r\n  stage: number;\r\n  stageId: string;\r\n  completionRate: number; // 0-1\r\n  totalSentences: number;\r\n  correctAnswers: number;\r\n  incorrectAnswers: number;\r\n  lastStudied: Date;\r\n  timeSpent: number; // ì´ í•™ìŠµ ì‹œê°„ (ë¶„)\r\n  averageAccuracy: number;\r\n  studySessions: number;\r\n  status: 'not_started' | 'in_progress' | 'completed' | 'mastered';\r\n}\r\n\r\ninterface IncorrectAnswer {\r\n  userId: string;\r\n  sentenceId: string;\r\n  level: number;\r\n  stage: number;\r\n  stageId: string;\r\n  incorrectCount: number;\r\n  lastIncorrectDate: Date;\r\n  mistakes: Array<{\r\n    userAnswer: string;\r\n    correctAnswer: string;\r\n    timestamp: Date;\r\n    mistakeType: 'grammar' | 'vocabulary' | 'spelling' | 'structure';\r\n  }>;\r\n  weight: number; // ì˜¤ë‹µ ê°€ì¤‘ì¹˜ (ìµœê·¼ 3ì¼ ê¸°ì¤€)\r\n}\r\n\r\ninterface LevelProgress {\r\n  level: number;\r\n  totalStages: number;\r\n  completedStages: number;\r\n  averageCompletionRate: number;\r\n  totalTimeSpent: number;\r\n  overallAccuracy: number;\r\n  weakStages: string[]; // ì™„ë£Œìœ¨ì´ ë‚®ì€ ìŠ¤í…Œì´ì§€ë“¤\r\n  strongStages: string[]; // ì™„ë£Œìœ¨ì´ ë†’ì€ ìŠ¤í…Œì´ì§€ë“¤\r\n}\r\n\r\nclass ProgressManagementService {\r\n  \r\n  /**\r\n   * ì‚¬ìš©ìì˜ ìŠ¤í…Œì´ì§€ ì§„ë„ ì—…ë°ì´íŠ¸\r\n   */\r\n  async updateStageProgress(\r\n    userId: string, \r\n    stageId: string, \r\n    sessionResult: {\r\n      correct: number;\r\n      total: number;\r\n      timeSpent: number;\r\n      incorrectSentences: string[];\r\n    }\r\n  ): Promise<UserProgress> {\r\n    \r\n    try {\r\n      // ê¸°ì¡´ ì§„ë„ ì¡°íšŒ\r\n      const existingProgress = await this.getStageProgress(userId, stageId);\r\n      \r\n      // ìƒˆë¡œìš´ ì™„ë£Œìœ¨ ê³„ì‚° (ëˆ„ì )\r\n      const newCorrect = existingProgress.correctAnswers + sessionResult.correct;\r\n      const newTotal = existingProgress.totalSentences + sessionResult.total;\r\n      const newCompletionRate = newTotal > 0 ? newCorrect / newTotal : 0;\r\n      \r\n      // í‰ê·  ì •í™•ë„ ê³„ì‚° (ì´ë™ í‰ê· )\r\n      const sessionAccuracy = sessionResult.total > 0 ? sessionResult.correct / sessionResult.total : 0;\r\n      const newAverageAccuracy = existingProgress.studySessions > 0 \r\n        ? (existingProgress.averageAccuracy * existingProgress.studySessions + sessionAccuracy) / (existingProgress.studySessions + 1)\r\n        : sessionAccuracy;\r\n      \r\n      // ìƒíƒœ ê²°ì •\r\n      const status = this.determineStageStatus(newCompletionRate, newAverageAccuracy, existingProgress.studySessions + 1);\r\n      \r\n      const updatedProgress: UserProgress = {\r\n        ...existingProgress,\r\n        completionRate: newCompletionRate,\r\n        totalSentences: newTotal,\r\n        correctAnswers: newCorrect,\r\n        incorrectAnswers: existingProgress.incorrectAnswers + (sessionResult.total - sessionResult.correct),\r\n        lastStudied: new Date(),\r\n        timeSpent: existingProgress.timeSpent + sessionResult.timeSpent,\r\n        averageAccuracy: newAverageAccuracy,\r\n        studySessions: existingProgress.studySessions + 1,\r\n        status\r\n      };\r\n      \r\n      // ì˜¤ë‹µ ê¸°ë¡ ì—…ë°ì´íŠ¸\r\n      if (sessionResult.incorrectSentences.length > 0) {\r\n        await this.updateIncorrectAnswers(userId, stageId, sessionResult.incorrectSentences);\r\n      }\r\n      \r\n      // Firestoreì— ì €ì¥ (ì‹¤ì œ êµ¬í˜„ì—ì„œ)\r\n      await this.saveProgressToFirestore(updatedProgress);\r\n      \r\n      return updatedProgress;\r\n      \r\n    } catch (error) {\r\n      console.error('ìŠ¤í…Œì´ì§€ ì§„ë„ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:', error);\r\n      throw error;\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * ìŠ¤í…Œì´ì§€ ìƒíƒœ ê²°ì •\r\n   */\r\n  private determineStageStatus(\r\n    completionRate: number, \r\n    averageAccuracy: number, \r\n    sessions: number\r\n  ): 'not_started' | 'in_progress' | 'completed' | 'mastered' {\r\n    \r\n    if (sessions === 0) return 'not_started';\r\n    \r\n    if (averageAccuracy >= 0.9 && completionRate >= 0.8 && sessions >= 3) {\r\n      return 'mastered';\r\n    } else if (averageAccuracy >= 0.7 && completionRate >= 0.6) {\r\n      return 'completed';\r\n    } else {\r\n      return 'in_progress';\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * ì˜¤ë‹µ ê¸°ë¡ ì—…ë°ì´íŠ¸\r\n   */\r\n  async updateIncorrectAnswers(\r\n    userId: string, \r\n    stageId: string, \r\n    incorrectSentenceIds: string[]\r\n  ): Promise<void> {\r\n    \r\n    try {\r\n      const now = new Date();\r\n      const threeDaysAgo = new Date(now.getTime() - 3 * 24 * 60 * 60 * 1000);\r\n      \r\n      for (const sentenceId of incorrectSentenceIds) {\r\n        // ê¸°ì¡´ ì˜¤ë‹µ ê¸°ë¡ ì¡°íšŒ\r\n        const existingRecord = await this.getIncorrectAnswer(userId, sentenceId);\r\n        \r\n        // ìµœê·¼ 3ì¼ ê°€ì¤‘ì¹˜ ê³„ì‚°\r\n        const recentMistakes = existingRecord.mistakes.filter(m => m.timestamp >= threeDaysAgo);\r\n        const weight = this.calculateIncorrectWeight(recentMistakes.length, now);\r\n        \r\n        const updatedRecord: IncorrectAnswer = {\r\n          ...existingRecord,\r\n          incorrectCount: existingRecord.incorrectCount + 1,\r\n          lastIncorrectDate: now,\r\n          mistakes: [\r\n            ...existingRecord.mistakes,\r\n            {\r\n              userAnswer: '', // ì‹¤ì œë¡œëŠ” ì„¸ì…˜ì—ì„œ ë°›ì•„ì˜¨ ì‚¬ìš©ì ë‹µë³€\r\n              correctAnswer: '', // ì‹¤ì œë¡œëŠ” ì •ë‹µ\r\n              timestamp: now,\r\n              mistakeType: 'grammar' // ì‹¤ì œë¡œëŠ” ë¶„ì„ëœ ì‹¤ìˆ˜ ìœ í˜•\r\n            }\r\n          ].slice(-10), // ìµœê·¼ 10ê°œë§Œ ìœ ì§€\r\n          weight\r\n        };\r\n        \r\n        await this.saveIncorrectAnswerToFirestore(updatedRecord);\r\n      }\r\n      \r\n    } catch (error) {\r\n      console.error('ì˜¤ë‹µ ê¸°ë¡ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:', error);\r\n      throw error;\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * ì˜¤ë‹µ ê°€ì¤‘ì¹˜ ê³„ì‚° (ìµœê·¼ 3ì¼ ê¸°ì¤€)\r\n   */\r\n  private calculateIncorrectWeight(recentMistakeCount: number, currentDate: Date): number {\r\n    // ê¸°ë³¸ ê°€ì¤‘ì¹˜: 1.0\r\n    // ìµœê·¼ 3ì¼ ë‚´ ì‹¤ìˆ˜ê°€ ë§ì„ìˆ˜ë¡ ê°€ì¤‘ì¹˜ ì¦ê°€\r\n    const baseWeight = 1.0;\r\n    const additionalWeight = recentMistakeCount * 0.5;\r\n    \r\n    // ì‹œê°„ì— ë”°ë¥¸ ê°ì†Œ (í•˜ë£¨ë‹¹ 10% ê°ì†Œ)\r\n    const daysSinceLastMistake = 0; // í˜„ì¬ëŠ” 0 (ë°©ê¸ˆ ì‹¤ìˆ˜)\r\n    const timeDecay = Math.pow(0.9, daysSinceLastMistake);\r\n    \r\n    return Math.min(5.0, (baseWeight + additionalWeight) * timeDecay);\r\n  }\r\n  \r\n  /**\r\n   * ë ˆë²¨ë³„ ì „ì²´ ì§„ë„ ì¡°íšŒ\r\n   */\r\n  async getLevelProgress(userId: string, level: number): Promise<LevelProgress> {\r\n    try {\r\n      // í•´ë‹¹ ë ˆë²¨ì˜ ëª¨ë“  ìŠ¤í…Œì´ì§€ ì§„ë„ ì¡°íšŒ\r\n      const stageProgresses = await this.getAllStageProgresses(userId, level);\r\n      \r\n      const totalStages = stageProgresses.length;\r\n      const completedStages = stageProgresses.filter(p => p.status === 'completed' || p.status === 'mastered').length;\r\n      \r\n      const averageCompletionRate = totalStages > 0 \r\n        ? stageProgresses.reduce((sum, p) => sum + p.completionRate, 0) / totalStages \r\n        : 0;\r\n      \r\n      const totalTimeSpent = stageProgresses.reduce((sum, p) => sum + p.timeSpent, 0);\r\n      \r\n      const overallAccuracy = totalStages > 0 \r\n        ? stageProgresses.reduce((sum, p) => sum + p.averageAccuracy, 0) / totalStages \r\n        : 0;\r\n      \r\n      // ì·¨ì•½/ê°•ì  ìŠ¤í…Œì´ì§€ ì‹ë³„\r\n      const weakStages = stageProgresses\r\n        .filter(p => p.averageAccuracy < 0.7 || p.completionRate < 0.6)\r\n        .map(p => p.stageId)\r\n        .slice(0, 5);\r\n      \r\n      const strongStages = stageProgresses\r\n        .filter(p => p.averageAccuracy >= 0.9 && p.completionRate >= 0.8)\r\n        .map(p => p.stageId)\r\n        .slice(0, 5);\r\n      \r\n      return {\r\n        level,\r\n        totalStages,\r\n        completedStages,\r\n        averageCompletionRate,\r\n        totalTimeSpent,\r\n        overallAccuracy,\r\n        weakStages,\r\n        strongStages\r\n      };\r\n      \r\n    } catch (error) {\r\n      console.error('ë ˆë²¨ ì§„ë„ ì¡°íšŒ ì‹¤íŒ¨:', error);\r\n      throw error;\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * ì˜¤ë‹µ ìš°ì„  ë¬¸ì¥ ì¡°íšŒ (ìµœê·¼ 3ì¼ ê°€ì¤‘ì¹˜ ê¸°ì¤€)\r\n   */\r\n  async getIncorrectPrioritySentences(userId: string, maxCount: number = 20): Promise<string[]> {\r\n    try {\r\n      const now = new Date();\r\n      const threeDaysAgo = new Date(now.getTime() - 3 * 24 * 60 * 60 * 1000);\r\n      \r\n      // ìµœê·¼ 3ì¼ ë‚´ ì˜¤ë‹µ ê¸°ë¡ ì¡°íšŒ\r\n      const incorrectAnswers = await this.getRecentIncorrectAnswers(userId, threeDaysAgo);\r\n      \r\n      // ê°€ì¤‘ì¹˜ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬\r\n      const sortedIncorrectAnswers = incorrectAnswers\r\n        .filter(ia => ia.weight > 1.0) // ê°€ì¤‘ì¹˜ê°€ ìˆëŠ” ê²ƒë§Œ\r\n        .sort((a, b) => b.weight - a.weight) // ê°€ì¤‘ì¹˜ ë†’ì€ ìˆœ\r\n        .slice(0, maxCount);\r\n      \r\n      return sortedIncorrectAnswers.map(ia => ia.sentenceId);\r\n      \r\n    } catch (error) {\r\n      console.error('ì˜¤ë‹µ ìš°ì„  ë¬¸ì¥ ì¡°íšŒ ì‹¤íŒ¨:', error);\r\n      return [];\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * ì „ì²´ í•™ìŠµ ì§„ë„ ìš”ì•½\r\n   */\r\n  async getOverallProgress(userId: string): Promise<{\r\n    totalLevels: number;\r\n    completedLevels: number;\r\n    currentLevel: number;\r\n    totalTimeSpent: number;\r\n    overallAccuracy: number;\r\n    totalSentencesStudied: number;\r\n    achievementBadges: string[];\r\n  }> {\r\n    \r\n    try {\r\n      const levels = [1, 2, 3, 4, 5, 6]; // ì‚¬ìš© ê°€ëŠ¥í•œ ë ˆë²¨ë“¤\r\n      const levelProgresses = await Promise.all(\r\n        levels.map(level => this.getLevelProgress(userId, level))\r\n      );\r\n      \r\n      const completedLevels = levelProgresses.filter(lp => \r\n        lp.completedStages / lp.totalStages >= 0.8 && lp.overallAccuracy >= 0.7\r\n      ).length;\r\n      \r\n      const currentLevel = this.getCurrentLevel(levelProgresses);\r\n      \r\n      const totalTimeSpent = levelProgresses.reduce((sum, lp) => sum + lp.totalTimeSpent, 0);\r\n      const overallAccuracy = levelProgresses.reduce((sum, lp) => sum + lp.overallAccuracy, 0) / levels.length;\r\n      \r\n      const totalSentencesStudied = await this.getTotalSentencesStudied(userId);\r\n      \r\n      const achievementBadges = this.calculateAchievementBadges(levelProgresses, totalTimeSpent, totalSentencesStudied);\r\n      \r\n      return {\r\n        totalLevels: levels.length,\r\n        completedLevels,\r\n        currentLevel,\r\n        totalTimeSpent,\r\n        overallAccuracy,\r\n        totalSentencesStudied,\r\n        achievementBadges\r\n      };\r\n      \r\n    } catch (error) {\r\n      console.error('ì „ì²´ ì§„ë„ ìš”ì•½ ì¡°íšŒ ì‹¤íŒ¨:', error);\r\n      throw error;\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * ì„±ì·¨ ë°°ì§€ ê³„ì‚°\r\n   */\r\n  private calculateAchievementBadges(\r\n    levelProgresses: LevelProgress[], \r\n    totalTimeSpent: number, \r\n    totalSentences: number\r\n  ): string[] {\r\n    \r\n    const badges: string[] = [];\r\n    \r\n    // ì‹œê°„ ê¸°ë°˜ ë°°ì§€\r\n    if (totalTimeSpent >= 1000) badges.push('ğŸ• ì²œ ì‹œê°„ í•™ìŠµì');\r\n    else if (totalTimeSpent >= 500) badges.push('â° ì˜¤ë°± ì‹œê°„ ë‹¬ì„±');\r\n    else if (totalTimeSpent >= 100) badges.push('â±ï¸ ë°± ì‹œê°„ í•™ìŠµ');\r\n    \r\n    // ë¬¸ì¥ ìˆ˜ ê¸°ë°˜ ë°°ì§€\r\n    if (totalSentences >= 5000) badges.push('ğŸ“š ë¬¸ì¥ ë§ˆìŠ¤í„°');\r\n    else if (totalSentences >= 2000) badges.push('ğŸ“– ë¬¸ì¥ ë°•ì‚¬');\r\n    else if (totalSentences >= 1000) badges.push('ğŸ“ ì²œ ë¬¸ì¥ ë‹¬ì„±');\r\n    \r\n    // ì •í™•ë„ ê¸°ë°˜ ë°°ì§€\r\n    const highAccuracyLevels = levelProgresses.filter(lp => lp.overallAccuracy >= 0.9).length;\r\n    if (highAccuracyLevels >= 3) badges.push('ğŸ¯ ì •í™•ë„ ë§ˆìŠ¤í„°');\r\n    else if (highAccuracyLevels >= 1) badges.push('âœ¨ ì •í™•ë„ ë‹¬ì¸');\r\n    \r\n    // ì™„ë£Œë„ ê¸°ë°˜ ë°°ì§€\r\n    const completedLevels = levelProgresses.filter(lp => lp.averageCompletionRate >= 0.8).length;\r\n    if (completedLevels >= 4) badges.push('ğŸ† ë ˆë²¨ ì •ë³µì');\r\n    else if (completedLevels >= 2) badges.push('ğŸ¥‡ ì„±ì‹¤í•œ í•™ìŠµì');\r\n    \r\n    return badges;\r\n  }\r\n  \r\n  // Private helper methods\r\n  private async getStageProgress(userId: string, stageId: string): Promise<UserProgress> {\r\n    // Firestoreì—ì„œ ìŠ¤í…Œì´ì§€ ì§„ë„ ì¡°íšŒ (ê¸°ë³¸ê°’ ë°˜í™˜)\r\n    return {\r\n      userId,\r\n      level: 1,\r\n      stage: 1,\r\n      stageId,\r\n      completionRate: 0,\r\n      totalSentences: 0,\r\n      correctAnswers: 0,\r\n      incorrectAnswers: 0,\r\n      lastStudied: new Date(),\r\n      timeSpent: 0,\r\n      averageAccuracy: 0,\r\n      studySessions: 0,\r\n      status: 'not_started'\r\n    };\r\n  }\r\n  \r\n  private async getIncorrectAnswer(userId: string, sentenceId: string): Promise<IncorrectAnswer> {\r\n    // ê¸°ë³¸ê°’ ë°˜í™˜\r\n    return {\r\n      userId,\r\n      sentenceId,\r\n      level: 1,\r\n      stage: 1,\r\n      stageId: '',\r\n      incorrectCount: 0,\r\n      lastIncorrectDate: new Date(),\r\n      mistakes: [],\r\n      weight: 1.0\r\n    };\r\n  }\r\n  \r\n  private async saveProgressToFirestore(progress: UserProgress): Promise<void> {\r\n    // Firestore ì €ì¥ ë¡œì§\r\n  }\r\n  \r\n  private async saveIncorrectAnswerToFirestore(incorrectAnswer: IncorrectAnswer): Promise<void> {\r\n    // Firestore ì €ì¥ ë¡œì§\r\n  }\r\n  \r\n  private async getAllStageProgresses(_userId: string, _level: number): Promise<UserProgress[]> {\r\n    // í•´ë‹¹ ë ˆë²¨ì˜ ëª¨ë“  ìŠ¤í…Œì´ì§€ ì§„ë„ ì¡°íšŒ\r\n    return [];\r\n  }\r\n  \r\n  private async getRecentIncorrectAnswers(_userId: string, _since: Date): Promise<IncorrectAnswer[]> {\r\n    // ìµœê·¼ ì˜¤ë‹µ ê¸°ë¡ ì¡°íšŒ\r\n    return [];\r\n  }\r\n  \r\n  private getCurrentLevel(levelProgresses: LevelProgress[]): number {\r\n    // í˜„ì¬ ì§„í–‰ ì¤‘ì¸ ë ˆë²¨ ê³„ì‚°\r\n    for (let i = 0; i < levelProgresses.length; i++) {\r\n      const lp = levelProgresses[i];\r\n      if (lp.averageCompletionRate < 0.8 || lp.overallAccuracy < 0.7) {\r\n        return lp.level;\r\n      }\r\n    }\r\n    return levelProgresses.length; // ëª¨ë“  ë ˆë²¨ ì™„ë£Œ\r\n  }\r\n  \r\n  private async getTotalSentencesStudied(_userId: string): Promise<number> {\r\n    // ì´ í•™ìŠµí•œ ë¬¸ì¥ ìˆ˜ ê³„ì‚°\r\n    return 0;\r\n  }\r\n}\r\n\r\nexport const progressManagementService = new ProgressManagementService();","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\reviewAlgorithm.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'activity' is defined but never used. Allowed unused args must match /^_/u.","line":295,"column":64,"nodeType":null,"messageId":"unusedVar","endLine":295,"endColumn":72}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * @deprecated ì´ ì„œë¹„ìŠ¤ëŠ” deprecatedì…ë‹ˆë‹¤.\r\n * ìƒˆ í”„ë¡œì íŠ¸ì—ì„œëŠ” services/srs/SRSEngine.tsë¥¼ ì‚¬ìš©í•˜ì„¸ìš”.\r\n * \r\n * ë§ˆì´ê·¸ë ˆì´ì…˜ ê°€ì´ë“œ:\r\n * - ReviewAlgorithmService â†’ SRSEngine\r\n * - calculateNextReview() â†’ SRSEngine.updateCard() \r\n * - getTodayReviewSentences() â†’ SRSEngine.getCardsForReview()\r\n * \r\n * 2025-01-12: SSOT ì‹œìŠ¤í…œìœ¼ë¡œ í†µí•© ì¤‘\r\n */\r\n\r\n// ê³ ê¸‰ ë³µìŠµ ì•Œê³ ë¦¬ì¦˜ ì„œë¹„ìŠ¤  \r\n// ê°„ê²© ë°˜ë³µ í•™ìŠµ (Spaced Repetition) + ë§ê° ê³¡ì„  ê¸°ë°˜\r\n\r\ninterface ReviewSession {\r\n  sentenceId: string;\r\n  userId: string;\r\n  accuracy: number; // 0-1 ì ìˆ˜\r\n  responseTime: number; // ì‘ë‹µ ì‹œê°„ (ms)\r\n  difficulty: 'easy' | 'medium' | 'hard';\r\n  timestamp: Date;\r\n  reviewCount: number;\r\n  intervalDays: number;\r\n}\r\n\r\ninterface ReviewMetrics {\r\n  totalReviews: number;\r\n  averageAccuracy: number;\r\n  averageResponseTime: number;\r\n  retentionRate: number;\r\n  masteryLevel: 'beginner' | 'intermediate' | 'advanced' | 'mastered';\r\n}\r\n\r\ninterface MemoryStrength {\r\n  sentenceId: string;\r\n  strength: number; // 0-1, 1ì´ ì™„ì „íˆ ê¸°ì–µ\r\n  lastReviewDate: Date;\r\n  nextReviewDate: Date;\r\n  easeFactor: number; // SuperMemo ì•Œê³ ë¦¬ì¦˜ì˜ ease factor\r\n  intervalDays: number;\r\n  reviewCount: number;\r\n}\r\n\r\nclass ReviewAlgorithmService {\r\n  \r\n  /**\r\n   * SuperMemo SM-2 ì•Œê³ ë¦¬ì¦˜ ê¸°ë°˜ ê°„ê²© ë°˜ë³µ ê³„ì‚°\r\n   */\r\n  calculateNextReview(session: ReviewSession, currentStrength: MemoryStrength): MemoryStrength {\r\n    const { accuracy, difficulty, responseTime } = session;\r\n    \r\n    // ì •í™•ë„ì™€ ë‚œì´ë„ì— ë”°ë¥¸ í’ˆì§ˆ ì ìˆ˜ ê³„ì‚° (0-5)\r\n    const quality = this.calculateQuality(accuracy, difficulty, responseTime);\r\n    \r\n    let newEaseFactor = currentStrength.easeFactor;\r\n    let newInterval = currentStrength.intervalDays;\r\n    \r\n    if (quality >= 3) {\r\n      // ì„±ê³µì ì¸ ë³µìŠµ\r\n      if (currentStrength.reviewCount === 0) {\r\n        newInterval = 1;\r\n      } else if (currentStrength.reviewCount === 1) {\r\n        newInterval = 6;\r\n      } else {\r\n        newInterval = Math.round(currentStrength.intervalDays * currentStrength.easeFactor);\r\n      }\r\n      \r\n      // ease factor ì¡°ì •\r\n      newEaseFactor = Math.max(1.3, \r\n        currentStrength.easeFactor + (0.1 - (5 - quality) * (0.08 + (5 - quality) * 0.02))\r\n      );\r\n    } else {\r\n      // ì‹¤íŒ¨í•œ ë³µìŠµ - ê°„ê²© ë¦¬ì…‹\r\n      newInterval = 1;\r\n      newEaseFactor = Math.max(1.3, currentStrength.easeFactor - 0.2);\r\n    }\r\n    \r\n    const nextReviewDate = new Date();\r\n    nextReviewDate.setDate(nextReviewDate.getDate() + newInterval);\r\n    \r\n    return {\r\n      ...currentStrength,\r\n      strength: this.updateMemoryStrength(currentStrength.strength, quality),\r\n      lastReviewDate: new Date(),\r\n      nextReviewDate,\r\n      easeFactor: newEaseFactor,\r\n      intervalDays: newInterval,\r\n      reviewCount: currentStrength.reviewCount + 1\r\n    };\r\n  }\r\n  \r\n  /**\r\n   * ì •í™•ë„, ë‚œì´ë„, ì‘ë‹µì‹œê°„ ê¸°ë°˜ í’ˆì§ˆ ì ìˆ˜ ê³„ì‚°\r\n   */\r\n  private calculateQuality(accuracy: number, difficulty: string, responseTime: number): number {\r\n    // ê¸°ë³¸ ì •í™•ë„ ì ìˆ˜ (0-5)\r\n    let qualityScore = accuracy * 5;\r\n    \r\n    // ì‘ë‹µ ì‹œê°„ ê°€ì¤‘ì¹˜ (ë¹ ë¥¸ ì‘ë‹µì€ ë” ë†’ì€ ì ìˆ˜)\r\n    const timeWeight = this.getTimeWeight(responseTime);\r\n    qualityScore *= timeWeight;\r\n    \r\n    // ë‚œì´ë„ ê°€ì¤‘ì¹˜\r\n    const difficultyWeight = {\r\n      'easy': 0.8,    // ì‰¬ìš´ ë¬¸ì œëŠ” ì ìˆ˜ ê°ì†Œ\r\n      'medium': 1.0,  // ë³´í†µ ë¬¸ì œëŠ” ê·¸ëŒ€ë¡œ\r\n      'hard': 1.2     // ì–´ë ¤ìš´ ë¬¸ì œëŠ” ì ìˆ˜ ì¦ê°€\r\n    };\r\n    qualityScore *= difficultyWeight[difficulty];\r\n    \r\n    // 0-5 ë²”ìœ„ë¡œ ì œí•œ\r\n    return Math.max(0, Math.min(5, Math.round(qualityScore)));\r\n  }\r\n  \r\n  /**\r\n   * ì‘ë‹µ ì‹œê°„ ê¸°ë°˜ ê°€ì¤‘ì¹˜ ê³„ì‚°\r\n   */\r\n  private getTimeWeight(responseTime: number): number {\r\n    // ì´ìƒì ì¸ ì‘ë‹µ ì‹œê°„: 3-7ì´ˆ\r\n    const idealMin = 3000;\r\n    const idealMax = 7000;\r\n    \r\n    if (responseTime < idealMin) {\r\n      // ë„ˆë¬´ ë¹ ë¦„ - ì¶”ì¸¡ì¼ ê°€ëŠ¥ì„±\r\n      return 0.8;\r\n    } else if (responseTime <= idealMax) {\r\n      // ì´ìƒì  ë²”ìœ„\r\n      return 1.0;\r\n    } else if (responseTime <= 15000) {\r\n      // ì¡°ê¸ˆ ëŠë¦¼ - ì ì§„ì  ê°ì†Œ\r\n      return 1.0 - (responseTime - idealMax) / 20000;\r\n    } else {\r\n      // ë§¤ìš° ëŠë¦¼\r\n      return 0.6;\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * ê¸°ì–µ ê°•ë„ ì—…ë°ì´íŠ¸ (ë§ê° ê³¡ì„  ì ìš©)\r\n   */\r\n  private updateMemoryStrength(currentStrength: number, quality: number): number {\r\n    // ì„±ê³µì ì¸ ë³µìŠµ (quality >= 3)\r\n    if (quality >= 3) {\r\n      // ê¸°ì–µ ê°•ë„ ì¦ê°€, ìµœëŒ€ 1.0\r\n      const increase = (quality / 5) * 0.3;\r\n      return Math.min(1.0, currentStrength + increase);\r\n    } else {\r\n      // ì‹¤íŒ¨í•œ ë³µìŠµ - ê¸°ì–µ ê°•ë„ ê°ì†Œ\r\n      const decrease = (3 - quality) / 5 * 0.4;\r\n      return Math.max(0.1, currentStrength - decrease);\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * ì˜¤ëŠ˜ ë³µìŠµí•  ë¬¸ì¥ë“¤ ì„ ì •\r\n   */\r\n  async getTodayReviewSentences(userId: string, maxCount: number = 50): Promise<string[]> {\r\n    const today = new Date();\r\n    \r\n    // 1. ë³µìŠµ ì¼ì •ì´ ëœ ë¬¸ì¥ë“¤\r\n    const scheduledReviews = await this.getScheduledReviews(userId, today);\r\n    \r\n    // 2. ì·¨ì•½í•œ ë¬¸ì¥ë“¤ (ê°•ë„ê°€ ë‚®ì€ ìˆœ)\r\n    const weakSentences = await this.getWeakSentences(userId, maxCount - scheduledReviews.length);\r\n    \r\n    // 3. ìƒˆë¡œìš´ ë¬¸ì¥ë“¤ (ì•„ì§ í•œ ë²ˆë„ ë³µìŠµí•˜ì§€ ì•Šì€ ê²ƒ)\r\n    const newSentences = await this.getNewSentences(userId, maxCount - scheduledReviews.length - weakSentences.length);\r\n    \r\n    // ìš°ì„ ìˆœìœ„: ì˜ˆì •ëœ ë³µìŠµ > ì·¨ì•½í•œ ë¬¸ì¥ > ìƒˆë¡œìš´ ë¬¸ì¥\r\n    return [...scheduledReviews, ...weakSentences, ...newSentences].slice(0, maxCount);\r\n  }\r\n  \r\n  /**\r\n   * ê°œì¸ë³„ ë³µìŠµ íŒ¨í„´ ë¶„ì„\r\n   */\r\n  async analyzeReviewPattern(userId: string): Promise<ReviewMetrics> {\r\n    const recentSessions = await this.getRecentSessions(userId, 30); // ìµœê·¼ 30ì¼\r\n    \r\n    if (recentSessions.length === 0) {\r\n      return {\r\n        totalReviews: 0,\r\n        averageAccuracy: 0,\r\n        averageResponseTime: 0,\r\n        retentionRate: 0,\r\n        masteryLevel: 'beginner'\r\n      };\r\n    }\r\n    \r\n    const totalReviews = recentSessions.length;\r\n    const averageAccuracy = recentSessions.reduce((sum, s) => sum + s.accuracy, 0) / totalReviews;\r\n    const averageResponseTime = recentSessions.reduce((sum, s) => sum + s.responseTime, 0) / totalReviews;\r\n    \r\n    // ìœ ì§€ìœ¨ ê³„ì‚° (7ì¼ í›„ ì¬ë³µìŠµ ì‹œ ì„±ê³µë¥ )\r\n    const retentionRate = await this.calculateRetentionRate(userId);\r\n    \r\n    // ìˆ™ë ¨ë„ ë ˆë²¨ ê²°ì •\r\n    const masteryLevel = this.determineMasteryLevel(averageAccuracy, retentionRate, totalReviews);\r\n    \r\n    return {\r\n      totalReviews,\r\n      averageAccuracy,\r\n      averageResponseTime,\r\n      retentionRate,\r\n      masteryLevel\r\n    };\r\n  }\r\n  \r\n  /**\r\n   * ì ì‘í˜• ë‚œì´ë„ ì¡°ì •\r\n   */\r\n  async adaptiveDifficultyAdjustment(userId: string): Promise<'easier' | 'maintain' | 'harder'> {\r\n    const metrics = await this.analyzeReviewPattern(userId);\r\n    \r\n    if (metrics.averageAccuracy > 0.9 && metrics.retentionRate > 0.8) {\r\n      return 'harder'; // ë” ì–´ë ¤ìš´ ë¬¸ì¥ ì œê³µ\r\n    } else if (metrics.averageAccuracy < 0.6 || metrics.retentionRate < 0.5) {\r\n      return 'easier'; // ë” ì‰¬ìš´ ë¬¸ì¥ ì œê³µ\r\n    } else {\r\n      return 'maintain'; // í˜„ì¬ ìˆ˜ì¤€ ìœ ì§€\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * ê°œì¸ ë§ì¶¤ ë³µìŠµ ìŠ¤ì¼€ì¤„ ìƒì„±\r\n   */\r\n  async generatePersonalizedSchedule(userId: string): Promise<{\r\n    daily: number;\r\n    weekly: number;\r\n    monthlyGoal: number;\r\n    optimalTimes: string[];\r\n  }> {\r\n    const pattern = await this.analyzeReviewPattern(userId);\r\n    const userActivity = await this.getUserActivityPattern(userId);\r\n    \r\n    // ê°œì¸ë³„ ìµœì  ë³µìŠµ íšŸìˆ˜ ê³„ì‚°\r\n    const dailyTarget = this.calculateOptimalDailyReviews(pattern, userActivity);\r\n    \r\n    return {\r\n      daily: dailyTarget,\r\n      weekly: dailyTarget * 7,\r\n      monthlyGoal: dailyTarget * 30,\r\n      optimalTimes: userActivity.peakHours || ['09:00', '19:00'] // ê¸°ë³¸ê°’\r\n    };\r\n  }\r\n  \r\n  // Private helper methods\r\n  private async getScheduledReviews(_userId: string, _date: Date): Promise<string[]> {\r\n    // Firestoreì—ì„œ ì˜¤ëŠ˜ ë³µìŠµ ì˜ˆì •ì¸ ë¬¸ì¥ë“¤ ì¡°íšŒ\r\n    // ì‹¤ì œ êµ¬í˜„ì—ì„œëŠ” Firestore ì¿¼ë¦¬ ì‚¬ìš©\r\n    return [];\r\n  }\r\n  \r\n  private async getWeakSentences(_userId: string, _count: number): Promise<string[]> {\r\n    // ê¸°ì–µ ê°•ë„ê°€ ë‚®ì€ ë¬¸ì¥ë“¤ ì¡°íšŒ\r\n    return [];\r\n  }\r\n  \r\n  private async getNewSentences(_userId: string, _count: number): Promise<string[]> {\r\n    // ì•„ì§ ë³µìŠµí•˜ì§€ ì•Šì€ ìƒˆë¡œìš´ ë¬¸ì¥ë“¤ ì¡°íšŒ\r\n    return [];\r\n  }\r\n  \r\n  private async getRecentSessions(_userId: string, _days: number): Promise<ReviewSession[]> {\r\n    // ìµœê·¼ ë³µìŠµ ì„¸ì…˜ë“¤ ì¡°íšŒ\r\n    return [];\r\n  }\r\n  \r\n  private async calculateRetentionRate(_userId: string): Promise<number> {\r\n    // 7ì¼ í›„ ë³µìŠµ ì„±ê³µë¥  ê³„ì‚°\r\n    return 0.7; // ì„ì‹œê°’\r\n  }\r\n  \r\n  private determineMasteryLevel(accuracy: number, retention: number, totalReviews: number): 'beginner' | 'intermediate' | 'advanced' | 'mastered' {\r\n    if (totalReviews < 50) return 'beginner';\r\n    if (accuracy > 0.9 && retention > 0.85) return 'mastered';\r\n    if (accuracy > 0.75 && retention > 0.7) return 'advanced';\r\n    if (accuracy > 0.6 && retention > 0.6) return 'intermediate';\r\n    return 'beginner';\r\n  }\r\n  \r\n  private async getUserActivityPattern(_userId: string): Promise<{\r\n    peakHours: string[];\r\n    preferredDuration: number;\r\n    consistency: number;\r\n  }> {\r\n    // ì‚¬ìš©ì í™œë™ íŒ¨í„´ ë¶„ì„\r\n    return {\r\n      peakHours: ['09:00', '19:00'],\r\n      preferredDuration: 20, // ë¶„\r\n      consistency: 0.7\r\n    };\r\n  }\r\n  \r\n  private calculateOptimalDailyReviews(pattern: ReviewMetrics, activity: any): number {\r\n    // ê°œì¸ë³„ ìµœì  ì¼ì¼ ë³µìŠµ íšŸìˆ˜ ê³„ì‚°\r\n    const baseTarget = 30;\r\n    \r\n    if (pattern.masteryLevel === 'beginner') return Math.max(15, baseTarget * 0.5);\r\n    if (pattern.masteryLevel === 'intermediate') return baseTarget;\r\n    if (pattern.masteryLevel === 'advanced') return baseTarget * 1.5;\r\n    if (pattern.masteryLevel === 'mastered') return baseTarget * 0.7; // ìœ ì§€ ëª¨ë“œ\r\n    \r\n    return baseTarget;\r\n  }\r\n}\r\n\r\n/**\r\n * @deprecated reviewAlgorithmServiceëŠ” deprecatedì…ë‹ˆë‹¤.\r\n * ëŒ€ì‹  services/srs/SRSEngine.tsë¥¼ ì‚¬ìš©í•˜ì„¸ìš”:\r\n * \r\n * import { SRSEngine } from '@/services/srs/SRSEngine';\r\n * const srsEngine = new SRSEngine();\r\n */\r\nexport const reviewAlgorithmService = new ReviewAlgorithmService();","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\scenarioDialogue.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'userInput' is defined but never used. Allowed unused args must match /^_/u.","line":372,"column":31,"nodeType":null,"messageId":"unusedVar","endLine":372,"endColumn":40}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// ì‹œë‚˜ë¦¬ì˜¤ ê¸°ë°˜ ëŒ€í™” ëª¨ë“œ ì„œë¹„ìŠ¤\r\nimport { api } from '../lib/api';\r\n\r\nexport interface DialogueTurn {\r\n  id: string;\r\n  turnNumber: number;\r\n  speaker: 'user' | 'ai';\r\n  text_kr: string;\r\n  text_en: string;\r\n  context?: string;\r\n  options?: string[];\r\n  expectedResponse?: string;\r\n  grammarFocus?: string[];\r\n  vocabularyFocus?: string[];\r\n}\r\n\r\nexport interface DialogueScenario {\r\n  id: string;\r\n  title: string;\r\n  description: string;\r\n  category: string;\r\n  difficulty: 'beginner' | 'intermediate' | 'advanced';\r\n  estimatedTime: number; // minutes\r\n  totalTurns: number;\r\n  context: string;\r\n  objective: string;\r\n  turns: DialogueTurn[];\r\n  completionCriteria: {\r\n    minTurns: number;\r\n    maxTurns: number;\r\n    requiredTopics: string[];\r\n  };\r\n}\r\n\r\nexport interface DialogueSession {\r\n  sessionId: string;\r\n  scenarioId: string;\r\n  userId: string;\r\n  startedAt: Date;\r\n  currentTurn: number;\r\n  userTurns: Array<{\r\n    turnNumber: number;\r\n    userInput: string;\r\n    aiResponse: string;\r\n    feedback?: string;\r\n    score?: number;\r\n    timestamp: Date;\r\n  }>;\r\n  isCompleted: boolean;\r\n  finalScore?: number;\r\n  summary?: string;\r\n}\r\n\r\nexport interface ScenarioCategory {\r\n  id: string;\r\n  name: string;\r\n  description: string;\r\n  icon: string;\r\n  scenarios: DialogueScenario[];\r\n}\r\n\r\nclass ScenarioDialogueService {\r\n  private readonly API_BASE = '/api/scenario';\r\n\r\n  // ì‹œë‚˜ë¦¬ì˜¤ ì¹´í…Œê³ ë¦¬ ëª©ë¡ ì¡°íšŒ\r\n  async getScenarioCategories(): Promise<ScenarioCategory[]> {\r\n    try {\r\n      const response = await api.get(`${this.API_BASE}/categories`);\r\n      return response.data.categories;\r\n    } catch (error) {\r\n      console.error('Failed to get scenario categories:', error);\r\n      return this.getMockCategories();\r\n    }\r\n  }\r\n\r\n  // íŠ¹ì • ì¹´í…Œê³ ë¦¬ì˜ ì‹œë‚˜ë¦¬ì˜¤ë“¤ ì¡°íšŒ\r\n  async getScenariosByCategory(categoryId: string): Promise<DialogueScenario[]> {\r\n    try {\r\n      const response = await api.get(`${this.API_BASE}/category/${categoryId}`);\r\n      return response.data.scenarios;\r\n    } catch (error) {\r\n      console.error('Failed to get scenarios by category:', error);\r\n      return this.getMockScenarios(categoryId);\r\n    }\r\n  }\r\n\r\n  // ì‹œë‚˜ë¦¬ì˜¤ ìƒì„¸ ì •ë³´ ì¡°íšŒ\r\n  async getScenarioDetails(scenarioId: string): Promise<DialogueScenario> {\r\n    try {\r\n      const response = await api.get(`${this.API_BASE}/scenario/${scenarioId}`);\r\n      return response.data;\r\n    } catch (error) {\r\n      console.error('Failed to get scenario details:', error);\r\n      return this.getMockScenarioDetails(scenarioId);\r\n    }\r\n  }\r\n\r\n  // ëŒ€í™” ì„¸ì…˜ ì‹œì‘\r\n  async startDialogueSession(userId: string, scenarioId: string): Promise<DialogueSession> {\r\n    try {\r\n      const response = await api.post(`${this.API_BASE}/session/start`, {\r\n        userId,\r\n        scenarioId\r\n      });\r\n      return response.data;\r\n    } catch (error) {\r\n      console.error('Failed to start dialogue session:', error);\r\n      return this.createMockSession(userId, scenarioId);\r\n    }\r\n  }\r\n\r\n  // ì‚¬ìš©ì ì‘ë‹µ ì²˜ë¦¬ ë° AI ì‘ë‹µ ìƒì„±\r\n  async processUserTurn(sessionId: string, userInput: string): Promise<{\r\n    aiResponse: string;\r\n    feedback?: string;\r\n    score: number;\r\n    isCompleted: boolean;\r\n    nextTurn?: DialogueTurn;\r\n  }> {\r\n    try {\r\n      const response = await api.post(`${this.API_BASE}/session/${sessionId}/turn`, {\r\n        userInput\r\n      });\r\n      return response.data;\r\n    } catch (error) {\r\n      console.error('Failed to process user turn:', error);\r\n      return this.getMockTurnResponse(userInput);\r\n    }\r\n  }\r\n\r\n  // ëŒ€í™” ì„¸ì…˜ ì™„ë£Œ\r\n  async completeDialogueSession(sessionId: string): Promise<{\r\n    finalScore: number;\r\n    summary: string;\r\n    achievements: string[];\r\n    recommendations: string[];\r\n  }> {\r\n    try {\r\n      const response = await api.post(`${this.API_BASE}/session/${sessionId}/complete`);\r\n      return response.data;\r\n    } catch (error) {\r\n      console.error('Failed to complete dialogue session:', error);\r\n      return this.getMockSessionSummary();\r\n    }\r\n  }\r\n\r\n  // ì‚¬ìš©ì ëŒ€í™” ê¸°ë¡ ì¡°íšŒ\r\n  async getUserDialogueHistory(userId: string): Promise<DialogueSession[]> {\r\n    try {\r\n      const response = await api.get(`${this.API_BASE}/user/${userId}/history`);\r\n      return response.data.sessions;\r\n    } catch (error) {\r\n      console.error('Failed to get user dialogue history:', error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  // Mock Data Methods\r\n  private getMockCategories(): ScenarioCategory[] {\r\n    return [\r\n      {\r\n        id: 'daily-life',\r\n        name: 'ì¼ìƒ ëŒ€í™”',\r\n        description: 'ì¼ìƒìƒí™œì—ì„œ ìì£¼ ë°œìƒí•˜ëŠ” ëŒ€í™” ìƒí™©',\r\n        icon: 'ğŸ ',\r\n        scenarios: this.getMockScenarios('daily-life')\r\n      },\r\n      {\r\n        id: 'business',\r\n        name: 'ë¹„ì¦ˆë‹ˆìŠ¤',\r\n        description: 'ì—…ë¬´ í™˜ê²½ì—ì„œì˜ ì „ë¬¸ì ì¸ ëŒ€í™”',\r\n        icon: 'ğŸ’¼',\r\n        scenarios: this.getMockScenarios('business')\r\n      },\r\n      {\r\n        id: 'travel',\r\n        name: 'ì—¬í–‰',\r\n        description: 'ì—¬í–‰ ì¤‘ ë§ˆì£¼ì¹˜ëŠ” ë‹¤ì–‘í•œ ìƒí™©',\r\n        icon: 'âœˆï¸',\r\n        scenarios: this.getMockScenarios('travel')\r\n      },\r\n      {\r\n        id: 'social',\r\n        name: 'ì‚¬êµ ëª¨ì„',\r\n        description: 'íŒŒí‹°, ëª¨ì„ì—ì„œì˜ ì‚¬êµì  ëŒ€í™”',\r\n        icon: 'ğŸ‰',\r\n        scenarios: this.getMockScenarios('social')\r\n      },\r\n      {\r\n        id: 'academic',\r\n        name: 'í•™ìˆ /êµìœ¡',\r\n        description: 'í•™êµ, ëŒ€í•™, í•™íšŒì—ì„œì˜ í•™ìˆ ì  ëŒ€í™”',\r\n        icon: 'ğŸ“',\r\n        scenarios: this.getMockScenarios('academic')\r\n      },\r\n      {\r\n        id: 'emergency',\r\n        name: 'ì‘ê¸‰ ìƒí™©',\r\n        description: 'ì‘ê¸‰ ìƒí™©ì—ì„œì˜ ë¹ ë¥´ê³  ì •í™•í•œ ì˜ì‚¬ì†Œí†µ',\r\n        icon: 'ğŸš¨',\r\n        scenarios: this.getMockScenarios('emergency')\r\n      }\r\n    ];\r\n  }\r\n\r\n  private getMockScenarios(categoryId: string): DialogueScenario[] {\r\n    const scenarios = {\r\n      'daily-life': [\r\n        {\r\n          id: 'dl-restaurant',\r\n          title: 'ë ˆìŠ¤í† ë‘ì—ì„œ ì£¼ë¬¸í•˜ê¸°',\r\n          description: 'ì›¨ì´í„°ì™€ì˜ ëŒ€í™”ë¥¼ í†µí•´ ìŒì‹ì„ ì£¼ë¬¸í•˜ëŠ” ìƒí™©',\r\n          category: 'daily-life',\r\n          difficulty: 'beginner' as const,\r\n          estimatedTime: 10,\r\n          totalTurns: 8,\r\n          context: 'í˜„ì§€ ë ˆìŠ¤í† ë‘ì—ì„œ ì €ë… ì‹ì‚¬ë¥¼ ìœ„í•´ ë©”ë‰´ë¥¼ ë³´ê³  ì£¼ë¬¸í•˜ëŠ” ìƒí™©',\r\n          objective: 'ì›í•˜ëŠ” ìŒì‹ì„ ì„±ê³µì ìœ¼ë¡œ ì£¼ë¬¸í•˜ê³  í•„ìš”í•œ ì •ë³´ë¥¼ í™•ì¸í•˜ê¸°',\r\n          turns: this.getMockRestaurantTurns(),\r\n          completionCriteria: {\r\n            minTurns: 6,\r\n            maxTurns: 10,\r\n            requiredTopics: ['greeting', 'menu-inquiry', 'ordering', 'payment']\r\n          }\r\n        },\r\n        {\r\n          id: 'dl-shopping',\r\n          title: 'ì‡¼í•‘ëª°ì—ì„œ ì˜· êµ¬ë§¤í•˜ê¸°',\r\n          description: 'ë§¤ì¥ ì§ì›ê³¼ ëŒ€í™”í•˜ë©° ì›í•˜ëŠ” ì˜·ì„ ì°¾ê³  êµ¬ë§¤í•˜ëŠ” ìƒí™©',\r\n          category: 'daily-life',\r\n          difficulty: 'intermediate' as const,\r\n          estimatedTime: 12,\r\n          totalTurns: 10,\r\n          context: 'ë°±í™”ì ì—ì„œ íŠ¹ë³„í•œ í–‰ì‚¬ë¥¼ ìœ„í•œ ì˜·ì„ ì°¾ëŠ” ìƒí™©',\r\n          objective: 'ì‚¬ì´ì¦ˆ, ìƒ‰ìƒ, ê°€ê²© ë“±ì„ í™•ì¸í•˜ê³  ë§Œì¡±ìŠ¤ëŸ¬ìš´ êµ¬ë§¤í•˜ê¸°',\r\n          turns: [],\r\n          completionCriteria: {\r\n            minTurns: 8,\r\n            maxTurns: 12,\r\n            requiredTopics: ['size-inquiry', 'color-preference', 'price-check', 'trying-on']\r\n          }\r\n        }\r\n      ],\r\n      'business': [\r\n        {\r\n          id: 'biz-meeting',\r\n          title: 'íŒ€ ë¯¸íŒ… ì§„í–‰í•˜ê¸°',\r\n          description: 'í”„ë¡œì íŠ¸ ì§„í–‰ ìƒí™©ì„ ë…¼ì˜í•˜ëŠ” íŒ€ ë¯¸íŒ…',\r\n          category: 'business',\r\n          difficulty: 'advanced' as const,\r\n          estimatedTime: 15,\r\n          totalTurns: 12,\r\n          context: 'ìƒˆë¡œìš´ í”„ë¡œì íŠ¸ì˜ ì¤‘ê°„ ì ê²€ì„ ìœ„í•œ íŒ€ ë¯¸íŒ…',\r\n          objective: 'í”„ë¡œì íŠ¸ í˜„í™© ê³µìœ , ë¬¸ì œì  ë…¼ì˜, ë‹¤ìŒ ë‹¨ê³„ ê³„íš ìˆ˜ë¦½',\r\n          turns: [],\r\n          completionCriteria: {\r\n            minTurns: 10,\r\n            maxTurns: 15,\r\n            requiredTopics: ['status-report', 'problem-discussion', 'solution-proposal', 'next-steps']\r\n          }\r\n        }\r\n      ],\r\n      'travel': [\r\n        {\r\n          id: 'tr-airport',\r\n          title: 'ê³µí•­ì—ì„œ ì²´í¬ì¸í•˜ê¸°',\r\n          description: 'êµ­ì œì„  í•­ê³µí¸ ì²´í¬ì¸ ë° ìˆ˜í•˜ë¬¼ ì²˜ë¦¬',\r\n          category: 'travel',\r\n          difficulty: 'intermediate' as const,\r\n          estimatedTime: 10,\r\n          totalTurns: 8,\r\n          context: 'í•´ì™¸ì—¬í–‰ì„ ìœ„í•´ ê³µí•­ ì²´í¬ì¸ ì¹´ìš´í„°ì—ì„œ ìˆ˜ì†ì„ ë°ŸëŠ” ìƒí™©',\r\n          objective: 'ì²´í¬ì¸ ì™„ë£Œ, ì¢Œì„ ì„ íƒ, ìˆ˜í•˜ë¬¼ ì²˜ë¦¬, íƒ‘ìŠ¹ê¶Œ ìˆ˜ë ¹',\r\n          turns: [],\r\n          completionCriteria: {\r\n            minTurns: 6,\r\n            maxTurns: 10,\r\n            requiredTopics: ['check-in', 'seat-selection', 'baggage', 'boarding-pass']\r\n          }\r\n        }\r\n      ]\r\n    };\r\n\r\n    return scenarios[categoryId as keyof typeof scenarios] || [];\r\n  }\r\n\r\n  private getMockRestaurantTurns(): DialogueTurn[] {\r\n    return [\r\n      {\r\n        id: 'turn-1',\r\n        turnNumber: 1,\r\n        speaker: 'ai',\r\n        text_kr: 'ì•ˆë…•í•˜ì„¸ìš”! í™˜ì˜í•©ë‹ˆë‹¤. ë©”ë‰´ ë³´ì‹¤ê¹Œìš”?',\r\n        text_en: 'Hello! Welcome. Would you like to see the menu?',\r\n        context: 'ì›¨ì´í„°ê°€ ì¹œê·¼í•˜ê²Œ ì¸ì‚¬í•˜ë©° ë©”ë‰´ë¥¼ ê¶Œí•œë‹¤',\r\n        options: [\r\n          'Yes, please.',\r\n          'What do you recommend?',\r\n          'I need a few more minutes.'\r\n        ]\r\n      },\r\n      {\r\n        id: 'turn-2',\r\n        turnNumber: 2,\r\n        speaker: 'user',\r\n        text_kr: 'ë„¤, ë©”ë‰´ë¥¼ ë³´ì—¬ì£¼ì„¸ìš”.',\r\n        text_en: 'Yes, please show me the menu.',\r\n        expectedResponse: 'Yes, please',\r\n        grammarFocus: ['polite-requests'],\r\n        vocabularyFocus: ['restaurant-vocabulary']\r\n      },\r\n      {\r\n        id: 'turn-3',\r\n        turnNumber: 3,\r\n        speaker: 'ai',\r\n        text_kr: 'ì˜¤ëŠ˜ì˜ íŠ¹ì„  ìš”ë¦¬ëŠ” ì—°ì–´ ìŠ¤í…Œì´í¬ì…ë‹ˆë‹¤. ì¶”ì²œí•´ë“œë ¤ìš”!',\r\n        text_en: 'Today\\'s special is salmon steak. I highly recommend it!',\r\n        context: 'ì›¨ì´í„°ê°€ ì˜¤ëŠ˜ì˜ íŠ¹ì„ ì„ ì¶”ì²œí•œë‹¤'\r\n      },\r\n      {\r\n        id: 'turn-4',\r\n        turnNumber: 4,\r\n        speaker: 'user',\r\n        text_kr: 'ì—°ì–´ ìŠ¤í…Œì´í¬ê°€ ì–¼ë§ˆë‚˜ ë§¤ìš´ê°€ìš”?',\r\n        text_en: 'How spicy is the salmon steak?',\r\n        expectedResponse: 'How spicy is the salmon steak?',\r\n        grammarFocus: ['question-formation', 'degree-adverbs'],\r\n        vocabularyFocus: ['food-descriptions', 'taste-vocabulary']\r\n      }\r\n    ];\r\n  }\r\n\r\n  private getMockScenarioDetails(scenarioId: string): DialogueScenario {\r\n    const scenarios = this.getMockCategories();\r\n    for (const category of scenarios) {\r\n      const scenario = category.scenarios.find(s => s.id === scenarioId);\r\n      if (scenario) return scenario;\r\n    }\r\n    \r\n    // Fallback\r\n    return {\r\n      id: scenarioId,\r\n      title: 'Sample Scenario',\r\n      description: 'A sample dialogue scenario',\r\n      category: 'daily-life',\r\n      difficulty: 'intermediate',\r\n      estimatedTime: 10,\r\n      totalTurns: 8,\r\n      context: 'Sample context',\r\n      objective: 'Complete the conversation',\r\n      turns: [],\r\n      completionCriteria: {\r\n        minTurns: 5,\r\n        maxTurns: 10,\r\n        requiredTopics: ['greeting', 'conversation', 'closing']\r\n      }\r\n    };\r\n  }\r\n\r\n  private createMockSession(userId: string, scenarioId: string): DialogueSession {\r\n    return {\r\n      sessionId: `session_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\r\n      scenarioId,\r\n      userId,\r\n      startedAt: new Date(),\r\n      currentTurn: 0,\r\n      userTurns: [],\r\n      isCompleted: false\r\n    };\r\n  }\r\n\r\n  private getMockTurnResponse(userInput: string): {\r\n    aiResponse: string;\r\n    feedback?: string;\r\n    score: number;\r\n    isCompleted: boolean;\r\n    nextTurn?: DialogueTurn;\r\n  } {\r\n    return {\r\n      aiResponse: 'Thank you for your response. Let me help you with the next part of our conversation.',\r\n      feedback: 'Great job! Your grammar and vocabulary usage were very natural.',\r\n      score: Math.floor(Math.random() * 30) + 70, // 70-100\r\n      isCompleted: false,\r\n      nextTurn: {\r\n        id: 'next-turn',\r\n        turnNumber: 2,\r\n        speaker: 'ai',\r\n        text_kr: 'ë‹¤ìŒ ë‹¨ê³„ë¡œ ë„˜ì–´ê°€ê² ìŠµë‹ˆë‹¤.',\r\n        text_en: 'Let\\'s move on to the next step.',\r\n        context: 'Continuing the conversation'\r\n      }\r\n    };\r\n  }\r\n\r\n  private getMockSessionSummary() {\r\n    return {\r\n      finalScore: 85,\r\n      summary: 'í›Œë¥­í•œ ëŒ€í™” ì‹¤ë ¥ì„ ë³´ì—¬ì£¼ì…¨ìŠµë‹ˆë‹¤! ìì—°ìŠ¤ëŸ¬ìš´ í‘œí˜„ê³¼ ì ì ˆí•œ ë¬¸ë²• ì‚¬ìš©ì´ ì¸ìƒì ì´ì—ˆìŠµë‹ˆë‹¤.',\r\n      achievements: [\r\n        'ì™„ë²½í•œ ì¸ì‚¬ë§ êµ¬ì‚¬',\r\n        'ìì—°ìŠ¤ëŸ¬ìš´ ì§ˆë¬¸ í˜•ì„±',\r\n        'ì ì ˆí•œ ì–´íœ˜ ì„ íƒ',\r\n        'ëŒ€í™” íë¦„ ìœ ì§€'\r\n      ],\r\n      recommendations: [\r\n        'ì¢€ ë” ë‹¤ì–‘í•œ ì ‘ì†ì‚¬ ì‚¬ìš©í•˜ê¸°',\r\n        'ê°ì • í‘œí˜„ ì–´íœ˜ ëŠ˜ë¦¬ê¸°',\r\n        'ë³µë¬¸ êµ¬ì¡° ì—°ìŠµí•˜ê¸°'\r\n      ]\r\n    };\r\n  }\r\n}\r\n\r\nexport const scenarioDialogueService = new ScenarioDialogueService();","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\sentenceService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\speedDifficultyModes.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'userLevel' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":169,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":169,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'settings' is defined but never used. Allowed unused args must match /^_/u.","line":216,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":216,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'level' is defined but never used. Allowed unused args must match /^_/u.","line":478,"column":38,"nodeType":null,"messageId":"unusedVar","endLine":478,"endColumn":43}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// ì†ë„/ë‚œì´ë„ ì¡°ì ˆ ëª¨ë“œ ì„œë¹„ìŠ¤\r\n\r\nexport type DifficultyMode = 'fast' | 'explanation' | 'mixed_levels';\r\n\r\nexport interface SpeedModeSettings {\r\n  timeLimit: number; // ì´ˆ\r\n  showTimer: boolean;\r\n  earlyFinishBonus: boolean;\r\n  pressureLevel: 'low' | 'medium' | 'high';\r\n}\r\n\r\nexport interface ExplanationModeSettings {\r\n  showDetailedFeedback: boolean;\r\n  includeGrammarNotes: boolean;\r\n  includeExamples: boolean;\r\n  audioExplanation: boolean;\r\n  pauseAfterEachQuestion: boolean;\r\n}\r\n\r\nexport interface MixedLevelSettings {\r\n  includedLevels: number[];\r\n  randomOrder: boolean;\r\n  balanceByDifficulty: boolean;\r\n  adaptiveSelection: boolean; // ì‹¤ë ¥ì— ë§ì¶° ë¬¸ì œ ì„ íƒ\r\n}\r\n\r\nexport interface SpeedSession {\r\n  sessionId: string;\r\n  userId: string;\r\n  mode: DifficultyMode;\r\n  settings: SpeedModeSettings | ExplanationModeSettings | MixedLevelSettings;\r\n  questions: SpeedQuestion[];\r\n  results: SpeedResult[];\r\n  startTime: Date;\r\n  endTime?: Date;\r\n  totalScore: number;\r\n  averageResponseTime: number;\r\n}\r\n\r\nexport interface SpeedQuestion {\r\n  questionId: string;\r\n  content: string;\r\n  level: number;\r\n  stage: number;\r\n  timeLimit?: number;\r\n  difficulty: 'easy' | 'medium' | 'hard';\r\n  tags: string[];\r\n}\r\n\r\nexport interface SpeedResult {\r\n  questionId: string;\r\n  userAnswer: string;\r\n  correctAnswer: string;\r\n  isCorrect: boolean;\r\n  responseTime: number;\r\n  timeExceeded: boolean;\r\n  bonusPoints: number;\r\n  explanation?: string;\r\n}\r\n\r\nclass SpeedDifficultyService {\r\n  \r\n  /**\r\n   * ë¹ ë¥¸ ëª¨ë“œ ì„¸ì…˜ ìƒì„± (2-3ì´ˆ ì œí•œ)\r\n   */\r\n  async createFastSession(\r\n    userId: string,\r\n    settings: SpeedModeSettings,\r\n    questionCount: number = 20\r\n  ): Promise<SpeedSession> {\r\n    \r\n    try {\r\n      const questions = await this.generateFastModeQuestions(userId, questionCount, settings);\r\n      \r\n      const session: SpeedSession = {\r\n        sessionId: `fast-${Date.now()}-${userId}`,\r\n        userId,\r\n        mode: 'fast',\r\n        settings,\r\n        questions,\r\n        results: [],\r\n        startTime: new Date(),\r\n        totalScore: 0,\r\n        averageResponseTime: 0\r\n      };\r\n      \r\n      return session;\r\n      \r\n    } catch (error) {\r\n      console.error('ë¹ ë¥¸ ëª¨ë“œ ì„¸ì…˜ ìƒì„± ì‹¤íŒ¨:', error);\r\n      throw error;\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * í•´ì„¤ ëª¨ë“œ ì„¸ì…˜ ìƒì„±\r\n   */\r\n  async createExplanationSession(\r\n    userId: string,\r\n    settings: ExplanationModeSettings,\r\n    questionCount: number = 15\r\n  ): Promise<SpeedSession> {\r\n    \r\n    try {\r\n      const questions = await this.generateExplanationModeQuestions(userId, questionCount, settings);\r\n      \r\n      const session: SpeedSession = {\r\n        sessionId: `explanation-${Date.now()}-${userId}`,\r\n        userId,\r\n        mode: 'explanation',\r\n        settings,\r\n        questions,\r\n        results: [],\r\n        startTime: new Date(),\r\n        totalScore: 0,\r\n        averageResponseTime: 0\r\n      };\r\n      \r\n      return session;\r\n      \r\n    } catch (error) {\r\n      console.error('í•´ì„¤ ëª¨ë“œ ì„¸ì…˜ ìƒì„± ì‹¤íŒ¨:', error);\r\n      throw error;\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * ë ˆë²¨ í˜¼í•© ëª¨ë“œ ì„¸ì…˜ ìƒì„±\r\n   */\r\n  async createMixedLevelSession(\r\n    userId: string,\r\n    settings: MixedLevelSettings,\r\n    questionCount: number = 25\r\n  ): Promise<SpeedSession> {\r\n    \r\n    try {\r\n      const questions = await this.generateMixedLevelQuestions(userId, questionCount, settings);\r\n      \r\n      const session: SpeedSession = {\r\n        sessionId: `mixed-${Date.now()}-${userId}`,\r\n        userId,\r\n        mode: 'mixed_levels',\r\n        settings,\r\n        questions,\r\n        results: [],\r\n        startTime: new Date(),\r\n        totalScore: 0,\r\n        averageResponseTime: 0\r\n      };\r\n      \r\n      return session;\r\n      \r\n    } catch (error) {\r\n      console.error('ë ˆë²¨ í˜¼í•© ëª¨ë“œ ì„¸ì…˜ ìƒì„± ì‹¤íŒ¨:', error);\r\n      throw error;\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * ë¹ ë¥¸ ëª¨ë“œ ë¬¸ì œ ìƒì„±\r\n   */\r\n  private async generateFastModeQuestions(\r\n    userId: string,\r\n    count: number,\r\n    settings: SpeedModeSettings\r\n  ): Promise<SpeedQuestion[]> {\r\n    \r\n    // ì‚¬ìš©ì í˜„ì¬ ë ˆë²¨ ê¸°ì¤€ìœ¼ë¡œ ì ì ˆí•œ ë‚œì´ë„ ë¬¸ì œ ì„ íƒ\r\n    const userLevel = await this.getUserLevel(userId);\r\n    \r\n    const mockQuestions: SpeedQuestion[] = [\r\n      {\r\n        questionId: 'fast-L3-001',\r\n        content: 'If I _____ time, I would go to the movies.',\r\n        level: 3,\r\n        stage: 1,\r\n        timeLimit: settings.timeLimit,\r\n        difficulty: 'medium',\r\n        tags: ['conditional', 'grammar']\r\n      },\r\n      {\r\n        questionId: 'fast-L3-002',\r\n        content: 'She _____ working when I called her.',\r\n        level: 3,\r\n        stage: 2,\r\n        timeLimit: settings.timeLimit,\r\n        difficulty: 'easy',\r\n        tags: ['past-continuous', 'grammar']\r\n      },\r\n      {\r\n        questionId: 'fast-L4-001',\r\n        content: 'We need to _____ our marketing strategy.',\r\n        level: 4,\r\n        stage: 1,\r\n        timeLimit: settings.timeLimit,\r\n        difficulty: 'hard',\r\n        tags: ['business', 'vocabulary']\r\n      }\r\n    ];\r\n    \r\n    // ì••ë°• ìˆ˜ì¤€ì— ë”°ë¼ ì‹œê°„ ì œí•œ ì¡°ì •\r\n    const adjustedQuestions = mockQuestions.map(q => ({\r\n      ...q,\r\n      timeLimit: this.adjustTimeLimitByPressure(settings.timeLimit, settings.pressureLevel)\r\n    }));\r\n    \r\n    return adjustedQuestions.slice(0, count);\r\n  }\r\n  \r\n  /**\r\n   * í•´ì„¤ ëª¨ë“œ ë¬¸ì œ ìƒì„±\r\n   */\r\n  private async generateExplanationModeQuestions(\r\n    userId: string,\r\n    count: number,\r\n    settings: ExplanationModeSettings\r\n  ): Promise<SpeedQuestion[]> {\r\n    \r\n    const mockQuestions: SpeedQuestion[] = [\r\n      {\r\n        questionId: 'exp-L3-001',\r\n        content: 'If I had known, I _____ differently.',\r\n        level: 3,\r\n        stage: 9,\r\n        difficulty: 'hard',\r\n        tags: ['third-conditional', 'grammar', 'complex']\r\n      },\r\n      {\r\n        questionId: 'exp-L4-001',\r\n        content: 'The proposal _____ be reviewed by the committee.',\r\n        level: 4,\r\n        stage: 5,\r\n        difficulty: 'medium',\r\n        tags: ['passive-voice', 'business', 'formal']\r\n      }\r\n    ];\r\n    \r\n    return mockQuestions.slice(0, count);\r\n  }\r\n  \r\n  /**\r\n   * ë ˆë²¨ í˜¼í•© ëª¨ë“œ ë¬¸ì œ ìƒì„±\r\n   */\r\n  private async generateMixedLevelQuestions(\r\n    userId: string,\r\n    count: number,\r\n    settings: MixedLevelSettings\r\n  ): Promise<SpeedQuestion[]> {\r\n    \r\n    const allQuestions: SpeedQuestion[] = [];\r\n    \r\n    // ê° ë ˆë²¨ì—ì„œ ë¬¸ì œ ì„ íƒ\r\n    for (const level of settings.includedLevels) {\r\n      const levelQuestions = await this.getQuestionsForLevel(level);\r\n      allQuestions.push(...levelQuestions);\r\n    }\r\n    \r\n    // ëœë¤ ìˆœì„œ ë˜ëŠ” ë‚œì´ë„ ê· í˜•\r\n    let selectedQuestions = allQuestions;\r\n    \r\n    if (settings.randomOrder) {\r\n      selectedQuestions = this.shuffleArray(allQuestions);\r\n    } else if (settings.balanceByDifficulty) {\r\n      selectedQuestions = this.balanceByDifficulty(allQuestions);\r\n    }\r\n    \r\n    return selectedQuestions.slice(0, count);\r\n  }\r\n  \r\n  /**\r\n   * ë‹µë³€ ì²˜ë¦¬ ë° ì ìˆ˜ ê³„ì‚°\r\n   */\r\n  async processAnswer(\r\n    sessionId: string,\r\n    questionId: string,\r\n    userAnswer: string,\r\n    responseTime: number\r\n  ): Promise<SpeedResult> {\r\n    \r\n    try {\r\n      const question = await this.getQuestionById(questionId);\r\n      const correctAnswer = await this.getCorrectAnswer(questionId);\r\n      \r\n      const isCorrect = this.validateAnswer(userAnswer, correctAnswer);\r\n      const timeExceeded = question.timeLimit ? responseTime > (question.timeLimit * 1000) : false;\r\n      \r\n      // ë³´ë„ˆìŠ¤ ì ìˆ˜ ê³„ì‚° (ë¹ ë¥¸ ì •ë‹µ)\r\n      let bonusPoints = 0;\r\n      if (isCorrect && question.timeLimit) {\r\n        const timeRatio = responseTime / (question.timeLimit * 1000);\r\n        if (timeRatio < 0.5) bonusPoints = 50; // ì ˆë°˜ ì‹œê°„ ë‚´ ì •ë‹µ\r\n        else if (timeRatio < 0.7) bonusPoints = 30;\r\n        else if (timeRatio < 0.9) bonusPoints = 10;\r\n      }\r\n      \r\n      const result: SpeedResult = {\r\n        questionId,\r\n        userAnswer,\r\n        correctAnswer,\r\n        isCorrect,\r\n        responseTime,\r\n        timeExceeded,\r\n        bonusPoints\r\n      };\r\n      \r\n      // í•´ì„¤ ëª¨ë“œì¸ ê²½ìš° ì„¤ëª… ì¶”ê°€\r\n      const session = await this.getSession(sessionId);\r\n      if (session.mode === 'explanation') {\r\n        result.explanation = await this.generateExplanation(question, isCorrect);\r\n      }\r\n      \r\n      return result;\r\n      \r\n    } catch (error) {\r\n      console.error('ë‹µë³€ ì²˜ë¦¬ ì‹¤íŒ¨:', error);\r\n      throw error;\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * ìƒì„¸ ì„¤ëª… ìƒì„±\r\n   */\r\n  private async generateExplanation(question: SpeedQuestion, isCorrect: boolean): Promise<string> {\r\n    \r\n    const explanations: Record<string, string> = {\r\n      'exp-L3-001': `\r\n        ğŸ¯ **Third Conditional (3ì°¨ ì¡°ê±´ë¬¸)**\r\n        \r\n        **êµ¬ì¡°**: If + had + past participle, would have + past participle\r\n        **ì˜ë¯¸**: ê³¼ê±°ì˜ ê°€ì •ì  ìƒí™©ê³¼ ê·¸ ê²°ê³¼\r\n        \r\n        ${isCorrect ? 'âœ… ì •ë‹µì…ë‹ˆë‹¤!' : 'âŒ ë‹¤ì‹œ ìƒê°í•´ë³´ì„¸ìš”.'}\r\n        \r\n        **ì •ë‹µ**: would have acted\r\n        **ì´ìœ **: ê³¼ê±°ì— ì¼ì–´ë‚˜ì§€ ì•Šì€ ê°€ì •ê³¼ ê·¸ ê²°ê³¼ë¥¼ í‘œí˜„í•  ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.\r\n        \r\n        **ë¹„ìŠ·í•œ ì˜ˆë¬¸**:\r\n        - If I had studied harder, I would have passed the exam.\r\n        - If she had left earlier, she wouldn't have been late.\r\n      `,\r\n      'exp-L4-001': `\r\n        ğŸ¯ **Passive Voice in Business Context**\r\n        \r\n        **êµ¬ì¡°**: will + be + past participle\r\n        **ì˜ë¯¸**: ë¯¸ë˜ì˜ ìˆ˜ë™íƒœ í‘œí˜„\r\n        \r\n        ${isCorrect ? 'âœ… ì •ë‹µì…ë‹ˆë‹¤!' : 'âŒ ë‹¤ì‹œ ìƒê°í•´ë³´ì„¸ìš”.'}\r\n        \r\n        **ì •ë‹µ**: will\r\n        **ì´ìœ **: ê³µì‹ì ì¸ ë¹„ì¦ˆë‹ˆìŠ¤ ë¬¸ì„œì—ì„œ ë¯¸ë˜ ê³„íšì„ ìˆ˜ë™íƒœë¡œ í‘œí˜„í•  ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.\r\n        \r\n        **ë¹„ìŠ·í•œ ì˜ˆë¬¸**:\r\n        - The contract will be signed next week.\r\n        - New policies will be implemented in January.\r\n      `\r\n    };\r\n    \r\n    return explanations[question.questionId] || 'í•´ì„¤ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';\r\n  }\r\n  \r\n  /**\r\n   * ì„¸ì…˜ ì™„ë£Œ ë° í†µê³„ ê³„ì‚°\r\n   */\r\n  async completeSession(sessionId: string): Promise<{\r\n    totalScore: number;\r\n    accuracy: number;\r\n    averageResponseTime: number;\r\n    bonusPoints: number;\r\n    improvementAreas: string[];\r\n    nextRecommendation: string;\r\n  }> {\r\n    \r\n    try {\r\n      const session = await this.getSession(sessionId);\r\n      session.endTime = new Date();\r\n      \r\n      const results = session.results;\r\n      const correctAnswers = results.filter(r => r.isCorrect).length;\r\n      const totalQuestions = results.length;\r\n      \r\n      const accuracy = (correctAnswers / totalQuestions) * 100;\r\n      const averageResponseTime = results.reduce((sum, r) => sum + r.responseTime, 0) / totalQuestions;\r\n      const bonusPoints = results.reduce((sum, r) => sum + r.bonusPoints, 0);\r\n      const totalScore = (correctAnswers * 100) + bonusPoints;\r\n      \r\n      // ê°œì„  ì˜ì—­ ë¶„ì„\r\n      const incorrectTags = results\r\n        .filter(r => !r.isCorrect)\r\n        .map(r => this.getQuestionTags(r.questionId))\r\n        .flat()\r\n        .reduce((acc, tag) => {\r\n          acc[tag] = (acc[tag] || 0) + 1;\r\n          return acc;\r\n        }, {} as Record<string, number>);\r\n      \r\n      const improvementAreas = Object.entries(incorrectTags)\r\n        .sort(([,a], [,b]) => b - a)\r\n        .slice(0, 3)\r\n        .map(([tag]) => tag);\r\n      \r\n      // ë‹¤ìŒ ì¶”ì²œ ëª¨ë“œ\r\n      let nextRecommendation = '';\r\n      if (session.mode === 'fast') {\r\n        if (accuracy >= 80) {\r\n          nextRecommendation = 'ë†’ì€ ì •í™•ë„ë¥¼ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤! í•´ì„¤ ëª¨ë“œë¡œ ë” ê¹Šì´ í•™ìŠµí•´ë³´ì„¸ìš”.';\r\n        } else {\r\n          nextRecommendation = 'ê¸°ë³¸ í•™ìŠµì„ ë” ì§„í–‰í•œ í›„ ë‹¤ì‹œ ë„ì „í•´ë³´ì„¸ìš”.';\r\n        }\r\n      } else if (session.mode === 'explanation') {\r\n        nextRecommendation = 'ì¶©ë¶„íˆ í•™ìŠµí•˜ì…¨ìŠµë‹ˆë‹¤. ë¹ ë¥¸ ëª¨ë“œë¡œ ë°˜ì‘ì†ë„ë¥¼ í…ŒìŠ¤íŠ¸í•´ë³´ì„¸ìš”.';\r\n      } else {\r\n        nextRecommendation = 'ë‹¤ì–‘í•œ ë ˆë²¨ì˜ ë¬¸ì œë¥¼ ì˜ í’€ê³  ìˆìŠµë‹ˆë‹¤. ê³„ì† ë„ì „í•˜ì„¸ìš”!';\r\n      }\r\n      \r\n      return {\r\n        totalScore,\r\n        accuracy,\r\n        averageResponseTime,\r\n        bonusPoints,\r\n        improvementAreas,\r\n        nextRecommendation\r\n      };\r\n      \r\n    } catch (error) {\r\n      console.error('ì„¸ì…˜ ì™„ë£Œ ì²˜ë¦¬ ì‹¤íŒ¨:', error);\r\n      throw error;\r\n    }\r\n  }\r\n  \r\n  // Private helper methods\r\n  \r\n  private adjustTimeLimitByPressure(baseTime: number, pressure: 'low' | 'medium' | 'high'): number {\r\n    switch (pressure) {\r\n      case 'low': return baseTime * 1.5;\r\n      case 'medium': return baseTime;\r\n      case 'high': return baseTime * 0.7;\r\n      default: return baseTime;\r\n    }\r\n  }\r\n  \r\n  private shuffleArray<T>(array: T[]): T[] {\r\n    const shuffled = [...array];\r\n    for (let i = shuffled.length - 1; i > 0; i--) {\r\n      const j = Math.floor(Math.random() * (i + 1));\r\n      [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];\r\n    }\r\n    return shuffled;\r\n  }\r\n  \r\n  private balanceByDifficulty(questions: SpeedQuestion[]): SpeedQuestion[] {\r\n    const easy = questions.filter(q => q.difficulty === 'easy');\r\n    const medium = questions.filter(q => q.difficulty === 'medium');\r\n    const hard = questions.filter(q => q.difficulty === 'hard');\r\n    \r\n    const balanced: SpeedQuestion[] = [];\r\n    const maxLength = Math.max(easy.length, medium.length, hard.length);\r\n    \r\n    for (let i = 0; i < maxLength; i++) {\r\n      if (easy[i]) balanced.push(easy[i]);\r\n      if (medium[i]) balanced.push(medium[i]);\r\n      if (hard[i]) balanced.push(hard[i]);\r\n    }\r\n    \r\n    return balanced;\r\n  }\r\n  \r\n  private validateAnswer(userAnswer: string, correctAnswer: string): boolean {\r\n    const normalize = (str: string) => str.toLowerCase().trim().replace(/[.,!?]/g, '');\r\n    return normalize(userAnswer) === normalize(correctAnswer);\r\n  }\r\n  \r\n  // Mock data methods (ì‹¤ì œë¡œëŠ” DBì—ì„œ ì¡°íšŒ)\r\n  \r\n  private async getUserLevel(_userId: string): Promise<number> {\r\n    return 3; // Mock\r\n  }\r\n  \r\n  private async getQuestionsForLevel(level: number): Promise<SpeedQuestion[]> {\r\n    return []; // Mock\r\n  }\r\n  \r\n  private async getQuestionById(questionId: string): Promise<SpeedQuestion> {\r\n    return {\r\n      questionId,\r\n      content: '',\r\n      level: 1,\r\n      stage: 1,\r\n      difficulty: 'medium',\r\n      tags: []\r\n    }; // Mock\r\n  }\r\n  \r\n  private async getCorrectAnswer(questionId: string): Promise<string> {\r\n    const answers: Record<string, string> = {\r\n      'fast-L3-001': 'had',\r\n      'fast-L3-002': 'was',\r\n      'fast-L4-001': 'leverage',\r\n      'exp-L3-001': 'would have acted',\r\n      'exp-L4-001': 'will'\r\n    };\r\n    return answers[questionId] || 'answer';\r\n  }\r\n  \r\n  private async getSession(sessionId: string): Promise<SpeedSession> {\r\n    // Mock session ë°˜í™˜\r\n    return {\r\n      sessionId,\r\n      userId: 'user-1',\r\n      mode: 'fast',\r\n      settings: { timeLimit: 3, showTimer: true, earlyFinishBonus: true, pressureLevel: 'medium' },\r\n      questions: [],\r\n      results: [],\r\n      startTime: new Date(),\r\n      totalScore: 0,\r\n      averageResponseTime: 0\r\n    };\r\n  }\r\n  \r\n  private getQuestionTags(questionId: string): string[] {\r\n    const tags: Record<string, string[]> = {\r\n      'fast-L3-001': ['conditional', 'grammar'],\r\n      'fast-L3-002': ['past-continuous', 'grammar'],\r\n      'fast-L4-001': ['business', 'vocabulary']\r\n    };\r\n    return tags[questionId] || [];\r\n  }\r\n}\r\n\r\nexport const speedDifficultyService = new SpeedDifficultyService();","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\srs\\SRSEngine.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\srs\\adapters\\storage\\LocalStorageAdapter.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\srs\\adapters\\storage\\MemoryStorageAdapter.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\srs\\algorithms\\ForgettingCurve.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\srs\\algorithms\\MockSM2Algorithm.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'timeSinceLastReview' is defined but never used. Allowed unused args must match /^_/u.","line":65,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":65,"endColumn":24}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Mock SuperMemo SM-2 ì•Œê³ ë¦¬ì¦˜ (í…ŒìŠ¤íŠ¸ìš©)\r\n * ISRSAlgorithm ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„ì²´\r\n * \r\n * ê²°ì •ì ì´ê³  ì˜ˆì¸¡ ê°€ëŠ¥í•œ ê²°ê³¼ë¥¼ ì œê³µ\r\n */\r\n\r\nimport { ISRSAlgorithm } from '../interfaces/ISRSEngine';\r\n\r\nexport class MockSM2Algorithm implements ISRSAlgorithm {\r\n  readonly name = 'Mock SuperMemo SM-2';\r\n  readonly version = 'test-1.0';\r\n\r\n  private readonly config = {\r\n    minEaseFactor: 1.3,\r\n    maxEaseFactor: 2.5,\r\n    initialEaseFactor: 1.8,\r\n    easeFactorStep: 0.1,\r\n    failureThreshold: 3,\r\n    maxInterval: 10 // í…ŒìŠ¤íŠ¸ìš©ìœ¼ë¡œ ì¶•ì†Œ\r\n  };\r\n\r\n  calculateNextInterval(\r\n    currentInterval: number,\r\n    easeFactor: number,\r\n    quality: number,\r\n    reviewCount: number\r\n  ): number {\r\n    // ê°„ë‹¨í•˜ê³  ì˜ˆì¸¡ ê°€ëŠ¥í•œ ë¡œì§\r\n    if (quality < this.config.failureThreshold) {\r\n      return 1; // ì‹¤íŒ¨ì‹œ 1ì¼\r\n    }\r\n\r\n    if (reviewCount === 0) {\r\n      return 1;\r\n    }\r\n\r\n    if (reviewCount === 1) {\r\n      return 3;\r\n    }\r\n\r\n    // ì„±ê³µì‹œ ê°„ë‹¨í•œ ê³±ì…ˆ\r\n    const nextInterval = Math.round(currentInterval * Math.max(1.2, easeFactor));\r\n    return Math.min(nextInterval, this.config.maxInterval);\r\n  }\r\n\r\n  updateEaseFactor(currentEaseFactor: number, quality: number): number {\r\n    // ê°„ë‹¨í•œ ì¡°ì •\r\n    let adjustment = 0;\r\n    \r\n    if (quality >= 4) {\r\n      adjustment = 0.1;\r\n    } else if (quality <= 2) {\r\n      adjustment = -0.1;\r\n    }\r\n    \r\n    const newEF = currentEaseFactor + adjustment;\r\n    return Math.max(this.config.minEaseFactor, \r\n           Math.min(this.config.maxEaseFactor, newEF));\r\n  }\r\n\r\n  updateMemoryStrength(\r\n    currentStrength: number,\r\n    quality: number,\r\n    timeSinceLastReview: number\r\n  ): number {\r\n    // ê°„ë‹¨í•œ ê°•í™”/ì•½í™” ë¡œì§\r\n    const reviewBonus = quality / 5; // 0-1 ë²”ìœ„\r\n    const timeDecayFactor = 0.9; // ë‹¨ìˆœ ê°ì†Œ\r\n    \r\n    const decayedStrength = currentStrength * timeDecayFactor;\r\n    const reinforcement = reviewBonus * 0.3;\r\n    \r\n    const newStrength = Math.min(1.0, decayedStrength + reinforcement);\r\n    return Math.max(0.1, newStrength);\r\n  }\r\n\r\n  /**\r\n   * í…ŒìŠ¤íŠ¸ìš© - ê²°ì •ì  í’ˆì§ˆ ì ìˆ˜ ë°˜í™˜\r\n   */\r\n  getDeterministicQuality(isCorrect: boolean, responseTime: number): number {\r\n    if (!isCorrect) return 2;\r\n    \r\n    // ì‘ë‹µ ì‹œê°„ì— ë”°ë¥¸ ê°„ë‹¨í•œ í’ˆì§ˆ ì ìˆ˜\r\n    if (responseTime < 3000) return 5; // ë¹ ë¥¸ ì‘ë‹µ\r\n    if (responseTime < 7000) return 4; // ì ì ˆí•œ ì‘ë‹µ\r\n    if (responseTime < 12000) return 3; // ëŠë¦° ì‘ë‹µ\r\n    return 2; // ë„ˆë¬´ ëŠë¦¼\r\n  }\r\n\r\n  /**\r\n   * í…ŒìŠ¤íŠ¸ìš© - ì˜ˆì¸¡ ê°€ëŠ¥í•œ ê°„ê²© ê³„ì‚°\r\n   */\r\n  getPredictableInterval(reviewCount: number, isCorrect: boolean): number {\r\n    if (!isCorrect) return 1;\r\n    \r\n    const intervals = [1, 3, 6, 10]; // ì˜ˆì¸¡ ê°€ëŠ¥í•œ ì‹œí€€ìŠ¤\r\n    return intervals[Math.min(reviewCount, intervals.length - 1)];\r\n  }\r\n\r\n  /**\r\n   * í…ŒìŠ¤íŠ¸ìš© - ì„¤ì • ë®ì–´ì“°ê¸°\r\n   */\r\n  overrideConfigForTest(config: Partial<typeof this.config>): void {\r\n    Object.assign(this.config, config);\r\n  }\r\n\r\n  /**\r\n   * í…ŒìŠ¤íŠ¸ìš© - ê¸°ë³¸ ì„¤ì •ìœ¼ë¡œ ì¬ì„¤ì •\r\n   */\r\n  resetConfigForTest(): void {\r\n    this.config.minEaseFactor = 1.3;\r\n    this.config.maxEaseFactor = 2.5;\r\n    this.config.initialEaseFactor = 1.8;\r\n    this.config.maxInterval = 10;\r\n  }\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\srs\\algorithms\\SuperMemoSM2.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\srs\\algorithms\\SuperMemoSM2Strategy.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\srs\\config\\DefaultConfigProvider.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\srs\\config\\MockConfigProvider.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\srs\\container\\SRSContainer.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\srs\\engines\\ModularSRSEngine.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'cardId' is defined but never used. Allowed unused args must match /^_/u.","line":183,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":183,"endColumn":20}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * ëª¨ë“ˆí˜• SRS ì—”ì§„ - ëŠìŠ¨í•œ ê²°í•© êµ¬í˜„\r\n * ì˜ì¡´ì„± ì£¼ì…ì„ í†µí•´ ëª¨ë“  êµ¬ì„±ìš”ì†Œë¥¼ êµì²´ ê°€ëŠ¥\r\n * \r\n * ê¸°ì¡´ SRSEngine.tsë¥¼ ëŒ€ì²´í•˜ëŠ” ìƒˆë¡œìš´ ì•„í‚¤í…ì²˜\r\n */\r\n\r\nimport { \r\n  ISRSEngine, \r\n  ISRSStorage, \r\n  ISRSAlgorithm, \r\n  ISRSConfigProvider,\r\n  ISRSEventBus,\r\n  ReviewCard, \r\n  ReviewSession, \r\n  SRSConfig, \r\n  SRSStats,\r\n  PerformanceAnalysis,\r\n  SRSEvent\r\n} from '../interfaces/ISRSEngine';\r\n\r\nexport class ModularSRSEngine implements ISRSEngine {\r\n  \r\n  constructor(\r\n    private storage: ISRSStorage,\r\n    private algorithm: ISRSAlgorithm,\r\n    private configProvider: ISRSConfigProvider,\r\n    private eventBus?: ISRSEventBus\r\n  ) {}\r\n\r\n  // ============= ì„¤ì • ê´€ë¦¬ =============\r\n  \r\n  getConfig(): SRSConfig {\r\n    return this.configProvider.getDefaultConfig();\r\n  }\r\n\r\n  updateConfig(config: Partial<SRSConfig>): void {\r\n    // ì„¤ì • ì—…ë°ì´íŠ¸ ë¡œì§\r\n    console.log('Updating SRS config:', config);\r\n    \r\n    try {\r\n      // configProviderë¥¼ í†µí•´ ë³€ê²½ì‚¬í•­ ì €ì¥\r\n      this.configProvider.updateConfig(config);\r\n      \r\n      // ì„¤ì • ë³€ê²½ ì´ë²¤íŠ¸ ë°œìƒ\r\n      this.emitEvent({\r\n        type: 'config_updated',\r\n        timestamp: new Date(),\r\n        data: { updatedFields: Object.keys(config), config }\r\n      });\r\n      \r\n      console.log('âœ… SRS config updated successfully');\r\n    } catch (error) {\r\n      console.error('âŒ Failed to update SRS config:', error);\r\n      this.emitEvent({\r\n        type: 'config_update_failed', \r\n        timestamp: new Date(),\r\n        data: { error: error.message, attemptedConfig: config }\r\n      });\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  // ============= ì¹´ë“œ ìƒëª…ì£¼ê¸° =============\r\n\r\n  createCard(content: ReviewCard['content']): ReviewCard {\r\n    const config = this.getConfig();\r\n    \r\n    const newCard: ReviewCard = {\r\n      id: this.generateCardId(),\r\n      content,\r\n      memory: {\r\n        strength: config.initialMemoryStrength,\r\n        easeFactor: config.initialEaseFactor,\r\n        interval: config.minInterval,\r\n        reviewCount: 0,\r\n        lastReviewed: new Date(),\r\n        nextReview: new Date(Date.now() + config.minInterval * 24 * 60 * 60 * 1000),\r\n        difficulty: 0.5\r\n      },\r\n      performance: {\r\n        accuracy: [],\r\n        responseTime: [],\r\n        streak: 0,\r\n        mistakes: 0\r\n      }\r\n    };\r\n\r\n    // ì´ë²¤íŠ¸ ë°œí–‰\r\n    this.emitEvent({\r\n      type: 'card_created',\r\n      timestamp: new Date(),\r\n      data: { card: newCard }\r\n    });\r\n\r\n    return newCard;\r\n  }\r\n\r\n  updateCard(card: ReviewCard, session: ReviewSession): ReviewCard {\r\n    const config = this.getConfig();\r\n    const quality = this.calculateQuality(session);\r\n    \r\n    // ì•Œê³ ë¦¬ì¦˜ì„ í†µí•œ ì—…ë°ì´íŠ¸ (Strategy Pattern)\r\n    const newInterval = this.algorithm.calculateNextInterval(\r\n      card.memory.interval,\r\n      card.memory.easeFactor,\r\n      quality,\r\n      card.memory.reviewCount\r\n    );\r\n\r\n    const newEaseFactor = this.algorithm.updateEaseFactor(\r\n      card.memory.easeFactor,\r\n      quality\r\n    );\r\n\r\n    const timeSinceLastReview = session.timestamp.getTime() - card.memory.lastReviewed.getTime();\r\n    const newStrength = this.algorithm.updateMemoryStrength(\r\n      card.memory.strength,\r\n      quality,\r\n      timeSinceLastReview\r\n    );\r\n\r\n    // configë¥¼ í™œìš©í•œ ì¶”ê°€ ê²€ì¦ ë° ì¡°ì •\r\n    let adjustedInterval = newInterval;\r\n    if (config.minInterval && newInterval < config.minInterval) {\r\n      adjustedInterval = config.minInterval;\r\n      console.log(`Adjusted interval from ${newInterval} to ${adjustedInterval} (min constraint)`);\r\n    }\r\n    if (config.maxInterval && newInterval > config.maxInterval) {\r\n      adjustedInterval = config.maxInterval;\r\n      console.log(`Adjusted interval from ${newInterval} to ${adjustedInterval} (max constraint)`);\r\n    }\r\n\r\n    // timeSinceLastReviewë¥¼ í™œìš©í•œ ì§€ì—° íŒ¨ë„í‹° ì ìš©\r\n    const expectedReviewTime = card.memory.interval * 24 * 60 * 60 * 1000; // ë°€ë¦¬ì´ˆ ë³€í™˜\r\n    const reviewDelayRatio = timeSinceLastReview / expectedReviewTime;\r\n    \r\n    if (reviewDelayRatio > 1.5) { // ì˜ˆì •ë³´ë‹¤ 50% ì´ìƒ ëŠ¦ê²Œ ë³µìŠµ\r\n      const delayPenalty = Math.min(reviewDelayRatio - 1, 0.3); // ìµœëŒ€ 30% íŒ¨ë„í‹°\r\n      adjustedInterval = Math.round(adjustedInterval * (1 - delayPenalty));\r\n      console.log(`Applied delay penalty: ${(delayPenalty * 100).toFixed(1)}%, interval adjusted to ${adjustedInterval}`);\r\n    }\r\n\r\n    // ì„±ëŠ¥ íˆìŠ¤í† ë¦¬ ì—…ë°ì´íŠ¸\r\n    const updatedCard: ReviewCard = {\r\n      ...card,\r\n      memory: {\r\n        ...card.memory,\r\n        strength: newStrength,\r\n        easeFactor: newEaseFactor,\r\n        interval: adjustedInterval, // configì™€ ì§€ì—° íŒ¨ë„í‹°ê°€ ì ìš©ëœ ê°„ê²© ì‚¬ìš©\r\n        reviewCount: card.memory.reviewCount + 1,\r\n        lastReviewed: session.timestamp,\r\n        nextReview: new Date(session.timestamp.getTime() + adjustedInterval * 24 * 60 * 60 * 1000)\r\n      },\r\n      performance: {\r\n        accuracy: [...card.performance.accuracy.slice(-9), session.isCorrect ? 1 : 0],\r\n        responseTime: [...card.performance.responseTime.slice(-9), session.responseTime],\r\n        streak: session.isCorrect ? card.performance.streak + 1 : 0,\r\n        mistakes: session.isCorrect ? card.performance.mistakes : card.performance.mistakes + 1\r\n      }\r\n    };\r\n\r\n    // ë§ˆìŠ¤í„°ë¦¬ ì²´í¬\r\n    if (this.isMastered(updatedCard)) {\r\n      this.emitEvent({\r\n        type: 'card_mastered',\r\n        timestamp: new Date(),\r\n        data: { card: updatedCard }\r\n      });\r\n    }\r\n\r\n    // ë³µìŠµ ì´ë²¤íŠ¸ ë°œí–‰\r\n    this.emitEvent({\r\n      type: 'card_reviewed',\r\n      timestamp: new Date(),\r\n      data: { card: updatedCard, session }\r\n    });\r\n\r\n    return updatedCard;\r\n  }\r\n\r\n  deleteCard(cardId: string): boolean {\r\n    // êµ¬í˜„ì²´ì— ë”°ë¼ ë‹¤ë¥´ê²Œ ì²˜ë¦¬\r\n    // ì—¬ê¸°ì„œëŠ” ë…¼ë¦¬ì  ì‚­ì œë§Œ ìˆ˜í–‰\r\n    return true;\r\n  }\r\n\r\n  // ============= ë³µìŠµ ìŠ¤ì¼€ì¤„ë§ =============\r\n\r\n  getCardsForReview(cards: ReviewCard[]): ReviewCard[] {\r\n    const now = new Date();\r\n    \r\n    return cards\r\n      .filter(card => card.memory.nextReview <= now)\r\n      .sort((a, b) => {\r\n        // ìš°ì„ ìˆœìœ„ ì •ë ¬: ì˜¤ë˜ëœ ê²ƒë¶€í„°, ì–´ë ¤ìš´ ê²ƒë¶€í„°\r\n        const aOverdue = now.getTime() - a.memory.nextReview.getTime();\r\n        const bOverdue = now.getTime() - b.memory.nextReview.getTime();\r\n        \r\n        if (aOverdue !== bOverdue) {\r\n          return bOverdue - aOverdue; // ë” ì˜¤ë˜ëœ ê²ƒë¶€í„°\r\n        }\r\n        \r\n        return a.memory.easeFactor - b.memory.easeFactor; // ì–´ë ¤ìš´ ê²ƒë¶€í„°\r\n      });\r\n  }\r\n\r\n  calculateNextReview(card: ReviewCard, session: ReviewSession): Date {\r\n    const quality = this.calculateQuality(session);\r\n    const nextInterval = this.algorithm.calculateNextInterval(\r\n      card.memory.interval,\r\n      card.memory.easeFactor,\r\n      quality,\r\n      card.memory.reviewCount\r\n    );\r\n    \r\n    return new Date(session.timestamp.getTime() + nextInterval * 24 * 60 * 60 * 1000);\r\n  }\r\n\r\n  // ============= í†µê³„ ë° ë¶„ì„ =============\r\n\r\n  calculateStats(cards: ReviewCard[]): SRSStats {\r\n    const now = new Date();\r\n    const dueCards = cards.filter(card => card.memory.nextReview <= now);\r\n    const masteredCards = cards.filter(card => this.isMastered(card));\r\n    const learningCards = cards.filter(card => card.memory.reviewCount === 0);\r\n\r\n    const totalAccuracy = cards.reduce((sum, card) => {\r\n      const recentAccuracy = card.performance.accuracy.slice(-5);\r\n      return sum + (recentAccuracy.length > 0 \r\n        ? recentAccuracy.reduce((a, b) => a + b, 0) / recentAccuracy.length \r\n        : 0);\r\n    }, 0);\r\n\r\n    const totalResponseTime = cards.reduce((sum, card) => {\r\n      const recentResponseTime = card.performance.responseTime.slice(-5);\r\n      return sum + (recentResponseTime.length > 0\r\n        ? recentResponseTime.reduce((a, b) => a + b, 0) / recentResponseTime.length\r\n        : 0);\r\n    }, 0);\r\n\r\n    return {\r\n      totalCards: cards.length,\r\n      dueForReview: dueCards.length,\r\n      averageMemoryStrength: cards.reduce((sum, card) => sum + card.memory.strength, 0) / cards.length || 0,\r\n      masteredCards: masteredCards.length,\r\n      learningCards: learningCards.length,\r\n      avgAccuracy: totalAccuracy / cards.length || 0,\r\n      avgResponseTime: totalResponseTime / cards.length || 0\r\n    };\r\n  }\r\n\r\n  analyzePerformance(cards: ReviewCard[]): PerformanceAnalysis {\r\n    // íŒ¨í„´ë³„ ì„±ê³¼ ë¶„ì„\r\n    const patternStats = new Map<string, {correct: number, total: number}>();\r\n    \r\n    cards.forEach(card => {\r\n      const pattern = card.content.pattern || 'unknown';\r\n      const stats = patternStats.get(pattern) || {correct: 0, total: 0};\r\n      const recentAccuracy = card.performance.accuracy.slice(-5);\r\n      \r\n      stats.total += recentAccuracy.length;\r\n      stats.correct += recentAccuracy.reduce((sum, acc) => sum + acc, 0);\r\n      patternStats.set(pattern, stats);\r\n    });\r\n\r\n    const weakPatterns = Array.from(patternStats.entries())\r\n      .filter(([_, stats]) => stats.total >= 3 && (stats.correct / stats.total) < 0.6)\r\n      .map(([pattern]) => pattern);\r\n\r\n    const strongPatterns = Array.from(patternStats.entries())\r\n      .filter(([_, stats]) => stats.total >= 3 && (stats.correct / stats.total) > 0.8)\r\n      .map(([pattern]) => pattern);\r\n\r\n    // ì¶”ì²œ í¬ì»¤ìŠ¤ ê²°ì •\r\n    const avgAccuracy = cards.reduce((sum, card) => \r\n      sum + (card.performance.accuracy.slice(-5).reduce((a, b) => a + b, 0) / \r\n             Math.max(1, card.performance.accuracy.length)), 0) / cards.length;\r\n    \r\n    const avgResponseTime = cards.reduce((sum, card) => \r\n      sum + (card.performance.responseTime.slice(-5).reduce((a, b) => a + b, 0) / \r\n             Math.max(1, card.performance.responseTime.length)), 0) / cards.length;\r\n\r\n    let recommendedFocus: 'accuracy' | 'speed' | 'retention' = 'accuracy';\r\n    if (avgAccuracy > 0.8 && avgResponseTime > 10000) {\r\n      recommendedFocus = 'speed';\r\n    } else if (avgAccuracy > 0.8 && avgResponseTime < 5000) {\r\n      recommendedFocus = 'retention';\r\n    }\r\n\r\n    return {\r\n      weakPatterns,\r\n      strongPatterns,\r\n      recommendedFocus,\r\n      estimatedMasteryTime: this.estimateMasteryTime(cards)\r\n    };\r\n  }\r\n\r\n  // ============= private ë©”ì„œë“œë“¤ =============\r\n\r\n  private generateCardId(): string {\r\n    return `card_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n  }\r\n\r\n  private calculateQuality(session: ReviewSession): number {\r\n    // ê¸°ë³¸ì ìœ¼ë¡œ ì •í™•ë„ ê¸°ë°˜, í™•ì¥ ê°€ëŠ¥\r\n    return session.isCorrect ? 4 : 2;\r\n  }\r\n\r\n  private isMastered(card: ReviewCard): boolean {\r\n    return card.memory.strength > 0.9 && \r\n           card.memory.reviewCount >= 5 &&\r\n           card.performance.streak >= 3;\r\n  }\r\n\r\n  private estimateMasteryTime(cards: ReviewCard[]): number {\r\n    // ê°„ë‹¨í•œ ì¶”ì • ë¡œì§ (ì¼ ë‹¨ìœ„)\r\n    const notMastered = cards.filter(card => !this.isMastered(card));\r\n    const avgReviewsNeeded = 8; // í‰ê· ì ìœ¼ë¡œ 8ë²ˆ ë³µìŠµ í•„ìš”\r\n    const avgDaysPerReview = 3; // í‰ê·  3ì¼ë§ˆë‹¤ ë³µìŠµ\r\n    \r\n    return notMastered.length * avgReviewsNeeded * avgDaysPerReview;\r\n  }\r\n\r\n  private emitEvent(event: SRSEvent): void {\r\n    this.eventBus?.emit(event);\r\n  }\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\srs\\events\\SimpleEventBus.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\srs\\interfaces\\ISRSEngine.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\stageFocusMode.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'masteredCount' is defined but never used. Allowed unused args must match /^_/u.","line":459,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":459,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'sessionId' is defined but never used. Allowed unused args must match /^_/u.","line":480,"column":28,"nodeType":null,"messageId":"unusedVar","endLine":480,"endColumn":37}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Stage ì§‘ì¤‘ ëª¨ë“œ - ì •ë°€ ì—°ìŠµ ì„œë¹„ìŠ¤\r\n\r\nexport type SpeedLevel = 'slow' | 'medium' | 'fast';\r\nexport type RepeatCount = 5 | 6 | 7 | 8;\r\n\r\nexport interface StageFocusSettings {\r\n  level: number;\r\n  stage: number;\r\n  speedLevel: SpeedLevel; // 3ì´ˆ/2ì´ˆ/1ì´ˆ\r\n  repeatCount: RepeatCount; // 5-8ë¬¸ì¥\r\n  immediateCorrection: boolean; // ì˜¤ë‹µ ì‹œ ì¦‰ì‹œ ì •ë‹µ í‘œì‹œ\r\n  autoPlayCorrectAnswer: boolean; // ì •ë‹µ ìë™ ë°œí™”\r\n  shuffleQuestions: boolean; // ë¬¸ì¥ ìˆœì„œ ì„ê¸°\r\n}\r\n\r\nexport interface StageFocusQuestion {\r\n  id: string;\r\n  front_ko: string;\r\n  target_en: string;\r\n  difficulty: 'easy' | 'medium' | 'hard';\r\n  tags: string[];\r\n  repeatIndex: number; // ëª‡ ë²ˆì§¸ ë°˜ë³µì¸ì§€ (1-8)\r\n}\r\n\r\nexport interface StageFocusResult {\r\n  questionId: string;\r\n  repeatIndex: number;\r\n  userAnswer: string;\r\n  correctAnswer: string;\r\n  isCorrect: boolean;\r\n  responseTime: number;\r\n  needsReview: boolean; // ì¶”ê°€ ì—°ìŠµ í•„ìš” ì—¬ë¶€\r\n}\r\n\r\nexport interface StageFocusSession {\r\n  sessionId: string;\r\n  userId: string;\r\n  settings: StageFocusSettings;\r\n  questions: StageFocusQuestion[];\r\n  results: StageFocusResult[];\r\n  startTime: Date;\r\n  endTime?: Date;\r\n  totalAttempts: number;\r\n  correctAttempts: number;\r\n  averageResponseTime: number;\r\n  masteredQuestions: string[]; // ë§ˆìŠ¤í„°í•œ ë¬¸ì¥ë“¤\r\n  needsReviewQuestions: string[]; // ì¶”ê°€ ì—°ìŠµì´ í•„ìš”í•œ ë¬¸ì¥ë“¤\r\n}\r\n\r\nclass StageFocusService {\r\n  \r\n  /**\r\n   * Stage ì§‘ì¤‘ ëª¨ë“œ ì„¸ì…˜ ìƒì„±\r\n   */\r\n  async createStageFocusSession(\r\n    userId: string,\r\n    settings: StageFocusSettings\r\n  ): Promise<StageFocusSession> {\r\n    \r\n    try {\r\n      // í•´ë‹¹ ìŠ¤í…Œì´ì§€ì˜ ë¬¸ì¥ë“¤ ì¡°íšŒ\r\n      const originalQuestions = await this.getStageQuestions(settings.level, settings.stage);\r\n      \r\n      // repeatCountë§Œí¼ ë¬¸ì¥ ì„ íƒ (ëœë¤ ë˜ëŠ” ìˆœì„œëŒ€ë¡œ)\r\n      const selectedQuestions = this.selectQuestionsForPractice(originalQuestions, settings.repeatCount);\r\n      \r\n      // ë°˜ë³µ í•™ìŠµì„ ìœ„í•œ ì§ˆë¬¸ ìƒì„± (ê° ë¬¸ì¥ì„ ì—¬ëŸ¬ ë²ˆ ë°˜ë³µ)\r\n      const practiceQuestions = this.generatePracticeQuestions(selectedQuestions, settings);\r\n      \r\n      const session: StageFocusSession = {\r\n        sessionId: `stage-focus-${Date.now()}-${userId}`,\r\n        userId,\r\n        settings,\r\n        questions: practiceQuestions,\r\n        results: [],\r\n        startTime: new Date(),\r\n        totalAttempts: 0,\r\n        correctAttempts: 0,\r\n        averageResponseTime: 0,\r\n        masteredQuestions: [],\r\n        needsReviewQuestions: []\r\n      };\r\n      \r\n      return session;\r\n      \r\n    } catch (error) {\r\n      console.error('Stage ì§‘ì¤‘ ëª¨ë“œ ì„¸ì…˜ ìƒì„± ì‹¤íŒ¨:', error);\r\n      throw error;\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * íŠ¹ì • ìŠ¤í…Œì´ì§€ì˜ ë¬¸ì¥ë“¤ ì¡°íšŒ\r\n   */\r\n  private async getStageQuestions(level: number, stage: number): Promise<any[]> {\r\n    // ì‹¤ì œë¡œëŠ” Firestoreë‚˜ APIì—ì„œ ì¡°íšŒ\r\n    // ì„ì‹œ ë°ì´í„°\r\n    const mockQuestions = [\r\n      {\r\n        id: `Lv${level}-P1-S${stage.toString().padStart(2, '0')}_01`,\r\n        front_ko: 'ë‚´ì¼ ë¹„ê°€ ì˜¬ ê²ƒ ê°™ìŠµë‹ˆë‹¤.',\r\n        target_en: \"It's going to rain tomorrow.\",\r\n        difficulty: 'medium',\r\n        tags: ['future', 'weather']\r\n      },\r\n      {\r\n        id: `Lv${level}-P1-S${stage.toString().padStart(2, '0')}_02`,\r\n        front_ko: 'ë‹¤ìŒ ì£¼ì— ì—¬í–‰ì„ ê°ˆ ì˜ˆì •ì…ë‹ˆë‹¤.',\r\n        target_en: \"I'm going to travel next week.\",\r\n        difficulty: 'medium',\r\n        tags: ['future', 'travel']\r\n      },\r\n      {\r\n        id: `Lv${level}-P1-S${stage.toString().padStart(2, '0')}_03`,\r\n        front_ko: 'ì–¸ì  ê°€ëŠ” ì„±ê³µí•  ê²ƒì…ë‹ˆë‹¤.',\r\n        target_en: 'I will succeed someday.',\r\n        difficulty: 'hard',\r\n        tags: ['future', 'motivation']\r\n      },\r\n      {\r\n        id: `Lv${level}-P1-S${stage.toString().padStart(2, '0')}_04`,\r\n        front_ko: 'ì˜¤ëŠ˜ ì €ë…ì— ì¹œêµ¬ë¥¼ ë§Œë‚  ê±°ì˜ˆìš”.',\r\n        target_en: \"I'm meeting a friend tonight.\",\r\n        difficulty: 'easy',\r\n        tags: ['future', 'social']\r\n      },\r\n      {\r\n        id: `Lv${level}-P1-S${stage.toString().padStart(2, '0')}_05`,\r\n        front_ko: 'ê·¸ ì¼ì€ ì‰½ì§€ ì•Šì„ ê²ƒì…ë‹ˆë‹¤.',\r\n        target_en: \"It won't be easy.\",\r\n        difficulty: 'medium',\r\n        tags: ['future', 'difficulty']\r\n      },\r\n      {\r\n        id: `Lv${level}-P1-S${stage.toString().padStart(2, '0')}_06`,\r\n        front_ko: 'ê³„íšì„ ë°”ê¿€ ìƒê°ì…ë‹ˆë‹¤.',\r\n        target_en: \"I'm going to change the plan.\",\r\n        difficulty: 'medium',\r\n        tags: ['future', 'planning']\r\n      },\r\n      {\r\n        id: `Lv${level}-P1-S${stage.toString().padStart(2, '0')}_07`,\r\n        front_ko: 'íšŒì˜ëŠ” ì–¸ì œ ì‹œì‘í•  ì˜ˆì •ì¸ê°€ìš”?',\r\n        target_en: 'When is the meeting going to start?',\r\n        difficulty: 'hard',\r\n        tags: ['future', 'question', 'business']\r\n      },\r\n      {\r\n        id: `Lv${level}-P1-S${stage.toString().padStart(2, '0')}_08`,\r\n        front_ko: 'ê·¸ë“¤ì€ ê³§ ë„ì°©í•  ê²ƒì…ë‹ˆë‹¤.',\r\n        target_en: 'They will arrive soon.',\r\n        difficulty: 'easy',\r\n        tags: ['future', 'arrival']\r\n      }\r\n    ];\r\n    \r\n    return mockQuestions;\r\n  }\r\n  \r\n  /**\r\n   * ì—°ìŠµí•  ë¬¸ì¥ë“¤ ì„ íƒ\r\n   */\r\n  private selectQuestionsForPractice(questions: any[], count: RepeatCount): any[] {\r\n    if (questions.length <= count) {\r\n      return questions;\r\n    }\r\n    \r\n    // ë‚œì´ë„ë³„ ê· í˜• ì„ íƒ (ì‰¬ì›€:ë³´í†µ:ì–´ë ¤ì›€ = 2:3:3 ë¹„ìœ¨)\r\n    const easy = questions.filter(q => q.difficulty === 'easy');\r\n    const medium = questions.filter(q => q.difficulty === 'medium');\r\n    const hard = questions.filter(q => q.difficulty === 'hard');\r\n    \r\n    const selected = [];\r\n    const targetEasy = Math.min(Math.floor(count * 0.25), easy.length);\r\n    const targetMedium = Math.min(Math.floor(count * 0.4), medium.length);\r\n    const targetHard = Math.min(count - targetEasy - targetMedium, hard.length);\r\n    \r\n    // ëœë¤ ì„ íƒ\r\n    selected.push(...this.shuffleArray(easy).slice(0, targetEasy));\r\n    selected.push(...this.shuffleArray(medium).slice(0, targetMedium));\r\n    selected.push(...this.shuffleArray(hard).slice(0, targetHard));\r\n    \r\n    // ë¶€ì¡±í•œ ë§Œí¼ ë‚˜ë¨¸ì§€ì—ì„œ ì±„ìš°ê¸°\r\n    const remaining = count - selected.length;\r\n    if (remaining > 0) {\r\n      const allRemaining = questions.filter(q => !selected.includes(q));\r\n      selected.push(...this.shuffleArray(allRemaining).slice(0, remaining));\r\n    }\r\n    \r\n    return selected.slice(0, count);\r\n  }\r\n  \r\n  /**\r\n   * ë°˜ë³µ í•™ìŠµìš© ì§ˆë¬¸ ìƒì„±\r\n   */\r\n  private generatePracticeQuestions(\r\n    selectedQuestions: any[], \r\n    settings: StageFocusSettings\r\n  ): StageFocusQuestion[] {\r\n    \r\n    const practiceQuestions: StageFocusQuestion[] = [];\r\n    \r\n    // ê° ë¬¸ì¥ì„ 2-3ë²ˆ ë°˜ë³µí•˜ì—¬ ì´ ì—°ìŠµëŸ‰ í™•ë³´\r\n    const repetitionsPerQuestion = Math.ceil(15 / selectedQuestions.length); // ì´ 15ë²ˆ ì •ë„ ì—°ìŠµ\r\n    \r\n    for (let repeat = 1; repeat <= repetitionsPerQuestion; repeat++) {\r\n      for (const question of selectedQuestions) {\r\n        practiceQuestions.push({\r\n          id: question.id,\r\n          front_ko: question.front_ko,\r\n          target_en: question.target_en,\r\n          difficulty: question.difficulty,\r\n          tags: question.tags,\r\n          repeatIndex: repeat\r\n        });\r\n      }\r\n    }\r\n    \r\n    // ì„¤ì •ì— ë”°ë¼ ì„ê¸°\r\n    if (settings.shuffleQuestions) {\r\n      return this.shuffleArray(practiceQuestions);\r\n    }\r\n    \r\n    return practiceQuestions;\r\n  }\r\n  \r\n  /**\r\n   * ë‹µë³€ ì²˜ë¦¬ ë° ì¦‰ì‹œ í”¼ë“œë°±\r\n   */\r\n  async processAnswer(\r\n    sessionId: string,\r\n    question: StageFocusQuestion,\r\n    userAnswer: string,\r\n    responseTime: number\r\n  ): Promise<{\r\n    result: StageFocusResult;\r\n    feedback: {\r\n      isCorrect: boolean;\r\n      correctAnswer: string;\r\n      shouldPlayAudio: boolean;\r\n      encouragement: string;\r\n      needsRetry: boolean;\r\n    };\r\n  }> {\r\n    \r\n    try {\r\n      const isCorrect = this.validateAnswer(userAnswer, question.target_en);\r\n      \r\n      const result: StageFocusResult = {\r\n        questionId: question.id,\r\n        repeatIndex: question.repeatIndex,\r\n        userAnswer,\r\n        correctAnswer: question.target_en,\r\n        isCorrect,\r\n        responseTime,\r\n        needsReview: !isCorrect || responseTime > this.getTargetTime(question.difficulty)\r\n      };\r\n      \r\n      // ì¦‰ì‹œ í”¼ë“œë°± ìƒì„±\r\n      const feedback = {\r\n        isCorrect,\r\n        correctAnswer: question.target_en,\r\n        shouldPlayAudio: !isCorrect, // í‹€ë ¸ì„ ë•Œë§Œ ì •ë‹µ ë°œí™”\r\n        encouragement: this.generateEncouragement(isCorrect, question.repeatIndex),\r\n        needsRetry: !isCorrect && question.repeatIndex <= 2 // ì´ˆê¸° ë°˜ë³µì—ì„œ í‹€ë¦¬ë©´ ì¬ì‹œë„\r\n      };\r\n      \r\n      return { result, feedback };\r\n      \r\n    } catch (error) {\r\n      console.error('ë‹µë³€ ì²˜ë¦¬ ì‹¤íŒ¨:', error);\r\n      throw error;\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * ì„¸ì…˜ ì™„ë£Œ ë° ë§ˆìŠ¤í„° ë¶„ì„\r\n   */\r\n  async completeSession(sessionId: string): Promise<{\r\n    totalAccuracy: number;\r\n    averageResponseTime: number;\r\n    masteredQuestions: string[];\r\n    needsReviewQuestions: string[];\r\n    improvementAreas: string[];\r\n    nextStageRecommendation: string;\r\n    practiceEffectiveness: 'excellent' | 'good' | 'needs_work';\r\n  }> {\r\n    \r\n    try {\r\n      const session = await this.getSession(sessionId);\r\n      \r\n      if (!session) {\r\n        throw new Error('ì„¸ì…˜ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');\r\n      }\r\n      \r\n      const totalAttempts = session.results.length;\r\n      const correctAttempts = session.results.filter(r => r.isCorrect).length;\r\n      const totalAccuracy = (correctAttempts / totalAttempts) * 100;\r\n      \r\n      const averageResponseTime = session.results.reduce((sum, r) => sum + r.responseTime, 0) / totalAttempts;\r\n      \r\n      // ë¬¸ì¥ë³„ ë§ˆìŠ¤í„° ì—¬ë¶€ ë¶„ì„\r\n      const questionResults = this.groupResultsByQuestion(session.results);\r\n      const masteredQuestions: string[] = [];\r\n      const needsReviewQuestions: string[] = [];\r\n      \r\n      Object.entries(questionResults).forEach(([questionId, results]) => {\r\n        const accuracy = results.filter(r => r.isCorrect).length / results.length;\r\n        const avgResponseTime = results.reduce((sum, r) => sum + r.responseTime, 0) / results.length;\r\n        \r\n        if (accuracy >= 0.8 && avgResponseTime <= this.getTargetTime('medium')) {\r\n          masteredQuestions.push(questionId);\r\n        } else {\r\n          needsReviewQuestions.push(questionId);\r\n        }\r\n      });\r\n      \r\n      // ê°œì„  ì˜ì—­ ë¶„ì„\r\n      const incorrectResults = session.results.filter(r => !r.isCorrect);\r\n      const improvementTags = this.analyzeIncorrectPatterns(incorrectResults);\r\n      \r\n      // ì—°ìŠµ íš¨ê³¼ì„± í‰ê°€\r\n      let practiceEffectiveness: 'excellent' | 'good' | 'needs_work';\r\n      if (totalAccuracy >= 85 && averageResponseTime <= 4000) {\r\n        practiceEffectiveness = 'excellent';\r\n      } else if (totalAccuracy >= 70 && averageResponseTime <= 6000) {\r\n        practiceEffectiveness = 'good';\r\n      } else {\r\n        practiceEffectiveness = 'needs_work';\r\n      }\r\n      \r\n      // ë‹¤ìŒ ì¶”ì²œ\r\n      const nextStageRecommendation = this.generateNextRecommendation(\r\n        session.settings,\r\n        practiceEffectiveness,\r\n        masteredQuestions.length\r\n      );\r\n      \r\n      return {\r\n        totalAccuracy,\r\n        averageResponseTime,\r\n        masteredQuestions,\r\n        needsReviewQuestions,\r\n        improvementAreas: improvementTags,\r\n        nextStageRecommendation,\r\n        practiceEffectiveness\r\n      };\r\n      \r\n    } catch (error) {\r\n      console.error('ì„¸ì…˜ ì™„ë£Œ ì²˜ë¦¬ ì‹¤íŒ¨:', error);\r\n      throw error;\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * ì‚¬ìš© ê°€ëŠ¥í•œ ìŠ¤í…Œì´ì§€ ëª©ë¡ ì¡°íšŒ\r\n   */\r\n  async getAvailableStages(level: number): Promise<{\r\n    stages: Array<{\r\n      stage: number;\r\n      title: string;\r\n      difficulty: string;\r\n      questionCount: number;\r\n      completed: boolean;\r\n      lastPracticed?: Date;\r\n    }>;\r\n    totalStages: number;\r\n  }> {\r\n    \r\n    try {\r\n      // ì‹¤ì œë¡œëŠ” Firestoreì—ì„œ ì¡°íšŒ\r\n      // Level 3 ê¸°ì¤€ ì„ì‹œ ë°ì´í„°\r\n      const stages = Array.from({ length: 30 }, (_, i) => ({\r\n        stage: i + 1,\r\n        title: `Stage ${i + 1} - ${this.getStageTitle(level, i + 1)}`,\r\n        difficulty: i < 10 ? 'easy' : i < 20 ? 'medium' : 'hard',\r\n        questionCount: Math.floor(Math.random() * 20) + 30, // 30-50ê°œ\r\n        completed: Math.random() > 0.3, // 70% ì™„ë£Œ\r\n        lastPracticed: Math.random() > 0.5 ? new Date(Date.now() - Math.random() * 7 * 24 * 60 * 60 * 1000) : undefined\r\n      }));\r\n      \r\n      return {\r\n        stages,\r\n        totalStages: stages.length\r\n      };\r\n      \r\n    } catch (error) {\r\n      console.error('ìŠ¤í…Œì´ì§€ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨:', error);\r\n      throw error;\r\n    }\r\n  }\r\n  \r\n  // Private helper methods\r\n  \r\n  private shuffleArray<T>(array: T[]): T[] {\r\n    const shuffled = [...array];\r\n    for (let i = shuffled.length - 1; i > 0; i--) {\r\n      const j = Math.floor(Math.random() * (i + 1));\r\n      [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];\r\n    }\r\n    return shuffled;\r\n  }\r\n  \r\n  private validateAnswer(userAnswer: string, correctAnswer: string): boolean {\r\n    const normalize = (str: string) => str.toLowerCase().trim().replace(/[.,!?]/g, '');\r\n    return normalize(userAnswer) === normalize(correctAnswer);\r\n  }\r\n  \r\n  private getTargetTime(difficulty: 'easy' | 'medium' | 'hard'): number {\r\n    switch (difficulty) {\r\n      case 'easy': return 3000;\r\n      case 'medium': return 4000;\r\n      case 'hard': return 6000;\r\n      default: return 4000;\r\n    }\r\n  }\r\n  \r\n  private generateEncouragement(isCorrect: boolean, _repeatIndex: number): string {\r\n    if (isCorrect) {\r\n      const positive = [\r\n        'ì •í™•í•©ë‹ˆë‹¤! ğŸ‘',\r\n        'ì™„ë²½í•´ìš”! âœ¨',\r\n        'í›Œë¥­í•©ë‹ˆë‹¤! ğŸ‰',\r\n        'ì˜í•˜ê³  ìˆì–´ìš”! ğŸ’ª',\r\n        'ì¢‹ìŠµë‹ˆë‹¤! ğŸ‘'\r\n      ];\r\n      return positive[Math.floor(Math.random() * positive.length)];\r\n    } else {\r\n      const encouraging = [\r\n        'ë‹¤ì‹œ í•œë²ˆ ì‹œë„í•´ë³´ì„¸ìš”! ğŸ’ª',\r\n        'ê±°ì˜ ë‹¤ ì™”ì–´ìš”! ğŸ¯',\r\n        'ì¡°ê¸ˆ ë” ì—°ìŠµí•˜ë©´ ë©ë‹ˆë‹¤! ğŸ“š',\r\n        'í¬ê¸°í•˜ì§€ ë§ˆì„¸ìš”! ğŸŒŸ',\r\n        'ë‹¤ìŒë²ˆì—” ë” ì˜í•  ê±°ì˜ˆìš”! ğŸš€'\r\n      ];\r\n      return encouraging[Math.floor(Math.random() * encouraging.length)];\r\n    }\r\n  }\r\n  \r\n  private groupResultsByQuestion(results: StageFocusResult[]): Record<string, StageFocusResult[]> {\r\n    return results.reduce((groups, result) => {\r\n      if (!groups[result.questionId]) {\r\n        groups[result.questionId] = [];\r\n      }\r\n      groups[result.questionId].push(result);\r\n      return groups;\r\n    }, {} as Record<string, StageFocusResult[]>);\r\n  }\r\n  \r\n  private analyzeIncorrectPatterns(_incorrectResults: StageFocusResult[]): string[] {\r\n    // ê°„ë‹¨í•œ íŒ¨í„´ ë¶„ì„ (ì‹¤ì œë¡œëŠ” ë” ì •êµí•œ AI ë¶„ì„)\r\n    const patterns = ['future', 'grammar', 'vocabulary', 'structure'];\r\n    return patterns.slice(0, 2); // ì„ì‹œë¡œ 2ê°œ ë°˜í™˜\r\n  }\r\n  \r\n  private generateNextRecommendation(\r\n    settings: StageFocusSettings,\r\n    effectiveness: string,\r\n    masteredCount: number\r\n  ): string {\r\n    \r\n    if (effectiveness === 'excellent') {\r\n      return `ì™„ë²½í•œ ì„±ê³¼ì…ë‹ˆë‹¤! ë‹¤ìŒ ìŠ¤í…Œì´ì§€(Stage ${settings.stage + 1})ë¡œ ì§„í–‰í•˜ê±°ë‚˜ ì†ë„ë¥¼ ë†’ì—¬ë³´ì„¸ìš”.`;\r\n    } else if (effectiveness === 'good') {\r\n      return `ì¢‹ì€ ê²°ê³¼ì…ë‹ˆë‹¤! ê°™ì€ ìŠ¤í…Œì´ì§€ë¥¼ í•œ ë²ˆ ë” ì—°ìŠµí•˜ê±°ë‚˜ ë‹¤ìŒ ìŠ¤í…Œì´ì§€ë¡œ ì§„í–‰í•˜ì„¸ìš”.`;\r\n    } else {\r\n      return `ë” ì—°ìŠµì´ í•„ìš”í•©ë‹ˆë‹¤. ì†ë„ë¥¼ ë‚®ì¶”ê³  ê°™ì€ ìŠ¤í…Œì´ì§€ë¥¼ ë°˜ë³µ ì—°ìŠµí•´ë³´ì„¸ìš”.`;\r\n    }\r\n  }\r\n  \r\n  private getStageTitle(level: number, stage: number): string {\r\n    const titles = [\r\n      'Basic Patterns', 'Future Forms', 'Past Tense', 'Present Perfect',\r\n      'Conditionals', 'Passive Voice', 'Reported Speech', 'Modal Verbs',\r\n      'Relative Clauses', 'Advanced Grammar'\r\n    ];\r\n    return titles[(stage - 1) % titles.length];\r\n  }\r\n  \r\n  private async getSession(sessionId: string): Promise<StageFocusSession | null> {\r\n    // ì‹¤ì œë¡œëŠ” ì €ì¥ëœ ì„¸ì…˜ ì¡°íšŒ\r\n    return null; // ì„ì‹œ\r\n  }\r\n}\r\n\r\nexport const stageFocusService = new StageFocusService();","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\stageMetadataService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\statistics\\StatisticsCalculator.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'_error' is defined but never used.","line":43,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":43,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'today' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":179,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":179,"endColumn":16}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * í†µê³„ ê³„ì‚° ì„œë¹„ìŠ¤ êµ¬í˜„ì²´\n * @description ë‹¨ì¼ ì±…ì„ ì›ì¹™ - í†µê³„ ê³„ì‚°ë§Œì„ ë‹´ë‹¹\n */\n\nimport {\n  IStatisticsCalculator,\n  UserProgressData,\n  StatisticsMetrics,\n  LevelProgressData,\n  SessionRecord,\n  StatisticsError\n} from './types';\n\nexport class StatisticsCalculator implements IStatisticsCalculator {\n  private readonly TOTAL_LEVELS = 10;\n  private readonly LEVEL_STAGE_COUNTS: Record<number, number> = {\n    1: 19, 2: 30, 3: 44, 4: 32, 5: 30,\n    6: 44, 7: 42, 8: 50, 9: 48, 10: 50\n  };\n\n  /**\n   * ì „ì²´ í†µê³„ ë©”íŠ¸ë¦­ ê³„ì‚°\n   */\n  calculateOverallMetrics(userData: UserProgressData): StatisticsMetrics {\n    try {\n      const overallProgress = this.calculateOverallProgress(userData);\n      const averageAccuracy = this.calculateAverageAccuracy(userData.sessionHistory);\n      const incorrectCount = this.calculateIncorrectCount(userData.sessionHistory);\n      const streakDays = this.calculateStreakDays(userData.sessionHistory);\n      const totalStudyTime = this.calculateTotalStudyTime(userData.sessionHistory);\n      const weakAreas = this.identifyWeakAreas(userData.sessionHistory);\n\n      return {\n        overallProgress,\n        averageAccuracy,\n        incorrectCount,\n        currentLevel: userData.level,\n        streakDays,\n        totalStudyTime,\n        weakAreas\n      };\n    } catch (_error) {\n      throw new StatisticsError(\n        'Failed to calculate overall metrics',\n        'CALCULATION_ERROR',\n        userData.userId\n      );\n    }\n  }\n\n  /**\n   * ë ˆë²¨ë³„ ì§„í–‰ë¥  ê³„ì‚°\n   */\n  calculateLevelProgress(userData: UserProgressData, level: number): LevelProgressData {\n    if (level < 1 || level > this.TOTAL_LEVELS) {\n      throw new StatisticsError(\n        `Invalid level: ${level}`,\n        'INVALID_INPUT',\n        userData.userId\n      );\n    }\n\n    const totalStages = this.LEVEL_STAGE_COUNTS[level] || 0;\n    const levelSessions = userData.sessionHistory.filter(s => s.level === level);\n    const completedStages = new Set(levelSessions.map(s => s.stage)).size;\n    const progress = totalStages > 0 ? Math.round((completedStages / totalStages) * 100) : 0;\n    const bestAccuracy = levelSessions.length > 0 \n      ? Math.max(...levelSessions.map(s => s.accuracy))\n      : 0;\n\n    return {\n      level,\n      progress,\n      bestAccuracy: Math.round(bestAccuracy),\n      completedStages,\n      totalStages\n    };\n  }\n\n  /**\n   * ì •í™•ë„ íŠ¸ë Œë“œ ê³„ì‚° (ìµœê·¼ Nì¼)\n   */\n  calculateAccuracyTrend(sessionHistory: SessionRecord[], days: number): number[] {\n    const now = new Date();\n    const cutoffDate = new Date(now.getTime() - (days * 24 * 60 * 60 * 1000));\n    \n    const recentSessions = sessionHistory.filter(session => \n      new Date(session.completedAt) >= cutoffDate\n    );\n\n    if (recentSessions.length === 0) return [];\n\n    // ë‚ ì§œë³„ë¡œ ê·¸ë£¹í™”í•˜ê³  í‰ê·  ê³„ì‚°\n    const dailyAccuracy: Record<string, number[]> = {};\n    recentSessions.forEach(session => {\n      const dateKey = new Date(session.completedAt).toDateString();\n      if (!dailyAccuracy[dateKey]) dailyAccuracy[dateKey] = [];\n      dailyAccuracy[dateKey].push(session.accuracy);\n    });\n\n    return Object.values(dailyAccuracy).map(accuracyList =>\n      Math.round(accuracyList.reduce((sum, acc) => sum + acc, 0) / accuracyList.length)\n    );\n  }\n\n  /**\n   * ì•½ì  ì˜ì—­ ì‹ë³„\n   */\n  identifyWeakAreas(sessionHistory: SessionRecord[]): string[] {\n    if (sessionHistory.length === 0) return [];\n\n    const levelAccuracy: Record<number, number[]> = {};\n    sessionHistory.forEach(session => {\n      if (!levelAccuracy[session.level]) levelAccuracy[session.level] = [];\n      levelAccuracy[session.level].push(session.accuracy);\n    });\n\n    const weakLevels: string[] = [];\n    Object.entries(levelAccuracy).forEach(([level, accuracyList]) => {\n      const avgAccuracy = accuracyList.reduce((sum, acc) => sum + acc, 0) / accuracyList.length;\n      if (avgAccuracy < 70) { // 70% ë¯¸ë§Œì„ ì•½ì ìœ¼ë¡œ íŒë‹¨\n        weakLevels.push(`Level ${level}`);\n      }\n    });\n\n    return weakLevels;\n  }\n\n  /**\n   * ì „ì²´ ì§„í–‰ë¥  ê³„ì‚° (Private)\n   */\n  private calculateOverallProgress(userData: UserProgressData): number {\n    const totalPossibleStages = Object.values(this.LEVEL_STAGE_COUNTS)\n      .reduce((sum, count) => sum + count, 0);\n    \n    const completedStages = new Set(\n      userData.sessionHistory.map(session => `${session.level}-${session.stage}`)\n    ).size;\n\n    return totalPossibleStages > 0 \n      ? Math.round((completedStages / totalPossibleStages) * 100) \n      : 0;\n  }\n\n  /**\n   * í‰ê·  ì •í™•ë„ ê³„ì‚° (Private)\n   */\n  private calculateAverageAccuracy(sessionHistory: SessionRecord[]): number {\n    if (sessionHistory.length === 0) return 0;\n    \n    const totalAccuracy = sessionHistory.reduce((sum, session) => sum + session.accuracy, 0);\n    return Math.round(totalAccuracy / sessionHistory.length);\n  }\n\n  /**\n   * í‹€ë¦° ë¬¸ì œ ìˆ˜ ê³„ì‚° (Private)\n   */\n  private calculateIncorrectCount(sessionHistory: SessionRecord[]): number {\n    return sessionHistory.reduce((total, session) => \n      total + (session.totalCards - session.correctAnswers), 0\n    );\n  }\n\n  /**\n   * ì—°ì† í•™ìŠµ ì¼ìˆ˜ ê³„ì‚° (Private)\n   */\n  private calculateStreakDays(sessionHistory: SessionRecord[]): number {\n    if (sessionHistory.length === 0) return 0;\n\n    const sortedSessions = sessionHistory\n      .sort((a, b) => new Date(b.completedAt).getTime() - new Date(a.completedAt).getTime());\n\n    const uniqueDates = [...new Set(\n      sortedSessions.map(session => new Date(session.completedAt).toDateString())\n    )];\n\n    let streak = 0;\n    const today = new Date().toDateString();\n    \n    for (let i = 0; i < uniqueDates.length; i++) {\n      const date = new Date(uniqueDates[i]);\n      const expectedDate = new Date();\n      expectedDate.setDate(expectedDate.getDate() - i);\n      \n      if (date.toDateString() === expectedDate.toDateString()) {\n        streak++;\n      } else {\n        break;\n      }\n    }\n\n    return streak;\n  }\n\n  /**\n   * ì´ í•™ìŠµ ì‹œê°„ ê³„ì‚° (Private)\n   */\n  private calculateTotalStudyTime(sessionHistory: SessionRecord[]): number {\n    return Math.round(\n      sessionHistory.reduce((total, session) => total + session.timeSpent, 0) / 60\n    ); // ì´ˆë¥¼ ë¶„ìœ¼ë¡œ ë³€í™˜\n  }\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\statistics\\StatisticsServiceFactory.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\statistics\\UserDataRepository.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\statistics\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\statistics\\types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\timers\\TimerManager.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'id' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":129,"column":17,"nodeType":null,"messageId":"unusedVar","endLine":129,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'id' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":160,"column":17,"nodeType":null,"messageId":"unusedVar","endLine":160,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * TimerManager - íƒ€ì´ë¨¸ ë¼ì´í”„ì‚¬ì´í´ ê´€ë¦¬ ëª¨ë“ˆ\r\n * \r\n * ì—­í• :\r\n * - ëª¨ë“  íƒ€ì´ë¨¸ì˜ ì¤‘ì•™ì§‘ì¤‘ì‹ ê´€ë¦¬\r\n * - íƒ€ì´ë¨¸ ì¤‘ë³µ ì‹¤í–‰ ë°©ì§€\r\n * - ì»´í¬ë„ŒíŠ¸ ì–¸ë§ˆìš´íŠ¸ì‹œ ìë™ ì •ë¦¬\r\n * - ì¼ì‹œì •ì§€/ì¬ê°œ ê¸°ëŠ¥ í†µí•© ê´€ë¦¬\r\n */\r\n\r\nexport type TimerType = 'countdown' | 'recognition' | 'waiting' | 'tts';\r\n\r\nexport interface TimerConfig {\r\n  id: string;\r\n  type: TimerType;\r\n  interval: number; // milliseconds\r\n  callback: (remainingTime: number) => void;\r\n  onComplete?: () => void;\r\n}\r\n\r\nexport interface TimerState {\r\n  id: string;\r\n  type: TimerType;\r\n  intervalId: number | null;\r\n  startTime: number;\r\n  duration: number;\r\n  remainingTime: number;\r\n  isPaused: boolean;\r\n  isActive: boolean;\r\n}\r\n\r\nclass TimerManager {\r\n  private timers: Map<string, TimerState> = new Map();\r\n  private static instance: TimerManager | null = null;\r\n\r\n  // Singleton pattern\r\n  static getInstance(): TimerManager {\r\n    if (!TimerManager.instance) {\r\n      TimerManager.instance = new TimerManager();\r\n    }\r\n    return TimerManager.instance;\r\n  }\r\n\r\n  /**\r\n   * ìƒˆë¡œìš´ íƒ€ì´ë¨¸ ì‹œì‘\r\n   */\r\n  startTimer(config: TimerConfig, duration: number): void {\r\n    // ê¸°ì¡´ íƒ€ì´ë¨¸ê°€ ìˆìœ¼ë©´ ì¤‘ì§€\r\n    this.stopTimer(config.id);\r\n\r\n    const now = Date.now();\r\n    const state: TimerState = {\r\n      id: config.id,\r\n      type: config.type,\r\n      intervalId: null,\r\n      startTime: now,\r\n      duration: duration * 1000, // convert to ms\r\n      remainingTime: duration,\r\n      isPaused: false,\r\n      isActive: true\r\n    };\r\n\r\n    // ì´ˆê¸° ìƒíƒœ ì½œë°± ì‹¤í–‰ (3ì´ˆë¶€í„° ì‹œì‘)\r\n    config.callback(state.remainingTime);\r\n\r\n    // íƒ€ì´ë¨¸ ì‹¤í–‰\r\n    state.intervalId = window.setInterval(() => {\r\n      this.tick(config.id, config);\r\n    }, config.interval);\r\n\r\n    this.timers.set(config.id, state);\r\n    console.log(`â° [TimerManager] íƒ€ì´ë¨¸ ì‹œì‘: ${config.id} (${duration}ì´ˆ)`);\r\n  }\r\n\r\n  /**\r\n   * íƒ€ì´ë¨¸ ì¤‘ì§€\r\n   */\r\n  stopTimer(id: string): boolean {\r\n    const state = this.timers.get(id);\r\n    if (!state) return false;\r\n\r\n    if (state.intervalId !== null) {\r\n      clearInterval(state.intervalId);\r\n    }\r\n\r\n    this.timers.delete(id);\r\n    console.log(`ğŸ›‘ [TimerManager] íƒ€ì´ë¨¸ ì¤‘ì§€: ${id}`);\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * íƒ€ì´ë¨¸ ì¼ì‹œì •ì§€\r\n   */\r\n  pauseTimer(id: string): boolean {\r\n    const state = this.timers.get(id);\r\n    if (!state || state.isPaused) return false;\r\n\r\n    if (state.intervalId !== null) {\r\n      clearInterval(state.intervalId);\r\n      state.intervalId = null;\r\n    }\r\n\r\n    state.isPaused = true;\r\n    console.log(`â¸ï¸ [TimerManager] íƒ€ì´ë¨¸ ì¼ì‹œì •ì§€: ${id}`);\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * íƒ€ì´ë¨¸ ì¬ê°œ\r\n   */\r\n  resumeTimer(id: string, config: TimerConfig): boolean {\r\n    const state = this.timers.get(id);\r\n    if (!state || !state.isPaused) return false;\r\n\r\n    // ë‚¨ì€ ì‹œê°„ìœ¼ë¡œ ë‹¤ì‹œ ì‹œì‘\r\n    state.intervalId = window.setInterval(() => {\r\n      this.tick(id, config);\r\n    }, config.interval);\r\n\r\n    state.isPaused = false;\r\n    console.log(`â–¶ï¸ [TimerManager] íƒ€ì´ë¨¸ ì¬ê°œ: ${id} (ë‚¨ì€ì‹œê°„: ${state.remainingTime}ì´ˆ)`);\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * íŠ¹ì • íƒ€ì…ì˜ ëª¨ë“  íƒ€ì´ë¨¸ ì¼ì‹œì •ì§€\r\n   */\r\n  pauseAllTimers(type?: TimerType): void {\r\n    for (const [id, state] of this.timers.entries()) {\r\n      if (!type || state.type === type) {\r\n        if (state.intervalId !== null) {\r\n          clearInterval(state.intervalId);\r\n          state.intervalId = null;\r\n          state.isPaused = true;\r\n        }\r\n      }\r\n    }\r\n    console.log(`â¸ï¸ [TimerManager] ëª¨ë“  ${type || ''} íƒ€ì´ë¨¸ ì¼ì‹œì •ì§€`);\r\n  }\r\n\r\n  /**\r\n   * íŠ¹ì • íƒ€ì…ì˜ ëª¨ë“  íƒ€ì´ë¨¸ ì¬ê°œ\r\n   */\r\n  resumeAllTimers(type?: TimerType, configs?: Map<string, TimerConfig>): void {\r\n    for (const [id, state] of this.timers.entries()) {\r\n      if ((!type || state.type === type) && state.isPaused) {\r\n        const config = configs?.get(id);\r\n        if (config) {\r\n          this.resumeTimer(id, config);\r\n        }\r\n      }\r\n    }\r\n    console.log(`â–¶ï¸ [TimerManager] ëª¨ë“  ${type || ''} íƒ€ì´ë¨¸ ì¬ê°œ`);\r\n  }\r\n\r\n  /**\r\n   * ëª¨ë“  íƒ€ì´ë¨¸ ì •ë¦¬\r\n   */\r\n  clearAllTimers(): void {\r\n    for (const [id, state] of this.timers.entries()) {\r\n      if (state.intervalId !== null) {\r\n        clearInterval(state.intervalId);\r\n      }\r\n    }\r\n    this.timers.clear();\r\n    console.log(`ğŸ§¹ [TimerManager] ëª¨ë“  íƒ€ì´ë¨¸ ì •ë¦¬ ì™„ë£Œ`);\r\n  }\r\n\r\n  /**\r\n   * íƒ€ì´ë¨¸ ìƒíƒœ ì¡°íšŒ\r\n   */\r\n  getTimerState(id: string): TimerState | null {\r\n    return this.timers.get(id) || null;\r\n  }\r\n\r\n  /**\r\n   * í™œì„± íƒ€ì´ë¨¸ ëª©ë¡\r\n   */\r\n  getActiveTimers(): TimerState[] {\r\n    return Array.from(this.timers.values()).filter(state => state.isActive);\r\n  }\r\n\r\n  /**\r\n   * íƒ€ì´ë¨¸ í‹± ì²˜ë¦¬\r\n   */\r\n  private tick(id: string, config: TimerConfig): void {\r\n    const state = this.timers.get(id);\r\n    if (!state || state.isPaused) return;\r\n\r\n    state.remainingTime -= 1;\r\n\r\n    // ì½œë°± ì‹¤í–‰\r\n    config.callback(state.remainingTime);\r\n\r\n    // ì™„ë£Œ ì²˜ë¦¬\r\n    if (state.remainingTime <= 0) {\r\n      if (state.intervalId !== null) {\r\n        clearInterval(state.intervalId);\r\n        state.intervalId = null;\r\n      }\r\n      \r\n      state.isActive = false;\r\n      \r\n      // ì™„ë£Œ ì½œë°± ì‹¤í–‰\r\n      if (config.onComplete) {\r\n        config.onComplete();\r\n      }\r\n      \r\n      // íƒ€ì´ë¨¸ ì œê±°\r\n      this.timers.delete(id);\r\n      console.log(`âœ… [TimerManager] íƒ€ì´ë¨¸ ì™„ë£Œ: ${id}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ë””ë²„ê·¸ ì •ë³´\r\n   */\r\n  debug(): void {\r\n    console.log(`ğŸ” [TimerManager] í™œì„± íƒ€ì´ë¨¸: ${this.timers.size}ê°œ`);\r\n    for (const [id, state] of this.timers.entries()) {\r\n      console.log(`  - ${id}: ${state.type} (ë‚¨ì€ì‹œê°„: ${state.remainingTime}ì´ˆ, ì¼ì‹œì •ì§€: ${state.isPaused})`);\r\n    }\r\n  }\r\n}\r\n\r\nexport default TimerManager;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\vocabularyService.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'userStage' is defined but never used. Allowed unused args must match /^_/u.","line":335,"column":49,"nodeType":null,"messageId":"unusedVar","endLine":335,"endColumn":58}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * vocabularyService - íŒ¨í„´ ë°ì´í„°ì—ì„œ ë‹¨ì–´ ì¶”ì¶œ ë° ê´€ë¦¬ ì„œë¹„ìŠ¤\r\n * - ë ˆë²¨ë³„ íŒ¨í„´ íŒŒì¼ì—ì„œ ë‹¨ì–´ ìë™ ì¶”ì¶œ\r\n * - ì‚¬ìš©ì í•™ìŠµ ì§„ë„ì— ë§ëŠ” ë‹¨ì–´ì¥ ì œê³µ\r\n * - ë‹¨ì–´ í•™ìŠµ ìƒíƒœ ê´€ë¦¬ ë° ë³µìŠµ ì¶”ì²œ\r\n */\r\n\r\nexport interface VocabularyWord {\r\n  id: string;\r\n  word: string;\r\n  translation: string;\r\n  level: number;\r\n  stage?: number;\r\n  category: 'pronoun' | 'verb' | 'adjective' | 'noun' | 'adverb' | 'preposition' | 'other';\r\n  difficulty: 'basic' | 'intermediate' | 'advanced';\r\n  frequency: number; // íŒ¨í„´ì—ì„œ ë“±ì¥ ë¹ˆë„\r\n  examples: {\r\n    sentence: string;\r\n    translation: string;\r\n    stageId: string;\r\n  }[];\r\n  firstAppeared: string; // ì²˜ìŒ ë“±ì¥í•œ ìŠ¤í…Œì´ì§€ ID\r\n}\r\n\r\nexport interface UserVocabularyProgress {\r\n  wordId: string;\r\n  status: 'unknown' | 'learning' | 'known' | 'review';\r\n  lastStudied?: Date;\r\n  correctCount: number;\r\n  wrongCount: number;\r\n  isFavorite: boolean;\r\n  nextReviewDate?: Date; // SRS ê¸°ë°˜ ë³µìŠµì¼\r\n}\r\n\r\nexport interface VocabularyStats {\r\n  totalWords: number;\r\n  knownWords: number;\r\n  learningWords: number;\r\n  reviewWords: number;\r\n  newWords: number;\r\n  completionRate: number;\r\n}\r\n\r\nclass VocabularyService {\r\n  private vocabularyCache = new Map<string, VocabularyWord[]>();\r\n  private userProgressCache = new Map<string, UserVocabularyProgress>();\r\n\r\n  /**\r\n   * ì˜ì–´ ë¬¸ì¥ì—ì„œ ë‹¨ì–´ ì¶”ì¶œ ë° ë¶„ë¥˜\r\n   */\r\n  private extractWordsFromSentence(sentence: string): Array<{ word: string; category: string }> {\r\n    // ë¬¸ì¥ ì •ë¦¬: êµ¬ë‘ì  ì œê±°, ì†Œë¬¸ì ë³€í™˜\r\n    const cleanSentence = sentence.toLowerCase()\r\n      .replace(/[^\\w\\s']/g, ' ')\r\n      .replace(/\\s+/g, ' ')\r\n      .trim();\r\n\r\n    const words = cleanSentence.split(' ').filter(word => word.length > 0);\r\n    \r\n    return words.map(word => ({\r\n      word: word.replace(/'/g, ''), // don't -> dont\r\n      category: this.categorizeWord(word)\r\n    }));\r\n  }\r\n\r\n  /**\r\n   * ë‹¨ì–´ ì¹´í…Œê³ ë¦¬ ë¶„ë¥˜ (ê¸°ë³¸ì ì¸ ê·œì¹™ ê¸°ë°˜)\r\n   */\r\n  private categorizeWord(word: string): VocabularyWord['category'] {\r\n    const cleanWord = word.toLowerCase().replace(/'/g, '');\r\n    \r\n    // ëŒ€ëª…ì‚¬\r\n    const pronouns = ['i', 'you', 'he', 'she', 'it', 'we', 'they', 'my', 'your', 'his', 'her', 'its', 'our', 'their'];\r\n    if (pronouns.includes(cleanWord)) return 'pronoun';\r\n    \r\n    // Be ë™ì‚¬ ë° ê¸°ë³¸ ë™ì‚¬\r\n    const verbs = ['am', 'is', 'are', 'was', 'were', 'be', 'been', 'being', 'have', 'has', 'had', 'do', 'does', 'did', 'will', 'would', 'can', 'could', 'should', 'may', 'might'];\r\n    if (verbs.includes(cleanWord)) return 'verb';\r\n    \r\n    // í˜„ì¬ì§„í–‰í˜• ë™ì‚¬ (-ing)\r\n    if (cleanWord.endsWith('ing')) return 'verb';\r\n    \r\n    // ê³¼ê±°í˜• ë™ì‚¬ (-ed)\r\n    if (cleanWord.endsWith('ed')) return 'verb';\r\n    \r\n    // í˜•ìš©ì‚¬ (ì¼ë°˜ì ì¸ íŒ¨í„´)\r\n    const adjectives = ['happy', 'sad', 'big', 'small', 'good', 'bad', 'new', 'old', 'young', 'tall', 'short', 'smart', 'kind', 'pretty', 'tired', 'strong', 'quiet', 'brave', 'funny', 'honest', 'nice', 'fast', 'safe', 'normal', 'special', 'important'];\r\n    if (adjectives.includes(cleanWord)) return 'adjective';\r\n    \r\n    // ì „ì¹˜ì‚¬\r\n    const prepositions = ['in', 'on', 'at', 'to', 'for', 'with', 'by', 'from', 'of', 'about', 'into', 'through', 'during', 'before', 'after', 'above', 'below', 'under', 'over'];\r\n    if (prepositions.includes(cleanWord)) return 'preposition';\r\n    \r\n    // ë¶€ì‚¬ (ì¼ë°˜ì ì¸ íŒ¨í„´)\r\n    if (cleanWord.endsWith('ly')) return 'adverb';\r\n    const adverbs = ['now', 'here', 'there', 'today', 'tomorrow', 'yesterday', 'always', 'never', 'sometimes', 'often', 'usually'];\r\n    if (adverbs.includes(cleanWord)) return 'adverb';\r\n    \r\n    // ë‚˜ë¨¸ì§€ëŠ” ëª…ì‚¬ë¡œ ë¶„ë¥˜\r\n    return 'noun';\r\n  }\r\n\r\n  /**\r\n   * ë‹¨ì–´ ë‚œì´ë„ ê²°ì •\r\n   */\r\n  private determineDifficulty(word: string, level: number, frequency: number): VocabularyWord['difficulty'] {\r\n    // ë ˆë²¨ê³¼ ë¹ˆë„ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë‚œì´ë„ ê²°ì •\r\n    if (level <= 2 && frequency >= 5) return 'basic';\r\n    if (level <= 5 && frequency >= 3) return 'intermediate';\r\n    return 'advanced';\r\n  }\r\n\r\n  /**\r\n   * íŠ¹ì • ë ˆë²¨ì˜ íŒ¨í„´ íŒŒì¼ì—ì„œ ë‹¨ì–´ ì¶”ì¶œ\r\n   */\r\n  async extractVocabularyFromLevel(level: number): Promise<VocabularyWord[]> {\r\n    const cacheKey = `level_${level}`;\r\n    if (this.vocabularyCache.has(cacheKey)) {\r\n      return this.vocabularyCache.get(cacheKey)!;\r\n    }\r\n\r\n    try {\r\n      console.log(`ğŸ” Level ${level} ë‹¨ì–´ ì¶”ì¶œ ì‹œì‘...`);\r\n      \r\n      // ë ˆë²¨ ë‚´ ëª¨ë“  ìŠ¤í…Œì´ì§€ íŒŒì¼ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°\r\n      const stageFiles = await this.getStageFilesForLevel(level);\r\n      if (stageFiles.length === 0) {\r\n        console.warn(`Level ${level} ìŠ¤í…Œì´ì§€ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.`);\r\n        return [];\r\n      }\r\n\r\n      const wordFrequency = new Map<string, number>();\r\n      const wordExamples = new Map<string, VocabularyWord['examples']>();\r\n      const wordFirstAppeared = new Map<string, string>();\r\n      const wordCategories = new Map<string, VocabularyWord['category']>();\r\n\r\n      // ê° ìŠ¤í…Œì´ì§€ íŒŒì¼ì—ì„œ ë‹¨ì–´ ì¶”ì¶œ\r\n      for (const stageFile of stageFiles) {\r\n        try {\r\n          // console.log(`ğŸ“„ ${stageFile} ì²˜ë¦¬ ì¤‘...`); // ë¡œê·¸ ì œê±°\r\n          const stageResponse = await fetch(`/patterns/banks/level_${level}/${stageFile}`);\r\n          if (!stageResponse.ok) {\r\n            console.warn(`íŒŒì¼ ${stageFile} ë¡œë“œ ì‹¤íŒ¨: ${stageResponse.status}`);\r\n            continue;\r\n          }\r\n\r\n          const stageData = await stageResponse.json();\r\n          \r\n          // ì•ˆì „ ê²€ì‚¬\r\n          if (!stageData || !Array.isArray(stageData.sentences)) {\r\n            console.warn(`íŒŒì¼ ${stageFile}ì˜ ë°ì´í„° êµ¬ì¡°ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.`);\r\n            continue;\r\n          }\r\n          \r\n          // ë¬¸ì¥ë“¤ì—ì„œ ë‹¨ì–´ ì¶”ì¶œ\r\n          for (const sentence of stageData.sentences) {\r\n            if (!sentence || !sentence.en || typeof sentence.en !== 'string') {\r\n              continue;\r\n            }\r\n\r\n            const extractedWords = this.extractWordsFromSentence(sentence.en);\r\n            \r\n            for (const { word, category } of extractedWords) {\r\n              if (!word || word.length < 2) continue; // ë„ˆë¬´ ì§§ì€ ë‹¨ì–´ ì œì™¸\r\n              \r\n              // ë¹ˆë„ìˆ˜ ì¦ê°€\r\n              wordFrequency.set(word, (wordFrequency.get(word) || 0) + 1);\r\n              \r\n              // ì¹´í…Œê³ ë¦¬ ì €ì¥ (ì²« ë²ˆì§¸ë¡œ ë°œê²¬ëœ ì¹´í…Œê³ ë¦¬ë¥¼ ì‚¬ìš©)\r\n              if (!wordCategories.has(word)) {\r\n                wordCategories.set(word, category);\r\n              }\r\n              \r\n              // ì²˜ìŒ ë“±ì¥ ìœ„ì¹˜ ê¸°ë¡\r\n              if (!wordFirstAppeared.has(word)) {\r\n                wordFirstAppeared.set(word, stageData.stage_id || `Lv${level}-Unknown`);\r\n              }\r\n              \r\n              // ì˜ˆë¬¸ ì¶”ê°€ (ìµœëŒ€ 3ê°œê¹Œì§€)\r\n              if (!wordExamples.has(word)) {\r\n                wordExamples.set(word, []);\r\n              }\r\n              \r\n              const examples = wordExamples.get(word)!;\r\n              if (examples.length < 3 && sentence.kr) {\r\n                examples.push({\r\n                  sentence: sentence.en,\r\n                  translation: sentence.kr,\r\n                  stageId: stageData.stage_id || `Lv${level}-Unknown`\r\n                });\r\n              }\r\n            }\r\n          }\r\n        } catch (error) {\r\n          console.warn(`ìŠ¤í…Œì´ì§€ íŒŒì¼ ${stageFile} ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜:`, error);\r\n        }\r\n      }\r\n\r\n      // VocabularyWord ê°ì²´ ìƒì„±\r\n      const vocabularyWords: VocabularyWord[] = Array.from(wordFrequency.entries()).map(([word, frequency]) => ({\r\n        id: `${level}_${word}`,\r\n        word,\r\n        translation: this.getKoreanTranslation(word), // ê°„ë‹¨í•œ ë²ˆì—­ (ì‹¤ì œë¡œëŠ” ë²ˆì—­ API ë˜ëŠ” ì‚¬ì „ í•„ìš”)\r\n        level,\r\n        category: wordCategories.get(word) || 'other',\r\n        difficulty: this.determineDifficulty(word, level, frequency),\r\n        frequency,\r\n        examples: wordExamples.get(word) || [],\r\n        firstAppeared: wordFirstAppeared.get(word) || `Lv${level}-Unknown`\r\n      }));\r\n\r\n      // ë¹ˆë„ìˆœìœ¼ë¡œ ì •ë ¬\r\n      vocabularyWords.sort((a, b) => b.frequency - a.frequency);\r\n\r\n      // ìºì‹œì— ì €ì¥\r\n      this.vocabularyCache.set(cacheKey, vocabularyWords);\r\n      \r\n      console.log(`âœ… Level ${level} ë‹¨ì–´ ${vocabularyWords.length}ê°œ ì¶”ì¶œ ì™„ë£Œ`);\r\n      return vocabularyWords;\r\n    } catch (error) {\r\n      console.error(`Level ${level} ë‹¨ì–´ ì¶”ì¶œ ì˜¤ë¥˜:`, error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ë ˆë²¨ë³„ ìŠ¤í…Œì´ì§€ íŒŒì¼ ëª©ë¡ ê°€ì ¸ì˜¤ê¸° (ì‹¤ì œ ì¡´ì¬í•˜ëŠ” íŒŒì¼ ê¸°ì¤€)\r\n   */\r\n  private async getStageFilesForLevel(level: number): Promise<string[]> {\r\n    const files: string[] = [];\r\n    \r\n    // ì‹¤ì œ ì¡´ì¬í•˜ëŠ” íŒŒì¼ë“¤ì„ ê¸°ì¤€ìœ¼ë¡œ í•˜ë“œì½”ë”©\r\n    if (level === 1) {\r\n      files.push(\r\n        'Lv1-P1-S01_bank.json',\r\n        'Lv1-P1-S02_bank.json',\r\n        'Lv1-P1-S03_bank.json',\r\n        'Lv1-P1-S04_bank.json',\r\n        'Lv1-P2-S05_bank.json',\r\n        'Lv1-P2-S06_bank.json',\r\n        'Lv1-P2-S07_bank.json',\r\n        'Lv1-P2-S08_bank.json',\r\n        'Lv1-P3-S09_bank.json',\r\n        'Lv1-P3-S10_bank.json',\r\n        'Lv1-P3-S11_bank.json',\r\n        'Lv1-P3-S12_bank.json',\r\n        'Lv1-P4-S13_bank.json',\r\n        'Lv1-P4-S14_bank.json',\r\n        'Lv1-P4-S15_bank.json',\r\n        'Lv1-P4-S16_bank.json'\r\n      );\r\n    } else if (level === 2) {\r\n      files.push(\r\n        'Lv2-P1-S01_bank.json',\r\n        'Lv2-P1-S02_bank.json',\r\n        'Lv2-P1-S03_bank.json',\r\n        'Lv2-P1-S04_bank.json',\r\n        'Lv2-P2-S05_bank.json',\r\n        'Lv2-P2-S06_bank.json',\r\n        'Lv2-P2-S07_bank.json',\r\n        'Lv2-P2-S08_bank.json',\r\n        'Lv2-P3-S09_bank.json',\r\n        'Lv2-P3-S10_bank.json',\r\n        'Lv2-P3-S11_bank.json',\r\n        'Lv2-P3-S12_bank.json',\r\n        'Lv2-P4-S13_bank.json',\r\n        'Lv2-P4-S14_bank.json',\r\n        'Lv2-P4-S15_bank.json',\r\n        'Lv2-P4-S16_bank.json',\r\n        'Lv2-P5-S17_bank.json',\r\n        'Lv2-P5-S18_bank.json',\r\n        'Lv2-P5-S19_bank.json',\r\n        'Lv2-P5-S20_bank.json'\r\n      );\r\n    }\r\n    // Level 3 ì´ìƒì€ ì¼ë¶€ë§Œ ì¶”ê°€ (ì‹¤ì œ íŒŒì¼ ê¸°ì¤€)\r\n    else if (level === 3) {\r\n      files.push(\r\n        'Lv3-P1-S02_bank.json',\r\n        'Lv3-P1-S03_bank.json',\r\n        'Lv3-P2-S07_bank.json',\r\n        'Lv3-P2-S08_bank.json',\r\n        'Lv3-P2-S10_bank.json'\r\n      );\r\n    }\r\n    \r\n    return files;\r\n  }\r\n\r\n  /**\r\n   * ê°„ë‹¨í•œ ì˜-í•œ ë²ˆì—­ (ì‹¤ì œë¡œëŠ” ë²ˆì—­ ì‚¬ì „ì´ë‚˜ API í•„ìš”)\r\n   */\r\n  private getKoreanTranslation(word: string): string {\r\n    const translations: Record<string, string> = {\r\n      // ëŒ€ëª…ì‚¬\r\n      'i': 'ë‚˜', 'you': 'ë„ˆ/ë‹¹ì‹ ', 'he': 'ê·¸', 'she': 'ê·¸ë…€', 'it': 'ê·¸ê²ƒ',\r\n      'we': 'ìš°ë¦¬', 'they': 'ê·¸ë“¤',\r\n      \r\n      // Be ë™ì‚¬\r\n      'am': '~ì´ë‹¤', 'is': '~ì´ë‹¤', 'are': '~ì´ë‹¤',\r\n      \r\n      // í˜•ìš©ì‚¬\r\n      'happy': 'í–‰ë³µí•œ', 'sad': 'ìŠ¬í”ˆ', 'big': 'í°', 'small': 'ì‘ì€',\r\n      'good': 'ì¢‹ì€', 'bad': 'ë‚˜ìœ', 'new': 'ìƒˆë¡œìš´', 'old': 'ì˜¤ë˜ëœ',\r\n      'young': 'ì Šì€', 'tall': 'í‚¤ í°', 'short': 'ì§§ì€', 'smart': 'ë˜‘ë˜‘í•œ',\r\n      'kind': 'ì¹œì ˆí•œ', 'pretty': 'ì˜ˆìœ', 'tired': 'í”¼ê³¤í•œ', 'strong': 'ê°•í•œ',\r\n      'quiet': 'ì¡°ìš©í•œ', 'brave': 'ìš©ê°í•œ', 'funny': 'ì¬ë¯¸ìˆëŠ”',\r\n      'honest': 'ì •ì§í•œ', 'nice': 'ì¢‹ì€', 'fast': 'ë¹ ë¥¸', 'safe': 'ì•ˆì „í•œ',\r\n      'normal': 'ì •ìƒì ì¸', 'special': 'íŠ¹ë³„í•œ', 'important': 'ì¤‘ìš”í•œ',\r\n      \r\n      // ì§ì—…\r\n      'student': 'í•™ìƒ', 'teacher': 'ì„ ìƒë‹˜', 'doctor': 'ì˜ì‚¬',\r\n      'cook': 'ìš”ë¦¬ì‚¬', 'driver': 'ìš´ì „ì', 'farmer': 'ë†ë¶€',\r\n      'writer': 'ì‘ê°€', 'singer': 'ê°€ìˆ˜', 'painter': 'í™”ê°€',\r\n      'actor': 'ë°°ìš°', 'scientist': 'ê³¼í•™ì',\r\n      \r\n      // ëª…ì‚¬\r\n      'friend': 'ì¹œêµ¬', 'book': 'ì±…', 'pencil': 'ì—°í•„', 'computer': 'ì»´í“¨í„°',\r\n      'family': 'ê°€ì¡±', 'chair': 'ì˜ì', 'team': 'íŒ€', 'ball': 'ê³µ',\r\n      \r\n      // ë™ì‚¬\r\n      'eating': 'ë¨¹ëŠ”', 'studying': 'ê³µë¶€í•˜ëŠ”', 'playing': 'ë†€ê³  ìˆëŠ”',\r\n      'working': 'ì¼í•˜ëŠ”', 'reading': 'ì½ëŠ”', 'running': 'ë›°ëŠ”',\r\n      \r\n      // ì‹œê°„/ì¥ì†Œ\r\n      'now': 'ì§€ê¸ˆ', 'today': 'ì˜¤ëŠ˜', 'park': 'ê³µì›', 'lunch': 'ì ì‹¬'\r\n    };\r\n    \r\n    return translations[word.toLowerCase()] || word; // ë²ˆì—­ì´ ì—†ìœ¼ë©´ ì›ë¬¸ ë°˜í™˜\r\n  }\r\n\r\n  /**\r\n   * ì‚¬ìš©ìì˜ í•™ìŠµ ì§„ë„ì— ë§ëŠ” ë‹¨ì–´ì¥ ê°€ì ¸ì˜¤ê¸°\r\n   */\r\n  async getVocabularyForUser(userLevel: number, userStage: number | 'ALL'): Promise<VocabularyWord[]> {\r\n    const allWords: VocabularyWord[] = [];\r\n    \r\n    // ì‚¬ìš©ì ë ˆë²¨ê¹Œì§€ì˜ ëª¨ë“  ë‹¨ì–´ ìˆ˜ì§‘\r\n    for (let level = 1; level <= userLevel; level++) {\r\n      const levelWords = await this.extractVocabularyFromLevel(level);\r\n      allWords.push(...levelWords);\r\n    }\r\n    \r\n    // ì¤‘ë³µ ì œê±° (ê°™ì€ ë‹¨ì–´ê°€ ì—¬ëŸ¬ ë ˆë²¨ì—ì„œ ë‚˜ì˜¬ ìˆ˜ ìˆìŒ)\r\n    const uniqueWords = new Map<string, VocabularyWord>();\r\n    for (const word of allWords) {\r\n      if (!uniqueWords.has(word.word) || uniqueWords.get(word.word)!.level > word.level) {\r\n        uniqueWords.set(word.word, word);\r\n      }\r\n    }\r\n    \r\n    return Array.from(uniqueWords.values()).sort((a, b) => b.frequency - a.frequency);\r\n  }\r\n\r\n  /**\r\n   * ë‹¨ì–´ í•™ìŠµ í†µê³„ ê³„ì‚°\r\n   */\r\n  calculateVocabularyStats(vocabularyWords: VocabularyWord[], userProgress: UserVocabularyProgress[]): VocabularyStats {\r\n    const progressMap = new Map<string, UserVocabularyProgress>();\r\n    userProgress.forEach(p => progressMap.set(p.wordId, p));\r\n    \r\n    let knownWords = 0;\r\n    let learningWords = 0;\r\n    let reviewWords = 0;\r\n    let newWords = 0;\r\n    \r\n    vocabularyWords.forEach(word => {\r\n      const progress = progressMap.get(word.id);\r\n      if (!progress) {\r\n        newWords++;\r\n      } else {\r\n        switch (progress.status) {\r\n          case 'known': knownWords++; break;\r\n          case 'learning': learningWords++; break;\r\n          case 'review': reviewWords++; break;\r\n          case 'unknown': newWords++; break;\r\n        }\r\n      }\r\n    });\r\n    \r\n    return {\r\n      totalWords: vocabularyWords.length,\r\n      knownWords,\r\n      learningWords,\r\n      reviewWords,\r\n      newWords,\r\n      completionRate: vocabularyWords.length > 0 ? Math.round((knownWords / vocabularyWords.length) * 100) : 0\r\n    };\r\n  }\r\n}\r\n\r\nexport const vocabularyService = new VocabularyService();\r\nexport default vocabularyService;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\webSpeechAPI.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\services\\writingMode.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'question' is defined but never used. Allowed unused args must match /^_/u.","line":220,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":220,"endColumn":13}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Writing ëª¨ë“œ - í‚¤ë³´ë“œ ì…ë ¥, ë¬¸ë²•/ë§ì¶¤ë²• ì²´í¬, ì •í™•ì„± ê°•í™”\r\n\r\nexport interface WritingFeedback {\r\n  isCorrect: boolean;\r\n  originalInput: string;\r\n  correctedText: string;\r\n  grammarErrors: GrammarError[];\r\n  spellingErrors: SpellingError[];\r\n  suggestions: WritingSuggestion[];\r\n  score: number; // 0-100\r\n  explanation: string;\r\n}\r\n\r\nexport interface GrammarError {\r\n  type: 'grammar' | 'punctuation' | 'structure' | 'tense' | 'article';\r\n  position: { start: number; end: number };\r\n  original: string;\r\n  corrected: string;\r\n  rule: string;\r\n  explanation: string;\r\n}\r\n\r\nexport interface SpellingError {\r\n  position: { start: number; end: number };\r\n  original: string;\r\n  suggestions: string[];\r\n  confidence: number;\r\n}\r\n\r\nexport interface WritingSuggestion {\r\n  type: 'alternative' | 'improvement' | 'style' | 'vocabulary';\r\n  original: string;\r\n  suggested: string;\r\n  reason: string;\r\n  priority: 'high' | 'medium' | 'low';\r\n}\r\n\r\nexport interface WritingSession {\r\n  sessionId: string;\r\n  userId: string;\r\n  questions: WritingQuestion[];\r\n  results: WritingResult[];\r\n  startTime: Date;\r\n  endTime?: Date;\r\n  totalScore: number;\r\n  accuracyRate: number;\r\n  commonMistakes: string[];\r\n}\r\n\r\nexport interface WritingQuestion {\r\n  id: string;\r\n  front_ko: string;\r\n  target_en: string;\r\n  level: number;\r\n  stage: number;\r\n  difficulty: 'easy' | 'medium' | 'hard';\r\n  grammarFocus: string[];\r\n  vocabularyFocus: string[];\r\n}\r\n\r\nexport interface WritingResult {\r\n  questionId: string;\r\n  userInput: string;\r\n  feedback: WritingFeedback;\r\n  timeSpent: number;\r\n  attemptsCount: number;\r\n  finalScore: number;\r\n}\r\n\r\nclass WritingModeService {\r\n  \r\n  /**\r\n   * ì‚¬ìš©ì ì…ë ¥ì— ëŒ€í•œ ìƒì„¸ í”¼ë“œë°± ìƒì„±\r\n   */\r\n  async generateWritingFeedback(\r\n    userInput: string,\r\n    targetAnswer: string,\r\n    question: WritingQuestion\r\n  ): Promise<WritingFeedback> {\r\n    \r\n    try {\r\n      // 1. ê¸°ë³¸ ì •í™•ì„± ì²´í¬\r\n      const isCorrect = this.checkBasicCorrectness(userInput, targetAnswer);\r\n      \r\n      // 2. ë¬¸ë²• ì˜¤ë¥˜ ê²€ì¶œ\r\n      const grammarErrors = await this.detectGrammarErrors(userInput, targetAnswer);\r\n      \r\n      // 3. ë§ì¶¤ë²• ì˜¤ë¥˜ ê²€ì¶œ\r\n      const spellingErrors = await this.detectSpellingErrors(userInput);\r\n      \r\n      // 4. ê°œì„  ì œì•ˆ ìƒì„±\r\n      const suggestions = await this.generateSuggestions(userInput, targetAnswer, question);\r\n      \r\n      // 5. ì ìˆ˜ ê³„ì‚°\r\n      const score = this.calculateWritingScore(userInput, targetAnswer, grammarErrors, spellingErrors);\r\n      \r\n      // 6. ìƒì„¸ ì„¤ëª… ìƒì„±\r\n      const explanation = this.generateExplanation(userInput, targetAnswer, grammarErrors, suggestions);\r\n      \r\n      return {\r\n        isCorrect,\r\n        originalInput: userInput,\r\n        correctedText: this.generateCorrectedText(userInput, grammarErrors, spellingErrors),\r\n        grammarErrors,\r\n        spellingErrors,\r\n        suggestions,\r\n        score,\r\n        explanation\r\n      };\r\n      \r\n    } catch (error) {\r\n      console.error('Writing í”¼ë“œë°± ìƒì„± ì‹¤íŒ¨:', error);\r\n      throw error;\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * ë¬¸ë²• ì˜¤ë¥˜ ê²€ì¶œ (ë£° ê¸°ë°˜ + AI ë³´ì¡°)\r\n   */\r\n  private async detectGrammarErrors(userInput: string, _targetAnswer: string): Promise<GrammarError[]> {\r\n    const errors: GrammarError[] = [];\r\n    \r\n    // ê¸°ë³¸ì ì¸ ë¬¸ë²• ë£° ì²´í¬\r\n    const rules = [\r\n      // beë™ì‚¬ ì˜¤ë¥˜\r\n      {\r\n        pattern: /\\b(I|You|We|They)\\s+(is)\\b/gi,\r\n        type: 'grammar' as const,\r\n        rule: 'Subject-Verb Agreement',\r\n        fix: (match: string) => match.replace(/is/gi, 'are')\r\n      },\r\n      // ë‹¨ìˆ˜/ë³µìˆ˜ ì˜¤ë¥˜\r\n      {\r\n        pattern: /\\b(a|an)\\s+(\\w+s)\\b/gi,\r\n        type: 'grammar' as const,\r\n        rule: 'Article-Noun Agreement',\r\n        fix: (match: string) => match.replace(/s$/, '')\r\n      },\r\n      // ì‹œì œ ì˜¤ë¥˜ (ê°„ë‹¨í•œ ì˜ˆì‹œ)\r\n      {\r\n        pattern: /\\byesterday\\s+.*\\b(will|going\\s+to)\\b/gi,\r\n        type: 'tense' as const,\r\n        rule: 'Past Time + Future Tense Mismatch',\r\n        fix: (match: string) => match.replace(/(will|going\\s+to)/gi, 'went')\r\n      },\r\n      // ê´€ì‚¬ ì˜¤ë¥˜\r\n      {\r\n        pattern: /\\b(a)\\s+([aeiou])/gi,\r\n        type: 'article' as const,\r\n        rule: 'Article Before Vowel',\r\n        fix: (match: string) => match.replace(/^a\\s+/, 'an ')\r\n      }\r\n    ];\r\n    \r\n    rules.forEach(rule => {\r\n      let match;\r\n      while ((match = rule.pattern.exec(userInput)) !== null) {\r\n        const start = match.index;\r\n        const end = start + match[0].length;\r\n        \r\n        errors.push({\r\n          type: rule.type,\r\n          position: { start, end },\r\n          original: match[0],\r\n          corrected: rule.fix(match[0]),\r\n          rule: rule.rule,\r\n          explanation: this.getGrammarExplanation(rule.rule)\r\n        });\r\n      }\r\n    });\r\n    \r\n    return errors;\r\n  }\r\n  \r\n  /**\r\n   * ë§ì¶¤ë²• ì˜¤ë¥˜ ê²€ì¶œ\r\n   */\r\n  private async detectSpellingErrors(userInput: string): Promise<SpellingError[]> {\r\n    const errors: SpellingError[] = [];\r\n    \r\n    // ê°„ë‹¨í•œ ë§ì¶¤ë²• ì‚¬ì „ (ì‹¤ì œë¡œëŠ” ë” í° ì‚¬ì „ ì‚¬ìš©)\r\n    const commonMisspellings: Record<string, string[]> = {\r\n      'recieve': ['receive'],\r\n      'seperate': ['separate'],\r\n      'occurence': ['occurrence'],\r\n      'neccessary': ['necessary'],\r\n      'beleive': ['believe'],\r\n      'achive': ['achieve'],\r\n      'begining': ['beginning'],\r\n      'definately': ['definitely'],\r\n      'intresting': ['interesting'],\r\n      'exersise': ['exercise']\r\n    };\r\n    \r\n    const words = userInput.toLowerCase().match(/\\b\\w+\\b/g) || [];\r\n    \r\n    words.forEach((word, _index) => {\r\n      if (commonMisspellings[word]) {\r\n        const start = userInput.toLowerCase().indexOf(word);\r\n        const end = start + word.length;\r\n        \r\n        errors.push({\r\n          position: { start, end },\r\n          original: word,\r\n          suggestions: commonMisspellings[word],\r\n          confidence: 0.8\r\n        });\r\n      }\r\n    });\r\n    \r\n    return errors;\r\n  }\r\n  \r\n  /**\r\n   * ê°œì„  ì œì•ˆ ìƒì„±\r\n   */\r\n  private async generateSuggestions(\r\n    userInput: string,\r\n    targetAnswer: string,\r\n    question: WritingQuestion\r\n  ): Promise<WritingSuggestion[]> {\r\n    \r\n    const suggestions: WritingSuggestion[] = [];\r\n    \r\n    // ëŒ€ì•ˆ í‘œí˜„ ì œì•ˆ\r\n    if (userInput.toLowerCase() !== targetAnswer.toLowerCase()) {\r\n      suggestions.push({\r\n        type: 'alternative',\r\n        original: userInput,\r\n        suggested: targetAnswer,\r\n        reason: 'ë” ìì—°ìŠ¤ëŸ¬ìš´ ì˜ì–´ í‘œí˜„ì…ë‹ˆë‹¤',\r\n        priority: 'high'\r\n      });\r\n    }\r\n    \r\n    // ì–´íœ˜ ê°œì„  ì œì•ˆ\r\n    const basicToAdvanced: Record<string, string> = {\r\n      'good': 'excellent, outstanding, remarkable',\r\n      'bad': 'terrible, awful, disappointing',\r\n      'big': 'huge, enormous, massive',\r\n      'small': 'tiny, miniature, compact',\r\n      'very': 'extremely, incredibly, remarkably',\r\n      'get': 'obtain, acquire, receive',\r\n      'make': 'create, produce, generate',\r\n      'do': 'perform, execute, accomplish'\r\n    };\r\n    \r\n    Object.entries(basicToAdvanced).forEach(([basic, advanced]) => {\r\n      if (userInput.toLowerCase().includes(basic.toLowerCase())) {\r\n        suggestions.push({\r\n          type: 'vocabulary',\r\n          original: basic,\r\n          suggested: advanced,\r\n          reason: 'ë” ê³ ê¸‰ ì–´íœ˜ë¥¼ ì‚¬ìš©í•´ë³´ì„¸ìš”',\r\n          priority: 'medium'\r\n        });\r\n      }\r\n    });\r\n    \r\n    return suggestions;\r\n  }\r\n  \r\n  /**\r\n   * Writing ì ìˆ˜ ê³„ì‚°\r\n   */\r\n  private calculateWritingScore(\r\n    userInput: string,\r\n    targetAnswer: string,\r\n    grammarErrors: GrammarError[],\r\n    spellingErrors: SpellingError[]\r\n  ): number {\r\n    \r\n    let score = 100;\r\n    \r\n    // ë¬¸ë²• ì˜¤ë¥˜ ê°ì \r\n    score -= grammarErrors.length * 15;\r\n    \r\n    // ë§ì¶¤ë²• ì˜¤ë¥˜ ê°ì \r\n    score -= spellingErrors.length * 10;\r\n    \r\n    // ì •í™•ë„ ë³´ë„ˆìŠ¤/ê°ì \r\n    const similarity = this.calculateSimilarity(userInput, targetAnswer);\r\n    if (similarity >= 0.9) score += 10;\r\n    else if (similarity < 0.5) score -= 20;\r\n    \r\n    // ê¸¸ì´ ì°¨ì´ ê°ì \r\n    const lengthDiff = Math.abs(userInput.length - targetAnswer.length) / targetAnswer.length;\r\n    if (lengthDiff > 0.5) score -= 10;\r\n    \r\n    return Math.max(0, Math.min(100, Math.round(score)));\r\n  }\r\n  \r\n  /**\r\n   * êµì •ëœ í…ìŠ¤íŠ¸ ìƒì„±\r\n   */\r\n  private generateCorrectedText(\r\n    userInput: string,\r\n    grammarErrors: GrammarError[],\r\n    spellingErrors: SpellingError[]\r\n  ): string {\r\n    \r\n    let corrected = userInput;\r\n    \r\n    // ë¬¸ë²• ì˜¤ë¥˜ë¶€í„° ìˆ˜ì • (ë’¤ì—ì„œë¶€í„° ìˆ˜ì •í•˜ì—¬ ì¸ë±ìŠ¤ ë³€í™” ë°©ì§€)\r\n    [...grammarErrors]\r\n      .sort((a, b) => b.position.start - a.position.start)\r\n      .forEach(error => {\r\n        corrected = corrected.substring(0, error.position.start) +\r\n                   error.corrected +\r\n                   corrected.substring(error.position.end);\r\n      });\r\n    \r\n    // ë§ì¶¤ë²• ì˜¤ë¥˜ ìˆ˜ì •\r\n    [...spellingErrors]\r\n      .sort((a, b) => b.position.start - a.position.start)\r\n      .forEach(error => {\r\n        if (error.suggestions.length > 0) {\r\n          corrected = corrected.substring(0, error.position.start) +\r\n                     error.suggestions[0] +\r\n                     corrected.substring(error.position.end);\r\n        }\r\n      });\r\n    \r\n    return corrected;\r\n  }\r\n  \r\n  /**\r\n   * ìƒì„¸ ì„¤ëª… ìƒì„±\r\n   */\r\n  private generateExplanation(\r\n    userInput: string,\r\n    targetAnswer: string,\r\n    grammarErrors: GrammarError[],\r\n    suggestions: WritingSuggestion[]\r\n  ): string {\r\n    \r\n    let explanation = '';\r\n    \r\n    if (grammarErrors.length > 0) {\r\n      explanation += 'ğŸ“ **ë¬¸ë²• ê°œì„ ì :**\\n';\r\n      grammarErrors.forEach((error, index) => {\r\n        explanation += `${index + 1}. ${error.rule}: \"${error.original}\" â†’ \"${error.corrected}\"\\n   ${error.explanation}\\n\\n`;\r\n      });\r\n    }\r\n    \r\n    if (suggestions.length > 0) {\r\n      explanation += 'ğŸ’¡ **ê°œì„  ì œì•ˆ:**\\n';\r\n      suggestions.slice(0, 3).forEach((suggestion, index) => {\r\n        explanation += `${index + 1}. ${suggestion.reason}\\n   \"${suggestion.original}\" â†’ \"${suggestion.suggested}\"\\n\\n`;\r\n      });\r\n    }\r\n    \r\n    if (userInput.trim().toLowerCase() === targetAnswer.trim().toLowerCase()) {\r\n      explanation += 'âœ… **ì™„ë²½í•©ë‹ˆë‹¤!** ë¬¸ë²•ê³¼ ë§ì¶¤ë²•ì´ ëª¨ë‘ ì •í™•í•©ë‹ˆë‹¤.';\r\n    }\r\n    \r\n    return explanation || 'ì¢‹ì€ ì‹œë„ì…ë‹ˆë‹¤! ê³„ì† ì—°ìŠµí•˜ì„¸ìš”.';\r\n  }\r\n  \r\n  /**\r\n   * í—¬í¼ ë©”ì„œë“œë“¤\r\n   */\r\n  private checkBasicCorrectness(userInput: string, targetAnswer: string): boolean {\r\n    const normalize = (str: string) => str.toLowerCase().trim().replace(/[.,!?]/g, '');\r\n    return normalize(userInput) === normalize(targetAnswer);\r\n  }\r\n  \r\n  private calculateSimilarity(str1: string, str2: string): number {\r\n    const longer = str1.length > str2.length ? str1 : str2;\r\n    const shorter = str1.length > str2.length ? str2 : str1;\r\n    \r\n    if (longer.length === 0) return 1.0;\r\n    \r\n    const editDistance = this.levenshteinDistance(longer, shorter);\r\n    return (longer.length - editDistance) / longer.length;\r\n  }\r\n  \r\n  private levenshteinDistance(str1: string, str2: string): number {\r\n    const matrix = Array(str2.length + 1).fill(null).map(() => Array(str1.length + 1).fill(null));\r\n    \r\n    for (let i = 0; i <= str1.length; i++) matrix[0][i] = i;\r\n    for (let j = 0; j <= str2.length; j++) matrix[j][0] = j;\r\n    \r\n    for (let j = 1; j <= str2.length; j++) {\r\n      for (let i = 1; i <= str1.length; i++) {\r\n        const indicator = str1[i - 1] === str2[j - 1] ? 0 : 1;\r\n        matrix[j][i] = Math.min(\r\n          matrix[j][i - 1] + 1,\r\n          matrix[j - 1][i] + 1,\r\n          matrix[j - 1][i - 1] + indicator\r\n        );\r\n      }\r\n    }\r\n    \r\n    return matrix[str2.length][str1.length];\r\n  }\r\n  \r\n  private getGrammarExplanation(rule: string): string {\r\n    const explanations: Record<string, string> = {\r\n      'Subject-Verb Agreement': 'ì£¼ì–´ì™€ ë™ì‚¬ì˜ ìˆ˜ê°€ ì¼ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤. I/You/We/TheyëŠ” areì„ ì‚¬ìš©í•©ë‹ˆë‹¤.',\r\n      'Article-Noun Agreement': 'ë¶€ì •ê´€ì‚¬ a/an ë’¤ì—ëŠ” ë‹¨ìˆ˜ëª…ì‚¬ê°€ ì™€ì•¼ í•©ë‹ˆë‹¤.',\r\n      'Past Time + Future Tense Mismatch': 'ê³¼ê±° ì‹œê°„ í‘œí˜„ê³¼ í•¨ê»˜ ë¯¸ë˜ ì‹œì œë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.',\r\n      'Article Before Vowel': 'ëª¨ìŒìœ¼ë¡œ ì‹œì‘í•˜ëŠ” ë‹¨ì–´ ì•ì—ëŠ” \"an\"ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.'\r\n    };\r\n    \r\n    return explanations[rule] || 'ë¬¸ë²• ê·œì¹™ì„ í™•ì¸í•´ë³´ì„¸ìš”.';\r\n  }\r\n  \r\n  /**\r\n   * ë ˆë²¨ë³„ ë§ì¶¤ í”¼ë“œë°± ìƒì„±\r\n   */\r\n  async generateLevelSpecificFeedback(\r\n    feedback: WritingFeedback,\r\n    level: number\r\n  ): Promise<string> {\r\n    \r\n    if (level <= 2) {\r\n      return 'ê¸°ì´ˆ ë‹¨ê³„ì…ë‹ˆë‹¤. ë§ì¶¤ë²•ê³¼ ê¸°ë³¸ ë¬¸ë²•ì— ì§‘ì¤‘í•˜ì„¸ìš”.';\r\n    } else if (level <= 4) {\r\n      return 'ì¤‘ê¸‰ ë‹¨ê³„ì…ë‹ˆë‹¤. ë¬¸ë²• ì •í™•ì„±ê³¼ ìì—°ìŠ¤ëŸ¬ìš´ í‘œí˜„ì„ ì—°ìŠµí•˜ì„¸ìš”.';\r\n    } else {\r\n      return 'ê³ ê¸‰ ë‹¨ê³„ì…ë‹ˆë‹¤. ë‹¤ì–‘í•œ í‘œí˜„ê³¼ ê³ ê¸‰ ì–´íœ˜ ì‚¬ìš©ì— ë„ì „í•˜ì„¸ìš”.';\r\n    }\r\n  }\r\n}\r\n\r\nexport const writingModeService = new WritingModeService();","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\state\\AudioFlowStateMachine.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'data' is defined but never used. Allowed unused args must match /^_/u.","line":148,"column":75,"nodeType":null,"messageId":"unusedVar","endLine":148,"endColumn":79}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * AudioFlowStateMachine - ë©”ì¸ ìƒíƒœ ë¨¸ì‹ \r\n * ëª©ì : ì˜¤ë””ì˜¤ í”Œë¡œìš° ìƒíƒœë¥¼ ì²´ê³„ì ìœ¼ë¡œ ê´€ë¦¬í•˜ê³  ì „í™˜ì„ ì œì–´\r\n */\r\n\r\nimport { BaseFlowState } from './BaseFlowState';\r\nimport type { \r\n  FlowState, \r\n  FlowAction, \r\n  ActionResult, \r\n  StateDisplayInfo, \r\n  StateMachineContext, \r\n  FlowCallbacks,\r\n  StateTransition \r\n} from './types';\r\n\r\n// êµ¬ì²´ ìƒíƒœ í´ë˜ìŠ¤ë“¤ import (Phase 2ì—ì„œ êµ¬í˜„)\r\nimport { IdleState } from './states/IdleState';\r\nimport { TTSState } from './states/TTSState';\r\nimport { BeepState } from './states/BeepState';\r\nimport { RecordingState } from './states/RecordingState';\r\nimport { ProcessingState } from './states/ProcessingState';\r\nimport { TimeoutState } from './states/TimeoutState';\r\n\r\nexport class AudioFlowStateMachine {\r\n  private currentState: BaseFlowState;\r\n  private context: StateMachineContext;\r\n  private callbacks: FlowCallbacks;\r\n  private states: Map<FlowState, BaseFlowState>;\r\n  private transitionMap: Map<string, StateTransition[]>;\r\n\r\n  constructor(callbacks: FlowCallbacks, recordingDuration: number = 10) {\r\n    this.callbacks = callbacks;\r\n    this.context = {\r\n      remainingTime: 0,\r\n      isPaused: false,\r\n      recordingDuration,\r\n    };\r\n\r\n    // ìƒíƒœ ì¸ìŠ¤í„´ìŠ¤ë“¤ ì´ˆê¸°í™”\r\n    this.states = new Map();\r\n    this.initializeStates();\r\n    \r\n    // ìƒíƒœ ì „í™˜ ê·œì¹™ ì´ˆê¸°í™”\r\n    this.transitionMap = new Map();\r\n    this.initializeTransitions();\r\n\r\n    // ì´ˆê¸° ìƒíƒœ ì„¤ì •\r\n    this.currentState = this.states.get('idle')!;\r\n  }\r\n\r\n  private initializeStates(): void {\r\n    const stateClasses = [\r\n      IdleState,\r\n      TTSState,\r\n      BeepState,\r\n      RecordingState,\r\n      ProcessingState,\r\n      TimeoutState,\r\n    ];\r\n\r\n    stateClasses.forEach(StateClass => {\r\n      const stateInstance = new StateClass(this.context, this.callbacks);\r\n      this.states.set(stateInstance.getStateName(), stateInstance);\r\n    });\r\n  }\r\n\r\n  private initializeTransitions(): void {\r\n    const transitions: StateTransition[] = [\r\n      // ì •ìƒ í”Œë¡œìš°\r\n      { from: 'idle', to: 'tts', action: 'start' },\r\n      { from: 'tts', to: 'beep', action: 'complete' },\r\n      { from: 'beep', to: 'recording', action: 'complete' },\r\n      { from: 'recording', to: 'processing', action: 'complete' },\r\n      { from: 'processing', to: 'idle', action: 'complete' },\r\n      \r\n      // íƒ€ì„ì•„ì›ƒ í”Œë¡œìš°\r\n      { from: 'recording', to: 'timeout', action: 'timeout' },\r\n      { from: 'timeout', to: 'idle', action: 'complete' },\r\n      \r\n      // ì¤‘ì§€ í”Œë¡œìš°\r\n      { from: 'tts', to: 'idle', action: 'stop' },\r\n      { from: 'beep', to: 'idle', action: 'stop' },\r\n      { from: 'recording', to: 'idle', action: 'stop' },\r\n      { from: 'timeout', to: 'idle', action: 'stop' },\r\n    ];\r\n\r\n    transitions.forEach(transition => {\r\n      const key = `${transition.from}-${transition.action}`;\r\n      const existing = this.transitionMap.get(key) || [];\r\n      existing.push(transition);\r\n      this.transitionMap.set(key, existing);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * í˜„ì¬ ìƒíƒœ ë°˜í™˜\r\n   */\r\n  public getCurrentState(): FlowState {\r\n    return this.currentState.getStateName();\r\n  }\r\n\r\n  /**\r\n   * ì»¨í…ìŠ¤íŠ¸ ì •ë³´ ë°˜í™˜\r\n   */\r\n  public getContext(): StateMachineContext {\r\n    return { ...this.context };\r\n  }\r\n\r\n  /**\r\n   * ìƒíƒœ í‘œì‹œ ì •ë³´ ë°˜í™˜\r\n   */\r\n  public getDisplayInfo(): StateDisplayInfo {\r\n    return this.currentState.getDisplayInfo();\r\n  }\r\n\r\n  /**\r\n   * í—ˆìš©ëœ ì•¡ì…˜ ëª©ë¡ ë°˜í™˜\r\n   */\r\n  public getAllowedActions(): FlowAction[] {\r\n    return this.currentState.getAllowedActions();\r\n  }\r\n\r\n  /**\r\n   * ì•¡ì…˜ ì‹¤í–‰\r\n   */\r\n  public async executeAction(action: FlowAction, data?: any): Promise<ActionResult> {\r\n    console.log(`[StateMachine] Executing action '${action}' in state '${this.getCurrentState()}'`);\r\n    \r\n    try {\r\n      const result = this.currentState.handleAction(action);\r\n      \r\n      if (result.success && result.newState && result.newState !== this.getCurrentState()) {\r\n        await this.transitionTo(result.newState, action, data);\r\n      }\r\n      \r\n      return result;\r\n    } catch (error) {\r\n      const errorMessage = error instanceof Error ? error.message : 'Unknown error';\r\n      this.callbacks.onError(`Action execution failed: ${errorMessage}`);\r\n      return { success: false, error: errorMessage };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ì§ì ‘ ìƒíƒœ ì „í™˜ (ë‚´ë¶€ìš©)\r\n   */\r\n  public async transitionTo(newStateName: FlowState, action?: FlowAction, data?: any): Promise<void> {\r\n    const currentStateName = this.getCurrentState();\r\n    \r\n    console.log(`[StateMachine] Transitioning: ${currentStateName} â†’ ${newStateName}`);\r\n    \r\n    // ì „í™˜ ê°€ëŠ¥ì„± ê²€ì¦\r\n    if (action && !this.isTransitionAllowed(currentStateName, newStateName, action)) {\r\n      throw new Error(\r\n        `Transition from '${currentStateName}' to '${newStateName}' with action '${action}' is not allowed`\r\n      );\r\n    }\r\n\r\n    const newState = this.states.get(newStateName);\r\n    if (!newState) {\r\n      throw new Error(`State '${newStateName}' not found`);\r\n    }\r\n\r\n    // í˜„ì¬ ìƒíƒœ ì¢…ë£Œ\r\n    await this.currentState.exit();\r\n    \r\n    // ìƒˆ ìƒíƒœë¡œ ì „í™˜\r\n    this.currentState = newState;\r\n    \r\n    // ìƒˆ ìƒíƒœ ì§„ì…\r\n    await this.currentState.enter();\r\n    \r\n    console.log(`[StateMachine] Transition completed: ${newStateName}`);\r\n  }\r\n\r\n  /**\r\n   * ì „í™˜ ê°€ëŠ¥ì„± ê²€ì¦\r\n   */\r\n  private isTransitionAllowed(from: FlowState, to: FlowState, action: FlowAction): boolean {\r\n    const key = `${from}-${action}`;\r\n    const transitions = this.transitionMap.get(key) || [];\r\n    \r\n    return transitions.some(transition => \r\n      transition.to === to && \r\n      (!transition.condition || transition.condition())\r\n    );\r\n  }\r\n\r\n  /**\r\n   * í”Œë¡œìš° ì‹œì‘ (ì™¸ë¶€ ì¸í„°í˜ì´ìŠ¤)\r\n   */\r\n  public async startFlow(text: string): Promise<ActionResult> {\r\n    this.context.currentText = text;\r\n    return this.executeAction('start');\r\n  }\r\n\r\n  /**\r\n   * ì¼ì‹œì •ì§€\r\n   */\r\n  public pauseFlow(): ActionResult {\r\n    if (this.context.isPaused) {\r\n      return { success: false, error: 'Already paused' };\r\n    }\r\n    \r\n    const result = this.currentState.handleAction('pause');\r\n    if (result.success) {\r\n      this.context.isPaused = true;\r\n    }\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * ì¬ê°œ\r\n   */\r\n  public resumeFlow(): ActionResult {\r\n    if (!this.context.isPaused) {\r\n      return { success: false, error: 'Not paused' };\r\n    }\r\n    \r\n    const result = this.currentState.handleAction('resume');\r\n    if (result.success) {\r\n      this.context.isPaused = false;\r\n    }\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * ì¤‘ì§€\r\n   */\r\n  public stopFlow(): ActionResult {\r\n    const result = this.currentState.handleAction('stop');\r\n    if (result.success) {\r\n      this.context.isPaused = false;\r\n      this.context.remainingTime = 0;\r\n    }\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * ì •ë‹µ ì¬ìƒ\r\n   */\r\n  public async playAnswerAndNext(answerText?: string): Promise<ActionResult> {\r\n    this.context.answerText = answerText;\r\n    return this.executeAction('complete');\r\n  }\r\n\r\n  /**\r\n   * ì»¨í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸\r\n   */\r\n  public updateContext(updates: Partial<StateMachineContext>): void {\r\n    this.context = { ...this.context, ...updates };\r\n  }\r\n\r\n  /**\r\n   * ì •ë¦¬\r\n   */\r\n  public async cleanup(): Promise<void> {\r\n    console.log('[StateMachine] Cleaning up...');\r\n    \r\n    try {\r\n      await this.currentState.exit();\r\n    } catch (error) {\r\n      console.warn('[StateMachine] Error during cleanup:', error);\r\n    }\r\n    \r\n    // ëª¨ë“  ìƒíƒœ ì •ë¦¬\r\n    this.states.clear();\r\n    this.transitionMap.clear();\r\n  }\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\state\\BaseFlowState.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\state\\states\\BeepState.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\state\\states\\IdleState.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\state\\states\\ProcessingState.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\state\\states\\RecordingState.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\state\\states\\TTSState.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\state\\states\\TimeoutState.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\state\\types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\store\\useAppStore.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'state' is defined but never used. Allowed unused args must match /^_/u.","line":138,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":138,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'state' is defined but never used. Allowed unused args must match /^_/u.","line":145,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":145,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'state' is defined but never used. Allowed unused args must match /^_/u.","line":175,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":175,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'state' is defined but never used. Allowed unused args must match /^_/u.","line":265,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":265,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { create } from 'zustand';\r\nimport { persist } from 'zustand/middleware';\r\nimport type { AppSettings, StudyState, DrillCard, StudySession, FeedbackResponse } from '@/types';\r\n\r\nexport type LearningMode = 'writing' | 'speaking';\r\n\r\nexport type ThemeMode = 'default' | 'personal';\r\n\r\nexport interface PersonalTheme {\r\n  primary: string;    // #4A90E2 (ì°¨ë¶„í•œ ë¸”ë£¨)\r\n  secondary: string;  // #7B68EE (ë¯¸ë””ì—„ í¼í”Œ)\r\n  accent: string;     // #FF8A80 (ë”°ëœ»í•œ ì½”ë„)\r\n  base: string;       // #F5F7FA (ë¶€ë“œëŸ¬ìš´ í™”ì´íŠ¸)\r\n}\r\n\r\ninterface AppStore {\r\n  // Settings\r\n  settings: AppSettings;\r\n  updateSettings: (settings: Partial<AppSettings>) => void;\r\n\r\n  // Global Learning Mode\r\n  learningMode: LearningMode;\r\n  setLearningMode: (mode: LearningMode) => void;\r\n  \r\n  // Speaking Stage (1ë‹¨ê³„ 3ì´ˆ, 2ë‹¨ê³„ 2ì´ˆ, 3ë‹¨ê³„ 1ì´ˆ)\r\n  speakingStage: 1 | 2 | 3;\r\n  setSpeakingStage: (stage: 1 | 2 | 3) => void;\r\n  \r\n  // Stage Progress for 3-step system\r\n  stageProgress: Record<string, boolean[]>; // key: \"level-stage\" => [1ë‹¨ê³„ì™„ë£Œ, 2ë‹¨ê³„ì™„ë£Œ, 3ë‹¨ê³„ì™„ë£Œ]\r\n  updateStageProgress: (level: number, stage: number, speakingStage: 1 | 2 | 3, completed: boolean) => void;\r\n  getStageProgress: (level: number, stage: number) => boolean[];\r\n\r\n  // Theme System\r\n  themeMode: ThemeMode;\r\n  personalTheme: PersonalTheme;\r\n  setThemeMode: (mode: ThemeMode) => void;\r\n  setPersonalTheme: (theme: Partial<PersonalTheme>) => void;\r\n\r\n  // User state\r\n  user: {\r\n    id: string | null;\r\n    level: number;\r\n    stage: number | 'ALL';\r\n    isAuthenticated: boolean;\r\n  };\r\n  setUser: (user: Partial<AppStore['user']>) => void;\r\n  setUserLevel: (level: number) => void;\r\n  setUserStage: (stage: number | 'ALL') => void;\r\n\r\n  // Stage selection state\r\n  stageSelection: {\r\n    selectedLevel: number | null;\r\n    isStageModalOpen: boolean;\r\n  };\r\n  setSelectedLevel: (level: number | null) => void;\r\n  setStageModalOpen: (isOpen: boolean) => void;\r\n  selectLevelAndStage: (level: number, stage: number | 'ALL') => void;\r\n\r\n  // Study session state\r\n  study: StudyState;\r\n  setCurrentSession: (session: StudySession | null) => void;\r\n  setCurrentCard: (card: DrillCard | null, index: number) => void;\r\n  setCards: (cards: DrillCard[]) => void;\r\n  setRecording: (isRecording: boolean) => void;\r\n  setProcessing: (isProcessing: boolean) => void;\r\n  setFeedback: (feedback: FeedbackResponse | null) => void;\r\n  resetStudyState: () => void;\r\n\r\n  // UI state\r\n  ui: {\r\n    isLoading: boolean;\r\n    error: string | null;\r\n    notification: string | null;\r\n  };\r\n  setLoading: (isLoading: boolean) => void;\r\n  setError: (error: string | null) => void;\r\n  setNotification: (notification: string | null) => void;\r\n  clearError: () => void;\r\n  clearNotification: () => void;\r\n}\r\n\r\nconst initialSettings: AppSettings = {\r\n  language: 'ko',\r\n  sttEngine: 'browser',\r\n  ttsEnabled: true,\r\n  volume: 1.0,\r\n};\r\n\r\nconst initialStudyState: StudyState = {\r\n  currentSession: null,\r\n  currentCard: null,\r\n  currentIndex: 0,\r\n  cards: [],\r\n  isRecording: false,\r\n  isProcessing: false,\r\n  feedback: null,\r\n};\r\n\r\nconst initialUserState = {\r\n  id: null,\r\n  level: 1,\r\n  stage: 1,\r\n  isAuthenticated: false,\r\n};\r\n\r\nconst initialStageSelectionState = {\r\n  selectedLevel: null,\r\n  isStageModalOpen: false,\r\n};\r\n\r\nconst initialUIState = {\r\n  isLoading: false,\r\n  error: null,\r\n  notification: null,\r\n};\r\n\r\nconst initialPersonalTheme: PersonalTheme = {\r\n  primary: '#6b7280',    // íšŒìƒ‰ (ê¸°ë³¸ í…Œë§ˆì™€ ë™ì¼)\r\n  secondary: '#ffffff',  // í°ìƒ‰ (ê¸°ë³¸ í…Œë§ˆì™€ ë™ì¼)\r\n  accent: '#4b5563',     // ì–´ë‘ìš´ íšŒìƒ‰ (ê¸°ë³¸ í…Œë§ˆì™€ ë™ì¼)\r\n  base: '#f9fafb',       // ì—°í•œ íšŒìƒ‰ ë°°ê²½ (ê¸°ë³¸ í…Œë§ˆì™€ ë™ì¼)\r\n};\r\n\r\nexport const useAppStore = create<AppStore>()(\r\n  persist(\r\n    (set, get) => ({\r\n      // Settings\r\n      settings: initialSettings,\r\n      updateSettings: (newSettings) =>\r\n        set((state) => ({\r\n          settings: { ...state.settings, ...newSettings },\r\n        })),\r\n\r\n      // Global Learning Mode\r\n      learningMode: 'speaking', // ê¸°ë³¸ê°’ì€ ê¸°ì¡´ ë°©ì‹(speaking)\r\n      setLearningMode: (mode) =>\r\n        set((state) => ({\r\n          learningMode: mode,\r\n        })),\r\n      \r\n      // Speaking Stage\r\n      speakingStage: 1, // ê¸°ë³¸ê°’: 1ë‹¨ê³„ (3ì´ˆ)\r\n      setSpeakingStage: (stage) =>\r\n        set((state) => ({\r\n          speakingStage: stage,\r\n        })),\r\n      \r\n      // Stage Progress\r\n      stageProgress: {},\r\n      updateStageProgress: (level, stage, speakingStage, completed) =>\r\n        set((state) => {\r\n          const key = `${level}-${stage}`;\r\n          const currentProgress = state.stageProgress[key] || [false, false, false];\r\n          const newProgress = [...currentProgress];\r\n          newProgress[speakingStage - 1] = completed; // 0-based index\r\n          \r\n          return {\r\n            stageProgress: {\r\n              ...state.stageProgress,\r\n              [key]: newProgress\r\n            }\r\n          };\r\n        }),\r\n      getStageProgress: (level, stage) => {\r\n        const state = get();\r\n        const key = `${level}-${stage}`;\r\n        return state.stageProgress[key] || [false, false, false];\r\n      },\r\n\r\n      // Theme System\r\n      themeMode: 'default', // ê¸°ë³¸ê°’: ê¹”ë”í•œ í…Œë§ˆ\r\n      personalTheme: initialPersonalTheme,\r\n      setThemeMode: (mode) =>\r\n        set((state) => ({\r\n          themeMode: mode,\r\n        })),\r\n      setPersonalTheme: (theme) =>\r\n        set((state) => ({\r\n          personalTheme: { ...state.personalTheme, ...theme },\r\n        })),\r\n\r\n      // User\r\n      user: initialUserState,\r\n      setUser: (userData) =>\r\n        set((state) => ({\r\n          user: { ...state.user, ...userData },\r\n        })),\r\n      \r\n      setUserLevel: (level) =>\r\n        set((state) => ({\r\n          user: { ...state.user, level },\r\n        })),\r\n      \r\n      setUserStage: (stage) =>\r\n        set((state) => ({\r\n          user: { ...state.user, stage },\r\n        })),\r\n\r\n      // Stage selection\r\n      stageSelection: initialStageSelectionState,\r\n      \r\n      setSelectedLevel: (level) =>\r\n        set((state) => ({\r\n          stageSelection: { ...state.stageSelection, selectedLevel: level },\r\n        })),\r\n\r\n      setStageModalOpen: (isOpen) =>\r\n        set((state) => ({\r\n          stageSelection: { ...state.stageSelection, isStageModalOpen: isOpen },\r\n        })),\r\n\r\n      selectLevelAndStage: (level, stage) =>\r\n        set((state) => ({\r\n          user: { \r\n            ...state.user, \r\n            level, \r\n            stage \r\n          },\r\n          stageSelection: { \r\n            selectedLevel: null, \r\n            isStageModalOpen: false \r\n          },\r\n        })),\r\n\r\n      // Study session\r\n      study: initialStudyState,\r\n      \r\n      setCurrentSession: (session) =>\r\n        set((state) => ({\r\n          study: { ...state.study, currentSession: session },\r\n        })),\r\n\r\n      setCurrentCard: (card, index) =>\r\n        set((state) => ({\r\n          study: { \r\n            ...state.study, \r\n            currentCard: card, \r\n            currentIndex: index,\r\n            feedback: null, // Clear previous feedback\r\n          },\r\n        })),\r\n\r\n      setCards: (cards) =>\r\n        set((state) => ({\r\n          study: { ...state.study, cards },\r\n        })),\r\n\r\n      setRecording: (isRecording) =>\r\n        set((state) => ({\r\n          study: { ...state.study, isRecording },\r\n        })),\r\n\r\n      setProcessing: (isProcessing) =>\r\n        set((state) => ({\r\n          study: { ...state.study, isProcessing },\r\n        })),\r\n\r\n      setFeedback: (feedback) =>\r\n        set((state) => ({\r\n          study: { ...state.study, feedback },\r\n        })),\r\n\r\n      resetStudyState: () =>\r\n        set((state) => ({\r\n          study: initialStudyState,\r\n        })),\r\n\r\n      // UI state\r\n      ui: initialUIState,\r\n\r\n      setLoading: (isLoading) =>\r\n        set((state) => ({\r\n          ui: { ...state.ui, isLoading },\r\n        })),\r\n\r\n      setError: (error) =>\r\n        set((state) => ({\r\n          ui: { ...state.ui, error },\r\n        })),\r\n\r\n      setNotification: (notification) =>\r\n        set((state) => ({\r\n          ui: { ...state.ui, notification },\r\n        })),\r\n\r\n      clearError: () =>\r\n        set((state) => ({\r\n          ui: { ...state.ui, error: null },\r\n        })),\r\n\r\n      clearNotification: () =>\r\n        set((state) => ({\r\n          ui: { ...state.ui, notification: null },\r\n        })),\r\n    }),\r\n    {\r\n      name: 'dasi-english-store',\r\n      // Only persist settings, user data, learning mode, and stage progress\r\n      partialize: (state) => ({\r\n        settings: state.settings,\r\n        user: state.user,\r\n        learningMode: state.learningMode,\r\n        speakingStage: state.speakingStage,\r\n        stageProgress: state.stageProgress,\r\n      }),\r\n    }\r\n  )\r\n);\r\n\r\n// Selectors for easier access\r\nexport const useSettings = () => useAppStore((state) => state.settings);\r\nexport const useUser = () => useAppStore((state) => state.user);\r\nexport const useStudy = () => useAppStore((state) => ({\r\n  ...state.study,\r\n  cards: state.study.cards || [],\r\n}));\r\nexport const useUI = () => useAppStore((state) => state.ui);\r\nexport const useLearningMode = () => useAppStore((state) => ({\r\n  mode: state.learningMode,\r\n  setLearningMode: state.setLearningMode,\r\n}));\r\n\r\nexport const useSpeakingStage = () => useAppStore((state) => ({\r\n  stage: state.speakingStage,\r\n  setSpeakingStage: state.setSpeakingStage,\r\n}));\r\n\r\nexport const useStageSelection = () => useAppStore((state) => ({\r\n  stageSelection: state.stageSelection,\r\n  setSelectedLevel: state.setSelectedLevel,\r\n  setStageModalOpen: state.setStageModalOpen,\r\n  selectLevelAndStage: state.selectLevelAndStage,\r\n}));\r\n\r\nexport const useTheme = () => useAppStore((state) => ({\r\n  themeMode: state.themeMode,\r\n  personalTheme: state.personalTheme,\r\n  setThemeMode: state.setThemeMode,\r\n  setPersonalTheme: state.setPersonalTheme,\r\n}));\r\n\r\nexport const useStageProgress = () => useAppStore((state) => ({\r\n  stageProgress: state.stageProgress,\r\n  updateStageProgress: state.updateStageProgress,\r\n  getStageProgress: state.getStageProgress,\r\n}));","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\types\\core.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\types\\global.d.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\types\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\types\\interview.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\types\\pattern-training.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\types\\services.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\utils\\answerNormalization.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\utils\\errorHandling.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\utils\\index.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'context' is defined but never used. Allowed unused args must match /^_/u.","line":40,"column":44,"nodeType":null,"messageId":"unusedVar","endLine":40,"endColumn":51}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @fileoverview ìœ í‹¸ë¦¬í‹° ëª¨ë“ˆì˜ ì¤‘ì•™ ì§‘ì¤‘ì‹ ìµìŠ¤í¬íŠ¸\n * @description ê¸°ë³¸ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë“¤\n * @author DaSiStart Team\n * @version 1.0.0\n */\n\n// ë¡œê·¸ ì¹´í…Œê³ ë¦¬ íƒ€ì…\nexport type LogCategory = 'PERFORMANCE' | 'API' | 'AUDIO' | 'SRS' | 'PLUGIN' | 'GENERAL';\n\n// ê°œë³„ ë¡œê¹… í•¨ìˆ˜ë“¤ (í”ŒëŸ¬ê·¸ì¸ ì‹œìŠ¤í…œì—ì„œ ì‚¬ìš©)\nexport const logInfo = (message: string, category?: LogCategory) =>\n  console.log(`[INFO]${category ? `[${category}]` : ''} ${message}`);\n\nexport const logWarn = (message: string, category?: LogCategory) =>\n  console.warn(`[WARN]${category ? `[${category}]` : ''} ${message}`);\n\nexport const logError = (message: string, category?: LogCategory) =>\n  console.error(`[ERROR]${category ? `[${category}]` : ''} ${message}`);\n\nexport const logDebug = (message: string, category?: LogCategory) =>\n  console.debug(`[DEBUG]${category ? `[${category}]` : ''} ${message}`);\n\n// ê¸°ë³¸ ë¡œê¹… í•¨ìˆ˜ (ë ˆê±°ì‹œ í˜¸í™˜ì„±)\nexport const logger = {\n  info: logInfo,\n  warn: logWarn,\n  error: logError,\n  debug: logDebug\n};\n\n// ê¸°ë³¸ ì—ëŸ¬ í•¸ë“¤ëŸ¬\nexport const errorHandler = {\n  handle: (error: any, context?: string) => {\n    console.error(`Error${context ? ` in ${context}` : ''}:`, error);\n  }\n};\n\n// API ì—ëŸ¬ í•¸ë“¤ë§ í•¨ìˆ˜\nexport const handleApiError = (error: any, context?: any) => {\n  const errorMessage = error?.response?.data?.message || error?.message || 'API Error';\n  logger.error(`API Error: ${errorMessage}`, 'API');\n  return {\n    success: false,\n    error: errorMessage,\n    timestamp: Date.now()\n  };\n};\n\n// ê¸°ë³¸ ì„±ëŠ¥ ëª¨ë‹ˆí„°\nexport const performanceMonitor = {\n  start: (label: string) => console.time(label),\n  end: (label: string) => console.timeEnd(label),\n  mark: (label: string) => logger.debug(`Performance mark: ${label}`)\n};\n\n// ë¡œê·¸ ì¹´í…Œê³ ë¦¬ ìƒìˆ˜\nexport const LogCategory = {\n  AUDIO: 'AUDIO',\n  API: 'API',\n  PERFORMANCE: 'PERFORMANCE',\n  USER_INTERACTION: 'USER_INTERACTION',\n  ERROR: 'ERROR'\n} as const;\n\n// ì—ëŸ¬ íƒ€ì… ìƒìˆ˜\nexport const ErrorType = {\n  API_CONNECTION: 'API_CONNECTION',\n  API_TIMEOUT: 'API_TIMEOUT',\n  API_UNAUTHORIZED: 'API_UNAUTHORIZED',\n  SPEECH_PERMISSION_DENIED: 'SPEECH_PERMISSION_DENIED',\n  SPEECH_NOT_SUPPORTED: 'SPEECH_NOT_SUPPORTED',\n  BROWSER_NOT_SUPPORTED: 'BROWSER_NOT_SUPPORTED'\n} as const;\n\n// DaSi ëª¨ë‹ˆí„°ë§ í´ë˜ìŠ¤ (ê°„ì†Œí™”)\nexport class DaSiStartMonitoring {\n  private static instance: DaSiStartMonitoring | null = null;\n  private isInitialized = false;\n\n  private constructor() {\n    this.setupSystemInfo();\n    this.startPerformanceMonitoring();\n  }\n\n  static getInstance(): DaSiStartMonitoring {\n    if (!DaSiStartMonitoring.instance) {\n      DaSiStartMonitoring.instance = new DaSiStartMonitoring();\n    }\n    return DaSiStartMonitoring.instance;\n  }\n\n  private setupSystemInfo(): void {\n    try {\n      logger.info('DaSi monitoring system initialized', LogCategory.PERFORMANCE);\n      this.isInitialized = true;\n    } catch (error) {\n      console.error('Failed to setup system info:', error);\n    }\n  }\n\n  private startPerformanceMonitoring(): void {\n    try {\n      performanceMonitor.start('DaSi-Session');\n      logger.info('Performance monitoring started', LogCategory.PERFORMANCE);\n    } catch (error) {\n      console.error('Failed to start performance monitoring:', error);\n    }\n  }\n\n  public logUserAction(action: string, details?: any): void {\n    logger.info(`User action: ${action}`, LogCategory.USER_INTERACTION);\n    if (details) {\n      logger.debug(`Action details: ${JSON.stringify(details)}`, LogCategory.USER_INTERACTION);\n    }\n  }\n\n  public reportError(error: any, context?: string): void {\n    errorHandler.handle(error, context);\n    logger.error(`Error reported: ${error.message || error}`, LogCategory.ERROR);\n  }\n}\n\n// ìë™ ì´ˆê¸°í™”\nsetTimeout(() => {\n  try {\n    DaSiStartMonitoring.getInstance();\n  } catch (error) {\n    console.warn('DaSi monitoring initialization failed:', error);\n  }\n}, 100);\n\n// ê¸°ë³¸ ìµìŠ¤í¬íŠ¸\nexport default {\n  logger,\n  errorHandler,\n  performanceMonitor,\n  LogCategory,\n  ErrorType,\n  DaSiStartMonitoring\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\utils\\loggingUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\utils\\performanceUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\utils\\speakingStageUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\utils\\speechUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\utils\\stageFocusDefaults.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\kimdaesoo\\source\\claude\\DaSi_eng\\web_app\\src\\utils\\urlParams.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]
